!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function i(a){return this instanceof i?(this.length=0,this.parent=void 0,"number"==typeof a?j(this,a):"string"==typeof a?k(this,a,arguments.length>1?arguments[1]:"utf8"):l(this,a)):arguments.length>1?new i(a,arguments[1]):new i(a)}function j(a,b){if(a=r(a,b<0?0:0|s(b)),!i.TYPED_ARRAY_SUPPORT)for(var c=0;c<b;c++)a[c]=0;return a}function k(a,b,c){"string"==typeof c&&""!==c||(c="utf8");var d=0|u(b,c);return a=r(a,d),a.write(b,c),a}function l(a,b){if(i.isBuffer(b))return m(a,b);if(f(b))return n(a,b);if(null==b)throw new TypeError("must start with number, buffer, array or string");return"undefined"!=typeof ArrayBuffer&&b.buffer instanceof ArrayBuffer?o(a,b):b.length?p(a,b):q(a,b)}function m(a,b){var c=0|s(b.length);return a=r(a,c),b.copy(a,0,0,c),a}function n(a,b){var c=0|s(b.length);a=r(a,c);for(var d=0;d<c;d+=1)a[d]=255&b[d];return a}function o(a,b){var c=0|s(b.length);a=r(a,c);for(var d=0;d<c;d+=1)a[d]=255&b[d];return a}function p(a,b){var c=0|s(b.length);a=r(a,c);for(var d=0;d<c;d+=1)a[d]=255&b[d];return a}function q(a,b){var c,d=0;"Buffer"===b.type&&f(b.data)&&(c=b.data,d=0|s(c.length)),a=r(a,d);for(var e=0;e<d;e+=1)a[e]=255&c[e];return a}function r(a,b){i.TYPED_ARRAY_SUPPORT?a=i._augment(new Uint8Array(b)):(a.length=b,a._isBuffer=!0);var c=0!==b&&b<=i.poolSize>>>1;return c&&(a.parent=h),a}function s(a){if(a>=g)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+g.toString(16)+" bytes");return 0|a}function t(a,b){if(!(this instanceof t))return new t(a,b);var c=new i(a,b);return delete c.parent,c}function u(a,b){if("string"!=typeof a&&(a=String(a)),0===a.length)return 0;switch(b||"utf8"){case"ascii":case"binary":case"raw":return a.length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*a.length;case"hex":return a.length>>>1;case"utf8":case"utf-8":return T(a).length;case"base64":return W(a).length;default:return a.length}}function v(a,b,c,d){c=Number(c)||0;var e=a.length-c;d?(d=Number(d),d>e&&(d=e)):d=e;var f=b.length;if(f%2!==0)throw new Error("Invalid hex string");d>f/2&&(d=f/2);for(var g=0;g<d;g++){var h=parseInt(b.substr(2*g,2),16);if(isNaN(h))throw new Error("Invalid hex string");a[c+g]=h}return g}function w(a,b,c,d){return X(T(b,a.length-c),a,c,d)}function x(a,b,c,d){return X(U(b),a,c,d)}function y(a,b,c,d){return x(a,b,c,d)}function z(a,b,c,d){return X(W(b),a,c,d)}function A(a,b,c,d){return X(V(b,a.length-c),a,c,d)}function B(a,b,c){return 0===b&&c===a.length?d.fromByteArray(a):d.fromByteArray(a.slice(b,c))}function C(a,b,c){var d="",e="";c=Math.min(a.length,c);for(var f=b;f<c;f++)a[f]<=127?(d+=Y(e)+String.fromCharCode(a[f]),e=""):e+="%"+a[f].toString(16);return d+Y(e)}function D(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;e<c;e++)d+=String.fromCharCode(127&a[e]);return d}function E(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;e<c;e++)d+=String.fromCharCode(a[e]);return d}function F(a,b,c){var d=a.length;(!b||b<0)&&(b=0),(!c||c<0||c>d)&&(c=d);for(var e="",f=b;f<c;f++)e+=S(a[f]);return e}function G(a,b,c){for(var d=a.slice(b,c),e="",f=0;f<d.length;f+=2)e+=String.fromCharCode(d[f]+256*d[f+1]);return e}function H(a,b,c){if(a%1!==0||a<0)throw new RangeError("offset is not uint");if(a+b>c)throw new RangeError("Trying to access beyond buffer length")}function I(a,b,c,d,e,f){if(!i.isBuffer(a))throw new TypeError("buffer must be a Buffer instance");if(b>e||b<f)throw new RangeError("value is out of bounds");if(c+d>a.length)throw new RangeError("index out of range")}function J(a,b,c,d){b<0&&(b=65535+b+1);for(var e=0,f=Math.min(a.length-c,2);e<f;e++)a[c+e]=(b&255<<8*(d?e:1-e))>>>8*(d?e:1-e)}function K(a,b,c,d){b<0&&(b=4294967295+b+1);for(var e=0,f=Math.min(a.length-c,4);e<f;e++)a[c+e]=b>>>8*(d?e:3-e)&255}function L(a,b,c,d,e,f){if(b>e||b<f)throw new RangeError("value is out of bounds");if(c+d>a.length)throw new RangeError("index out of range");if(c<0)throw new RangeError("index out of range")}function M(a,b,c,d,f){return f||L(a,b,c,4,3.4028234663852886e38,-3.4028234663852886e38),e.write(a,b,c,d,23,4),c+4}function N(a,b,c,d,f){return f||L(a,b,c,8,1.7976931348623157e308,-1.7976931348623157e308),e.write(a,b,c,d,52,8),c+8}function Q(a){if(a=R(a).replace(P,""),a.length<2)return"";for(;a.length%4!==0;)a+="=";return a}function R(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function S(a){return a<16?"0"+a.toString(16):a.toString(16)}function T(a,b){b=b||1/0;for(var c,d=a.length,e=null,f=[],g=0;g<d;g++){if(c=a.charCodeAt(g),c>55295&&c<57344){if(!e){if(c>56319){(b-=3)>-1&&f.push(239,191,189);continue}if(g+1===d){(b-=3)>-1&&f.push(239,191,189);continue}e=c;continue}if(c<56320){(b-=3)>-1&&f.push(239,191,189),e=c;continue}c=e-55296<<10|c-56320|65536,e=null}else e&&((b-=3)>-1&&f.push(239,191,189),e=null);if(c<128){if((b-=1)<0)break;f.push(c)}else if(c<2048){if((b-=2)<0)break;f.push(c>>6|192,63&c|128)}else if(c<65536){if((b-=3)<0)break;f.push(c>>12|224,c>>6&63|128,63&c|128)}else{if(!(c<2097152))throw new Error("Invalid code point");if((b-=4)<0)break;f.push(c>>18|240,c>>12&63|128,c>>6&63|128,63&c|128)}}return f}function U(a){for(var b=[],c=0;c<a.length;c++)b.push(255&a.charCodeAt(c));return b}function V(a,b){for(var c,d,e,f=[],g=0;g<a.length&&!((b-=2)<0);g++)c=a.charCodeAt(g),d=c>>8,e=c%256,f.push(e),f.push(d);return f}function W(a){return d.toByteArray(Q(a))}function X(a,b,c,d){for(var e=0;e<d&&!(e+c>=b.length||e>=a.length);e++)b[e+c]=a[e];return e}function Y(a){try{return decodeURIComponent(a)}catch(a){return String.fromCharCode(65533)}}var d=a("base64-js"),e=a("ieee754"),f=a("is-array");c.Buffer=i,c.SlowBuffer=t,c.INSPECT_MAX_BYTES=50,i.poolSize=8192;var g=1073741823,h={};i.TYPED_ARRAY_SUPPORT=function(){try{var a=new ArrayBuffer(0),b=new Uint8Array(a);return b.foo=function(){return 42},42===b.foo()&&"function"==typeof b.subarray&&0===new Uint8Array(1).subarray(1,1).byteLength}catch(a){return!1}}(),i.isBuffer=function(b){return!(null==b||!b._isBuffer)},i.compare=function(b,c){if(!i.isBuffer(b)||!i.isBuffer(c))throw new TypeError("Arguments must be Buffers");if(b===c)return 0;for(var d=b.length,e=c.length,f=0,g=Math.min(d,e);f<g&&b[f]===c[f];)++f;return f!==g&&(d=b[f],e=c[f]),d<e?-1:e<d?1:0},i.isEncoding=function(b){switch(String(b).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.concat=function(b,c){if(!f(b))throw new TypeError("list argument must be an Array of Buffers.");if(0===b.length)return new i(0);if(1===b.length)return b[0];var d;if(void 0===c)for(c=0,d=0;d<b.length;d++)c+=b[d].length;var e=new i(c),g=0;for(d=0;d<b.length;d++){var h=b[d];h.copy(e,g),g+=h.length}return e},i.byteLength=u,i.prototype.length=void 0,i.prototype.parent=void 0,i.prototype.toString=function(b,c,d){var e=!1;if(c=0|c,d=void 0===d||d===1/0?this.length:0|d,b||(b="utf8"),c<0&&(c=0),d>this.length&&(d=this.length),d<=c)return"";for(;;)switch(b){case"hex":return F(this,c,d);case"utf8":case"utf-8":return C(this,c,d);case"ascii":return D(this,c,d);case"binary":return E(this,c,d);case"base64":return B(this,c,d);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return G(this,c,d);default:if(e)throw new TypeError("Unknown encoding: "+b);b=(b+"").toLowerCase(),e=!0}},i.prototype.equals=function(b){if(!i.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b||0===i.compare(this,b)},i.prototype.inspect=function(){var b="",d=c.INSPECT_MAX_BYTES;return this.length>0&&(b=this.toString("hex",0,d).match(/.{2}/g).join(" "),this.length>d&&(b+=" ... ")),"<Buffer "+b+">"},i.prototype.compare=function(b){if(!i.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b?0:i.compare(this,b)},i.prototype.indexOf=function(b,c){function d(a,b,c){for(var d=-1,e=0;c+e<a.length;e++)if(a[c+e]===b[d===-1?0:e-d]){if(d===-1&&(d=e),e-d+1===b.length)return c+d}else d=-1;return-1}if(c>2147483647?c=2147483647:c<-2147483648&&(c=-2147483648),c>>=0,0===this.length)return-1;if(c>=this.length)return-1;if(c<0&&(c=Math.max(this.length+c,0)),"string"==typeof b)return 0===b.length?-1:String.prototype.indexOf.call(this,b,c);if(i.isBuffer(b))return d(this,b,c);if("number"==typeof b)return i.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,b,c):d(this,[b],c);throw new TypeError("val must be string, number or Buffer")},i.prototype.get=function(b){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(b)},i.prototype.set=function(b,c){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(b,c)},i.prototype.write=function(b,c,d,e){if(void 0===c)e="utf8",d=this.length,c=0;else if(void 0===d&&"string"==typeof c)e=c,d=this.length,c=0;else if(isFinite(c))c=0|c,isFinite(d)?(d=0|d,void 0===e&&(e="utf8")):(e=d,d=void 0);else{var f=e;e=c,c=0|d,d=f}var g=this.length-c;if((void 0===d||d>g)&&(d=g),b.length>0&&(d<0||c<0)||c>this.length)throw new RangeError("attempt to write outside buffer bounds");e||(e="utf8");for(var h=!1;;)switch(e){case"hex":return v(this,b,c,d);case"utf8":case"utf-8":return w(this,b,c,d);case"ascii":return x(this,b,c,d);case"binary":return y(this,b,c,d);case"base64":return z(this,b,c,d);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,b,c,d);default:if(h)throw new TypeError("Unknown encoding: "+e);e=(""+e).toLowerCase(),h=!0}},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},i.prototype.slice=function(b,c){var d=this.length;b=~~b,c=void 0===c?d:~~c,b<0?(b+=d,b<0&&(b=0)):b>d&&(b=d),c<0?(c+=d,c<0&&(c=0)):c>d&&(c=d),c<b&&(c=b);var e;if(i.TYPED_ARRAY_SUPPORT)e=i._augment(this.subarray(b,c));else{var f=c-b;e=new i(f,void 0);for(var g=0;g<f;g++)e[g]=this[g+b]}return e.length&&(e.parent=this.parent||this),e},i.prototype.readUIntLE=function(b,c,d){b=0|b,c=0|c,d||H(b,c,this.length);for(var e=this[b],f=1,g=0;++g<c&&(f*=256);)e+=this[b+g]*f;return e},i.prototype.readUIntBE=function(b,c,d){b=0|b,c=0|c,d||H(b,c,this.length);for(var e=this[b+--c],f=1;c>0&&(f*=256);)e+=this[b+--c]*f;return e},i.prototype.readUInt8=function(b,c){return c||H(b,1,this.length),this[b]},i.prototype.readUInt16LE=function(b,c){return c||H(b,2,this.length),this[b]|this[b+1]<<8},i.prototype.readUInt16BE=function(b,c){return c||H(b,2,this.length),this[b]<<8|this[b+1]},i.prototype.readUInt32LE=function(b,c){return c||H(b,4,this.length),(this[b]|this[b+1]<<8|this[b+2]<<16)+16777216*this[b+3]},i.prototype.readUInt32BE=function(b,c){return c||H(b,4,this.length),16777216*this[b]+(this[b+1]<<16|this[b+2]<<8|this[b+3])},i.prototype.readIntLE=function(b,c,d){b=0|b,c=0|c,d||H(b,c,this.length);for(var e=this[b],f=1,g=0;++g<c&&(f*=256);)e+=this[b+g]*f;return f*=128,e>=f&&(e-=Math.pow(2,8*c)),e},i.prototype.readIntBE=function(b,c,d){b=0|b,c=0|c,d||H(b,c,this.length);for(var e=c,f=1,g=this[b+--e];e>0&&(f*=256);)g+=this[b+--e]*f;return f*=128,g>=f&&(g-=Math.pow(2,8*c)),g},i.prototype.readInt8=function(b,c){return c||H(b,1,this.length),128&this[b]?(255-this[b]+1)*-1:this[b]},i.prototype.readInt16LE=function(b,c){c||H(b,2,this.length);var d=this[b]|this[b+1]<<8;return 32768&d?4294901760|d:d},i.prototype.readInt16BE=function(b,c){c||H(b,2,this.length);var d=this[b+1]|this[b]<<8;return 32768&d?4294901760|d:d},i.prototype.readInt32LE=function(b,c){return c||H(b,4,this.length),this[b]|this[b+1]<<8|this[b+2]<<16|this[b+3]<<24},i.prototype.readInt32BE=function(b,c){return c||H(b,4,this.length),this[b]<<24|this[b+1]<<16|this[b+2]<<8|this[b+3]},i.prototype.readFloatLE=function(b,c){return c||H(b,4,this.length),e.read(this,b,!0,23,4)},i.prototype.readFloatBE=function(b,c){return c||H(b,4,this.length),e.read(this,b,!1,23,4)},i.prototype.readDoubleLE=function(b,c){return c||H(b,8,this.length),e.read(this,b,!0,52,8)},i.prototype.readDoubleBE=function(b,c){return c||H(b,8,this.length),e.read(this,b,!1,52,8)},i.prototype.writeUIntLE=function(b,c,d,e){b=+b,c=0|c,d=0|d,e||I(this,b,c,d,Math.pow(2,8*d),0);var f=1,g=0;for(this[c]=255&b;++g<d&&(f*=256);)this[c+g]=b/f&255;return c+d},i.prototype.writeUIntBE=function(b,c,d,e){b=+b,c=0|c,d=0|d,e||I(this,b,c,d,Math.pow(2,8*d),0);var f=d-1,g=1;for(this[c+f]=255&b;--f>=0&&(g*=256);)this[c+f]=b/g&255;return c+d},i.prototype.writeUInt8=function(b,c,d){return b=+b,c=0|c,d||I(this,b,c,1,255,0),i.TYPED_ARRAY_SUPPORT||(b=Math.floor(b)),this[c]=b,c+1},i.prototype.writeUInt16LE=function(b,c,d){return b=+b,c=0|c,d||I(this,b,c,2,65535,0),i.TYPED_ARRAY_SUPPORT?(this[c]=b,this[c+1]=b>>>8):J(this,b,c,!0),c+2},i.prototype.writeUInt16BE=function(b,c,d){return b=+b,c=0|c,d||I(this,b,c,2,65535,0),i.TYPED_ARRAY_SUPPORT?(this[c]=b>>>8,this[c+1]=b):J(this,b,c,!1),c+2},i.prototype.writeUInt32LE=function(b,c,d){return b=+b,c=0|c,d||I(this,b,c,4,4294967295,0),i.TYPED_ARRAY_SUPPORT?(this[c+3]=b>>>24,this[c+2]=b>>>16,this[c+1]=b>>>8,this[c]=b):K(this,b,c,!0),c+4},i.prototype.writeUInt32BE=function(b,c,d){return b=+b,c=0|c,d||I(this,b,c,4,4294967295,0),i.TYPED_ARRAY_SUPPORT?(this[c]=b>>>24,this[c+1]=b>>>16,this[c+2]=b>>>8,this[c+3]=b):K(this,b,c,!1),c+4},i.prototype.writeIntLE=function(b,c,d,e){if(b=+b,c=0|c,!e){var f=Math.pow(2,8*d-1);I(this,b,c,d,f-1,-f)}var g=0,h=1,i=b<0?1:0;for(this[c]=255&b;++g<d&&(h*=256);)this[c+g]=(b/h>>0)-i&255;return c+d},i.prototype.writeIntBE=function(b,c,d,e){if(b=+b,c=0|c,!e){var f=Math.pow(2,8*d-1);I(this,b,c,d,f-1,-f)}var g=d-1,h=1,i=b<0?1:0;for(this[c+g]=255&b;--g>=0&&(h*=256);)this[c+g]=(b/h>>0)-i&255;return c+d},i.prototype.writeInt8=function(b,c,d){return b=+b,c=0|c,d||I(this,b,c,1,127,-128),i.TYPED_ARRAY_SUPPORT||(b=Math.floor(b)),b<0&&(b=255+b+1),this[c]=b,c+1},i.prototype.writeInt16LE=function(b,c,d){return b=+b,c=0|c,d||I(this,b,c,2,32767,-32768),i.TYPED_ARRAY_SUPPORT?(this[c]=b,this[c+1]=b>>>8):J(this,b,c,!0),c+2},i.prototype.writeInt16BE=function(b,c,d){return b=+b,c=0|c,d||I(this,b,c,2,32767,-32768),i.TYPED_ARRAY_SUPPORT?(this[c]=b>>>8,this[c+1]=b):J(this,b,c,!1),c+2},i.prototype.writeInt32LE=function(b,c,d){return b=+b,c=0|c,d||I(this,b,c,4,2147483647,-2147483648),i.TYPED_ARRAY_SUPPORT?(this[c]=b,this[c+1]=b>>>8,this[c+2]=b>>>16,this[c+3]=b>>>24):K(this,b,c,!0),c+4},i.prototype.writeInt32BE=function(b,c,d){return b=+b,c=0|c,d||I(this,b,c,4,2147483647,-2147483648),b<0&&(b=4294967295+b+1),i.TYPED_ARRAY_SUPPORT?(this[c]=b>>>24,this[c+1]=b>>>16,this[c+2]=b>>>8,this[c+3]=b):K(this,b,c,!1),c+4},i.prototype.writeFloatLE=function(b,c,d){return M(this,b,c,!0,d)},i.prototype.writeFloatBE=function(b,c,d){return M(this,b,c,!1,d)},i.prototype.writeDoubleLE=function(b,c,d){return N(this,b,c,!0,d)},i.prototype.writeDoubleBE=function(b,c,d){return N(this,b,c,!1,d)},i.prototype.copy=function(b,c,d,e){if(d||(d=0),e||0===e||(e=this.length),c>=b.length&&(c=b.length),c||(c=0),e>0&&e<d&&(e=d),e===d)return 0;if(0===b.length||0===this.length)return 0;if(c<0)throw new RangeError("targetStart out of bounds");if(d<0||d>=this.length)throw new RangeError("sourceStart out of bounds");if(e<0)throw new RangeError("sourceEnd out of bounds");e>this.length&&(e=this.length),b.length-c<e-d&&(e=b.length-c+d);var f=e-d;if(f<1e3||!i.TYPED_ARRAY_SUPPORT)for(var g=0;g<f;g++)b[g+c]=this[g+d];else b._set(this.subarray(d,d+f),c);return f},i.prototype.fill=function(b,c,d){if(b||(b=0),c||(c=0),d||(d=this.length),d<c)throw new RangeError("end < start");if(d!==c&&0!==this.length){if(c<0||c>=this.length)throw new RangeError("start out of bounds");if(d<0||d>this.length)throw new RangeError("end out of bounds");var e;if("number"==typeof b)for(e=c;e<d;e++)this[e]=b;else{var f=T(b.toString()),g=f.length;for(e=c;e<d;e++)this[e]=f[e%g]}return this}},i.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(i.TYPED_ARRAY_SUPPORT)return new i(this).buffer;for(var b=new Uint8Array(this.length),c=0,d=b.length;c<d;c+=1)b[c]=this[c];return b.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var O=i.prototype;i._augment=function(b){return b.constructor=i,b._isBuffer=!0,b._set=b.set,b.get=O.get,b.set=O.set,b.write=O.write,b.toString=O.toString,b.toLocaleString=O.toString,b.toJSON=O.toJSON,b.equals=O.equals,b.compare=O.compare,b.indexOf=O.indexOf,b.copy=O.copy,b.slice=O.slice,b.readUIntLE=O.readUIntLE,b.readUIntBE=O.readUIntBE,b.readUInt8=O.readUInt8,b.readUInt16LE=O.readUInt16LE,b.readUInt16BE=O.readUInt16BE,b.readUInt32LE=O.readUInt32LE,b.readUInt32BE=O.readUInt32BE,b.readIntLE=O.readIntLE,b.readIntBE=O.readIntBE,b.readInt8=O.readInt8,b.readInt16LE=O.readInt16LE,b.readInt16BE=O.readInt16BE,b.readInt32LE=O.readInt32LE,b.readInt32BE=O.readInt32BE,b.readFloatLE=O.readFloatLE,b.readFloatBE=O.readFloatBE,b.readDoubleLE=O.readDoubleLE,b.readDoubleBE=O.readDoubleBE,b.writeUInt8=O.writeUInt8,b.writeUIntLE=O.writeUIntLE,b.writeUIntBE=O.writeUIntBE,b.writeUInt16LE=O.writeUInt16LE,b.writeUInt16BE=O.writeUInt16BE,b.writeUInt32LE=O.writeUInt32LE,b.writeUInt32BE=O.writeUInt32BE,b.writeIntLE=O.writeIntLE,b.writeIntBE=O.writeIntBE,b.writeInt8=O.writeInt8,b.writeInt16LE=O.writeInt16LE,b.writeInt16BE=O.writeInt16BE,b.writeInt32LE=O.writeInt32LE,b.writeInt32BE=O.writeInt32BE,b.writeFloatLE=O.writeFloatLE,b.writeFloatBE=O.writeFloatBE,b.writeDoubleLE=O.writeDoubleLE,b.writeDoubleBE=O.writeDoubleBE,b.fill=O.fill,b.inspect=O.inspect,b.toArrayBuffer=O.toArrayBuffer,b};var P=/[^+\/0-9A-z\-]/g},{"base64-js":2,ieee754:3,"is-array":4}],2:[function(a,b,c){var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(a){"use strict";function k(a){var b=a.charCodeAt(0);return b===c||b===i?62:b===e||b===j?63:b<f?-1:b<f+10?b-f+26+26:b<h+26?b-h:b<g+26?b-g+26:void 0}function l(a){function l(a){h[j++]=a}var c,d,e,f,g,h;if(a.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=a.length;g="="===a.charAt(i-2)?2:"="===a.charAt(i-1)?1:0,h=new b(3*a.length/4-g),e=g>0?a.length-4:a.length;var j=0;for(c=0,d=0;c<e;c+=4,d+=3)f=k(a.charAt(c))<<18|k(a.charAt(c+1))<<12|k(a.charAt(c+2))<<6|k(a.charAt(c+3)),l((16711680&f)>>16),l((65280&f)>>8),l(255&f);return 2===g?(f=k(a.charAt(c))<<2|k(a.charAt(c+1))>>4,l(255&f)):1===g&&(f=k(a.charAt(c))<<10|k(a.charAt(c+1))<<4|k(a.charAt(c+2))>>2,l(f>>8&255),l(255&f)),h}function m(a){function h(a){return d.charAt(a)}function i(a){return h(a>>18&63)+h(a>>12&63)+h(a>>6&63)+h(63&a)}var b,f,g,c=a.length%3,e="";for(b=0,g=a.length-c;b<g;b+=3)f=(a[b]<<16)+(a[b+1]<<8)+a[b+2],e+=i(f);switch(c){case 1:f=a[a.length-1],e+=h(f>>2),e+=h(f<<4&63),e+="==";break;case 2:f=(a[a.length-2]<<8)+a[a.length-1],e+=h(f>>10),e+=h(f>>4&63),e+=h(f<<2&63),e+="="}return e}var b="undefined"!=typeof Uint8Array?Uint8Array:Array,c="+".charCodeAt(0),e="/".charCodeAt(0),f="0".charCodeAt(0),g="a".charCodeAt(0),h="A".charCodeAt(0),i="-".charCodeAt(0),j="_".charCodeAt(0);a.toByteArray=l,a.fromByteArray=m}("undefined"==typeof c?this.base64js={}:c)},{}],3:[function(a,b,c){c.read=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?NaN:(n?-1:1)*(1/0);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},c.write=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,n=d?0:f-1,o=d?1:-1,p=b<0||0===b&&1/b<0?1:0;for(b=Math.abs(b),isNaN(b)||b===1/0?(h=isNaN(b)?1:0,g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),b+=g+l>=1?m/i:m*Math.pow(2,1-l),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p}},{}],4:[function(a,b,c){var d=Array.isArray,e=Object.prototype.toString;b.exports=d||function(a){return!!a&&"[object Array]"==e.call(a)}},{}],5:[function(a,b,c){b.exports=a("./lib/heap")},{"./lib/heap":6}],6:[function(a,b,c){(function(){var a,d,e,f,g,h,i,j,k,l,m,n,o,p,q;e=Math.floor,l=Math.min,d=function(a,b){return a<b?-1:a>b?1:0},k=function(a,b,c,f,g){var h;if(null==c&&(c=0),null==g&&(g=d),c<0)throw new Error("lo must be non-negative");for(null==f&&(f=a.length);c<f;)h=e((c+f)/2),g(b,a[h])<0?f=h:c=h+1;return[].splice.apply(a,[c,c-c].concat(b)),b},h=function(a,b,c){return null==c&&(c=d),a.push(b),p(a,0,a.length-1,c)},g=function(a,b){var c,e;return null==b&&(b=d),c=a.pop(),a.length?(e=a[0],a[0]=c,q(a,0,b)):e=c,e},j=function(a,b,c){var e;return null==c&&(c=d),e=a[0],a[0]=b,q(a,0,c),e},i=function(a,b,c){var e;return null==c&&(c=d),a.length&&c(a[0],b)<0&&(e=[a[0],b],b=e[0],a[0]=e[1],q(a,0,c)),b},f=function(a,b){var c,f,h,j,k,l;for(null==b&&(b=d),j=function(){l=[];for(var b=0,c=e(a.length/2);0<=c?b<c:b>c;0<=c?b++:b--)l.push(b);return l}.apply(this).reverse(),k=[],f=0,h=j.length;f<h;f++)c=j[f],k.push(q(a,c,b));return k},o=function(a,b,c){var e;if(null==c&&(c=d),e=a.indexOf(b),e!==-1)return p(a,0,e,c),q(a,e,c)},m=function(a,b,c){var e,g,h,j,k;if(null==c&&(c=d),g=a.slice(0,b),!g.length)return g;for(f(g,c),k=a.slice(b),h=0,j=k.length;h<j;h++)e=k[h],i(g,e,c);return g.sort(c).reverse()},n=function(a,b,c){var e,h,i,j,m,n,o,p,q,r;if(null==c&&(c=d),10*b<=a.length){if(j=a.slice(0,b).sort(c),!j.length)return j;for(i=j[j.length-1],p=a.slice(b),m=0,o=p.length;m<o;m++)e=p[m],c(e,i)<0&&(k(j,e,0,null,c),j.pop(),i=j[j.length-1]);return j}for(f(a,c),r=[],h=n=0,q=l(b,a.length);0<=q?n<q:n>q;h=0<=q?++n:--n)r.push(g(a,c));return r},p=function(a,b,c,e){var f,g,h;for(null==e&&(e=d),f=a[c];c>b&&(h=c-1>>1,g=a[h],e(f,g)<0);)a[c]=g,c=h;return a[c]=f},q=function(a,b,c){var e,f,g,h,i;for(null==c&&(c=d),f=a.length,i=b,g=a[b],e=2*b+1;e<f;)h=e+1,h<f&&!(c(a[e],a[h])<0)&&(e=h),a[b]=a[e],b=e,e=2*b+1;return a[b]=g,p(a,i,b,c)},a=function(){function a(a){this.cmp=null!=a?a:d,this.nodes=[]}return a.push=h,a.pop=g,a.replace=j,a.pushpop=i,a.heapify=f,a.updateItem=o,a.nlargest=m,a.nsmallest=n,a.prototype.push=function(a){return h(this.nodes,a,this.cmp)},a.prototype.pop=function(){return g(this.nodes,this.cmp)},a.prototype.peek=function(){return this.nodes[0]},a.prototype.contains=function(a){return this.nodes.indexOf(a)!==-1},a.prototype.replace=function(a){return j(this.nodes,a,this.cmp)},a.prototype.pushpop=function(a){return i(this.nodes,a,this.cmp)},a.prototype.heapify=function(){return f(this.nodes,this.cmp)},a.prototype.updateItem=function(a){return o(this.nodes,a,this.cmp)},a.prototype.clear=function(){return this.nodes=[]},a.prototype.empty=function(){return 0===this.nodes.length},a.prototype.size=function(){return this.nodes.length},a.prototype.clone=function(){var b;return b=new a,b.nodes=this.nodes.slice(0),b},a.prototype.toArray=function(){return this.nodes.slice(0)},a.prototype.insert=a.prototype.push,a.prototype.top=a.prototype.peek,a.prototype.front=a.prototype.peek,a.prototype.has=a.prototype.contains,a.prototype.copy=a.prototype.clone,a}(),function(a,d){return"function"==typeof define&&define.amd?define([],d):"object"==typeof c?b.exports=d():a.Heap=d()}(this,function(){return a})}).call(this)},{}],7:[function(require,module,exports){(function(global){"use strict";var numeric="undefined"==typeof exports?function(){}:exports;"undefined"!=typeof global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(b,c){var d,e,f,g;for("undefined"==typeof c&&(c=15),f=.5,d=new Date;;){for(f*=2,g=f;g>3;g-=4)b(),b(),b(),b();for(;g>0;)b(),g--;if(e=new Date,e-d>c)break}for(g=f;g>3;g-=4)b(),b(),b(),b();for(;g>0;)b(),g--;return e=new Date,1e3*(3*f-1)/(e-d)},numeric._myIndexOf=function(b){var d,c=this.length;for(d=0;d<c;++d)if(this[d]===b)return d;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(b){function c(a){if(0===a)return"0";if(isNaN(a))return"NaN";if(a<0)return"-"+c(-a);if(isFinite(a)){var b=Math.floor(Math.log(a)/Math.log(10)),d=a/Math.pow(10,b),e=d.toPrecision(numeric.precision);return 10===parseFloat(e)&&(b++,d=1,e=d.toPrecision(numeric.precision)),parseFloat(e).toString()+"e"+b.toString()}return"Infinity"}function e(a){var b;if("undefined"==typeof a)return d.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof a)return d.push('"'+a+'"'),!1;if("boolean"==typeof a)return d.push(a.toString()),!1;if("number"==typeof a){var f=c(a),g=a.toPrecision(numeric.precision),h=parseFloat(a.toString()).toString(),i=[f,g,h,parseFloat(g).toString(),parseFloat(h).toString()];for(b=1;b<i.length;b++)i[b].length<f.length&&(f=i[b]);return d.push(Array(numeric.precision+8-f.length).join(" ")+f),!1}if(null===a)return d.push("null"),!1;if("function"==typeof a){d.push(a.toString());var j=!1;for(b in a)a.hasOwnProperty(b)&&(j?d.push(",\n"):d.push("\n{"),j=!0,d.push(b),d.push(": \n"),e(a[b]));return j&&d.push("}\n"),!0}if(a instanceof Array){if(a.length>numeric.largeArray)return d.push("...Large Array..."),!0;var j=!1;for(d.push("["),b=0;b<a.length;b++)b>0&&(d.push(","),j&&d.push("\n ")),j=e(a[b]);return d.push("]"),!0}d.push("{");var j=!1;for(b in a)a.hasOwnProperty(b)&&(j&&d.push(",\n"),j=!0,d.push(b),d.push(": \n"),e(a[b]));return d.push("}"),!0}var d=[];return e(b),d.join("")},numeric.parseDate=function(b){function c(a){if("string"==typeof a)return Date.parse(a.replace(/-/g,"/"));if(!(a instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var d,b=[];for(d=0;d<a.length;d++)b[d]=c(a[d]);return b}return c(b)},numeric.parseFloat=function(b){function c(a){if("string"==typeof a)return parseFloat(a);if(!(a instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var d,b=[];for(d=0;d<a.length;d++)b[d]=c(a[d]);return b}return c(b)},numeric.parseCSV=function(b){var d,e,c=b.split("\n"),f=[],g=/(([^'",]*)|('[^']*')|("[^"]*")),/g,h=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,i=function(a){return a.substr(0,a.length-1)},j=0;for(e=0;e<c.length;e++){var l,k=(c[e]+",").match(g);if(k.length>0){for(f[j]=[],d=0;d<k.length;d++)l=i(k[d]),h.test(l)?f[j][d]=parseFloat(l):f[j][d]=l;j++}}return f},numeric.toCSV=function(b){var d,e,f,g,h,i,c=numeric.dim(b);for(f=c[0],g=c[1],i=[],d=0;d<f;d++){for(h=[],e=0;e<f;e++)h[e]=b[d][e].toString();i[d]=h.join(", ")}return i.join("\n")+"\n"},numeric.getURL=function(b){var c=new XMLHttpRequest;return c.open("GET",b,!1),c.send(),c},numeric.imageURL=function(b){function c(a){var c,d,e,f,g,h,i,j,b=a.length,k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l="";for(c=0;c<b;c+=3)d=a[c],e=a[c+1],f=a[c+2],g=d>>2,h=((3&d)<<4)+(e>>4),i=((15&e)<<2)+(f>>6),j=63&f,c+1>=b?i=j=64:c+2>=b&&(j=64),l+=k.charAt(g)+k.charAt(h)+k.charAt(i)+k.charAt(j);return l}function d(a,b,c){"undefined"==typeof b&&(b=0),"undefined"==typeof c&&(c=a.length);var h,d=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],e=-1,f=0;a.length;for(h=b;h<c;h++)f=255&(e^a[h]),e=e>>>8^d[f];return e^-1}var g,h,j,k,l,m,n,o,p,q,e=b[0].length,f=b[0][0].length,r=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,f>>24&255,f>>16&255,f>>8&255,255&f,e>>24&255,e>>16&255,e>>8&255,255&e,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(q=d(r,12,29),r[29]=q>>24&255,r[30]=q>>16&255,r[31]=q>>8&255,r[32]=255&q,g=1,h=0,n=0;n<e;n++){for(n<e-1?r.push(0):r.push(1),l=3*f+1+(0===n)&255,m=3*f+1+(0===n)>>8&255,r.push(l),r.push(m),r.push(255&~l),r.push(255&~m),0===n&&r.push(0),o=0;o<f;o++)for(j=0;j<3;j++)l=b[j][n][o],l=l>255?255:l<0?0:Math.round(l),g=(g+l)%65521,h=(h+g)%65521,r.push(l);r.push(0)}return p=(h<<16)+g,r.push(p>>24&255),r.push(p>>16&255),r.push(p>>8&255),r.push(255&p),k=r.length-41,r[33]=k>>24&255,r[34]=k>>16&255,r[35]=k>>8&255,r[36]=255&k,q=d(r,37),r.push(q>>24&255),r.push(q>>16&255),r.push(q>>8&255),r.push(255&q),r.push(0),r.push(0),r.push(0),r.push(0),r.push(73),r.push(69),r.push(78),r.push(68),r.push(174),r.push(66),r.push(96),r.push(130),"data:image/png;base64,"+c(r)},numeric._dim=function(b){for(var c=[];"object"==typeof b;)c.push(b.length),b=b[0];return c},numeric.dim=function(b){var c,d;return"object"==typeof b?(c=b[0],"object"==typeof c?(d=c[0],"object"==typeof d?numeric._dim(b):[b.length,c.length]):[b.length]):[]},numeric.mapreduce=function(b,c){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+c+';\nif(typeof x === "number") { var xi = x; '+b+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+b+";\n    xi = x[i-1];\n    "+b+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+b+"\n}\nreturn accum;")},numeric.mapreduce2=function(b,c){return Function("x","var n = x.length;\nvar i,xi;\n"+c+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+b+";\n}\nreturn accum;");
},numeric.same=function a(b,c){var d,e;if(!(b instanceof Array&&c instanceof Array))return!1;if(e=b.length,e!==c.length)return!1;for(d=0;d<e;d++)if(b[d]!==c[d]){if("object"!=typeof b[d])return!1;if(!a(b[d],c[d]))return!1}return!0},numeric.rep=function(b,c,d){"undefined"==typeof d&&(d=0);var g,e=b[d],f=Array(e);if(d===b.length-1){for(g=e-2;g>=0;g-=2)f[g+1]=c,f[g]=c;return g===-1&&(f[0]=c),f}for(g=e-1;g>=0;g--)f[g]=numeric.rep(b,c,d+1);return f},numeric.dotMMsmall=function(b,c){var d,e,f,g,h,i,j,k,l,m,n;for(g=b.length,h=c.length,i=c[0].length,j=Array(g),d=g-1;d>=0;d--){for(k=Array(i),l=b[d],f=i-1;f>=0;f--){for(m=l[h-1]*c[h-1][f],e=h-2;e>=1;e-=2)n=e-1,m+=l[e]*c[e][f]+l[n]*c[n][f];0===e&&(m+=l[0]*c[0][f]),k[f]=m}j[d]=k}return j},numeric._getCol=function(b,c,d){var f,e=b.length;for(f=e-1;f>0;--f)d[f]=b[f][c],--f,d[f]=b[f][c];0===f&&(d[0]=b[0][c])},numeric.dotMMbig=function(b,c){var j,l,m,o,d=numeric._getCol,e=c.length,f=Array(e),g=b.length,h=c[0].length,i=new Array(g),k=numeric.dotVV;for(--e,--g,l=g;l!==-1;--l)i[l]=Array(h);for(--h,l=h;l!==-1;--l)for(d(c,l,f),m=g;m!==-1;--m)o=0,j=b[m],i[m][l]=k(j,f);return i},numeric.dotMV=function(b,c){var f,d=b.length,g=(c.length,Array(d)),h=numeric.dotVV;for(f=d-1;f>=0;f--)g[f]=h(b[f],c);return g},numeric.dotVM=function(b,c){var e,f,g,h,j,m,n;for(g=b.length,h=c[0].length,j=Array(h),f=h-1;f>=0;f--){for(m=b[g-1]*c[g-1][f],e=g-2;e>=1;e-=2)n=e-1,m+=b[e]*c[e][f]+b[n]*c[n][f];0===e&&(m+=b[0]*c[0][f]),j[f]=m}return j},numeric.dotVV=function(b,c){var d,f,e=b.length,g=b[e-1]*c[e-1];for(d=e-2;d>=1;d-=2)f=d-1,g+=b[d]*c[d]+b[f]*c[f];return 0===d&&(g+=b[0]*c[0]),g},numeric.dot=function(b,c){var d=numeric.dim;switch(1e3*d(b).length+d(c).length){case 2002:return c.length<10?numeric.dotMMsmall(b,c):numeric.dotMMbig(b,c);case 2001:return numeric.dotMV(b,c);case 1002:return numeric.dotVM(b,c);case 1001:return numeric.dotVV(b,c);case 1e3:return numeric.mulVS(b,c);case 1:return numeric.mulSV(b,c);case 0:return b*c;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(b){var c,d,e,h,f=b.length,g=Array(f);for(c=f-1;c>=0;c--){for(h=Array(f),d=c+2,e=f-1;e>=d;e-=2)h[e]=0,h[e-1]=0;for(e>c&&(h[e]=0),h[c]=b[c],e=c-1;e>=1;e-=2)h[e]=0,h[e-1]=0;0===e&&(h[0]=0),g[c]=h}return g},numeric.getDiag=function(a){var c,b=Math.min(a.length,a[0].length),d=Array(b);for(c=b-1;c>=1;--c)d[c]=a[c][c],--c,d[c]=a[c][c];return 0===c&&(d[0]=a[0][0]),d},numeric.identity=function(b){return numeric.diag(numeric.rep([b],1))},numeric.pointwise=function(b,c,d){"undefined"==typeof d&&(d="");var f,h,e=[],g=/\[i\]$/,i="",j=!1;for(f=0;f<b.length;f++)g.test(b[f])?(h=b[f].substring(0,b[f].length-3),i=h):h=b[f],"ret"===h&&(j=!0),e.push(h);return e[b.length]="_s",e[b.length+1]="_k",e[b.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+i+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(j?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+b.join(",")+",_s,_k+1);\n    return ret;\n}\n"+d+"\nfor(i=_n-1;i!==-1;--i) {\n    "+c+"\n}\nreturn ret;",Function.apply(null,e)},numeric.pointwise2=function(b,c,d){"undefined"==typeof d&&(d="");var f,h,e=[],g=/\[i\]$/,i="",j=!1;for(f=0;f<b.length;f++)g.test(b[f])?(h=b[f].substring(0,b[f].length-3),i=h):h=b[f],"ret"===h&&(j=!0),e.push(h);return e[b.length]="var _n = "+i+".length;\nvar i"+(j?"":", ret = Array(_n)")+";\n"+d+"\nfor(i=_n-1;i!==-1;--i) {\n"+c+"\n}\nreturn ret;",Function.apply(null,e)},numeric._biforeach=function a(b,c,d,e,f){if(e===d.length-1)return void f(b,c);var g,h=d[e];for(g=h-1;g>=0;g--)a("object"==typeof b?b[g]:b,"object"==typeof c?c[g]:c,d,e+1,f)},numeric._biforeach2=function a(b,c,d,e,f){if(e===d.length-1)return f(b,c);var g,h=d[e],i=Array(h);for(g=h-1;g>=0;--g)i[g]=a("object"==typeof b?b[g]:b,"object"==typeof c?c[g]:c,d,e+1,f);return i},numeric._foreach=function a(b,c,d,e){if(d===c.length-1)return void e(b);var f,g=c[d];for(f=g-1;f>=0;f--)a(b[f],c,d+1,e)},numeric._foreach2=function a(b,c,d,e){if(d===c.length-1)return e(b);var f,g=c[d],h=Array(g);for(f=g-1;f>=0;f--)h[f]=a(b[f],c,d+1,e);return h},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var a,b;for(a=0;a<numeric.mathfuns2.length;++a)b=numeric.mathfuns2[a],numeric.ops2[b]=b;for(a in numeric.ops2)if(numeric.ops2.hasOwnProperty(a)){b=numeric.ops2[a];var c,d,e="";numeric.myIndexOf.call(numeric.mathfuns2,a)!==-1?(e="var "+b+" = Math."+b+";\n",c=function(a,c,d){return a+" = "+b+"("+c+","+d+")"},d=function(a,c){return a+" = "+b+"("+a+","+c+")"}):(c=function(a,c,d){return a+" = "+c+" "+b+" "+d},d=numeric.opseq.hasOwnProperty(a+"eq")?function(a,c){return a+" "+b+"= "+c}:function(a,c){return a+" = "+a+" "+b+" "+c}),numeric[a+"VV"]=numeric.pointwise2(["x[i]","y[i]"],c("ret[i]","x[i]","y[i]"),e),numeric[a+"SV"]=numeric.pointwise2(["x","y[i]"],c("ret[i]","x","y[i]"),e),numeric[a+"VS"]=numeric.pointwise2(["x[i]","y"],c("ret[i]","x[i]","y"),e),numeric[a]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+a+"VV, VS = numeric."+a+"VS, SV = numeric."+a+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+d("x","y")+"\n}\nreturn x;\n"),numeric[b]=numeric[a],numeric[a+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],d("ret[i]","x[i]"),e),numeric[a+"eqS"]=numeric.pointwise2(["ret[i]","x"],d("ret[i]","x"),e),numeric[a+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+a+"eqV, S = numeric."+a+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(a=0;a<numeric.mathfuns2.length;++a)b=numeric.mathfuns2[a],delete numeric.ops2[b];for(a=0;a<numeric.mathfuns.length;++a)b=numeric.mathfuns[a],numeric.ops1[b]=b;for(a in numeric.ops1)numeric.ops1.hasOwnProperty(a)&&(e="",b=numeric.ops1[a],numeric.myIndexOf.call(numeric.mathfuns,a)!==-1&&Math.hasOwnProperty(b)&&(e="var "+b+" = Math."+b+";\n"),numeric[a+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+b+"(ret[i]);",e),numeric[a+"eq"]=Function("x",'if(typeof x !== "object") return '+b+"x\nvar i;\nvar V = numeric."+a+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[a+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+b+"(x[i]);",e),numeric[a]=Function("x",'if(typeof x !== "object") return '+b+"(x)\nvar i;\nvar V = numeric."+a+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(a=0;a<numeric.mathfuns.length;++a)b=numeric.mathfuns[a],delete numeric.ops1[b];for(a in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(a)&&(b=numeric.mapreducers[a],numeric[a+"V"]=numeric.mapreduce2(b[0],b[1]),numeric[a]=Function("x","s","k",b[1]+'if(typeof x !== "object") {    xi = x;\n'+b[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+a+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+b[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(b,c){return"object"==typeof b?"object"==typeof c?numeric.truncVV(b,c):numeric.truncVS(b,c):"object"==typeof c?numeric.truncSV(b,c):Math.round(b/c)*c},numeric.inv=function(b){var h,i,k,l,m,n,o,b,c=numeric.dim(b),d=Math.abs,e=c[0],f=c[1],g=numeric.clone(b),j=numeric.identity(e);for(n=0;n<f;++n){var p=-1,q=-1;for(m=n;m!==e;++m)o=d(g[m][n]),o>q&&(p=m,q=o);for(i=g[p],g[p]=g[n],g[n]=i,l=j[p],j[p]=j[n],j[n]=l,b=i[n],o=n;o!==f;++o)i[o]/=b;for(o=f-1;o!==-1;--o)l[o]/=b;for(m=e-1;m!==-1;--m)if(m!==n){for(h=g[m],k=j[m],b=h[n],o=n+1;o!==f;++o)h[o]-=i[o]*b;for(o=f-1;o>0;--o)k[o]-=l[o]*b,--o,k[o]-=l[o]*b;0===o&&(k[0]-=l[0]*b)}}return j},numeric.det=function(b){var c=numeric.dim(b);if(2!==c.length||c[0]!==c[1])throw new Error("numeric: det() only works on square matrices");var f,g,h,j,k,l,m,n,d=c[0],e=1,i=numeric.clone(b);for(g=0;g<d-1;g++){for(h=g,f=g+1;f<d;f++)Math.abs(i[f][g])>Math.abs(i[h][g])&&(h=f);for(h!==g&&(m=i[h],i[h]=i[g],i[g]=m,e*=-1),j=i[g],f=g+1;f<d;f++){for(k=i[f],l=k[g]/j[g],h=g+1;h<d-1;h+=2)n=h+1,k[h]-=j[h]*l,k[n]-=j[n]*l;h!==d&&(k[h]-=j[h]*l)}if(0===j[g])return 0;e*=j[g]}return e*i[g][g]},numeric.transpose=function(b){var c,d,h,i,j,e=b.length,f=b[0].length,g=Array(f);for(d=0;d<f;d++)g[d]=Array(e);for(c=e-1;c>=1;c-=2){for(i=b[c],h=b[c-1],d=f-1;d>=1;--d)j=g[d],j[c]=i[d],j[c-1]=h[d],--d,j=g[d],j[c]=i[d],j[c-1]=h[d];0===d&&(j=g[0],j[c]=i[0],j[c-1]=h[0])}if(0===c){for(h=b[0],d=f-1;d>=1;--d)g[d][0]=h[d],--d,g[d][0]=h[d];0===d&&(g[0][0]=h[0])}return g},numeric.negtranspose=function(b){var c,d,h,i,j,e=b.length,f=b[0].length,g=Array(f);for(d=0;d<f;d++)g[d]=Array(e);for(c=e-1;c>=1;c-=2){for(i=b[c],h=b[c-1],d=f-1;d>=1;--d)j=g[d],j[c]=-i[d],j[c-1]=-h[d],--d,j=g[d],j[c]=-i[d],j[c-1]=-h[d];0===d&&(j=g[0],j[c]=-i[0],j[c-1]=-h[0])}if(0===c){for(h=b[0],d=f-1;d>=1;--d)g[d][0]=-h[d],--d,g[d][0]=-h[d];0===d&&(g[0][0]=-h[0])}return g},numeric._random=function a(b,c){var d,g,e=b[c],f=Array(e);if(c===b.length-1){for(g=Math.random,d=e-1;d>=1;d-=2)f[d]=g(),f[d-1]=g();return 0===d&&(f[0]=g()),f}for(d=e-1;d>=0;d--)f[d]=a(b,c+1);return f},numeric.random=function(b){return numeric._random(b,0)},numeric.norm2=function(b){return Math.sqrt(numeric.norm2Squared(b))},numeric.linspace=function(b,c,d){if("undefined"==typeof d&&(d=Math.max(Math.round(c-b)+1,1)),d<2)return 1===d?[b]:[];var e,f=Array(d);for(d--,e=d;e>=0;e--)f[e]=(e*c+(d-e)*b)/d;return f},numeric.getBlock=function(b,c,d){function f(a,b){var g,h=c[b],i=d[b]-h,j=Array(i);if(b===e.length-1){for(g=i;g>=0;g--)j[g]=a[g+h];return j}for(g=i;g>=0;g--)j[g]=f(a[g+h],b+1);return j}var e=numeric.dim(b);return f(b,0)},numeric.setBlock=function(b,c,d,e){function g(a,b,e){var h,i=c[e],j=d[e]-i;if(e===f.length-1)for(h=j;h>=0;h--)a[h+i]=b[h];for(h=j;h>=0;h--)g(a[h+i],b[h],e+1)}var f=numeric.dim(b);return g(b,e,0),b},numeric.getRange=function(b,c,d){var g,h,j,k,e=c.length,f=d.length,i=Array(e);for(g=e-1;g!==-1;--g)for(i[g]=Array(f),j=i[g],k=b[c[g]],h=f-1;h!==-1;--h)j[h]=k[d[h]];return i},numeric.blockMatrix=function(b){var c=numeric.dim(b);if(c.length<4)return numeric.blockMatrix([b]);var f,g,h,i,j,d=c[0],e=c[1];for(f=0,g=0,h=0;h<d;++h)f+=b[h][0].length;for(i=0;i<e;++i)g+=b[0][i][0].length;var k=Array(f);for(h=0;h<f;++h)k[h]=Array(g);var m,n,o,p,q,l=0;for(h=0;h<d;++h){for(m=g,i=e-1;i!==-1;--i)for(j=b[h][i],m-=j[0].length,o=j.length-1;o!==-1;--o)for(q=j[o],n=k[l+o],p=q.length-1;p!==-1;--p)n[m+p]=q[p];l+=b[h][0].length}return k},numeric.tensor=function(b,c){if("number"==typeof b||"number"==typeof c)return numeric.mul(b,c);var d=numeric.dim(b),e=numeric.dim(c);if(1!==d.length||1!==e.length)throw new Error("numeric: tensor product is only defined for vectors");var i,j,k,l,f=d[0],g=e[0],h=Array(f);for(j=f-1;j>=0;j--){for(i=Array(g),l=b[j],k=g-1;k>=3;--k)i[k]=l*c[k],--k,i[k]=l*c[k],--k,i[k]=l*c[k],--k,i[k]=l*c[k];for(;k>=0;)i[k]=l*c[k],--k;h[j]=i}return h},numeric.T=function(b,c){this.x=b,this.y=c},numeric.t=function(b,c){return new numeric.T(b,c)},numeric.Tbinop=function(b,c,d,e,f){numeric.indexOf;if("string"!=typeof f){var h;f="";for(h in numeric)numeric.hasOwnProperty(h)&&(b.indexOf(h)>=0||c.indexOf(h)>=0||d.indexOf(h)>=0||e.indexOf(h)>=0)&&h.length>1&&(f+="var "+h+" = numeric."+h+";\n")}return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+f+"\nif(x.y) {  if(y.y) {    return new numeric.T("+e+");\n  }\n  return new numeric.T("+d+");\n}\nif(y.y) {\n  return new numeric.T("+c+");\n}\nreturn new numeric.T("+b+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var b=numeric.mul,c=numeric.div;if(this.y){var d=numeric.add(b(this.x,this.x),b(this.y,this.y));return new numeric.T(c(this.x,d),c(numeric.neg(this.y),d))}return new T(c(1,this.x))},numeric.T.prototype.div=function a(b){if(b instanceof numeric.T||(b=new numeric.T(b)),b.y)return this.mul(b.reciprocal());var a=numeric.div;return this.y?new numeric.T(a(this.x,b.x),a(this.y,b.x)):new numeric.T(a(this.x,b.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var b=numeric.transpose,c=this.x,d=this.y;return d?new numeric.T(b(c),b(d)):new numeric.T(b(c))},numeric.T.prototype.transjugate=function(){var b=numeric.transpose,c=this.x,d=this.y;return d?new numeric.T(b(c),numeric.negtranspose(d)):new numeric.T(b(c))},numeric.Tunop=function(b,c,d){return"string"!=typeof d&&(d=""),Function("var x = this;\n"+d+"\nif(x.y) {  "+c+";\n}\n"+b+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var b=this;if("undefined"==typeof b.y)return new numeric.T(numeric.inv(b.x));var d,e,f,k,l,m,n,o,p,q,r,d,e,f,s,t,u,v,w,x,y,c=b.x.length,g=numeric.identity(c),h=numeric.rep([c,c],0),i=numeric.clone(b.x),j=numeric.clone(b.y);for(d=0;d<c;d++){for(u=i[d][d],v=j[d][d],s=u*u+v*v,f=d,e=d+1;e<c;e++)u=i[e][d],v=j[e][d],t=u*u+v*v,t>s&&(f=e,s=t);for(f!==d&&(y=i[d],i[d]=i[f],i[f]=y,y=j[d],j[d]=j[f],j[f]=y,y=g[d],g[d]=g[f],g[f]=y,y=h[d],h[d]=h[f],h[f]=y),k=i[d],l=j[d],o=g[d],p=h[d],u=k[d],v=l[d],e=d+1;e<c;e++)w=k[e],x=l[e],k[e]=(w*u+x*v)/s,l[e]=(x*u-w*v)/s;for(e=0;e<c;e++)w=o[e],x=p[e],o[e]=(w*u+x*v)/s,p[e]=(x*u-w*v)/s;for(e=d+1;e<c;e++){for(m=i[e],n=j[e],q=g[e],r=h[e],u=m[d],v=n[d],f=d+1;f<c;f++)w=k[f],x=l[f],m[f]-=w*u-x*v,n[f]-=x*u+w*v;for(f=0;f<c;f++)w=o[f],x=p[f],q[f]-=w*u-x*v,r[f]-=x*u+w*v}}for(d=c-1;d>0;d--)for(o=g[d],p=h[d],e=d-1;e>=0;e--)for(q=g[e],r=h[e],u=i[e][d],v=j[e][d],f=c-1;f>=0;f--)w=o[f],x=p[f],q[f]-=u*w-v*x,r[f]-=u*x+v*w;return new numeric.T(g,h)},numeric.T.prototype.get=function(b){var f,c=this.x,d=this.y,e=0,g=b.length;if(d){for(;e<g;)f=b[e],c=c[f],d=d[f],e++;return new numeric.T(c,d)}for(;e<g;)f=b[e],c=c[f],e++;return new numeric.T(c)},numeric.T.prototype.set=function(b,c){var g,d=this.x,e=this.y,f=0,h=b.length,i=c.x,j=c.y;if(0===h)return j?this.y=j:e&&(this.y=void 0),this.x=d,this;if(j){for(e||(e=numeric.rep(numeric.dim(d),0),this.y=e);f<h-1;)g=b[f],d=d[g],e=e[g],f++;return g=b[f],d[g]=i,e[g]=j,this}if(e){for(;f<h-1;)g=b[f],d=d[g],e=e[g],f++;return g=b[f],d[g]=i,i instanceof Array?e[g]=numeric.rep(numeric.dim(i),0):e[g]=0,this}for(;f<h-1;)g=b[f],d=d[g],f++;return g=b[f],d[g]=i,this},numeric.T.prototype.getRows=function(b,c){var e,g,d=c-b+1,f=Array(d),h=this.x,i=this.y;for(e=b;e<=c;e++)f[e-b]=h[e];if(i){for(g=Array(d),e=b;e<=c;e++)g[e-b]=i[e];return new numeric.T(f,g)}return new numeric.T(f)},numeric.T.prototype.setRows=function(b,c,d){var e,f=this.x,g=this.y,h=d.x,i=d.y;for(e=b;e<=c;e++)f[e]=h[e-b];if(i)for(g||(g=numeric.rep(numeric.dim(f),0),this.y=g),e=b;e<=c;e++)g[e]=i[e-b];else if(g)for(e=b;e<=c;e++)g[e]=numeric.rep([h[e-b].length],0);return this},numeric.T.prototype.getRow=function(b){var c=this.x,d=this.y;return d?new numeric.T(c[b],d[b]):new numeric.T(c[b])},numeric.T.prototype.setRow=function(b,c){var d=this.x,e=this.y,f=c.x,g=c.y;return d[b]=f,g?(e||(e=numeric.rep(numeric.dim(d),0),this.y=e),e[b]=g):e&&(e=numeric.rep([f.length],0)),this},numeric.T.prototype.getBlock=function(b,c){var d=this.x,e=this.y,f=numeric.getBlock;return e?new numeric.T(f(d,b,c),f(e,b,c)):new numeric.T(f(d,b,c))},numeric.T.prototype.setBlock=function(b,c,d){d instanceof numeric.T||(d=new numeric.T(d));var e=this.x,f=this.y,g=numeric.setBlock,h=d.x,i=d.y;return i?(f||(this.y=numeric.rep(numeric.dim(this),0),f=this.y),g(e,b,c,h),g(f,b,c,i),this):(g(e,b,c,h),void(f&&g(f,b,c,numeric.rep(numeric.dim(h),0))))},numeric.T.rep=function(b,c){var d=numeric.T;c instanceof d||(c=new d(c));var e=c.x,f=c.y,g=numeric.rep;return f?new d(g(b,e),g(b,f)):new d(g(b,e))},numeric.T.diag=function a(b){b instanceof numeric.T||(b=new numeric.T(b));var c=b.x,d=b.y,a=numeric.diag;return d?new numeric.T(a(c),a(d)):new numeric.T(a(c))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(b){return new numeric.T(numeric.identity(b))},numeric.T.prototype.getDiag=function(){var b=numeric,c=this.x,d=this.y;return d?new b.T(b.getDiag(c),b.getDiag(d)):new b.T(b.getDiag(c))},numeric.house=function(b){var c=numeric.clone(b),d=b[0]>=0?1:-1,e=d*numeric.norm2(b);c[0]+=e;var f=numeric.norm2(c);if(0===f)throw new Error("eig: internal error");return numeric.div(c,f)},numeric.toUpperHessenberg=function(b){var c=numeric.dim(b);if(2!==c.length||c[0]!==c[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var e,f,g,h,i,k,l,m,n,p,d=c[0],j=numeric.clone(b),o=numeric.identity(d);for(f=0;f<d-2;f++){for(h=Array(d-f-1),e=f+1;e<d;e++)h[e-f-1]=j[e][f];if(numeric.norm2(h)>0){for(i=numeric.house(h),k=numeric.getBlock(j,[f+1,f],[d-1,d-1]),l=numeric.tensor(i,numeric.dot(i,k)),e=f+1;e<d;e++)for(m=j[e],n=l[e-f-1],g=f;g<d;g++)m[g]-=2*n[g-f];for(k=numeric.getBlock(j,[0,f+1],[d-1,d-1]),l=numeric.tensor(numeric.dot(k,i),i),e=0;e<d;e++)for(m=j[e],n=l[e],g=f+1;g<d;g++)m[g]-=2*n[g-f-1];for(k=Array(d-f-1),e=f+1;e<d;e++)k[e-f-1]=o[e];for(l=numeric.tensor(i,numeric.dot(i,k)),e=f+1;e<d;e++)for(p=o[e],n=l[e-f-1],g=0;g<d;g++)p[g]-=2*n[g]}}return{H:j,Q:o}},numeric.epsilon=2.220446049250313e-16,numeric.QRFrancis=function(a,b){"undefined"==typeof b&&(b=1e4),a=numeric.clone(a);var f,g,h,i,j,k,l,m,n,p,q,r,s,t,u,v,w,x,d=(numeric.clone(a),numeric.dim(a)),e=d[0],o=numeric.identity(e);if(e<3)return{Q:o,B:[[0,e-1]]};var y=numeric.epsilon;for(x=0;x<b;x++){for(v=0;v<e-1;v++)if(Math.abs(a[v+1][v])<y*(Math.abs(a[v][v])+Math.abs(a[v+1][v+1]))){var z=numeric.QRFrancis(numeric.getBlock(a,[0,0],[v,v]),b),A=numeric.QRFrancis(numeric.getBlock(a,[v+1,v+1],[e-1,e-1]),b);for(r=Array(v+1),u=0;u<=v;u++)r[u]=o[u];for(s=numeric.dot(z.Q,r),u=0;u<=v;u++)o[u]=s[u];for(r=Array(e-v-1),u=v+1;u<e;u++)r[u-v-1]=o[u];for(s=numeric.dot(A.Q,r),u=v+1;u<e;u++)o[u]=s[u-v-1];return{Q:o,B:z.B.concat(numeric.add(A.B,v+1))}}if(h=a[e-2][e-2],i=a[e-2][e-1],j=a[e-1][e-2],k=a[e-1][e-1],m=h+k,l=h*k-i*j,n=numeric.getBlock(a,[0,0],[2,2]),m*m>=4*l){var B,C;B=.5*(m+Math.sqrt(m*m-4*l)),C=.5*(m-Math.sqrt(m*m-4*l)),n=numeric.add(numeric.sub(numeric.dot(n,n),numeric.mul(n,B+C)),numeric.diag(numeric.rep([3],B*C)))}else n=numeric.add(numeric.sub(numeric.dot(n,n),numeric.mul(n,m)),numeric.diag(numeric.rep([3],l)));for(f=[n[0][0],n[1][0],n[2][0]],g=numeric.house(f),r=[a[0],a[1],a[2]],s=numeric.tensor(g,numeric.dot(g,r)),u=0;u<3;u++)for(q=a[u],t=s[u],w=0;w<e;w++)q[w]-=2*t[w];for(r=numeric.getBlock(a,[0,0],[e-1,2]),s=numeric.tensor(numeric.dot(r,g),g),u=0;u<e;u++)for(q=a[u],t=s[u],w=0;w<3;w++)q[w]-=2*t[w];for(r=[o[0],o[1],o[2]],s=numeric.tensor(g,numeric.dot(g,r)),u=0;u<3;u++)for(p=o[u],t=s[u],w=0;w<e;w++)p[w]-=2*t[w];var D;for(v=0;v<e-2;v++){for(w=v;w<=v+1;w++)if(Math.abs(a[w+1][w])<y*(Math.abs(a[w][w])+Math.abs(a[w+1][w+1]))){var z=numeric.QRFrancis(numeric.getBlock(a,[0,0],[w,w]),b),A=numeric.QRFrancis(numeric.getBlock(a,[w+1,w+1],[e-1,e-1]),b);for(r=Array(w+1),u=0;u<=w;u++)r[u]=o[u];for(s=numeric.dot(z.Q,r),u=0;u<=w;u++)o[u]=s[u];for(r=Array(e-w-1),u=w+1;u<e;u++)r[u-w-1]=o[u];for(s=numeric.dot(A.Q,r),u=w+1;u<e;u++)o[u]=s[u-w-1];return{Q:o,B:z.B.concat(numeric.add(A.B,w+1))}}for(D=Math.min(e-1,v+3),f=Array(D-v),u=v+1;u<=D;u++)f[u-v-1]=a[u][v];for(g=numeric.house(f),r=numeric.getBlock(a,[v+1,v],[D,e-1]),s=numeric.tensor(g,numeric.dot(g,r)),u=v+1;u<=D;u++)for(q=a[u],t=s[u-v-1],w=v;w<e;w++)q[w]-=2*t[w-v];for(r=numeric.getBlock(a,[0,v+1],[e-1,D]),s=numeric.tensor(numeric.dot(r,g),g),u=0;u<e;u++)for(q=a[u],t=s[u],w=v+1;w<=D;w++)q[w]-=2*t[w-v-1];for(r=Array(D-v),u=v+1;u<=D;u++)r[u-v-1]=o[u];for(s=numeric.tensor(g,numeric.dot(g,r)),u=v+1;u<=D;u++)for(p=o[u],t=s[u-v-1],w=0;w<e;w++)p[w]-=2*t[w]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(b,c){var h,i,n,p,q,r,s,t,u,v,w,x,y,z,A,B,C,d=numeric.toUpperHessenberg(b),e=numeric.QRFrancis(d.H,c),f=numeric.T,g=b.length,k=e.B,l=numeric.dot(e.Q,numeric.dot(d.H,numeric.transpose(e.Q))),m=new f(numeric.dot(e.Q,d.Q)),o=k.length,D=Math.sqrt;for(i=0;i<o;i++)if(h=k[i][0],h===k[i][1]);else{if(p=h+1,q=l[h][h],r=l[h][p],s=l[p][h],t=l[p][p],0===r&&0===s)continue;u=-q-t,v=q*t-r*s,w=u*u-4*v,w>=0?(x=u<0?-.5*(u-D(w)):-.5*(u+D(w)),B=(q-x)*(q-x)+r*r,C=s*s+(t-x)*(t-x),B>C?(B=D(B),z=(q-x)/B,A=r/B):(C=D(C),z=s/C,A=(t-x)/C),n=new f([[A,-z],[z,A]]),m.setRows(h,p,n.dot(m.getRows(h,p)))):(x=-.5*u,y=.5*D(-w),B=(q-x)*(q-x)+r*r,C=s*s+(t-x)*(t-x),B>C?(B=D(B+y*y),z=(q-x)/B,A=r/B,x=0,y/=B):(C=D(C+y*y),z=s/C,A=(t-x)/C,x=y/C,y=0),n=new f([[A,-z],[z,A]],[[x,y],[y,-x]]),m.setRows(h,p,n.dot(m.getRows(h,p))))}var E=m.dot(b).dot(m.transjugate()),g=b.length,F=numeric.T.identity(g);for(p=0;p<g;p++)if(p>0)for(i=p-1;i>=0;i--){var G=E.get([i,i]),H=E.get([p,p]);numeric.neq(G.x,H.x)||numeric.neq(G.y,H.y)?(x=E.getRow(i).getBlock([i],[p-1]),y=F.getRow(p).getBlock([i],[p-1]),F.set([p,i],E.get([i,p]).neg().sub(x.dot(y)).div(G.sub(H)))):F.setRow(p,F.getRow(i))}for(p=0;p<g;p++)x=F.getRow(p),F.setRow(p,x.div(x.norm2()));return F=F.transpose(),F=m.transjugate().dot(F),{lambda:E.getDiag(),E:F}},numeric.ccsSparse=function(b){var d,e,f,g,c=b.length,h=[];for(f=c-1;f!==-1;--f){e=b[f];for(g in e){for(g=parseInt(g);g>=h.length;)h[h.length]=0;0!==e[g]&&h[g]++}}var d=h.length,i=Array(d+1);for(i[0]=0,f=0;f<d;++f)i[f+1]=i[f]+h[f];var j=Array(i[d]),k=Array(i[d]);for(f=c-1;f!==-1;--f){e=b[f];for(g in e)0!==e[g]&&(h[g]--,j[i[g]+h[g]]=f,k[i[g]+h[g]]=e[g])}return[i,j,k]},numeric.ccsFull=function(b){var i,j,k,l,c=b[0],d=b[1],e=b[2],f=numeric.ccsDim(b),g=f[0],h=f[1],n=numeric.rep([g,h],0);for(i=0;i<h;i++)for(k=c[i],l=c[i+1],j=k;j<l;++j)n[d[j]][i]=e[j];return n},numeric.ccsTSolve=function(b,c,d,e,f){function m(a){var b;if(0===d[a]){for(d[a]=1,b=g[a];b<g[a+1];++b)m(h[b]);f[l]=a,++l}}var g=b[0],h=b[1],i=b[2],j=g.length-1,k=Math.max,l=0;"undefined"==typeof e&&(d=numeric.rep([j],0)),"undefined"==typeof e&&(e=numeric.linspace(0,d.length-1)),"undefined"==typeof f&&(f=[]);var n,o,p,q,r,s,v;for(n=e.length-1;n!==-1;--n)m(e[n]);for(f.length=l,n=f.length-1;n!==-1;--n)d[f[n]]=0;for(n=e.length-1;n!==-1;--n)o=e[n],d[o]=c[o];for(n=f.length-1;n!==-1;--n){for(o=f[n],p=g[o],q=k(g[o+1],p),r=p;r!==q;++r)if(h[r]===o){d[o]/=i[r];break}for(v=d[o],r=p;r!==q;++r)s=h[r],s!==o&&(d[s]-=v*i[r])}return d},numeric.ccsDFS=function(b){this.k=Array(b),this.k1=Array(b),this.j=Array(b)},numeric.ccsDFS.prototype.dfs=function(b,c,d,e,f,g){var i,n,o,h=0,j=f.length,k=this.k,l=this.k1,m=this.j;if(0===e[b])for(e[b]=1,m[0]=b,k[0]=n=c[b],l[0]=o=c[b+1];;)if(n>=o){if(f[j]=m[h],0===h)return;++j,--h,n=k[h],o=l[h]}else i=g[d[n]],0===e[i]?(e[i]=1,k[h]=n,++h,m[h]=i,n=c[i],l[h]=o=c[i+1]):++n},numeric.ccsLPSolve=function(b,c,d,e,f,g,h){var q,r,s,t,v,w,x,y,B,i=b[0],j=b[1],k=b[2],n=(i.length-1,c[0]),o=c[1],p=c[2];for(r=n[f],s=n[f+1],e.length=0,q=r;q<s;++q)h.dfs(g[o[q]],i,j,d,e,g);for(q=e.length-1;q!==-1;--q)d[e[q]]=0;for(q=r;q!==s;++q)t=g[o[q]],d[t]=p[q];for(q=e.length-1;q!==-1;--q){for(t=e[q],v=i[t],w=i[t+1],x=v;x<w;++x)if(g[j[x]]===t){d[t]/=k[x];break}for(B=d[t],x=v;x<w;++x)y=g[j[x]],y!==t&&(d[y]-=B*k[x])}return d},numeric.ccsLUP1=function(b,c){var o,p,q,t,u,v,w,d=b[0].length-1,e=[numeric.rep([d+1],0),[],[]],f=[numeric.rep([d+1],0),[],[]],g=e[0],h=e[1],i=e[2],j=f[0],k=f[1],l=f[2],m=numeric.rep([d],0),n=numeric.rep([d],0),y=numeric.ccsLPSolve,A=(Math.max,Math.abs),B=numeric.linspace(0,d-1),C=numeric.linspace(0,d-1),D=new numeric.ccsDFS(d);for("undefined"==typeof c&&(c=1),o=0;o<d;++o){for(y(e,b,m,n,o,C,D),t=-1,u=-1,p=n.length-1;p!==-1;--p)q=n[p],q<=o||(v=A(m[q]),v>t&&(u=q,t=v));for(A(m[o])<c*t&&(p=B[o],t=B[u],B[o]=t,C[t]=o,B[u]=p,C[p]=u,t=m[o],m[o]=m[u],m[u]=t),t=g[o],u=j[o],w=m[o],h[t]=B[o],i[t]=1,++t,p=n.length-1;p!==-1;--p)q=n[p],v=m[q],n[p]=0,m[q]=0,q<=o?(k[u]=q,l[u]=v,++u):(h[t]=B[q],i[t]=v/w,++t);g[o+1]=t,j[o+1]=u}for(p=h.length-1;p!==-1;--p)h[p]=C[h[p]];return{L:e,U:f,P:B,Pinv:C}},numeric.ccsDFS0=function(b){this.k=Array(b),this.k1=Array(b),this.j=Array(b)},numeric.ccsDFS0.prototype.dfs=function(b,c,d,e,f,g,h){var j,o,p,i=0,k=f.length,l=this.k,m=this.k1,n=this.j;if(0===e[b])for(e[b]=1,n[0]=b,l[0]=o=c[g[b]],m[0]=p=c[g[b]+1];;){if(isNaN(o))throw new Error("Ow!");if(o>=p){if(f[k]=g[n[i]],0===i)return;++k,--i,o=l[i],p=m[i]}else j=d[o],0===e[j]?(e[j]=1,l[i]=o,++i,n[i]=j,j=g[j],o=c[j],m[i]=p=c[j+1]):++o}},numeric.ccsLPSolve0=function(b,c,d,e,f,g,h,i){var r,s,t,u,w,x,y,z,C,j=b[0],k=b[1],l=b[2],o=(j.length-1,c[0]),p=c[1],q=c[2];for(s=o[f],t=o[f+1],e.length=0,r=s;r<t;++r)i.dfs(p[r],j,k,d,e,g,h);for(r=e.length-1;r!==-1;--r)u=e[r],d[h[u]]=0;for(r=s;r!==t;++r)u=p[r],d[u]=q[r];for(r=e.length-1;r!==-1;--r){for(u=e[r],z=h[u],w=j[u],x=j[u+1],y=w;y<x;++y)if(k[y]===z){d[z]/=l[y];break}for(C=d[z],y=w;y<x;++y)d[k[y]]-=C*l[y];d[z]=C}},numeric.ccsLUP0=function(b,c){var o,p,q,t,u,v,w,d=b[0].length-1,e=[numeric.rep([d+1],0),[],[]],f=[numeric.rep([d+1],0),[],[]],g=e[0],h=e[1],i=e[2],j=f[0],k=f[1],l=f[2],m=numeric.rep([d],0),n=numeric.rep([d],0),y=numeric.ccsLPSolve0,A=(Math.max,Math.abs),B=numeric.linspace(0,d-1),C=numeric.linspace(0,d-1),D=new numeric.ccsDFS0(d);for("undefined"==typeof c&&(c=1),o=0;o<d;++o){for(y(e,b,m,n,o,C,B,D),t=-1,u=-1,p=n.length-1;p!==-1;--p)q=n[p],q<=o||(v=A(m[B[q]]),v>t&&(u=q,t=v));for(A(m[B[o]])<c*t&&(p=B[o],t=B[u],B[o]=t,C[t]=o,B[u]=p,C[p]=u),t=g[o],u=j[o],w=m[B[o]],h[t]=B[o],i[t]=1,++t,p=n.length-1;p!==-1;--p)q=n[p],v=m[B[q]],n[p]=0,m[B[q]]=0,q<=o?(k[u]=q,l[u]=v,++u):(h[t]=B[q],i[t]=v/w,++t);g[o+1]=t,j[o+1]=u}for(p=h.length-1;p!==-1;--p)h[p]=C[h[p]];return{L:e,U:f,P:B,Pinv:C}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(b){return[numeric.sup(b[1])+1,b[0].length-1]},numeric.ccsGetBlock=function(b,c,d){var e=numeric.ccsDim(b),f=e[0],g=e[1];"undefined"==typeof c?c=numeric.linspace(0,f-1):"number"==typeof c&&(c=[c]),"undefined"==typeof d?d=numeric.linspace(0,g-1):"number"==typeof d&&(d=[d]);var h,l,n,o,p,k=c.length,m=d.length,q=numeric.rep([g],0),r=[],s=[],t=[q,r,s],u=b[0],v=b[1],w=b[2],x=numeric.rep([f],0),y=0,z=numeric.rep([f],0);for(l=0;l<m;++l){o=d[l];var A=u[o],B=u[o+1];for(h=A;h<B;++h)n=v[h],z[n]=1,x[n]=w[h];for(h=0;h<k;++h)p=c[h],z[p]&&(r[y]=h,s[y]=x[c[h]],++y);for(h=A;h<B;++h)n=v[h],z[n]=0;q[l+1]=y}return t},numeric.ccsDot=function(b,c){var v,w,x,y,z,A,B,C,D,E,F,d=b[0],e=b[1],f=b[2],g=c[0],h=c[1],i=c[2],j=numeric.ccsDim(b),k=numeric.ccsDim(c),l=j[0],n=(j[1],k[1]),o=numeric.rep([l],0),p=numeric.rep([l],0),q=Array(l),r=numeric.rep([n],0),s=[],t=[],u=[r,s,t];for(x=0;x!==n;++x){for(y=g[x],z=g[x+1],D=0,w=y;w<z;++w)for(E=h[w],F=i[w],A=d[E],B=d[E+1],v=A;v<B;++v)C=e[v],0===p[C]&&(q[D]=C,p[C]=1,D+=1),o[C]=o[C]+f[v]*F;for(y=r[x],z=y+D,r[x+1]=z,w=D-1;w!==-1;--w)F=y+w,v=q[w],s[F]=v,t[F]=o[v],p[v]=0,o[v]=0;r[x+1]=r[x]+D}return u},numeric.ccsLUPSolve=function(b,c){var d=b.L,e=b.U,g=(b.P,c[0]),h=!1;"object"!=typeof g&&(c=[[0,c.length],numeric.linspace(0,c.length-1),c],g=c[0],h=!0);var u,v,w,x,y,z,i=c[1],j=c[2],k=d[0].length-1,l=g.length-1,m=numeric.rep([k],0),n=Array(k),o=numeric.rep([k],0),p=Array(k),q=numeric.rep([l+1],0),r=[],s=[],t=numeric.ccsTSolve,A=0;for(u=0;u<l;++u){for(y=0,w=g[u],x=g[u+1],v=w;v<x;++v)z=b.Pinv[i[v]],p[y]=z,o[z]=j[v],++y;for(p.length=y,t(d,o,m,p,n),v=p.length-1;v!==-1;--v)o[p[v]]=0;if(t(e,m,o,n,p),h)return o;for(v=n.length-1;v!==-1;--v)m[n[v]]=0;for(v=p.length-1;v!==-1;--v)z=p[v],r[A]=z,s[A]=o[z],o[z]=0,++A;q[u+1]=A}return[q,r,s]},numeric.ccsbinop=function(b,c){return"undefined"==typeof c&&(c=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+c+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+b+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n");
}(),numeric.ccsScatter=function(b){var l,c=b[0],d=b[1],e=b[2],f=numeric.sup(d)+1,g=c.length,h=numeric.rep([f],0),i=Array(g),j=Array(g),k=numeric.rep([f],0);for(l=0;l<g;++l)k[d[l]]++;for(l=0;l<f;++l)h[l+1]=h[l]+k[l];var n,o,m=h.slice(0);for(l=0;l<g;++l)o=d[l],n=m[o],i[n]=c[l],j[n]=e[l],m[o]=m[o]+1;return[h,i,j]},numeric.ccsGather=function(b){var k,l,m,n,o,c=b[0],d=b[1],e=b[2],f=c.length-1,g=d.length,h=Array(g),i=Array(g),j=Array(g);for(o=0,k=0;k<f;++k)for(m=c[k],n=c[k+1],l=m;l!==n;++l)i[o]=k,h[o]=d[l],j[o]=e[l],++o;return[h,i,j]},numeric.sdim=function a(b,c,d){if("undefined"==typeof c&&(c=[]),"object"!=typeof b)return c;"undefined"==typeof d&&(d=0),d in c||(c[d]=0),b.length>c[d]&&(c[d]=b.length);var e;for(e in b)b.hasOwnProperty(e)&&a(b[e],c,d+1);return c},numeric.sclone=function a(b,c,d){"undefined"==typeof c&&(c=0),"undefined"==typeof d&&(d=numeric.sdim(b).length);var e,f=Array(b.length);if(c===d-1){for(e in b)b.hasOwnProperty(e)&&(f[e]=b[e]);return f}for(e in b)b.hasOwnProperty(e)&&(f[e]=a(b[e],c+1,d));return f},numeric.sdiag=function(b){var d,f,c=b.length,e=Array(c);for(d=c-1;d>=1;d-=2)f=d-1,e[d]=[],e[d][d]=b[d],e[f]=[],e[f][f]=b[f];return 0===d&&(e[0]=[],e[0][0]=b[d]),e},numeric.sidentity=function(b){return numeric.sdiag(numeric.rep([b],1))},numeric.stranspose=function(b){var e,f,g,c=[];b.length;for(e in b)if(b.hasOwnProperty(e)){g=b[e];for(f in g)g.hasOwnProperty(f)&&("object"!=typeof c[f]&&(c[f]=[]),c[f][e]=g[f])}return c},numeric.sLUP=function(b,c){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(b,c){var h,i,j,k,l,m,o,d=b.length,f=(c.length,numeric.stranspose(c)),g=f.length,n=Array(d);for(j=d-1;j>=0;j--){for(o=[],h=b[j],l=g-1;l>=0;l--){m=0,i=f[l];for(k in h)h.hasOwnProperty(k)&&k in i&&(m+=h[k]*i[k]);m&&(o[l]=m)}n[j]=o}return n},numeric.sdotMV=function(b,c){var e,f,g,i,d=b.length,h=Array(d);for(f=d-1;f>=0;f--){e=b[f],i=0;for(g in e)e.hasOwnProperty(g)&&c[g]&&(i+=e[g]*c[g]);i&&(h[f]=i)}return h},numeric.sdotVM=function(b,c){var d,e,f,g,h=[];for(d in b)if(b.hasOwnProperty(d)){f=c[d],g=b[d];for(e in f)f.hasOwnProperty(e)&&(h[e]||(h[e]=0),h[e]+=g*f[e])}return h},numeric.sdotVV=function(b,c){var d,e=0;for(d in b)b[d]&&c[d]&&(e+=b[d]*c[d]);return e},numeric.sdot=function(b,c){var d=numeric.sdim(b).length,e=numeric.sdim(c).length,f=1e3*d+e;switch(f){case 0:return b*c;case 1001:return numeric.sdotVV(b,c);case 2001:return numeric.sdotMV(b,c);case 1002:return numeric.sdotVM(b,c);case 2002:return numeric.sdotMM(b,c);default:throw new Error("numeric.sdot not implemented for tensors of order "+d+" and "+e)}},numeric.sscatter=function(b){var d,e,f,i,c=b[0].length,g=b.length,h=[];for(e=c-1;e>=0;--e)if(b[g-1][e]){for(i=h,f=0;f<g-2;f++)d=b[f][e],i[d]||(i[d]=[]),i=i[d];i[b[f][e]]=b[f+1][e]}return h},numeric.sgather=function a(b,c,d){"undefined"==typeof c&&(c=[]),"undefined"==typeof d&&(d=[]);var e,f,g;e=d.length;for(f in b)if(b.hasOwnProperty(f))if(d[e]=parseInt(f),g=b[f],"number"==typeof g){if(g){if(0===c.length)for(f=e+1;f>=0;--f)c[f]=[];for(f=e;f>=0;--f)c[f].push(d[f]);c[e+1].push(g)}}else a(g,c,d);return d.length>e&&d.pop(),c},numeric.cLU=function(b){var h,i,j,k,l,m,c=b[0],d=b[1],e=b[2],f=c.length,g=0;for(h=0;h<f;h++)c[h]>g&&(g=c[h]);g++;var r,s,t,n=Array(g),o=Array(g),p=numeric.rep([g],1/0),q=numeric.rep([g],-(1/0));for(j=0;j<f;j++)h=c[j],i=d[j],i<p[h]&&(p[h]=i),i>q[h]&&(q[h]=i);for(h=0;h<g-1;h++)q[h]>q[h+1]&&(q[h+1]=q[h]);for(h=g-1;h>=1;h--)p[h]<p[h-1]&&(p[h-1]=p[h]);var u=0,v=0;for(h=0;h<g;h++)o[h]=numeric.rep([q[h]-p[h]+1],0),n[h]=numeric.rep([h-p[h]],0),u+=h-p[h]+1,v+=q[h]-h+1;for(j=0;j<f;j++)h=c[j],o[h][d[j]-p[h]]=e[j];for(h=0;h<g-1;h++)for(k=h-p[h],r=o[h],i=h+1;p[i]<=h&&i<g;i++)if(l=h-p[i],m=q[h]-h,s=o[i],t=s[l]/r[k]){for(j=1;j<=m;j++)s[j+l]-=t*r[j+k];n[i][h-p[i]]=t}var f,A,B,r=[],s=[],w=[],x=[],y=[],z=[];for(f=0,A=0,h=0;h<g;h++){for(k=p[h],l=q[h],B=o[h],i=h;i<=l;i++)B[i-k]&&(r[f]=h,s[f]=i,w[f]=B[i-k],f++);for(B=n[h],i=k;i<h;i++)B[i-k]&&(x[A]=h,y[A]=i,z[A]=B[i-k],A++);x[A]=h,y[A]=h,z[A]=1,A++}return{U:[r,s,w],L:[x,y,z]}},numeric.cLUsolve=function(b,c){var p,r,d=b.L,e=b.U,f=numeric.clone(c),g=d[0],h=d[1],i=d[2],j=e[0],k=e[1],l=e[2],m=j.length,o=(g.length,f.length);for(r=0,p=0;p<o;p++){for(;h[r]<p;)f[p]-=i[r]*f[h[r]],r++;r++}for(r=m-1,p=o-1;p>=0;p--){for(;k[r]>p;)f[p]-=l[r]*f[k[r]],r--;f[p]/=l[r],r--}return f},numeric.cgrid=function(b,c){"number"==typeof b&&(b=[b,b]);var e,f,g,d=numeric.rep(b,-1);if("function"!=typeof c)switch(c){case"L":c=function(a,c){return a>=b[0]/2||c<b[1]/2};break;default:c=function(a,b){return!0}}for(g=0,e=1;e<b[0]-1;e++)for(f=1;f<b[1]-1;f++)c(e,f)&&(d[e][f]=g,g++);return d},numeric.cdelsq=function(b){var g,h,i,j,k,c=[[-1,0],[0,-1],[0,1],[1,0]],d=numeric.dim(b),e=d[0],f=d[1],l=[],m=[],n=[];for(g=1;g<e-1;g++)for(h=1;h<f-1;h++)if(!(b[g][h]<0)){for(i=0;i<4;i++)j=g+c[i][0],k=h+c[i][1],b[j][k]<0||(l.push(b[g][h]),m.push(b[j][k]),n.push(-1));l.push(b[g][h]),m.push(b[g][h]),n.push(4)}return[l,m,n]},numeric.cdotMV=function(b,c){var d,h,j,e=b[0],f=b[1],g=b[2],i=e.length;for(j=0,h=0;h<i;h++)e[h]>j&&(j=e[h]);for(j++,d=numeric.rep([j],0),h=0;h<i;h++)d[e[h]]+=g[h]*c[f[h]];return d},numeric.Spline=function(b,c,d,e,f){this.x=b,this.yl=c,this.yr=d,this.kl=e,this.kr=f},numeric.Spline.prototype._at=function(b,c){var b,i,j,k,d=this.x,e=this.yl,f=this.yr,g=this.kl,h=this.kr,l=numeric.add,m=numeric.sub,n=numeric.mul;i=m(n(g[c],d[c+1]-d[c]),m(f[c+1],e[c])),j=l(n(h[c+1],d[c]-d[c+1]),m(f[c+1],e[c])),k=(b-d[c])/(d[c+1]-d[c]);var o=k*(1-k);return l(l(l(n(1-k,e[c]),n(k,f[c+1])),n(i,o*(1-k))),n(j,o*k))},numeric.Spline.prototype.at=function(b){if("number"==typeof b){var e,f,g,c=this.x,d=c.length,h=Math.floor;for(e=0,f=d-1;f-e>1;)g=h((e+f)/2),c[g]<=b?e=g:f=g;return this._at(b,e)}var l,d=b.length,m=Array(d);for(l=d-1;l!==-1;--l)m[l]=this.at(b[l]);return m},numeric.Spline.prototype.diff=function(){var h,i,j,b=this.x,c=this.yl,d=this.yr,e=this.kl,f=this.kr,g=c.length,k=e,l=f,m=Array(g),n=Array(g),o=numeric.add,p=numeric.mul,q=numeric.div,r=numeric.sub;for(h=g-1;h!==-1;--h)i=b[h+1]-b[h],j=r(d[h+1],c[h]),m[h]=q(o(p(j,6),p(e[h],-4*i),p(f[h+1],-2*i)),i*i),n[h+1]=q(o(p(j,-6),p(e[h],2*i),p(f[h+1],4*i)),i*i);return new numeric.Spline(b,k,l,m,n)},numeric.Spline.prototype.roots=function(){function b(a){return a*a}var d=[],e=this.x,f=this.yl,g=this.yr,h=this.kl,i=this.kr;"number"==typeof f[0]&&(f=[f],g=[g],h=[h],i=[i]);var l,m,n,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,j=f.length,k=e.length-1,d=Array(j),M=Math.sqrt;for(l=0;l!==j;++l){for(r=f[l],s=g[l],t=h[l],u=i[l],v=[],m=0;m!==k;m++){for(m>0&&s[m]*r[m]<0&&v.push(e[m]),D=e[m+1]-e[m],E=e[m],y=r[m],z=s[m+1],w=t[m]/D,x=u[m+1]/D,C=b(w-x+3*(y-z))+12*x*y,A=x+3*y+2*w-3*z,B=3*(x+w+2*(y-z)),C<=0?(G=A/B,F=G>e[m]&&G<e[m+1]?[e[m],G,e[m+1]]:[e[m],e[m+1]]):(G=(A-M(C))/B,H=(A+M(C))/B,F=[e[m]],G>e[m]&&G<e[m+1]&&F.push(G),H>e[m]&&H<e[m+1]&&F.push(H),F.push(e[m+1])),J=F[0],G=this._at(J,m),n=0;n<F.length-1;n++)if(K=F[n+1],H=this._at(K,m),0!==G)if(0===H||G*H>0)J=K,G=H;else{for(var N=0;;){if(L=(G*K-H*J)/(G-H),L<=J||L>=K)break;if(I=this._at(L,m),I*H>0)K=L,H=I,N===-1&&(G*=.5),N=-1;else{if(!(I*G>0))break;J=L,G=I,1===N&&(H*=.5),N=1}}v.push(L),J=F[n+1],G=this._at(J,m)}else v.push(J),J=K,G=H;0===H&&v.push(K)}d[l]=v}return"number"==typeof this.yl[0]?d[0]:d},numeric.spline=function(b,c,d,e){var j,f=b.length,g=[],h=[],i=[],k=numeric.sub,l=numeric.mul,m=numeric.add;for(j=f-2;j>=0;j--)h[j]=b[j+1]-b[j],i[j]=k(c[j+1],c[j]);"string"!=typeof d&&"string"!=typeof e||(d=e="periodic");var n=[[],[],[]];switch(typeof d){case"undefined":g[0]=l(3/(h[0]*h[0]),i[0]),n[0].push(0,0),n[1].push(0,1),n[2].push(2/h[0],1/h[0]);break;case"string":g[0]=m(l(3/(h[f-2]*h[f-2]),i[f-2]),l(3/(h[0]*h[0]),i[0])),n[0].push(0,0,0),n[1].push(f-2,0,1),n[2].push(1/h[f-2],2/h[f-2]+2/h[0],1/h[0]);break;default:g[0]=d,n[0].push(0),n[1].push(0),n[2].push(1)}for(j=1;j<f-1;j++)g[j]=m(l(3/(h[j-1]*h[j-1]),i[j-1]),l(3/(h[j]*h[j]),i[j])),n[0].push(j,j,j),n[1].push(j-1,j,j+1),n[2].push(1/h[j-1],2/h[j-1]+2/h[j],1/h[j]);switch(typeof e){case"undefined":g[f-1]=l(3/(h[f-2]*h[f-2]),i[f-2]),n[0].push(f-1,f-1),n[1].push(f-2,f-1),n[2].push(1/h[f-2],2/h[f-2]);break;case"string":n[1][n[1].length-1]=0;break;default:g[f-1]=e,n[0].push(f-1),n[1].push(f-1),n[2].push(1)}g="number"!=typeof g[0]?numeric.transpose(g):[g];var o=Array(g.length);if("string"==typeof d)for(j=o.length-1;j!==-1;--j)o[j]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(n)),g[j]),o[j][f-1]=o[j][0];else for(j=o.length-1;j!==-1;--j)o[j]=numeric.cLUsolve(numeric.cLU(n),g[j]);return o="number"==typeof c[0]?o[0]:numeric.transpose(o),new numeric.Spline(b,c,c,o,o)},numeric.fftpow2=function a(b,c){var d=b.length;if(1!==d){var g,h,e=Math.cos,f=Math.sin,i=Array(d/2),j=Array(d/2),k=Array(d/2),l=Array(d/2);for(h=d/2,g=d-1;g!==-1;--g)--h,k[h]=b[g],l[h]=c[g],--g,i[h]=b[g],j[h]=c[g];a(i,j),a(k,l),h=d/2;var m,o,p,n=-6.283185307179586/d;for(g=d-1;g!==-1;--g)--h,h===-1&&(h=d/2-1),m=n*g,o=e(m),p=f(m),b[g]=i[h]+o*k[h]-p*l[h],c[g]=j[h]+o*l[h]+p*k[h]}},numeric._ifftpow2=function a(b,c){var d=b.length;if(1!==d){var g,h,e=Math.cos,f=Math.sin,i=Array(d/2),j=Array(d/2),k=Array(d/2),l=Array(d/2);for(h=d/2,g=d-1;g!==-1;--g)--h,k[h]=b[g],l[h]=c[g],--g,i[h]=b[g],j[h]=c[g];a(i,j),a(k,l),h=d/2;var m,o,p,n=6.283185307179586/d;for(g=d-1;g!==-1;--g)--h,h===-1&&(h=d/2-1),m=n*g,o=e(m),p=f(m),b[g]=i[h]+o*k[h]-p*l[h],c[g]=j[h]+o*l[h]+p*k[h]}},numeric.ifftpow2=function(b,c){numeric._ifftpow2(b,c),numeric.diveq(b,b.length),numeric.diveq(c,c.length)},numeric.convpow2=function(b,c,d,e){numeric.fftpow2(b,c),numeric.fftpow2(d,e);var f,h,i,j,k,g=b.length;for(f=g-1;f!==-1;--f)h=b[f],j=c[f],i=d[f],k=e[f],b[f]=h*i-j*k,c[f]=h*k+j*i;numeric.ifftpow2(b,c)},numeric.T.prototype.fft=function(){var m,o,b=this.x,c=this.y,d=b.length,e=Math.log,f=e(2),g=Math.ceil(e(2*d-1)/f),h=Math.pow(2,g),i=numeric.rep([h],0),j=numeric.rep([h],0),k=Math.cos,l=Math.sin,n=-3.141592653589793/d,p=numeric.rep([h],0),q=numeric.rep([h],0);Math.floor(d/2);for(m=0;m<d;m++)p[m]=b[m];if("undefined"!=typeof c)for(m=0;m<d;m++)q[m]=c[m];for(i[0]=1,m=1;m<=h/2;m++)o=n*m*m,i[m]=k(o),j[m]=l(o),i[h-m]=k(o),j[h-m]=l(o);var s=new numeric.T(p,q),t=new numeric.T(i,j);return s=s.mul(t),numeric.convpow2(s.x,s.y,numeric.clone(t.x),numeric.neg(t.y)),s=s.mul(t),s.x.length=d,s.y.length=d,s},numeric.T.prototype.ifft=function(){var m,o,b=this.x,c=this.y,d=b.length,e=Math.log,f=e(2),g=Math.ceil(e(2*d-1)/f),h=Math.pow(2,g),i=numeric.rep([h],0),j=numeric.rep([h],0),k=Math.cos,l=Math.sin,n=3.141592653589793/d,p=numeric.rep([h],0),q=numeric.rep([h],0);Math.floor(d/2);for(m=0;m<d;m++)p[m]=b[m];if("undefined"!=typeof c)for(m=0;m<d;m++)q[m]=c[m];for(i[0]=1,m=1;m<=h/2;m++)o=n*m*m,i[m]=k(o),j[m]=l(o),i[h-m]=k(o),j[h-m]=l(o);var s=new numeric.T(p,q),t=new numeric.T(i,j);return s=s.mul(t),numeric.convpow2(s.x,s.y,numeric.clone(t.x),numeric.neg(t.y)),s=s.mul(t),s.x.length=d,s.y.length=d,s.div(d)},numeric.gradient=function(b,c){var d=c.length,e=b(c);if(isNaN(e))throw new Error("gradient: f(x) is a NaN!");var g,i,j,n,s,t,u,w,x,y,f=Math.max,h=numeric.clone(c),k=Array(d),f=(numeric.div,numeric.sub,Math.max),p=.001,q=Math.abs,r=Math.min,v=0;for(g=0;g<d;g++)for(var z=f(1e-6*e,1e-8);;){if(++v,v>20)throw new Error("Numerical gradient fails");if(h[g]=c[g]+z,i=b(h),h[g]=c[g]-z,j=b(h),h[g]=c[g],isNaN(i)||isNaN(j))z/=16;else{if(k[g]=(i-j)/(2*z),s=c[g]-z,t=c[g],u=c[g]+z,w=(i-e)/z,x=(e-j)/z,y=f(q(k[g]),q(e),q(i),q(j),q(s),q(t),q(u),1e-8),n=r(f(q(w-k[g]),q(x-k[g]),q(w-x))/y,z/y),!(n>p))break;z/=16}}return k},numeric.uncmin=function(b,c,d,e,f,g,h){var i=numeric.gradient;"undefined"==typeof h&&(h={}),"undefined"==typeof d&&(d=1e-8),"undefined"==typeof e&&(e=function(a){return i(b,a)}),"undefined"==typeof f&&(f=1e3),c=numeric.clone(c);var l,m,j=c.length,k=b(c);if(isNaN(k))throw new Error("uncmin: f(x0) is a NaN!");var n=Math.max,o=numeric.norm2;d=n(d,numeric.epsilon);var p,q,r,F,G,H,I,K,M,N,s=h.Hinv||numeric.identity(j),t=numeric.dot,v=(numeric.inv,numeric.sub),w=numeric.add,x=numeric.tensor,y=numeric.div,z=numeric.mul,A=numeric.all,B=numeric.isFinite,C=numeric.neg,D=0,Q="";for(q=e(c);D<f;){if("function"==typeof g&&g(D,c,k,q,s)){Q="Callback returned true";break}if(!A(B(q))){Q="Gradient has Infinity or NaN";break}if(p=C(t(s,q)),!A(B(p))){Q="Search direction has Infinity or NaN";break}if(N=o(p),N<d){Q="Newton step smaller than tol";break}for(M=1,m=t(q,p),G=c;D<f&&!(M*N<d)&&(F=z(p,M),G=w(c,F),l=b(G),l-k>=.1*M*m||isNaN(l));)M*=.5,++D;if(M*N<d){Q="Line search step size smaller than tol";break}if(D===f){Q="maxit reached during line search";break}r=e(G),H=v(r,q),K=t(H,F),I=t(s,H),s=v(w(s,z((K+t(H,I))/(K*K),x(F,F))),y(w(x(I,F),x(F,I)),K)),c=G,k=l,q=r,++D}return{solution:c,f:k,gradient:q,invHessian:s,iterations:D,message:Q}},numeric.Dopri=function(b,c,d,e,f,g,h){this.x=b,this.y=c,this.f=d,this.ymid=e,this.iterations=f,this.events=h,this.message=g},numeric.Dopri.prototype._at=function(b,c){function d(a){return a*a}var k,l,m,n,o,p,b,r,w,x,y,e=this,f=e.x,g=e.y,h=e.f,i=e.ymid,s=(f.length,Math.floor,.5),t=numeric.add,u=numeric.mul,v=numeric.sub;return k=f[c],l=f[c+1],n=g[c],o=g[c+1],r=l-k,m=k+s*r,p=i[c],w=v(h[c],u(n,1/(k-m)+2/(k-l))),x=v(h[c+1],u(o,1/(l-m)+2/(l-k))),y=[d(b-l)*(b-m)/d(k-l)/(k-m),d(b-k)*d(b-l)/d(k-m)/d(l-m),d(b-k)*(b-m)/d(l-k)/(l-m),(b-k)*d(b-l)*(b-m)/d(k-l)/(k-m),(b-l)*d(b-k)*(b-m)/d(k-l)/(l-m)],t(t(t(t(u(n,y[0]),u(p,y[1])),u(o,y[2])),u(w,y[3])),u(x,y[4]))},numeric.Dopri.prototype.at=function(b){var c,d,e,f=Math.floor;if("number"!=typeof b){var g=b.length,h=Array(g);for(c=g-1;c!==-1;--c)h[c]=this.at(b[c]);return h}var i=this.x;for(c=0,d=i.length-1;d-c>1;)e=f(.5*(c+d)),i[e]<=b?c=e:d=e;return this._at(b,c)},numeric.dopri=function(b,c,d,e,f,g,h){"undefined"==typeof f&&(f=1e-6),"undefined"==typeof g&&(g=1e3);var l,m,n,o,p,q,C,D,I,J,T,U,V,i=[b],j=[d],k=[e(b,d)],r=[],s=.2,t=[.075,.225],u=[44/45,-56/15,32/9],v=[19372/6561,-25360/2187,64448/6561,-212/729],w=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],x=[35/384,0,500/1113,125/192,-2187/6784,11/84],y=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,.023904308236133973],z=[.2,.3,.8,8/9,1,1],A=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],B=0,E=(c-b)/10,F=0,G=numeric.add,H=numeric.mul,L=(Math.max,Math.min),M=Math.abs,N=numeric.norminf,O=Math.pow,P=numeric.any,Q=numeric.lt,R=numeric.and,W=(numeric.sub,new numeric.Dopri(i,j,k,r,-1,""));for("function"==typeof h&&(T=h(b,d));b<c&&F<g;)if(++F,b+E>c&&(E=c-b),l=e(b+z[0]*E,G(d,H(s*E,k[B]))),m=e(b+z[1]*E,G(G(d,H(t[0]*E,k[B])),H(t[1]*E,l))),n=e(b+z[2]*E,G(G(G(d,H(u[0]*E,k[B])),H(u[1]*E,l)),H(u[2]*E,m))),o=e(b+z[3]*E,G(G(G(G(d,H(v[0]*E,k[B])),H(v[1]*E,l)),H(v[2]*E,m)),H(v[3]*E,n))),p=e(b+z[4]*E,G(G(G(G(G(d,H(w[0]*E,k[B])),H(w[1]*E,l)),H(w[2]*E,m)),H(w[3]*E,n)),H(w[4]*E,o))),I=G(G(G(G(G(d,H(k[B],E*x[0])),H(m,E*x[2])),H(n,E*x[3])),H(o,E*x[4])),H(p,E*x[5])),q=e(b+E,I),C=G(G(G(G(G(H(k[B],E*A[0]),H(m,E*A[2])),H(n,E*A[3])),H(o,E*A[4])),H(p,E*A[5])),H(q,E*A[6])),J="number"==typeof C?M(C):N(C),J>f){if(E=.2*E*O(f/J,.25),b+E===b){W.msg="Step size became too small";break}}else{if(r[B]=G(G(G(G(G(G(d,H(k[B],E*y[0])),H(m,E*y[2])),H(n,E*y[3])),H(o,E*y[4])),H(p,E*y[5])),H(q,E*y[6])),++B,i[B]=b+E,j[B]=I,k[B]=q,"function"==typeof h){var X,$,Y=b,Z=b+.5*E;if(U=h(Z,r[B-1]),V=R(Q(T,0),Q(0,U)),P(V)||(Y=Z,Z=b+E,T=U,U=h(Z,I),V=R(Q(T,0),Q(0,U))),P(V)){for(var ba,ca,da=0,ea=1,fa=1;;){if("number"==typeof T)$=(fa*U*Y-ea*T*Z)/(fa*U-ea*T);else for($=Z,D=T.length-1;D!==-1;--D)T[D]<0&&U[D]>0&&($=L($,(fa*U[D]*Y-ea*T[D]*Z)/(fa*U[D]-ea*T[D])));if($<=Y||$>=Z)break;X=W._at($,B-1),ca=h($,X),ba=R(Q(T,0),Q(0,ca)),P(ba)?(Z=$,U=ca,V=ba,fa=1,da===-1?ea*=.5:ea=1,da=-1):(Y=$,T=ca,ea=1,1===da?fa*=.5:fa=1,da=1)}return I=W._at(.5*(b+$),B-1),W.f[B]=e($,X),W.x[B]=$,W.y[B]=X,W.ymid[B-1]=I,W.events=V,W.iterations=F,W}}b+=E,d=I,T=U,E=L(.8*E*O(f/J,.25),4*E)}return W.iterations=F,W},numeric.LU=function(a,b){b=b||!1;var d,e,f,g,h,i,j,k,l,c=Math.abs,m=a.length,n=m-1,o=new Array(m);for(b||(a=numeric.clone(a)),f=0;f<m;++f){for(j=f,i=a[f],l=c(i[f]),e=f+1;e<m;++e)g=c(a[e][f]),l<g&&(l=g,j=e);for(o[f]=j,j!=f&&(a[f]=a[j],a[j]=i,i=a[f]),h=i[f],d=f+1;d<m;++d)a[d][f]/=h;for(d=f+1;d<m;++d){for(k=a[d],e=f+1;e<n;++e)k[e]-=k[f]*i[e],++e,k[e]-=k[f]*i[e];e===n&&(k[e]-=k[f]*i[e])}}return{LU:a,P:o}},numeric.LUsolve=function(b,c){var d,e,j,k,m,f=b.LU,g=f.length,h=numeric.clone(c),i=b.P;for(d=g-1;d!==-1;--d)h[d]=c[d];for(d=0;d<g;++d)for(j=i[d],i[d]!==d&&(m=h[d],h[d]=h[j],h[j]=m),k=f[d],e=0;e<d;++e)h[d]-=h[e]*k[e];for(d=g-1;d>=0;--d){for(k=f[d],e=d+1;e<g;++e)h[d]-=h[e]*k[e];h[d]/=k[d]}return h},numeric.solve=function(b,c,d){return numeric.LUsolve(numeric.LU(b,d),c)},numeric.echelonize=function(b){var h,i,j,k,l,m,n,o,c=numeric.dim(b),d=c[0],e=c[1],f=numeric.identity(d),g=Array(d),p=Math.abs,q=numeric.diveq;for(b=numeric.clone(b),h=0;h<d;++h){for(j=0,l=b[h],m=f[h],i=1;i<e;++i)p(l[j])<p(l[i])&&(j=i);for(g[h]=j,q(m,l[j]),q(l,l[j]),i=0;i<d;++i)if(i!==h){for(n=b[i],o=n[j],k=e-1;k!==-1;--k)n[k]-=l[k]*o;for(n=f[i],k=d-1;k!==-1;--k)n[k]-=m[k]*o}}return{I:f,A:b,P:g}},numeric.__solveLP=function(b,c,d,e,f,g,h){var r,N,Q,S,i=numeric.sum,k=(numeric.log,numeric.mul),l=numeric.sub,m=numeric.dot,n=numeric.div,o=numeric.add,p=b.length,q=d.length,s=!1,u=0,v=1,A=(numeric.transpose(c),numeric.svd,numeric.transpose),C=(numeric.leq,Math.sqrt),D=Math.abs,H=(numeric.muleq,numeric.norminf,numeric.any,Math.min),I=numeric.all,J=numeric.gt,K=Array(p),L=Array(q),O=(numeric.rep([q],1),numeric.solve),P=l(d,m(c,g)),R=m(b,b);for(Q=u;Q<f;++Q){var T,V;for(T=q-1;T!==-1;--T)L[T]=n(c[T],P[T]);var W=A(L);for(T=p-1;T!==-1;--T)K[T]=i(W[T]);v=.25*D(R/m(b,K));var X=100*C(R/m(K,K));for((!isFinite(v)||v>X)&&(v=X),S=o(b,k(v,K)),N=m(W,L),T=p-1;T!==-1;--T)N[T][T]+=1;V=O(N,n(S,v),!0);var Y=n(P,m(c,V)),Z=1;for(T=q-1;T!==-1;--T)Y[T]<0&&(Z=H(Z,-.999*Y[T]));if(r=l(g,k(V,Z)),P=l(d,m(c,r)),!I(J(P,0)))return{solution:g,message:"",iterations:Q};if(g=r,v<e)return{solution:r,message:"",iterations:Q};if(h){var $=m(b,S),_=m(c,S);for(s=!0,T=q-1;T!==-1;--T)if($*_[T]<0){s=!1;break}}else s=!(g[p-1]>=0);if(s)return{solution:r,message:"Unbounded",iterations:Q}}return{solution:g,message:"maximum iteration count exceeded",iterations:Q}},numeric._solveLP=function(b,c,d,e,f){var i,g=b.length,h=d.length,m=(numeric.sum,numeric.log,numeric.mul,numeric.sub),n=numeric.dot,q=(numeric.div,numeric.add,numeric.rep([g],0).concat([1])),r=numeric.rep([h,1],-1),s=numeric.blockMatrix([[c,r]]),t=d,i=numeric.rep([g],0).concat(Math.max(0,numeric.sup(numeric.neg(d)))+1),u=numeric.__solveLP(q,s,t,e,f,i,!1),v=numeric.clone(u.solution);v.length=g;var w=numeric.inf(m(d,n(c,v)));if(w<0)return{solution:NaN,message:"Infeasible",iterations:u.iterations};var x=numeric.__solveLP(b,c,d,e,f-u.iterations,v,!0);return x.iterations+=u.iterations,x},numeric.solveLP=function(b,c,d,e,f,g,h){if("undefined"==typeof h&&(h=1e3),"undefined"==typeof g&&(g=numeric.epsilon),"undefined"==typeof e)return numeric._solveLP(b,c,d,g,h);var p,i=e.length,j=e[0].length,k=c.length,l=numeric.echelonize(e),m=numeric.rep([j],0),n=l.P,o=[];for(p=n.length-1;p!==-1;--p)m[n[p]]=1;for(p=j-1;p!==-1;--p)0===m[p]&&o.push(p);var q=numeric.getRange,r=numeric.linspace(0,i-1),s=numeric.linspace(0,k-1),t=q(e,r,o),u=q(c,s,n),v=q(c,s,o),w=numeric.dot,x=numeric.sub,y=w(u,l.I),z=x(v,w(y,t)),A=x(d,w(y,f)),B=Array(n.length),C=Array(o.length);for(p=n.length-1;p!==-1;--p)B[p]=b[n[p]];for(p=o.length-1;p!==-1;--p)C[p]=b[o[p]];var D=x(C,w(B,w(l.I,t))),E=numeric._solveLP(D,z,A,g,h),F=E.solution;if(F!==F)return E;var G=w(l.I,x(f,w(t,F))),H=Array(b.length);for(p=n.length-1;p!==-1;--p)H[n[p]]=G[p];for(p=o.length-1;p!==-1;--p)H[o[p]]=F[p];return{solution:H,message:E.message,iterations:E.iterations}},numeric.MPStoLP=function(b){function s(a){throw new Error("MPStoLP: "+a+"\nLine "+f+": "+b[f]+"\nCurrent state: "+d[c]+"\n")}b instanceof String&&b.split("\n");var f,g,h,o,c=0,d=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],e=b.length,i=0,j={},k=[],l=0,m={},n=0,p=[],q=[],r=[];for(f=0;f<e;++f){h=b[f];var t=h.match(/\S*/g),u=[];for(g=0;g<t.length;++g)""!==t[g]&&u.push(t[g]);if(0!==u.length){for(g=0;g<d.length&&h.substr(0,d[g].length)!==d[g];++g);if(g<d.length){if(c=g,1===g&&(o=u[1]),6===g)return{name:o,c:p,A:numeric.transpose(q),b:r,rows:j,vars:m}}else switch(c){case 0:case 1:s("Unexpected line");case 2:switch(u[0]){case"N":0===i?i=u[1]:s("Two or more N rows");break;case"L":j[u[1]]=l,k[l]=1,r[l]=0,++l;break;case"G":j[u[1]]=l,k[l]=-1,r[l]=0,++l;break;case"E":j[u[1]]=l,k[l]=0,r[l]=0,++l;break;default:s("Parse error "+numeric.prettyPrint(u))}break;case 3:m.hasOwnProperty(u[0])||(m[u[0]]=n,p[n]=0,q[n]=numeric.rep([l],0),++n);var v=m[u[0]];for(g=1;g<u.length;g+=2)if(u[g]!==i){var w=j[u[g]];q[v][w]=(k[w]<0?-1:1)*parseFloat(u[g+1])}else p[v]=parseFloat(u[g+1]);break;case 4:for(g=1;g<u.length;g+=2)r[j[u[g]]]=(k[j[u[g]]]<0?-1:1)*parseFloat(u[g+1]);break;case 5:break;case 6:s("Internal error")}}}s("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(a,b,c,d,e,f,g){function h(a){var b,d,e=this,f=a.length,g=0,h=e.i=e.j=e.m=0;for(e.S=[],e.c=[],f||(a=[f++]);g<c;)e.S[g]=g++;for(g=0;g<c;g++)b=e.S[g],h=k(h+b+a[g%f]),d=e.S[h],e.S[g]=d,e.S[h]=b;e.g=function(b){var d=e.S,f=k(e.i+1),g=d[f],h=k(e.j+g),i=d[h];d[f]=i,d[h]=g;for(var j=d[k(g+i)];--b;)f=k(f+1),g=d[f],h=k(h+g),i=d[h],d[f]=i,d[h]=g,j=j*c+d[k(g+i)];return e.i=f,e.j=h,j},e.g(c)}function i(a,b,c,d,e){if(c=[],e=typeof a,b&&"object"==e)for(d in a)if(d.indexOf("S")<5)try{c.push(i(a[d],b-1))}catch(a){}return c.length?c:a+("string"!=e?"\0":"")}function j(a,b,c,d){for(a+="",c=0,d=0;d<a.length;d++)b[k(d)]=k((c^=19*b[k(d)])+a.charCodeAt(d));a="";for(d in b)a+=String.fromCharCode(b[d]);return a}function k(a){return a&c-1}b.seedrandom=function(l,m){var o,n=[];return l=j(i(m?[l,a]:arguments.length?l:[(new Date).getTime(),a,window],3),n),o=new h(n),j(o.S,a),b.random=function(){for(var b=o.g(d),h=g,i=0;b<e;)b=(b+i)*c,h*=c,i=o.g(1);for(;b>=f;)b/=2,h/=2,i>>>=1;return(b+i)/h},l},g=b.pow(c,d),e=b.pow(2,e),f=2*e,j(b.random(),a)}([],numeric.seedrandom,256,6,52),function(a){function b(a){if("object"!=typeof a)return a;var d,c=[],e=a.length;for(d=0;d<e;d++)c[d+1]=b(a[d]);return c}function c(a){if("object"!=typeof a)return a;var d,b=[],e=a.length;for(d=1;d<e;d++)b[d-1]=c(a[d]);return b}function d(a,b,c){var d,e,f,g,h;for(f=1;f<=c;f+=1){for(a[f][f]=1/a[f][f],h=-a[f][f],d=1;d<f;d+=1)a[d][f]=h*a[d][f];if(g=f+1,c<g)break;for(e=g;e<=c;e+=1)for(h=a[f][e],a[f][e]=0,d=1;d<=f;d+=1)a[d][e]=a[d][e]+h*a[d][f]}}function e(a,b,c,d){var e,f,g,h;for(f=1;f<=c;f+=1){for(h=0,e=1;e<f;e+=1)h+=a[e][f]*d[e];d[f]=(d[f]-h)/a[f][f]}for(g=1;g<=c;g+=1)for(f=c+1-g,d[f]=d[f]/a[f][f],h=-d[f],e=1;e<f;e+=1)d[e]=d[e]+h*a[e][f]}function f(a,b,c,d){var e,f,g,h,i,j;for(f=1;f<=c;f+=1){if(d[1]=f,j=0,g=f-1,g<1){if(j=a[f][f]-j,j<=0)break;a[f][f]=Math.sqrt(j)}else{for(h=1;h<=g;h+=1){for(i=a[h][f],e=1;e<h;e+=1)i-=a[e][f]*a[e][h];i/=a[h][h],a[h][f]=i,j+=i*i}if(j=a[f][f]-j,j<=0)break;a[f][f]=Math.sqrt(j)}d[1]=0}}function g(a,b,c,g,h,i,j,k,l,m,n,o,p,q,r,s){function U(){for(q[1]=q[1]+1,v=C,t=1;t<=m;t+=1){for(v+=1,I=-k[t],u=1;u<=g;u+=1)I+=j[u][t]*h[u];if(Math.abs(I)<Q&&(I=0),t>n)r[v]=I;else if(r[v]=-Math.abs(I),I>0){for(u=1;u<=g;u+=1)j[u][t]=-j[u][t];k[t]=-k[t]}}for(t=1;t<=p;t+=1)r[C+o[t]]=0;for(E=0,H=0,t=1;t<=m;t+=1)r[C+t]<H*r[G+t]&&(E=t,H=r[C+t]/r[G+t]);return 0===E?999:0}function V(){for(t=1;t<=g;t+=1){for(I=0,u=1;u<=g;u+=1)I+=a[u][t]*j[u][E];r[t]=I}for(w=z,t=1;t<=g;t+=1)r[w+t]=0;for(u=p+1;u<=g;u+=1)for(t=1;t<=g;t+=1)r[w+t]=r[w+t]+a[t][u]*r[u];for(O=!0,t=p;t>=1;t-=1){for(I=r[t],v=B+t*(t+3)/2,w=v-t,u=t+1;u<=p;u+=1)I-=r[v]*r[A+u],v+=u;if(I/=r[w],r[A+t]=I,o[t]<n)break;if(I<0)break;O=!1,y=t}if(!O)for(J=r[D+y]/r[A+y],t=1;t<=p&&!(o[t]<n)&&!(r[A+t]<0);t+=1)H=r[D+t]/r[A+t],H<J&&(J=H,y=t);for(I=0,t=z+1;t<=z+g;t+=1)I+=r[t]*r[t];if(Math.abs(I)<=Q){if(O)return s[1]=1,999;for(t=1;t<=p;t+=1)r[D+t]=r[D+t]-J*r[A+t];return r[D+p+1]=r[D+p+1]+J,700}for(I=0,t=1;t<=g;t+=1)I+=r[z+t]*j[t][E];for(K=-r[C+E]/I,P=!0,O||J<K&&(K=J,P=!1),t=1;t<=g;t+=1)h[t]=h[t]+K*r[z+t],Math.abs(h[t])<Q&&(h[t]=0);for(i[1]=i[1]+K*I*(K/2+r[D+p+1]),t=1;t<=p;t+=1)r[D+t]=r[D+t]-K*r[A+t];if(r[D+p+1]=r[D+p+1]+K,!P){for(I=-k[E],u=1;u<=g;u+=1)I+=h[u]*j[u][E];if(E>n)r[C+E]=I;else if(r[C+E]=-Math.abs(I),I>0){for(u=1;u<=g;u+=1)j[u][E]=-j[u][E];k[E]=-k[E]}return 700}for(p+=1,o[p]=E,v=B+(p-1)*p/2+1,t=1;t<=p-1;t+=1)r[v]=r[t],v+=1;if(p===g)r[v]=r[g];else{for(t=g;t>=p+1&&0!==r[t]&&(L=Math.max(Math.abs(r[t-1]),Math.abs(r[t])),M=Math.min(Math.abs(r[t-1]),Math.abs(r[t])),H=r[t-1]>=0?Math.abs(L*Math.sqrt(1+M*M/(L*L))):-Math.abs(L*Math.sqrt(1+M*M/(L*L))),L=r[t-1]/H,M=r[t]/H,1!==L);t-=1)if(0===L)for(r[t-1]=M*H,u=1;u<=g;u+=1)H=a[u][t-1],a[u][t-1]=a[u][t],a[u][t]=H;else for(r[t-1]=H,N=M/(1+L),u=1;u<=g;u+=1)H=L*a[u][t-1]+M*a[u][t],a[u][t]=N*(a[u][t-1]+H)-a[u][t],a[u][t-1]=H;r[v]=r[p]}return 0}function W(){if(v=B+y*(y+1)/2+1,w=v+y,0===r[w])return 798;if(L=Math.max(Math.abs(r[w-1]),Math.abs(r[w])),M=Math.min(Math.abs(r[w-1]),Math.abs(r[w])),H=r[w-1]>=0?Math.abs(L*Math.sqrt(1+M*M/(L*L))):-Math.abs(L*Math.sqrt(1+M*M/(L*L))),L=r[w-1]/H,M=r[w]/H,1===L)return 798;if(0===L){for(t=y+1;t<=p;t+=1)H=r[w-1],r[w-1]=r[w],r[w]=H,w+=t;for(t=1;t<=g;t+=1)H=a[t][y],a[t][y]=a[t][y+1],a[t][y+1]=H}else{for(N=M/(1+L),t=y+1;t<=p;t+=1)H=L*r[w-1]+M*r[w],r[w]=N*(r[w-1]+H)-r[w],r[w-1]=H,w+=t;for(t=1;t<=g;t+=1)H=L*a[t][y]+M*a[t][y+1],a[t][y+1]=N*(a[t][y]+H)-a[t][y+1],a[t][y]=H}return 0}function X(){for(w=v-y,t=1;t<=y;t+=1)r[w]=r[v],v+=1,w+=1;return r[D+y]=r[D+y+1],o[y]=o[y+1],y+=1,y<p?797:0}function Y(){return r[D+p]=r[D+p+1],r[D+p+1]=0,o[p]=0,p-=1,q[2]=q[2]+1,0}var t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T;F=Math.min(g,m),v=2*g+F*(F+5)/2+2*m+1,Q=1e-60;do Q+=Q,R=1+.1*Q,S=1+.2*Q;while(R<=1||S<=1);for(t=1;t<=g;t+=1)r[t]=b[t];for(t=g+1;t<=v;t+=1)r[t]=0;for(t=1;t<=m;t+=1)o[t]=0;if(x=[],0===s[1]){if(f(a,c,g,x),0!==x[1])return void(s[1]=2);e(a,c,g,b),d(a,c,g)}else{for(u=1;u<=g;u+=1)for(h[u]=0,t=1;t<=u;t+=1)h[u]=h[u]+a[t][u]*b[t];for(u=1;u<=g;u+=1)for(b[u]=0,t=u;t<=g;t+=1)b[u]=b[u]+a[u][t]*h[t]}for(i[1]=0,u=1;u<=g;u+=1)for(h[u]=b[u],i[1]=i[1]+r[u]*h[u],r[u]=0,t=u+1;t<=g;t+=1)a[t][u]=0;for(i[1]=-i[1]/2,s[1]=0,z=g,A=z+g,D=A+F,B=D+F+1,C=B+F*(F+1)/2,G=C+m,t=1;t<=m;t+=1){for(I=0,u=1;u<=g;u+=1)I+=j[u][t]*j[u][t];r[G+t]=Math.sqrt(I)}for(p=0,q[1]=0,q[2]=0,T=0;;){if(T=U(),999===T)return;for(;;){if(T=V(),0===T)break;if(999===T)return;if(700===T)if(y===p)Y();else{for(;;)if(W(),T=X(),797!==T)break;Y()}}}}function h(a,d,e,f,h,i){a=b(a),d=b(d),e=b(e);var j,k,l,m,n,t,o=[],p=[],q=[],r=[],s=[];if(h=h||0,i=i?b(i):[void 0,0],f=f?b(f):[],k=a.length-1,l=e[1].length-1,!f)for(j=1;j<=l;j+=1)f[j]=0;for(j=1;j<=l;j+=1)p[j]=0;for(m=0,n=Math.min(k,l),j=1;j<=k;j+=1)q[j]=0;for(o[1]=0,j=1;j<=2*k+n*(n+5)/2+2*l+1;j+=1)r[j]=0;for(j=1;j<=2;j+=1)s[j]=0;return g(a,d,k,k,q,o,e,f,k,l,h,p,m,s,r,i),t="",1===i[1]&&(t="constraints are inconsistent, no solution!"),2===i[1]&&(t="matrix D in quadratic function is not positive definite!"),{solution:c(q),value:c(o),unconstrained_solution:c(d),iterations:c(s),iact:c(p),message:t}}a.solveQP=h}(numeric),numeric.svd=function(b){function r(a,b){return a=Math.abs(a),b=Math.abs(b),a>b?a*Math.sqrt(1+b*b/a/a):0==b?a:b*Math.sqrt(1+a*a/b/b)}var c,d=numeric.epsilon,e=1e-64/d,f=50,g=0,h=0,i=0,j=0,k=0,l=numeric.clone(b),m=l.length,n=l[0].length;if(m<n)throw"Need more rows than columns";var o=new Array(n),p=new Array(n);for(h=0;h<n;h++)o[h]=p[h]=0;var q=numeric.rep([n,n],0),s=0,t=0,u=0,v=0,w=0,x=0,y=0;for(h=0;h<n;h++){for(o[h]=t,y=0,k=h+1,i=h;i<m;i++)y+=l[i][h]*l[i][h];if(y<=e)t=0;else for(s=l[h][h],t=Math.sqrt(y),s>=0&&(t=-t),u=s*t-y,l[h][h]=s-t,i=k;i<n;i++){for(y=0,j=h;j<m;j++)y+=l[j][h]*l[j][i];for(s=y/u,j=h;j<m;j++)l[j][i]+=s*l[j][h]}for(p[h]=t,y=0,i=k;i<n;i++)y+=l[h][i]*l[h][i];if(y<=e)t=0;else{for(s=l[h][h+1],t=Math.sqrt(y),s>=0&&(t=-t),u=s*t-y,l[h][h+1]=s-t,i=k;i<n;i++)o[i]=l[h][i]/u;for(i=k;i<m;i++){for(y=0,j=k;j<n;j++)y+=l[i][j]*l[h][j];for(j=k;j<n;j++)l[i][j]+=y*o[j]}}w=Math.abs(p[h])+Math.abs(o[h]),w>v&&(v=w)}for(h=n-1;h!=-1;h+=-1){if(0!=t){for(u=t*l[h][h+1],i=k;i<n;i++)q[i][h]=l[h][i]/u;for(i=k;i<n;i++){for(y=0,j=k;j<n;j++)y+=l[h][j]*q[j][i];for(j=k;j<n;j++)q[j][i]+=y*q[j][h]}}for(i=k;i<n;i++)q[h][i]=0,q[i][h]=0;q[h][h]=1,t=o[h],k=h}for(h=n-1;h!=-1;h+=-1){for(k=h+1,t=p[h],i=k;i<n;i++)l[h][i]=0;if(0!=t){for(u=l[h][h]*t,i=k;i<n;i++){for(y=0,j=k;j<m;j++)y+=l[j][h]*l[j][i];for(s=y/u,j=h;j<m;j++)l[j][i]+=s*l[j][h]}for(i=h;i<m;i++)l[i][h]=l[i][h]/t}else for(i=h;i<m;i++)l[i][h]=0;l[h][h]+=1}for(d*=v,j=n-1;j!=-1;j+=-1)for(var z=0;z<f;z++){var A=!1;for(k=j;k!=-1;k+=-1){if(Math.abs(o[k])<=d){A=!0;break}if(Math.abs(p[k-1])<=d)break}if(!A){g=0,y=1;var B=k-1;for(h=k;h<j+1&&(s=y*o[h],o[h]=g*o[h],!(Math.abs(s)<=d));h++)for(t=p[h],u=r(s,t),p[h]=u,g=t/u,y=-s/u,i=0;i<m;i++)w=l[i][B],x=l[i][h],l[i][B]=w*g+x*y,l[i][h]=-w*y+x*g}if(x=p[j],k==j){if(x<0)for(p[j]=-x,i=0;i<n;i++)q[i][j]=-q[i][j];break}if(z>=f-1)throw"Error: no convergence.";for(v=p[k],w=p[j-1],t=o[j-1],u=o[j],s=((w-x)*(w+x)+(t-u)*(t+u))/(2*u*w),t=r(s,1),s=s<0?((v-x)*(v+x)+u*(w/(s-t)-u))/v:((v-x)*(v+x)+u*(w/(s+t)-u))/v,g=1,y=1,h=k+1;h<j+1;h++){for(t=o[h],w=p[h],u=y*t,t=g*t,x=r(s,u),o[h-1]=x,g=s/x,y=u/x,s=v*g+t*y,t=-v*y+t*g,u=w*y,w*=g,i=0;i<n;i++)v=q[i][h-1],x=q[i][h],q[i][h-1]=v*g+x*y,q[i][h]=-v*y+x*g;for(x=r(s,u),p[h-1]=x,g=s/x,y=u/x,s=g*t+y*w,v=-y*t+g*w,i=0;i<m;i++)w=l[i][h-1],x=l[i][h],l[i][h-1]=w*g+x*y,l[i][h]=-w*y+x*g}o[k]=0,o[j]=s,p[j]=v}for(h=0;h<p.length;h++)p[h]<d&&(p[h]=0);for(h=0;h<n;h++)for(i=h-1;i>=0;i--)if(p[i]<p[h]){for(g=p[i],p[i]=p[h],p[h]=g,j=0;j<l.length;j++)c=l[j][h],l[j][h]=l[j][i],l[j][i]=c;for(j=0;j<q.length;j++)c=q[j][h],q[j][h]=q[j][i],q[j][i]=c;h=i}return{U:l,S:p,V:q}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(a,b,c){!function(){"use strict";function a(a,b){var c=a.x-b.x,d=a.y-b.y;return c*c+d*d}function c(a,b,c){var d=b.x,e=b.y,f=c.x-d,g=c.y-e;if(0!==f||0!==g){var h=((a.x-d)*f+(a.y-e)*g)/(f*f+g*g);h>1?(d=c.x,e=c.y):h>0&&(d+=f*h,e+=g*h)}return f=a.x-d,g=a.y-e,f*f+g*g}function d(b,c){for(var f,d=b[0],e=[d],g=1,h=b.length;g<h;g++)f=b[g],a(f,d)>c&&(e.push(f),d=f);return d!==f&&e.push(f),e}function e(a,b){var k,l,m,n,d=a.length,e="undefined"!=typeof Uint8Array?Uint8Array:Array,f=new e(d),g=0,h=d-1,i=[],j=[];for(f[g]=f[h]=1;h;){for(l=0,k=g+1;k<h;k++)m=c(a[k],a[g],a[h]),m>l&&(n=k,l=m);l>b&&(f[n]=1,i.push(g,n,n,h)),h=i.pop(),g=i.pop()}for(k=0;k<d;k++)f[k]&&j.push(a[k]);return j}function f(a,b,c){var f=void 0!==b?b*b:1;return a=c?a:d(a,f),a=e(a,f)}"function"==typeof define&&define.amd?define(function(){return f}):"undefined"!=typeof b?b.exports=f:"undefined"!=typeof self?self.simplify=f:window.simplify=f}()},{}],9:[function(a,b,c){"use strict";function m(a,b,c,d){this.points=a,this.ids=b,this.dimension=d,this.length=c}function o(a){var b,c,l;if(Array.isArray(a)){if(b=a.length,0===b)return new m(null,null,0,0);c=a[0].length,l=d(i.mallocDouble(b*(c+1)),[b,c+1]),f(a,l.hi(b,c))}else{b=a.shape[0],c=a.shape[1];var n=a.dtype;n="int8"===n||"int16"===n||"int32"===n?"int32":"uint8"===n||"uint8_clamped"===n||"buffer"===n||"uint16"===n||"uint32"===n?"uint32":"float32"===n?"float32":"float64",l=d(i.malloc(b*(c+1)),[b,c+1]),g.assign(l.hi(b,c),a)}for(var o=0;o<b;++o)l.set(o,c,o);for(var p=h.malloc([b,c],a.dtype),q=i.mallocInt32(b),r=0,s=p.data,t=l.data,v=(k.log2(k.nextPow2(b)),e.compile(l.order,!0,l.dtype)),w=[l];r<b;){var x=w.shift(),y=x,z=0|y.shape[0];if(z>1){var B,A=k.log2(r+1)%c,C=j.root(z);B=v(y,C,function(a,b){return a.get(A)-b.get(A)});for(var D=p.index(r,0),E=B.offset,o=0;o<c;++o)s[D++]=t[E++];q[r]=t[E],r+=1,w.push(y.hi(C)),z>2&&w.push(y.lo(C+1))}else{for(var E=y.offset,D=p.index(r,0),o=0;o<c;++o)s[D+o]=t[E++];q[r]=t[E],r+=1}}return i.free(l.data),new m(p,q,b,c)}function p(a){var b=a.p,c=a.i;if(b){for(var e=b.length,f=i.mallocFloat64(e),g=0;g<e;++g)f[g]=b[g];for(var h=c.length,j=i.mallocInt32(h),g=0;g<h;++g)j[g]=c[g];var k=e/h|0;return new m(d(f,[h,k]),j,h,k)}return new m(null,null,0,a.d)}b.exports=o,b.exports.deserialize=p;
var d=a("ndarray"),e=a("ndarray-select"),f=a("ndarray-pack"),g=a("ndarray-ops"),h=a("ndarray-scratch"),i=a("typedarray-pool"),j=a("inorder-tree-layout"),k=a("bit-twiddle"),l=a("./lib/heap.js"),n=m.prototype;n.serialize=function(){return this.length>0?{p:Array.prototype.slice.call(this.points.data,0,this.length*this.dimension),i:Array.prototype.slice.call(this.ids,0,this.length)}:{d:this.dimension}},n.range=function(b,c,d){var e=this.length;if(!(e<1)){for(var g=this.dimension,j=0;j<g;++j)if(c[j]<b[j])return;var t,l=this.points,m=this.ids,n=h.malloc([e,2,g]),o=i.mallocInt32(e),p=n.data,q=l.data,r=1,s=0;for(o[0]=0,f(b,n.pick(0,0)),f(c,n.pick(0,1));s<r;){for(var u=o[s],v=k.log2(u+1)%g,w=n.index(s,0,0),x=n.index(s,1,0),y=l.index(u,0),z=!0,j=0;j<g;++j){var A=q[y+j];if(A<p[w+j]||p[x+j]<A){z=!1;break}}if(z&&(t=d(m[u]),void 0!==t))break;var B=q[y+v],C=p[x+v],D=p[w+v];if(D<=B){var E=2*u+1;if(E<e){o[r]=E;for(var F=n.index(r,0,0),j=0;j<g;++j)p[F+j]=p[w+j];for(var G=n.index(r,1,0),j=0;j<g;++j)p[G+j]=p[x+j];p[G+v]=Math.min(C,B),r+=1}}if(B<=C){var H=2*(u+1);if(H<e){o[r]=H;for(var F=n.index(r,0,0),j=0;j<g;++j)p[F+j]=p[w+j];for(var G=n.index(r,1,0),j=0;j<g;++j)p[G+j]=p[x+j];p[F+v]=Math.max(D,B),r+=1}}s+=1}return h.free(n),i.free(o),t}},n.rnn=function(a,b,c){if(!(b<0)){var d=this.length;if(!(d<1)){var r,e=this.dimension,f=this.points,g=this.ids,j=h.malloc([d,e]),l=i.mallocInt32(d),m=j.data,n=f.data,o=1,p=0,q=b*b;l[0]=0;for(var s=0;s<e;++s)j.set(0,s,0);for(;p<o;){for(var t=l[p],u=f.index(t,0),v=0,s=0;s<e;++s)v+=Math.pow(a[s]-n[u+s],2);if(v<=q&&(r=c(g[t]),void 0!==r))break;for(var w=k.log2(t+1)%e,x=0,y=j.index(p,0),s=0;s<e;++s)s!==w&&(x+=m[y+s]);var z=a[w],A=n[u+w],B=m[y+w],C=B,D=B;z<A?D=Math.max(B,Math.pow(A-z,2)):C=Math.max(B,Math.pow(A-z,2));var E=C+x,F=D+x;if(E<=q){var G=2*t+1;if(G<d){l[o]=G;for(var H=j.index(o,0),s=0;s<e;++s)m[H+s]=m[y+s];m[H+w]=C,o+=1}}if(F<=q){var I=2*(t+1);if(I<d){l[o]=I;for(var H=j.index(o,0),s=0;s<e;++s)m[H+s]=m[y+s];m[H+w]=D,o+=1}}p+=1}return h.free(j),i.free(l),r}}},n.nn=function(a,b){var c=this.length;if(c<1)return-1;if("number"==typeof b){if(b<0)return-1}else b=1/0;var d=this.dimension,e=this.points,f=e.data,g=i.mallocFloat64(d),h=new l(c,d+1),j=h.index,m=h.data;j[0]=0;for(var n=0;n<=d;++n)m[n]=0;h.count+=1;for(var o=-1,p=b;h.count>0&&!(m[0]>=p);){for(var q=j[0],r=e.index(q,0),s=0,n=0;n<d;++n)s+=Math.pow(a[n]-f[r+n],2);s<p&&(p=s,o=q);for(var t=k.log2(q+1)%d,u=0,n=0;n<d;++n){var v=m[n+1];n!==t&&(u+=v),g[n]=v}var w=a[t],x=f[r+t],y=g[t],z=y,A=y;w<x?A=Math.max(y,Math.pow(x-w,2)):z=Math.max(y,Math.pow(x-w,2));var B=z+u,C=A+u;if(h.pop(),B<p){var D=2*q+1;if(D<c){var E=h.count;j[E]=D;var F=E*(d+1);m[F]=B;for(var n=1;n<=d;++n)m[F+n]=g[n-1];m[F+t+1]=z,h.push()}}if(C<p){var G=2*(q+1);if(G<c){var E=h.count;j[E]=G;var F=E*(d+1);m[F]=C;for(var n=1;n<=d;++n)m[F+n]=g[n-1];m[F+t+1]=A,h.push()}}}return i.freeFloat64(g),h.dispose(),o<0?-1:this.ids[o]},n.knn=function(a,b,c){if("number"==typeof c){if(c<0)return[]}else c=1/0;var d=this.length;if(d<1)return[];if("number"==typeof b){if(b<=0)return[];b=0|Math.min(b,d)}else b=d;var e=this.ids,f=this.dimension,g=this.points,h=g.data,j=i.mallocFloat64(f),m=new l(b,1),n=m.index,o=m.data,p=new l(d,f+1),q=p.index,r=p.data;q[0]=0;for(var s=0;s<=f;++s)r[s]=0;p.count+=1;for(var u=c;p.count>0&&!(r[0]>=u);){for(var v=q[0],w=g.index(v,0),x=0,s=0;s<f;++s)x+=Math.pow(a[s]-h[w+s],2);if(x<u){m.count>=b&&m.pop();var y=m.count;n[y]=v,o[y]=-x,m.push(),m.count>=b&&(u=-o[0])}for(var z=k.log2(v+1)%f,A=0,s=0;s<f;++s){var B=r[s+1];s!==z&&(A+=B),j[s]=B}var C=a[z],D=h[w+z],E=j[z],F=E,G=E;C<D?G=Math.max(E,Math.pow(D-C,2)):F=Math.max(E,Math.pow(D-C,2));var H=F+A,I=G+A;if(p.pop(),H<u){var J=2*v+1;if(J<d){var K=p.count;q[K]=J;var L=K*(f+1);r[L]=H;for(var s=1;s<=f;++s)r[L+s]=j[s-1];r[L+z+1]=F,p.push()}}if(I<u){var M=2*(v+1);if(M<d){var K=p.count;q[K]=M;var L=K*(f+1);r[L]=I;for(var s=1;s<=f;++s)r[L+s]=j[s-1];r[L+z+1]=G,p.push()}}}i.freeFloat64(j),p.dispose();for(var N=new Array(m.count),e=this.ids,s=m.count-1;s>=0;--s)N[s]=e[n[0]],m.pop();return m.dispose(),N},n.dispose=function(){i.free(this.points.data),i.freeInt32(this.ids),this.points=null,this.ids=null,this.length=0}},{"./lib/heap.js":10,"bit-twiddle":11,"inorder-tree-layout":12,ndarray:30,"ndarray-ops":14,"ndarray-pack":19,"ndarray-scratch":28,"ndarray-select":29,"typedarray-pool":33}],10:[function(a,b,c){"use strict";function e(a){return 1&a?a-1>>1:(a>>1)-1}function f(a,b){this.count=0,this.dataSize=b,this.index=d.mallocInt32(a),this.data=d.mallocFloat64(a*b)}b.exports=f;var d=a("typedarray-pool"),g=f.prototype;g.heapSwap=function(a,b){var c=this.data,d=this.index,e=this.dataSize,f=d[a];d[a]=d[b],d[b]=f;for(var g=e*a,h=e*b,i=0;i<e;++i){var j=c[g];c[g]=c[h],c[h]=j,g+=1,h+=1}},g.heapUp=function(a){for(var b=this.dataSize,d=(this.index,this.data),f=d[b*a];a>0;){var g=e(a);if(g>=0){var h=d[b*g];if(f<h){this.heapSwap(a,g),a=g;continue}}break}},g.heapDown=function(a){for(var b=this.dataSize,d=(this.index,this.data),e=this.count,f=d[b*a];;){var g=f,h=2*a+1,i=2*(a+1),j=a;if(h<e){var k=d[b*h];k<g&&(j=h,g=k)}if(i<e){var l=d[b*i];l<g&&(j=i)}if(j===a)break;this.heapSwap(a,j),a=j}},g.pop=function(){this.count-=1,this.heapSwap(0,this.count),this.heapDown(0)},g.push=function(){this.heapUp(this.count),this.count+=1},g.dispose=function(){d.freeInt32(this.index),d.freeFloat64(this.data)}},{"typedarray-pool":33}],11:[function(a,b,c){"use strict";"use restrict";function e(a){var b=32;return a&=-a,a&&b--,65535&a&&(b-=16),16711935&a&&(b-=8),252645135&a&&(b-=4),858993459&a&&(b-=2),1431655765&a&&(b-=1),b}var d=32;c.INT_BITS=d,c.INT_MAX=2147483647,c.INT_MIN=-1<<d-1,c.sign=function(a){return(a>0)-(a<0)},c.abs=function(a){var b=a>>d-1;return(a^b)-b},c.min=function(a,b){return b^(a^b)&-(a<b)},c.max=function(a,b){return a^(a^b)&-(a<b)},c.isPow2=function(a){return!(a&a-1||!a)},c.log2=function(a){var b,c;return b=(a>65535)<<4,a>>>=b,c=(a>255)<<3,a>>>=c,b|=c,c=(a>15)<<2,a>>>=c,b|=c,c=(a>3)<<1,a>>>=c,b|=c,b|a>>1},c.log10=function(a){return a>=1e9?9:a>=1e8?8:a>=1e7?7:a>=1e6?6:a>=1e5?5:a>=1e4?4:a>=1e3?3:a>=100?2:a>=10?1:0},c.popCount=function(a){return a-=a>>>1&1431655765,a=(858993459&a)+(a>>>2&858993459),16843009*(a+(a>>>4)&252645135)>>>24},c.countTrailingZeros=e,c.nextPow2=function(a){return a+=0===a,--a,a|=a>>>1,a|=a>>>2,a|=a>>>4,a|=a>>>8,a|=a>>>16,a+1},c.prevPow2=function(a){return a|=a>>>1,a|=a>>>2,a|=a>>>4,a|=a>>>8,a|=a>>>16,a-(a>>>1)},c.parity=function(a){return a^=a>>>16,a^=a>>>8,a^=a>>>4,a&=15,27030>>>a&1};var f=new Array(256);!function(a){for(var b=0;b<256;++b){var c=b,d=b,e=7;for(c>>>=1;c;c>>>=1)d<<=1,d|=1&c,--e;a[b]=d<<e&255}}(f),c.reverse=function(a){return f[255&a]<<24|f[a>>>8&255]<<16|f[a>>>16&255]<<8|f[a>>>24&255]},c.interleave2=function(a,b){return a&=65535,a=16711935&(a|a<<8),a=252645135&(a|a<<4),a=858993459&(a|a<<2),a=1431655765&(a|a<<1),b&=65535,b=16711935&(b|b<<8),b=252645135&(b|b<<4),b=858993459&(b|b<<2),b=1431655765&(b|b<<1),a|b<<1},c.deinterleave2=function(a,b){return a=a>>>b&1431655765,a=858993459&(a|a>>>1),a=252645135&(a|a>>>2),a=16711935&(a|a>>>4),a=65535&(a|a>>>16),a<<16>>16},c.interleave3=function(a,b,c){return a&=1023,a=4278190335&(a|a<<16),a=251719695&(a|a<<8),a=3272356035&(a|a<<4),a=1227133513&(a|a<<2),b&=1023,b=4278190335&(b|b<<16),b=251719695&(b|b<<8),b=3272356035&(b|b<<4),b=1227133513&(b|b<<2),a|=b<<1,c&=1023,c=4278190335&(c|c<<16),c=251719695&(c|c<<8),c=3272356035&(c|c<<4),c=1227133513&(c|c<<2),a|c<<2},c.deinterleave3=function(a,b){return a=a>>>b&1227133513,a=3272356035&(a|a>>>2),a=251719695&(a|a>>>4),a=4278190335&(a|a>>>8),a=1023&(a|a>>>16),a<<22>>22},c.nextCombination=function(a){var b=a|a-1;return b+1|(~b&-~b)-1>>>e(a)+1}},{}],12:[function(a,b,c){"use strict";function e(a){var b=(d.nextPow2(a+1)>>>1)-1,c=a-b;return d.nextPow2(c)-1>=b?b:(b>>>1)+c}function f(a){return 0}function g(a){return a-1}function h(a,b){if(a<=0)return 0;var c=e(a);return b>c?h(a-c-1,b-c-1):b===c?d.log2(a):h(c,b)}function i(a,b){return Math.max(b-1,0)}function j(a,b){return Math.min(b+1,a-1)}function k(a,b){if(a<=0)return-1;var c=e(a);if(b>c){var d=k(a-c-1,b-c-1);return d<0?c:d+c+1}if(b===c)return-1;var d=k(c,b);return d<0?c:d}function l(a,b){if(a<=0)return 0;var c=e(a);return b>c?l(a-c-1,b-c-1)+c+1:b===c?e(b):l(c,b)}function m(a,b){if(a<=0)return 0;var c=e(a);return b>c?m(a-c-1,b-c-1)+c+1:b===c?e(a-c-1)+c+1:m(c,b)}function n(a,b){return 0===h(a,b)}function o(a,b){a|=0,b|=0;for(var c=0;a>1;){var d=e(a);if(b>d)c+=d+1,a-=d+1,b-=d+1;else{if(b===d)break;a=d}}return c}function p(a,b){a|=0,b|=0;for(var c=0;a>1;){var d=e(a);if(b>d)c+=d+1,a-=d+1,b-=d+1;else{if(b===d){c+=a-1;break}a=d}}return c}var d=a("bit-twiddle");c.root=e,c.begin=f,c.end=g,c.height=h,c.prev=i,c.next=j,c.parent=k,c.left=l,c.right=m,c.leaf=n,c.lo=o,c.hi=p},{"bit-twiddle":13}],13:[function(a,b,c){arguments[4][11][0].apply(c,arguments)},{dup:11}],14:[function(a,b,c){"use strict";function f(a){if(!a)return e;for(var b=0;b<a.args.length;++b){var c=a.args[b];0===b?a.args[b]={name:c,lvalue:!0,rvalue:!!a.rvalue,count:a.count||1}:a.args[b]={name:c,lvalue:!1,rvalue:!0,count:1}}return a.thisVars||(a.thisVars=[]),a.localVars||(a.localVars=[]),a}function g(a){return d({args:a.args,pre:f(a.pre),body:f(a.body),post:f(a.proc),funcName:a.funcName})}function h(a){for(var b=[],c=0;c<a.args.length;++c)b.push("a"+c);var d=new Function("P",["return function ",a.funcName,"_ndarrayops(",b.join(","),") {P(",b.join(","),");return a0}"].join(""));return d(g(a))}var d=a("cwise-compiler"),e={body:"",args:[],thisVars:[],localVars:[]},i={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};!function(){for(var a in i){var b=i[a];c[a]=h({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+b+"c"},funcName:a}),c[a+"eq"]=h({args:["array","array"],body:{args:["a","b"],body:"a"+b+"=b"},rvalue:!0,funcName:a+"eq"}),c[a+"s"]=h({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+b+"s"},funcName:a+"s"}),c[a+"seq"]=h({args:["array","scalar"],body:{args:["a","s"],body:"a"+b+"=s"},rvalue:!0,funcName:a+"seq"})}}();var j={not:"!",bnot:"~",neg:"-",recip:"1.0/"};!function(){for(var a in j){var b=j[a];c[a]=h({args:["array","array"],body:{args:["a","b"],body:"a="+b+"b"},funcName:a}),c[a+"eq"]=h({args:["array"],body:{args:["a"],body:"a="+b+"a"},rvalue:!0,count:2,funcName:a+"eq"})}}();var k={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};!function(){for(var a in k){var b=k[a];c[a]=h({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+b+"c"},funcName:a}),c[a+"s"]=h({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+b+"s"},funcName:a+"s"}),c[a+"eq"]=h({args:["array","array"],body:{args:["a","b"],body:"a=a"+b+"b"},rvalue:!0,count:2,funcName:a+"eq"}),c[a+"seq"]=h({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+b+"s"},rvalue:!0,count:2,funcName:a+"seq"})}}();var l=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];!function(){for(var a=0;a<l.length;++a){var b=l[a];c[b]=h({args:["array","array"],pre:{args:[],body:"this_f=Math."+b,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:b}),c[b+"eq"]=h({args:["array"],pre:{args:[],body:"this_f=Math."+b,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:b+"eq"})}}();var m=["max","min","atan2","pow"];!function(){for(var a=0;a<m.length;++a){var b=m[a];c[b]=h({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+b,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:b}),c[b+"s"]=h({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+b,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:b+"s"}),c[b+"eq"]=h({args:["array","array"],pre:{args:[],body:"this_f=Math."+b,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:b+"eq"}),c[b+"seq"]=h({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+b,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:b+"seq"})}}();var n=["atan2","pow"];!function(){for(var a=0;a<n.length;++a){var b=n[a];c[b+"op"]=h({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+b,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:b+"op"}),c[b+"ops"]=h({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+b,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:b+"ops"}),c[b+"opeq"]=h({args:["array","array"],pre:{args:[],body:"this_f=Math."+b,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:b+"opeq"}),c[b+"opseq"]=h({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+b,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:b+"opseq"})}}(),c.any=d({args:["array"],pre:e,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),c.all=d({args:["array"],pre:e,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),c.sum=d({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),c.prod=d({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),c.norm2squared=d({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),c.norm2=d({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),c.norminf=d({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),c.norm1=d({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),c.sup=d({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),c.inf=d({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),c.argmin=d({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),c.argmax=d({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),c.random=h({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),c.assign=h({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),c.assigns=h({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),c.equals=d({args:["array","array"],pre:e,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},{"cwise-compiler":15}],15:[function(a,b,c){"use strict";function e(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}function f(a){var b=new e;b.pre=a.pre,b.body=a.body,b.post=a.post;var c=a.args.slice(0);b.argTypes=c;for(var f=0;f<c.length;++f){var g=c[f];if("array"===g){if(b.arrayArgs.push(f),b.shimArgs.push("array"+f),f<b.pre.args.length&&b.pre.args[f].count>0)throw new Error("cwise: pre() block may not reference array args");if(f<b.post.args.length&&b.post.args[f].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===g)b.scalarArgs.push(f),b.shimArgs.push("scalar"+f);else if("index"===g){if(b.indexArgs.push(f),f<b.pre.args.length&&b.pre.args[f].count>0)throw new Error("cwise: pre() block may not reference array index");if(f<b.body.args.length&&b.body.args[f].lvalue)throw new Error("cwise: body() block may not write to array index");if(f<b.post.args.length&&b.post.args[f].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===g){if(b.shapeArgs.push(f),f<b.pre.args.length&&b.pre.args[f].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(f<b.body.args.length&&b.body.args[f].lvalue)throw new Error("cwise: body() block may not write to array shape");if(f<b.post.args.length&&b.post.args[f].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!=typeof g||!g.offset)throw new Error("cwise: Unknown argument type "+c[f]);b.argTypes[f]="offset",b.offsetArgs.push({array:g.array,offset:g.offset}),b.offsetArgIndex.push(f)}}if(b.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(b.pre.args.length>c.length)throw new Error("cwise: Too many arguments in pre() block");if(b.body.args.length>c.length)throw new Error("cwise: Too many arguments in body() block");if(b.post.args.length>c.length)throw new Error("cwise: Too many arguments in post() block");return b.debug=!!a.printCode||!!a.debug,b.funcName=a.funcName||"cwise",b.blockSize=a.blockSize||64,d(b)}var d=a("./lib/thunk.js");b.exports=f},{"./lib/thunk.js":17}],16:[function(a,b,c){"use strict";function e(a,b,c){var k,l,d=a.length,e=b.arrayArgs.length,f=b.indexArgs.length>0,g=[],h=[],i=0,j=0;for(k=0;k<d;++k)h.push(["i",k,"=0"].join(""));for(l=0;l<e;++l)for(k=0;k<d;++k)j=i,i=a[k],0===k?h.push(["d",l,"s",k,"=t",l,"p",i].join("")):h.push(["d",l,"s",k,"=(t",l,"p",i,"-s",j,"*t",l,"p",j,")"].join(""));for(g.push("var "+h.join(",")),k=d-1;k>=0;--k)i=a[k],g.push(["for(i",k,"=0;i",k,"<s",i,";++i",k,"){"].join(""));for(g.push(c),k=0;k<d;++k){for(j=i,i=a[k],l=0;l<e;++l)g.push(["p",l,"+=d",l,"s",k].join(""));f&&(k>0&&g.push(["index[",j,"]-=s",j].join("")),g.push(["++index[",i,"]"].join(""))),g.push("}")}return g.join("\n")}function f(a,b,c,d){for(var f=b.length,g=c.arrayArgs.length,h=c.blockSize,i=c.indexArgs.length>0,j=[],k=0;k<g;++k)j.push(["var offset",k,"=p",k].join(""));for(var k=a;k<f;++k)j.push(["for(var j"+k+"=SS[",b[k],"]|0;j",k,">0;){"].join("")),j.push(["if(j",k,"<",h,"){"].join("")),j.push(["s",b[k],"=j",k].join("")),j.push(["j",k,"=0"].join("")),j.push(["}else{s",b[k],"=",h].join("")),j.push(["j",k,"-=",h,"}"].join("")),i&&j.push(["index[",b[k],"]=j",k].join(""));for(var k=0;k<g;++k){for(var l=["offset"+k],m=a;m<f;++m)l.push(["j",m,"*t",k,"p",b[m]].join(""));j.push(["p",k,"=(",l.join("+"),")"].join(""))}j.push(e(b,c,d));for(var k=a;k<f;++k)j.push("}");return j.join("\n")}function g(a){for(var b=0,c=a[0].length;b<c;){for(var d=1;d<a.length;++d)if(a[d][b]!==a[0][b])return b;++b}return b}function h(a,b,c){for(var d=a.body,e=[],f=[],g=0;g<a.args.length;++g){var h=a.args[g];if(!(h.count<=0)){var i=new RegExp(h.name,"g"),j="",k=b.arrayArgs.indexOf(g);switch(b.argTypes[g]){case"offset":var l=b.offsetArgIndex.indexOf(g),m=b.offsetArgs[l];k=m.array,j="+q"+l;case"array":j="p"+k+j;var n="l"+g,o="a"+k;1===h.count?"generic"===c[k]?h.lvalue?(e.push(["var ",n,"=",o,".get(",j,")"].join("")),d=d.replace(i,n),f.push([o,".set(",j,",",n,")"].join(""))):d=d.replace(i,[o,".get(",j,")"].join("")):d=d.replace(i,[o,"[",j,"]"].join("")):"generic"===c[k]?(e.push(["var ",n,"=",o,".get(",j,")"].join("")),d=d.replace(i,n),h.lvalue&&f.push([o,".set(",j,",",n,")"].join(""))):(e.push(["var ",n,"=",o,"[",j,"]"].join("")),d=d.replace(i,n),h.lvalue&&f.push([o,"[",j,"]=",n].join("")));break;case"scalar":d=d.replace(i,"Y"+b.scalarArgs.indexOf(g));break;case"index":d=d.replace(i,"index");break;case"shape":d=d.replace(i,"shape")}}}return[e.join("\n"),d,f.join("\n")].join("\n").trim()}function i(a){for(var b=new Array(a.length),c=!0,d=0;d<a.length;++d){var e=a[d],f=e.match(/\d+/);f=f?f[0]:"",0===e.charAt(0)?b[d]="u"+e.charAt(1)+f:b[d]=e.charAt(0)+f,d>0&&(c=c&&b[d]===b[d-1])}return c?b[0]:b.join("")}function j(a,b){for(var c=0|b[1].length,j=new Array(a.arrayArgs.length),k=new Array(a.arrayArgs.length),l=["SS"],m=["'use strict'"],n=[],o=0;o<c;++o)n.push(["s",o,"=SS[",o,"]"].join(""));for(var p=0;p<a.arrayArgs.length;++p){l.push("a"+p),l.push("t"+p),l.push("p"+p),k[p]=b[2*p],j[p]=b[2*p+1];for(var o=0;o<c;++o)n.push(["t",p,"p",o,"=t",p,"[",o,"]"].join(""))}for(var p=0;p<a.scalarArgs.length;++p)l.push("Y"+p);if(a.shapeArgs.length>0&&n.push("shape=SS.slice(0)"),a.indexArgs.length>0){for(var q=new Array(c),p=0;p<c;++p)q[p]="0";n.push(["index=[",q.join(","),"]"].join(""))}for(var p=0;p<a.offsetArgs.length;++p){for(var r=a.offsetArgs[p],s=[],o=0;o<r.offset.length;++o)0!==r.offset[o]&&(1===r.offset[o]?s.push(["t",r.array,"p",o].join("")):s.push([r.offset[o],"*t",r.array,"p",o].join("")));0===s.length?n.push("q"+p+"=0"):n.push(["q",p,"=",s.join("+")].join(""))}var t=d([].concat(a.pre.thisVars).concat(a.body.thisVars).concat(a.post.thisVars));n=n.concat(t),m.push("var "+n.join(","));for(var p=0;p<a.arrayArgs.length;++p)m.push("p"+p+"|=0");a.pre.body.length>3&&m.push(h(a.pre,a,k));var u=h(a.body,a,k),v=g(j);v<c?m.push(f(v,j[0],a,u)):m.push(e(j[0],a,u)),a.post.body.length>3&&m.push(h(a.post,a,k)),a.debug&&console.log("Generated cwise routine for ",b,":\n\n",m.join("\n"));var w=[a.funcName||"unnamed","_cwise_loop_",j[0].join("s"),"m",v,i(k)].join(""),x=new Function(["function ",w,"(",l.join(","),"){",m.join("\n"),"} return ",w].join(""));return x()}var d=a("uniq");b.exports=j},{uniq:18}],17:[function(a,b,c){"use strict";function e(a){var b=["'use strict'","var CACHED={}"],c=[],e=a.funcName+"_cwise_thunk";b.push(["return function ",e,"(",a.shimArgs.join(","),"){"].join(""));for(var f=[],g=[],h=[["array",a.arrayArgs[0],".shape"].join("")],i=0;i<a.arrayArgs.length;++i){var j=a.arrayArgs[i];c.push(["t",j,"=array",j,".dtype,","r",j,"=array",j,".order"].join("")),f.push("t"+j),f.push("r"+j),g.push("t"+j),g.push("r"+j+".join()"),h.push("array"+j+".data"),h.push("array"+j+".stride"),h.push("array"+j+".offset|0")}for(var i=0;i<a.scalarArgs.length;++i)h.push("scalar"+a.scalarArgs[i]);c.push(["type=[",g.join(","),"].join()"].join("")),c.push("proc=CACHED[type]"),b.push("var "+c.join(",")),b.push(["if(!proc){","CACHED[type]=proc=compile([",f.join(","),"])}","return proc(",h.join(","),")}"].join("")),a.debug&&console.log("Generated thunk:",b.join("\n"));var k=new Function("compile",b.join("\n"));return k(d.bind(void 0,a))}var d=a("./compile.js");b.exports=e},{"./compile.js":16}],18:[function(a,b,c){"use strict";function d(a,b){for(var c=1,d=a.length,e=a[0],f=a[0],g=1;g<d;++g)if(f=e,e=a[g],b(e,f)){if(g===c){c++;continue}a[c++]=e}return a.length=c,a}function e(a){for(var b=1,c=a.length,d=a[0],e=a[0],f=1;f<c;++f,e=d)if(e=d,d=a[f],d!==e){if(f===b){b++;continue}a[b++]=d}return a.length=b,a}function f(a,b,c){return 0===a.length?a:b?(c||a.sort(b),d(a,b)):(c||a.sort(),e(a))}b.exports=f},{}],19:[function(a,b,c){"use strict";var d=a("ndarray"),e=a("./doConvert.js");b.exports=function(b,c){for(var f=[],g=b,h=1;g instanceof Array;)f.push(g.length),h*=g.length,g=g[0];return 0===f.length?d():(c||(c=d(new Float64Array(h),f)),e(c,b),c)}},{"./doConvert.js":20,ndarray:30}],20:[function(a,b,c){b.exports=a("cwise-compiler")({args:["array","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\nvar _inline_1_v=_inline_1_arg1_,_inline_1_i\nfor(_inline_1_i=0;_inline_1_i<_inline_1_arg2_.length-1;++_inline_1_i) {\n_inline_1_v=_inline_1_v[_inline_1_arg2_[_inline_1_i]]\n}\n_inline_1_arg0_=_inline_1_v[_inline_1_arg2_[_inline_1_arg2_.length-1]]\n}",args:[{name:"_inline_1_arg0_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:4}],thisVars:[],localVars:["_inline_1_i","_inline_1_v"]},post:{body:"{}",args:[],thisVars:[],localVars:[]},funcName:"convert",blockSize:64})},{"cwise-compiler":21}],21:[function(a,b,c){"use strict";function e(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}function f(a){var b=new e;b.pre=a.pre,b.body=a.body,b.post=a.post;var c=a.args.slice(0);b.argTypes=c.slice(0);for(var f=0;f<c.length;++f){var g=c[f];if("array"===g){if(b.arrayArgs.push(f),b.shimArgs.push("array"+f),f<b.pre.args.length&&b.pre.args[f].count>0)throw new Error("cwise: pre() block may not reference array args");if(f<b.post.args.length&&b.post.args[f].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===g)b.scalarArgs.push(f),b.shimArgs.push("scalar"+f);else if("index"===g){if(b.indexArgs.push(f),f<b.pre.args.length&&b.pre.args[f].count>0)throw new Error("cwise: pre() block may not reference array index");if(f<b.body.args.length&&b.body.args[f].lvalue)throw new Error("cwise: body() block may not write to array index");if(f<b.post.args.length&&b.post.args[f].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===g){if(b.shapeArgs.push(f),f<b.pre.args.length&&b.pre.args[f].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(f<b.body.args.length&&b.body.args[f].lvalue)throw new Error("cwise: body() block may not write to array shape");if(f<b.post.args.length&&b.post.args[f].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!=typeof g||!g.offset)throw new Error("cwise: Unknown argument type "+c[f]);b.argTypes[f]="offset",b.offsetArgs.push({array:g.array,offset:g.offset}),b.offsetArgIndex.push(f)}}if(b.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(b.pre.args.length>c.length)throw new Error("cwise: Too many arguments in pre() block");if(b.body.args.length>c.length)throw new Error("cwise: Too many arguments in body() block");if(b.post.args.length>c.length)throw new Error("cwise: Too many arguments in post() block");return b.debug=!!a.printCode||!!a.debug,b.funcName=a.funcName||"cwise",b.blockSize=a.blockSize||64,d(b)}var d=a("./lib/thunk.js");b.exports=f},{"./lib/thunk.js":23}],22:[function(a,b,c){"use strict";function e(a,b,c){var k,l,d=a.length,e=b.arrayArgs.length,f=b.indexArgs.length>0,g=[],h=[],i=0,j=0;for(k=0;k<d;++k)h.push(["i",k,"=0"].join(""));for(l=0;l<e;++l)for(k=0;k<d;++k)j=i,i=a[k],0===k?h.push(["d",l,"s",k,"=t",l,"[",i,"]"].join("")):h.push(["d",l,"s",k,"=(t",l,"[",i,"]-s",j,"*t",l,"[",j,"])"].join(""));for(g.push("var "+h.join(",")),k=d-1;k>=0;--k)i=a[k],g.push(["for(i",k,"=0;i",k,"<s",i,";++i",k,"){"].join(""));for(g.push(c),k=0;k<d;++k){for(j=i,i=a[k],l=0;l<e;++l)g.push(["p",l,"+=d",l,"s",k].join(""));f&&(k>0&&g.push(["index[",j,"]-=s",j].join("")),g.push(["++index[",i,"]"].join(""))),g.push("}")}return g.join("\n")}function f(a,b,c,d){for(var f=b.length,g=c.arrayArgs.length,h=c.blockSize,i=c.indexArgs.length>0,j=[],k=0;k<g;++k)j.push(["var offset",k,"=p",k].join(""));for(var k=a;k<f;++k)j.push(["for(var j"+k+"=SS[",b[k],"]|0;j",k,">0;){"].join("")),j.push(["if(j",k,"<",h,"){"].join("")),j.push(["s",b[k],"=j",k].join("")),j.push(["j",k,"=0"].join("")),j.push(["}else{s",b[k],"=",h].join("")),j.push(["j",k,"-=",h,"}"].join("")),i&&j.push(["index[",b[k],"]=j",k].join(""));for(var k=0;k<g;++k){for(var l=["offset"+k],m=a;m<f;++m)l.push(["j",m,"*t",k,"[",b[m],"]"].join(""));j.push(["p",k,"=(",l.join("+"),")"].join(""))}j.push(e(b,c,d));for(var k=a;k<f;++k)j.push("}");return j.join("\n")}function g(a){for(var b=0,c=a[0].length;b<c;){for(var d=1;d<a.length;++d)if(a[d][b]!==a[0][b])return b;++b}return b}function h(a,b,c){for(var d=a.body,e=[],f=[],g=0;g<a.args.length;++g){var h=a.args[g];if(!(h.count<=0)){var i=new RegExp(h.name,"g"),j="",k=b.arrayArgs.indexOf(g);switch(b.argTypes[g]){case"offset":var l=b.offsetArgIndex.indexOf(g),m=b.offsetArgs[l];k=m.array,j="+q"+l;case"array":j="p"+k+j;var n="l"+g,o="a"+k;1===h.count?"generic"===c[k]?h.lvalue?(e.push(["var ",n,"=",o,".get(",j,")"].join("")),d=d.replace(i,n),f.push([o,".set(",j,",",n,")"].join(""))):d=d.replace(i,[o,".get(",j,")"].join("")):d=d.replace(i,[o,"[",j,"]"].join("")):"generic"===c[k]?(e.push(["var ",n,"=",o,".get(",j,")"].join("")),d=d.replace(i,n),h.lvalue&&f.push([o,".set(",j,",",n,")"].join(""))):(e.push(["var ",n,"=",o,"[",j,"]"].join("")),d=d.replace(i,n),h.lvalue&&f.push([o,"[",j,"]=",n].join("")));break;case"scalar":d=d.replace(i,"Y"+b.scalarArgs.indexOf(g));break;case"index":d=d.replace(i,"index");break;case"shape":d=d.replace(i,"shape")}}}return[e.join("\n"),d,f.join("\n")].join("\n").trim()}function i(a){for(var b=new Array(a.length),c=!0,d=0;d<a.length;++d){var e=a[d],f=e.match(/\d+/);f=f?f[0]:"",0===e.charAt(0)?b[d]="u"+e.charAt(1)+f:b[d]=e.charAt(0)+f,d>0&&(c=c&&b[d]===b[d-1])}return c?b[0]:b.join("")}function j(a,b){for(var c=0|b[1].length,j=new Array(a.arrayArgs.length),k=new Array(a.arrayArgs.length),l=["SS"],m=["'use strict'"],n=[],o=0;o<c;++o)n.push(["s",o,"=SS[",o,"]"].join(""));for(var p=0;p<a.arrayArgs.length;++p)l.push("a"+p),l.push("t"+p),l.push("p"+p),k[p]=b[2*p],j[p]=b[2*p+1];for(var p=0;p<a.scalarArgs.length;++p)l.push("Y"+p);
if(a.shapeArgs.length>0&&n.push("shape=SS.slice(0)"),a.indexArgs.length>0){for(var q=new Array(c),p=0;p<c;++p)q[p]="0";n.push(["index=[",q.join(","),"]"].join(""))}for(var p=0;p<a.offsetArgs.length;++p){for(var r=a.offsetArgs[p],s=[],o=0;o<r.offset.length;++o)0!==r.offset[o]&&(1===r.offset[o]?s.push(["t",r.array,"[",o,"]"].join("")):s.push([r.offset[o],"*t",r.array,"[",o,"]"].join("")));0===s.length?n.push("q"+p+"=0"):n.push(["q",p,"=(",s.join("+"),")|0"].join(""))}var t=d([].concat(a.pre.thisVars).concat(a.body.thisVars).concat(a.post.thisVars));n=n.concat(t),m.push("var "+n.join(","));for(var p=0;p<a.arrayArgs.length;++p)m.push("p"+p+"|=0");a.pre.body.length>3&&m.push(h(a.pre,a,k));var u=h(a.body,a,k),v=g(j);v<c?m.push(f(v,j[0],a,u)):m.push(e(j[0],a,u)),a.post.body.length>3&&m.push(h(a.post,a,k)),a.debug&&console.log("Generated cwise routine for ",b,":\n\n",m.join("\n"));var w=[a.funcName||"unnamed","_cwise_loop_",j[0].join("s"),"m",v,i(k)].join(""),x=new Function(["function ",w,"(",l.join(","),"){",m.join("\n"),"} return ",w].join(""));return x()}var d=a("uniq");b.exports=j},{uniq:24}],23:[function(a,b,c){arguments[4][17][0].apply(c,arguments)},{"./compile.js":22,dup:17}],24:[function(a,b,c){"use strict";function d(a,b){for(var c=1,d=a.length,e=a[0],f=a[0],g=1;g<d;++g)if(f=e,e=a[g],b(e,f)){if(g===c){c++;continue}a[c++]=e}return a.length=c,a}function e(a){for(var b=1,c=a.length,d=a[0],e=a[0],f=1;f<c;++f,e=d)if(e=d,d=a[f],d!==e){if(f===b){b++;continue}a[b++]=d}return a.length=b,a}function f(a,b,c){return 0===a.length?[]:b?(c||a.sort(b),d(a,b)):(c||a.sort(),e(a))}b.exports=f},{}],25:[function(a,b,c){arguments[4][11][0].apply(c,arguments)},{dup:11}],26:[function(a,b,c){"use strict";function d(a,b,c){var e=0|a[c];if(e<=0)return[];var g,f=new Array(e);if(c===a.length-1)for(g=0;g<e;++g)f[g]=b;else for(g=0;g<e;++g)f[g]=d(a,b,c+1);return f}function e(a,b){var c,d;for(c=new Array(a),d=0;d<a;++d)c[d]=b;return c}function f(a,b){switch("undefined"==typeof b&&(b=0),typeof a){case"number":if(a>0)return e(0|a,b);break;case"object":if("number"==typeof a.length)return d(a,b,0)}return[]}b.exports=f},{}],27:[function(a,b,c){(function(b,d){"use strict";function k(a){if(a){var b=a.length||a.byteLength,c=e.log2(b);i[c].push(a)}}function l(a){k(a.buffer)}function m(a){var a=e.nextPow2(a),b=e.log2(a),c=i[b];return c.length>0?c.pop():new ArrayBuffer(a)}function n(a){return new Uint8Array(m(a),0,a)}function o(a){return new Uint16Array(m(2*a),0,a)}function p(a){return new Uint32Array(m(4*a),0,a)}function q(a){return new Int8Array(m(a),0,a)}function r(a){return new Int16Array(m(2*a),0,a)}function s(a){return new Int32Array(m(4*a),0,a)}function t(a){return new Float32Array(m(4*a),0,a)}function u(a){return new Float64Array(m(8*a),0,a)}function v(a){return g?new Uint8ClampedArray(m(a),0,a):n(a)}function w(a){return new DataView(m(a),0,a)}function x(a){a=e.nextPow2(a);var b=e.log2(a),c=j[b];return c.length>0?c.pop():new d(a)}var e=a("bit-twiddle"),f=a("dup");b.__TYPEDARRAY_POOL||(b.__TYPEDARRAY_POOL={UINT8:f([32,0]),UINT16:f([32,0]),UINT32:f([32,0]),INT8:f([32,0]),INT16:f([32,0]),INT32:f([32,0]),FLOAT:f([32,0]),DOUBLE:f([32,0]),DATA:f([32,0]),UINT8C:f([32,0]),BUFFER:f([32,0])});var g="undefined"!=typeof Uint8ClampedArray,h=b.__TYPEDARRAY_POOL;h.UINT8C||(h.UINT8C=f([32,0])),h.BUFFER||(h.BUFFER=f([32,0]));var i=h.DATA,j=h.BUFFER;c.free=function(b){if(d.isBuffer(b))j[e.log2(b.length)].push(b);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(b)&&(b=b.buffer),!b)return;var c=b.length||b.byteLength,f=0|e.log2(c);i[f].push(b)}},c.freeUint8=c.freeUint16=c.freeUint32=c.freeInt8=c.freeInt16=c.freeInt32=c.freeFloat32=c.freeFloat=c.freeFloat64=c.freeDouble=c.freeUint8Clamped=c.freeDataView=l,c.freeArrayBuffer=k,c.freeBuffer=function(b){j[e.log2(b.length)].push(b)},c.malloc=function(b,c){if(void 0===c||"arraybuffer"===c)return m(b);switch(c){case"uint8":return n(b);case"uint16":return o(b);case"uint32":return p(b);case"int8":return q(b);case"int16":return r(b);case"int32":return s(b);case"float":case"float32":return t(b);case"double":case"float64":return u(b);case"uint8_clamped":return v(b);case"buffer":return x(b);case"data":case"dataview":return w(b);default:return null}return null},c.mallocArrayBuffer=m,c.mallocUint8=n,c.mallocUint16=o,c.mallocUint32=p,c.mallocInt8=q,c.mallocInt16=r,c.mallocInt32=s,c.mallocFloat32=c.mallocFloat=t,c.mallocFloat64=c.mallocDouble=u,c.mallocUint8Clamped=v,c.mallocDataView=w,c.mallocBuffer=x,c.clearCache=function(){for(var b=0;b<32;++b)h.UINT8[b].length=0,h.UINT16[b].length=0,h.UINT32[b].length=0,h.INT8[b].length=0,h.INT16[b].length=0,h.INT32[b].length=0,h.FLOAT[b].length=0,h.DOUBLE[b].length=0,h.UINT8C[b].length=0,i[b].length=0,j[b].length=0}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},a("buffer").Buffer)},{"bit-twiddle":25,buffer:1,dup:26}],28:[function(a,b,c){"use strict";function g(a){var b=a.dtype;"generic"!==b&&"array"!==b||(b="double");var c=f.malloc(a.size,b),g=d(c,a.shape);return e.assign(g,a),g}function h(a,b){b||(b="double");for(var c=1,e=new Array(a.length),g=a.length-1;g>=0;--g)e[g]=c,c*=a[g];return d(f.malloc(c,b),a,e,0)}function i(a){"generic"!==a.dtype&&"array"!==a.dtype&&f.free(a.data)}function j(a,b){b||(b="double");for(var c=1,e=new Array(a.length),g=a.length-1;g>=0;--g)e[g]=c,c*=a[g];for(var h=f.malloc(c,b),g=0;g<c;++g)h[g]=0;return d(h,a,e,0)}var d=a("ndarray"),e=a("ndarray-ops"),f=a("typedarray-pool");c.clone=g,c.malloc=h,c.free=i,c.zeros=j},{ndarray:30,"ndarray-ops":14,"typedarray-pool":27}],29:[function(a,b,c){"use strict";function n(a){return"s"+a}function o(a){return"t"+a}function p(a){return"u"+a}function q(a){return"v"+a}function r(a){return"i"+a}function s(a){return"p"+a}function t(a){return"x"+a}function u(a){var b=a.slice();return b.splice(a.indexOf(0),1),b.unshift(0),b}function v(a,b,c){function C(c,d,e){if(b)y.push(s(0),".offset=",h,"+",o(a[0]),"*(",d,");",s(1),".offset=",h,"+",o(a[0]),"*(",e,");",c,"=",f,"(",s(0),",",s(1),");");else{y.push(t(0),"=",h,"+",o(0),"*(",d,");",t(1),"=",h,"+",o(0),"*(",e,");"),v>1&&y.push("_cmp:");for(var i=v-1;i>0;--i)y.push("for(",r(i),"=0;",r(i),"<",n(i),";",r(i),"++){");w?y.push(c,"=",g,".get(",t(0),")-",g,".get(",t(1),");"):y.push(c,"=",g,"[",t(0),"]-",g,"[",t(1),"];"),v>1&&y.push("if(",c,")break _cmp;");for(var i=1;i<v;++i)y.push(t(0),"+=",q(i),";",t(1),"+=",q(i),"}")}}function D(b,c){y.push(t(0),"=",h,"+",o(a[0]),"*(",b,");",t(1),"=",h,"+",o(a[0]),"*(",c,");");for(var d=v-1;d>0;--d)y.push("for(",r(a[d]),"=0;",r(a[d]),"<",n(a[d]),";",r(a[d]),"++){");w?y.push(j,"=",g,".get(",t(0),");",g,".set(",t(0),",",g,".get(",t(1),"));",g,".set(",t(1),",",j,");"):y.push(j,"=",g,"[",t(0),"];",g,"[",t(0),"]=",g,"[",t(1),"];",g,"[",t(1),"]=",j,";");for(var d=1;d<v;++d)y.push(t(0),"+=",p(a[d]),";",t(1),"+=",p(a[d]),"}")}a=u(a);var v=a.length,w="generic"===c,x="ndSelect"+c+a.join("_")+"_"+(b?"cmp":"lex"),y=[],z=[d,e];b&&z.push(f);for(var A=[g+"="+d+".data",h+"="+d+".offset|0",i+"=Math.random",j],B=0;B<2;++B)A.push(t(B)+"=0");for(var B=0;B<v;++B)A.push(n(B)+"="+d+".shape["+B+"]|0",o(B)+"="+d+".stride["+B+"]|0",r(B)+"=0");for(var B=1;B<v;++B)B<v-1?A.push(q(B)+"=("+o(B)+"-"+n(B+1)+"*"+o(B+1)+")|0",p(a[B])+"=("+o(a[B])+"-"+n(a[B+1])+"*"+o(a[B+1])+")|0"):A.push(q(B)+"="+o(B),p(a[B])+"="+o(a[B]));if(b)for(var B=0;B<2;++B)A.push(s(B)+"="+d+".pick(0)");A.push(m+"=0",k+"=0",l+"="+n(a[0])+"-1"),y.push("while(",k,"<",l,"){",m,"=(",i,"()*(",l,"-",k,"+1)+",k,")|0;"),D(m,l),y.push(m,"=",k,";","for(",r(0),"=",k,";",r(0),"<",l,";",r(0),"++){"),C(j,r(0),l),y.push("if(",j,"<0){"),D(m,r(0)),y.push(m,"++;"),y.push("}}"),D(m,l),y.push("if(",m,"===",e,"){",k,"=",m,";","break;","}else if(",e,"<",m,"){",l,"=",m,"-1;","}else{",k,"=",m,"+1;","}","}"),b?y.push(s(0),".offset=",h,"+",k,"*",o(0),";","return ",s(0),";"):y.push("return ",d,".pick(",k,");");var E=["'use strict';function ",x,"(",z,"){","var ",A.join(),";",y.join(""),"};return ",x].join(""),F=new Function(E);return F()}function x(a,b,c){var d=a.join()+b+c,e=w[d];return e?e:w[d]=v(a,b,c)}function y(a,b,c){if(b|=0,0===a.dimension||a.shape[0]<=b||b<0)return null;var d=!!c,e=x(a.order,d,a.dtype);return d?e(a,b,c):e(a,b)}b.exports=y,b.exports.compile=x;var d="a",e="K",f="C",g="d",h="o",i="R",j="T",k="L",l="H",m="X",w={}},{}],30:[function(a,b,c){(function(c){function h(a,b){return a[0]-b[0]}function i(){var c,a=this.stride,b=new Array(a.length);for(c=0;c<b.length;++c)b[c]=[Math.abs(a[c]),c];b.sort(h);var d=new Array(b.length);for(c=0;c<d.length;++c)d[c]=b[c][1];return d}function j(a,b){var c=["View",b,"d",a].join("");b<0&&(c="View_Nil"+a);var f="generic"===a;if(b===-1){var g="function "+c+"(a){this.data=a;};var proto="+c+".prototype;proto.dtype='"+a+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+c+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+c+"(a){return new "+c+"(a);}",h=new Function(g);return h()}if(0===b){var g="function "+c+"(a,d) {this.data = a;this.offset = d};var proto="+c+".prototype;proto.dtype='"+a+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+c+"_copy() {return new "+c+"(this.data,this.offset)};proto.pick=function "+c+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+c+"_get(){return "+(f?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+c+"_set(v){return "+(f?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+c+"(a,b,c,d){return new "+c+"(a,d)}",h=new Function("TrivialArray",g);return h(l[a][0])}var g=["'use strict'"],j=d(b),k=j.map(function(a){return"i"+a}),m="this.offset+"+j.map(function(a){return"this._stride"+a+"*i"+a}).join("+");g.push("function "+c+"(a,"+j.map(function(a){return"b"+a}).join(",")+","+j.map(function(a){return"c"+a}).join(",")+",d){this.data=a");for(var n=0;n<b;++n)g.push("this._shape"+n+"=b"+n+"|0");for(var n=0;n<b;++n)g.push("this._stride"+n+"=c"+n+"|0");g.push("this.offset=d|0}","var proto="+c+".prototype","proto.dtype='"+a+"'","proto.dimension="+b);var o="VStride"+b+"d"+a,p="VShape"+b+"d"+a,q={stride:o,shape:p};for(var r in q){var s=q[r];g.push("function "+s+"(v) {this._v=v} var aproto="+s+".prototype","aproto.length="+b);for(var t=[],n=0;n<b;++n)t.push(["this._v._",r,n].join(""));g.push("aproto.toJSON=function "+s+"_toJSON(){return ["+t.join(",")+"]}","aproto.valueOf=aproto.toString=function "+s+"_toString(){return ["+t.join(",")+"].join()}");for(var n=0;n<b;++n)g.push("Object.defineProperty(aproto,"+n+",{get:function(){return this._v._"+r+n+"},set:function(v){return this._v._"+r+n+"=v|0},enumerable:true})");for(var n=0;n<e.length;++n)e[n]in Array.prototype&&g.push("aproto."+e[n]+"=Array.prototype."+e[n]);g.push(["Object.defineProperty(proto,'",r,"',{get:function ",s,"_get(){return new ",s,"(this)},set: function ",s,"_set(v){"].join(""));for(var n=0;n<b;++n)g.push("this._"+r+n+"=v["+n+"]|0");g.push("return v}})")}g.push("Object.defineProperty(proto,'size',{get:function "+c+"_size(){return "+j.map(function(a){return"this._shape"+a}).join("*"),"}})"),1===b?g.push("proto.order=[0]"):(g.push("Object.defineProperty(proto,'order',{get:"),b<4?(g.push("function "+c+"_order(){"),2===b?g.push("return (Math.abs(this._stride0)>Math.abs(this._stride1))?[1,0]:[0,1]}})"):3===b&&g.push("var s0=Math.abs(this._stride0),s1=Math.abs(this._stride1),s2=Math.abs(this._stride2);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):g.push("ORDER})")),g.push("proto.set=function "+c+"_set("+k.join(",")+",v){"),f?g.push("return this.data.set("+m+",v)}"):g.push("return this.data["+m+"]=v}"),g.push("proto.get=function "+c+"_get("+k.join(",")+"){"),f?g.push("return this.data.get("+m+")}"):g.push("return this.data["+m+"]}"),g.push("proto.index=function "+c+"_index(",k.join(),"){return "+m+"}"),g.push("proto.hi=function "+c+"_hi("+k.join(",")+"){return new "+c+"(this.data,"+j.map(function(a){return["(typeof i",a,"!=='number'||i",a,"<0)?this._shape",a,":i",a,"|0"].join("")}).join(",")+","+j.map(function(a){return"this._stride"+a}).join(",")+",this.offset)}");var u=j.map(function(a){return"a"+a+"=this._shape"+a}),v=j.map(function(a){return"c"+a+"=this._stride"+a});g.push("proto.lo=function "+c+"_lo("+k.join(",")+"){var b=this.offset,d=0,"+u.join(",")+","+v.join(","));for(var n=0;n<b;++n)g.push("if(typeof i"+n+"==='number'&&i"+n+">=0){d=i"+n+"|0;b+=c"+n+"*d;a"+n+"-=d}");g.push("return new "+c+"(this.data,"+j.map(function(a){return"a"+a}).join(",")+","+j.map(function(a){return"c"+a}).join(",")+",b)}"),g.push("proto.step=function "+c+"_step("+k.join(",")+"){var "+j.map(function(a){return"a"+a+"=this._shape"+a}).join(",")+","+j.map(function(a){return"b"+a+"=this._stride"+a}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var n=0;n<b;++n)g.push("if(typeof i"+n+"==='number'){d=i"+n+"|0;if(d<0){c+=b"+n+"*(a"+n+"-1);a"+n+"=ceil(-a"+n+"/d)}else{a"+n+"=ceil(a"+n+"/d)}b"+n+"*=d}");g.push("return new "+c+"(this.data,"+j.map(function(a){return"a"+a}).join(",")+","+j.map(function(a){return"b"+a}).join(",")+",c)}");for(var w=new Array(b),x=new Array(b),n=0;n<b;++n)w[n]="a[i"+n+"]",x[n]="b[i"+n+"]";g.push("proto.transpose=function "+c+"_transpose("+k+"){"+k.map(function(a,b){return a+"=("+a+"===undefined?"+b+":"+a+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+c+"(this.data,"+w.join(",")+","+x.join(",")+",this.offset)}"),g.push("proto.pick=function "+c+"_pick("+k+"){var a=[],b=[],c=this.offset");for(var n=0;n<b;++n)g.push("if(typeof i"+n+"==='number'&&i"+n+">=0){c=(c+this._stride"+n+"*i"+n+")|0}else{a.push(this._shape"+n+");b.push(this._stride"+n+")}");g.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),g.push("return function construct_"+c+"(data,shape,stride,offset){return new "+c+"(data,"+j.map(function(a){return"shape["+a+"]"}).join(",")+","+j.map(function(a){return"stride["+a+"]"}).join(",")+",offset)}");var h=new Function("CTOR_LIST","ORDER",g.join("\n"));return h(l[a],i)}function k(a){if(g&&c.isBuffer(a))return"buffer";if(f)switch(Object.prototype.toString.call(a)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(a)?"array":"generic"}function m(a,b,c,d){if(void 0===a){var e=l.array[0];return e([])}"number"==typeof a&&(a=[a]),void 0===b&&(b=[a.length]);var f=b.length;if(void 0===c){c=new Array(f);for(var g=f-1,h=1;g>=0;--g)c[g]=h,h*=b[g]}if(void 0===d){d=0;for(var g=0;g<f;++g)c[g]<0&&(d-=(b[g]-1)*c[g])}for(var i=k(a),m=l[i];m.length<=f+1;)m.push(j(i,m.length-1));var e=m[f+1];return e(a,b,c,d)}var d=a("iota-array"),e=["concat","join","slice","toString","indexOf","lastIndexOf","forEach","every","some","filter","map","reduce","reduceRight"],f="undefined"!=typeof Float64Array,g="undefined"!=typeof c,l={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};b.exports=m}).call(this,a("buffer").Buffer)},{buffer:1,"iota-array":31}],31:[function(a,b,c){"use strict";function d(a){for(var b=new Array(a),c=0;c<a;++c)b[c]=c;return b}b.exports=d},{}],32:[function(a,b,c){arguments[4][26][0].apply(c,arguments)},{dup:26}],33:[function(a,b,c){arguments[4][27][0].apply(c,arguments)},{"bit-twiddle":11,buffer:1,dup:27}],34:[function(a,b,c){var d;d=a("../color/sort.coffee"),b.exports=function(a,b,c,e,f,g,h){var i,j,k;for(e||(e="asc"),f instanceof Array||(f=[f]),c instanceof Array||(c=[c]),g&&void 0!==h&&"number"!=typeof h&&(h=g.id.nesting.indexOf(h)),k=0,i=0;i<c.length&&(j=c[i],a=g&&a.d3plus&&a.d3plus.sortKeys?a.d3plus.sortKeys[j]:a[j],b=g&&b.d3plus&&b.d3plus.sortKeys?b.d3plus.sortKeys[j]:b[j],k=g&&f.indexOf(j)>=0?d(a,b):a<b?-1:1,0===k&&i!==c.length-1);)i++;return"asc"===e?k:-k}},{"../color/sort.coffee":50}],35:[function(a,b,c){b.exports=function(a,b){var c;return a instanceof Array&&(c=void 0===b||null===b?b:b.constructor,a.indexOf(b)>=0||a.indexOf(c)>=0)}},{}],36:[function(a,b,c){var d,e;d=a("./comparator.coffee"),e=a("../core/fetch/sort.coffee"),b.exports=function(a,b,c,f,g,h){var i,j,k,l;if(!a||a.length<=1)return a||[];if(g)for(b||(b=g.order.value||g.size.value||g.id.value),c||(c=g.order.sort.value),f||(f=g.color.value||[]),k=0,l=a.length;k<l;k++)i=a[k],i.d3plus||(i.d3plus={}),j="d3plus"in i&&"d3plus"in i.d3plus?i.d3plus:i,i.d3plus.sortKeys=e(g,j,b,f,h);return a.sort(function(a,e){return d(a,e,b,c,f,g,h)})}},{"../core/fetch/sort.coffee":66,"./comparator.coffee":34}],37:[function(a,b,c){b.exports=function(a,b){return void 0===b?a:b===!1?[]:b instanceof Array?b:(a instanceof Array||(a=[]),a.indexOf(b)>=0?a.splice(a.indexOf(b),1):a.push(b),a)}},{}],38:[function(a,b,c){var d;d=function(a){var b,c,e,f;if(f=d.tested,a in f)return f[a];for(c=0,e=!1;c<document.styleSheets.length;){if(b=document.styleSheets[c],b.href&&b.href.indexOf(a)>=0){e=!0;break}c++}return e},d.tested={},b.exports=d},{}],39:[function(a,b,c){b.exports=!1},{}],40:[function(a,b,c){var d,e;d=a("./ie.js"),e=a("./touch.coffee"),e?b.exports={click:"click",down:"touchstart",up:"touchend",over:"touchstart",out:"touchend",move:"touchmove"}:b.exports={click:"click",down:"mousedown",up:"mouseup",over:d?"mouseenter":"mouseover",out:d?"mouseleave":"mouseout",move:"mousemove"}},{"./ie.js":39,"./touch.coffee":44}],41:[function(a,b,c){var d;d=function(){var a;return a="-webkit-transform"in document.body.style?"-webkit-":"-moz-transform"in document.body.style?"-moz-":"-ms-transform"in document.body.style?"-ms-":"-o-transform"in document.body.style?"-o-":"",d=function(){return a},a},b.exports=d},{}],42:[function(a,b,c){b.exports="rtl"===d3.select("html").attr("dir")},{}],43:[function(a,b,c){var d;d=function(){var a,b,c,e,f;return a=document.createElement("p"),a.style.width="100%",a.style.height="200px",b=document.createElement("div"),b.style.position="absolute",b.style.top="0px",b.style.left="0px",b.style.visibility="hidden",b.style.width="200px",b.style.height="150px",b.style.overflow="hidden",b.appendChild(a),document.body.appendChild(b),e=a.offsetWidth,b.style.overflow="scroll",f=a.offsetWidth,e===f&&(f=b.clientWidth),document.body.removeChild(b),c=e-f,d=function(){return c},c},b.exports=d},{}],44:[function(a,b,c){b.exports=!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)},{}],45:[function(a,b,c){b.exports=function(a){var b;return b=d3.hsl(a),b.l>.45&&(b.s>.8&&(b.s=.8),b.l=.45),b.toString()}},{}],46:[function(a,b,c){b.exports=function(a,b){var c;return void 0===b&&(b=.5),c=d3.hsl(a),b=(1-c.l)*b,c.l+=b,c.s-=b,c.toString()}},{}],47:[function(a,b,c){b.exports=function(a,b,c,d){var e,f,g;return c||(c=1),d||(d=1),a=d3.rgb(a),b=d3.rgb(b),g=(c*a.r+d*b.r-c*d*b.r)/(c+d-c*d),f=(c*a.g+d*b.g-c*d*b.g)/(c+d-c*d),e=(c*a.b+d*b.b-c*d*b.b)/(c+d-c*d),d3.rgb(g,f,e).toString()}},{}],48:[function(a,b,c){var d;d=a("./scale.coffee"),b.exports=function(a,b){var c;return c=a||Math.floor(20*Math.random()),(b=b||d)(c)}},{"./scale.coffee":49}],49:[function(a,b,c){b.exports=d3.scale.ordinal().range(["#b22200","#EACE3F","#282F6B","#B35C1E","#224F20","#5F487C","#759143","#419391","#993F88","#e89c89","#ffee8d","#afd5e8","#f7ba77","#a5c697","#c5b5e5","#d1d392","#bbefd0","#e099cf"])},{}],50:[function(a,b,c){b.exports=function(a,b){var c,d;return c=d3.hsl(a),d=d3.hsl(b),a=0===c.s?361:c.h,b=0===d.s?361:d.h,a===b?c.l-d.l:a-b}},{}],51:[function(a,b,c){b.exports=function(a){var b,c,d,e,f;return e=d3.rgb(a),d=e.r,c=e.g,b=e.b,f=(299*d+587*c+114*b)/1e3,f>=128?"#444444":"#f7f7f7"}},{}],52:[function(a,b,c){b.exports=function(a){var b,c,d;return a+="",a=a.replace(RegExp(" ","g"),""),0===a.indexOf("rgb")&&(a=a.split("(")[1].split(")")[0].split(",").slice(0,3).join(",")),0===a.indexOf("hsl")&&(a=a.split(",")[2].split(")")[0]),c=d3.rgb(a).toString(),b=["black","#000","#000000","0%","0,0,0"],d=b.indexOf(a)>=0,"#000000"!==c||d}},{}],53:[function(a,b,c){var d,e,f,g;e=a("../../client/ie.js"),g=a("./wiki.coffee"),d="http://d3plus.org/assets/img/favicon.ico",f=function(a,b,c){c=c||"",e||"undefined"!=typeof InstallTrigger?console.log("[ D3plus ] "+b):0===a.indexOf("group")?window.chrome&&navigator.onLine?console[a]("%c%c "+b,"padding: 3px 10px;line-height: 25px;background-size: 20px;background-position: top left;background-image: url('"+d+"');","font-weight:200;"+c):console[a]("%cD3plus%c "+b,"line-height: 25px;font-weight: 800;color: #b35c1e;margin-left: 0px;","font-weight:200;"+c):console[a]("%c"+b,c+"font-weight:200;")},f.comment=function(a){this("log",a,"color:#aaa;")},f.error=function(a,b){this("groupCollapsed","ERROR: "+a,"font-weight:800;color:#D74B03;"),this.stack(),this.wiki(b),this.groupEnd()},f.group=function(a){this("group",a,"color:#888;")},f.groupCollapsed=function(a){this("groupCollapsed",a,"color:#888;")},f.groupEnd=function(){e||console.groupEnd()},f.log=function(a){this("log",a,"color:#444444;")},f.stack=function(){var a,b,c,d,f,g,h;e||(a=new Error,a.stack&&(g=a.stack.split("\n"),g=g.filter(function(a){return 0!==a.indexOf("Error")&&a.indexOf("d3plus.js:")<0&&a.indexOf("d3plus.min.js:")<0}),g.length&&g[0].length&&(f=window.chrome?"at ":"@",h=g[0].split(f)[1],g=h.split(":"),3===g.length&&g.pop(),b=g.pop(),d=g.join(":").split("/"),d=d[d.length-1],c="line "+b+" of "+d+": "+h,this("log",c,"color:#D74B03;"))))},f.time=function(a){e||console.time(a)},f.timeEnd=function(a){e||console.timeEnd(a)},f.warning=function(a,b){this("groupCollapsed",a,"color:#888;"),this.stack(),this.wiki(b),this.groupEnd()},f.wiki=function(a){a&&(a in g&&(a=d3plus.repo+"wiki/"+g[a]),this("log","documentation: "+a,"color:#aaa;"))},b.exports=f},{"../../client/ie.js":39,"./wiki.coffee":54}],54:[function(a,b,c){b.exports={active:"Segmenting-Data#active",aggs:"Custom-Aggregations",alt:"Alt-Text-Parameters",attrs:"Attribute-Data#axes",axes:"Axis-Parameters",background:"Background",color:"Color-Parameters",container:"Container-Element",coords:"Geography-Data",csv:"CSV-Export",data:"Data-Points",depth:"Visible-Depth",descs:"Value-Definitions",dev:"Verbose-Mode",draw:"Draw",edges:"Edges-List",error:"Custom-Error-Message",focus:"Focus-Element",font:"Font-Styles",footer:"Custom-Footer",format:"Value-Formatting",height:"Height",history:"User-History",hover:"Hover-Element",icon:"Icon-Parameters",id:"Unique-ID",keywords:"Keyword-Parameters",labels:"Data-Labels",legend:"Legend",links:"Link-Styles",margin:"Outer-Margins",messages:"Status-Messages",method:"Methods",nodes:"Node-Positions",open:"Open",order:"Data-Ordering",remove:"Remove",search:"Search-Box",select:"Selecting-Elements#select",selectAll:"Selecting-Elements#selectall",shape:"Data-Shapes",size:"Size-Parameters",temp:"Segmenting-Data#temp",text:"Text-Parameters",time:"Time-Parameters",timeline:"Timeline",timing:"Animation-Timing",title:"Custom-Titles",tooltip:"Tooltip-Parameters",total:"Segmenting-Data#total",type:"Output-Type",ui:"Custom-Interface",width:"Width",x:"Axis-Parameters",y:"Axis-Parameters",zoom:"Zooming"}},{}],55:[function(a,b,c){var d=a("../../util/buckets.coffee"),e=a("../fetch/value.coffee"),f=a("../console/print.coffee");b.exports=function(a){a.dev.value&&f.time("getting color data range");var b=[];if(a.data.pool.forEach(function(c){var d=parseFloat(e(a,c,a.color.value));"number"==typeof d&&!isNaN(d)&&b.indexOf(d)<0&&b.push(d)}),a.dev.value&&f.timeEnd("getting color data range"),b.length>1){if(a.dev.value&&f.time("calculating color scale"),b=d3.extent(b),b[0]<0&&b[1]>0){var g=a.color.range;3==g.length&&(b.push(b[1]),b[1]=0)}else if(b[1]>0&&b[0]>=0){var g=a.color.heatmap;b=d(b,g.length)}else{var g=a.color.range.slice(0);b[0]<0?g.pop():g.shift()}a.color.valueScale=d3.scale.sqrt().domain(b).range(g).interpolate(d3.interpolateRgb),a.dev.value&&f.timeEnd("calculating color scale")}else a.color.valueScale=null}},{"../../util/buckets.coffee":203,"../console/print.coffee":53,"../fetch/value.coffee":68}],56:[function(a,b,c){var d=a("../fetch/value.coffee"),e=a("../console/print.coffee"),f=a("../../object/validate.coffee");b.exports=function(a,b){a.dev.value&&e.time("filtering data");var c=d3.keys(a.data.keys||{});"attrs"in a&&(c=c.concat(d3.keys(a.attrs.keys||{}))),b=b.filter(function(b){var c=d(a,b,a.id.value);return null!==c});var g=a.types[a.type.value].requirements||[];a.data.filters.forEach(function(e){c.indexOf(a[e].value)>=0&&g.indexOf(e)>=0&&(b=b.filter(function(b){var c=d(a,b,a[e].value);return"size"===e?"number"==typeof c:null!==c}))});var h=a.data.solo.length?"solo":"mute";return a.data[h].forEach(function(c){function g(b){var d=a[c][h].value,e=!1;return d.forEach(function(a){"function"==typeof a?e=a(b):a===b&&(e=!0)}),"solo"===h?e:!e}function i(b){if(a[c].nesting){var e=a[c].nesting;f(e)&&(e=d3.values(e));for(var h=0;h<e.length;h++){var i=b.filter(function(b){return g(d(a,b,e[h]))});i.length&&(b=i)}}return b}b=i(b),"id"===c&&("nodes"in a&&a.nodes.value&&(a.dev.value&&e.time("filtering nodes"),a.nodes.restricted=i(a.nodes.value),a.dev.value&&e.timeEnd("filtering nodes")),"edges"in a&&a.edges.value&&(a.dev.value&&e.time("filtering edges"),a.edges.restricted=a.edges.value.filter(function(b){var c=i([b[a.edges.source],b[a.edges.target]]);return 2===c.length}),a.dev.value&&e.timeEnd("filtering edges")))}),a.dev.value&&e.timeEnd("filtering data"),b}},{"../../object/validate.coffee":171,"../console/print.coffee":53,"../fetch/value.coffee":68}],57:[function(a,b,c){var d=a("./nest.js"),e=a("../fetch/value.coffee"),f=a("../console/print.coffee"),g=a("../../util/uniques.coffee");b.exports=function(a){var b;if(a.data.time={values:[]},a.time&&a.time.value){a.dev.value&&(b="analyzing time periods",f.time(b)),a.data.time.values=g(a.data.value,a.time.value,e,a),a.data.time.values.sort(function(a,b){return a-b});var c=[];a.data.time.values.forEach(function(b,d){if(0!==d){var e=a.data.time.values[d-1];c.push(b-e),d===a.data.time.values.length-1&&(a.data.time.total=b-a.data.time.values[0])}}),c=d3.min(c),a.data.time.step=c;var h=["Milliseconds","Seconds","Minutes","Hours","Date","Month","FullYear"],i=[1e3,60,60,24,30,12,1];a.data.time.periods=h;var j=function(b,c,d){return a.data.time.stepDivider||(arr=i.slice(0,d),arr.length?a.data.time.stepDivider=arr.reduce(function(a,b){return a*b}):a.data.time.stepDivider=1),Math.round(Math.floor(c-b)/a.data.time.stepDivider)},k=a.data.time.total;h.forEach(function(b,d){var e="Date"===b?28:i[d];if(!a.data.time.stepType&&(d===h.length-1||Math.round(c)<e)){a.data.time.stepType=b;var f=a.data.time.values[0],g=a.data.time.values[a.data.time.values.length-1];a.data.time.stepIntervals=j(f,g,d)}!a.data.time.totalType&&(d===h.length-1||Math.round(k)<e)&&(a.data.time.totalType=b),c/=e,k/=e}),a.data.time.values.forEach(function(b,c){if(0!==c){var d=a.data.time.values[0];a.data.time.dataSteps.push(j(d,b,h.indexOf(a.data.time.stepType)))}else a.data.time.dataSteps=[0]});var l=a.time.format.value,m=a.format.locale.value,n=[function(a){return a.getMilliseconds()},function(a){return a.getSeconds()},function(a){return a.getMinutes()},function(a){return a.getHours()},function(a){return 1!=a.getDate()},function(a){return a.getMonth()},function(a){return!0}];a.data.time.functions=n;var o=function(a,b,c){if(a===b)return c&&m.timeFormat[a+"Small"]?m.timeFormat[a+"Small"]:m.timeFormat[a];if(h.indexOf(a)>=4||h.indexOf(b)<=3)return m.timeFormat[b+"-"+a];var d;return d="Date"===b?m.timeFormat[b]:m.timeFormat[b+"-Date"],"Hours"===a?d+" "+m.timeFormat[a]:d+" "+m.timeFormat["Hours-"+a]};if(a.data.time.getFormat=o,l)"string"==typeof l?a.data.time.format=d3.locale(m.format).timeFormat(l):"function"==typeof l?a.data.time.format=l:l instanceof Array&&(a.data.time.format=d3.locale(m.format).timeFormat.multi(r)),a.data.time.multiFormat=a.data.time.format;else{for(var p=a.data.time.stepType,q=a.data.time.totalType,r=[],s=h.indexOf(p);s<=h.indexOf(q);s++){var t=s-1<h.indexOf(p)?h[s]:h[s-1],u=h[s]===t&&p!==q,v=o(t,h[s],u);r.push([v,n[s]])}a.data.time.format=d3.locale(m.format).timeFormat(o(p,q)),r.length>1?a.data.time.multiFormat=d3.locale(m.format).timeFormat.multi(r):a.data.time.multiFormat=a.data.time.format}a.data.time.ticks=[];for(var w=d3.min(a.data.time.values),x=d3.max(a.data.time.values),y=0;y<=a.data.time.stepIntervals;y++){var z=new Date(w);z["set"+a.data.time.stepType](z["get"+a.data.time.stepType]()+y),z<=x&&a.data.time.ticks.push(z)}a.dev.value&&f.timeEnd(b)}if(a.dev.value&&(b="nesting data by time and depths",f.time(b)),a.data.nested={},0===a.data.time.values.length)a.data.nested.all={},a.id.nesting.forEach(function(b,c){var e=a.id.nesting.slice(0,c+1);a.data.nested.all[b]=d(a,a.data.value,e)});else{var A=a.data.value.reduce(function(b,c){var d=e(a,c,a.time.value).getTime();return d in b||(b[d]=[]),b[d].push(c),b},{});a.data.time.values.forEach(function(b){var c=b.getTime();a.data.nested[c]={},a.id.nesting.forEach(function(b,e){var f=a.id.nesting.slice(0,e+1);a.data.nested[c][b]=d(a,A[c],f)})})}a.dev.value&&f.timeEnd(b)}},{"../../util/uniques.coffee":209,"../console/print.coffee":53,"../fetch/value.coffee":68,"./nest.js":61}],58:[function(a,b,c){var d;d=a("../fetch/value.coffee"),b.exports=function(a,b,c){var e,f,g,h,i,j,k,l,m,n;if(f=d3.nest(),a.id.grouping.value)for(void 0===c&&(c=a.id.nesting),g=h=0,j=c.length;h<j;g=++h)l=c[g],g<a.depth.value&&!function(b){return f.key(function(c){return d(a,c.d3plus,b)})}(l);for(m=[],i=0,k=b.length;i<k;i++)e=b[i],n=a.size.value?d(a,e,a.size.value):1,n&&"number"==typeof n&&n>0&&(delete e.d3plus.r,delete e.d3plus.x,delete e.d3plus.y,m.push({d3plus:e,id:e[a.id.value],value:n}));return f.entries(m)}},{"../fetch/value.coffee":68}],59:[function(a,b,c){var d,e,f=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};d=a("../console/print.coffee"),e=a("../../object/validate.coffee"),b.exports=function(a,b){var c,g,h,i,j,k,l,m,n;if(l=b+" key analysis",a.dev.value&&d.time(l),a[b].keys={},c=function(d){var g,h,i,j,k,l,m;if(d instanceof Array){for(k=[],h=0,j=d.length;h<j;h++)g=d[h],k.push(c(g));return k}if(e(d)){l=[];for(i in d)m=d[i],0===i.indexOf("d3plus")||f.call(a[b].keys,i)>=0||null===m?l.push(void 0):l.push(a[b].keys[i]=typeof m);return l}},e(a[b].value)){i=d3.keys(a[b].value).length===a.id.nesting.length,j=a[b].value;for(g in j)if(m=j[g],i&&a.id.nesting.indexOf(g)>=0&&e(m))for(h in m)n=m[h],c(n);else c(m)}else{k=a[b].value;for(g in k)m=k[g],c(m)}if(a.dev.value)return d.time(l)}},{"../../object/validate.coffee":171,"../console/print.coffee":53}],60:[function(a,b,c){var d,e;d=a("../console/print.coffee"),e=a("../../object/validate.coffee"),b.exports=function(a,b,c){var f,g,h,i;return f=a.dev.value,f&&d.time("loading "+b),i=a[b].url,a[b].filetype.value?g=a[b].filetype.value:(g=i.slice(i.length-5).split("."),g=g.length>1&&g[1],g?("txt"===g&&(g="text"),a[b].filetype.accepted.indexOf(g)<0&&(g="json")):g="json"),(h="dsv"===g?d3.dsv(a[b].delimiter.value,"text/plain"):d3[g])(i,function(h,j){var k,l;if(!h&&j){if("function"==typeof a[b].callback){if(l=a[b].callback(j))if(e(l)&&b in l)for(k in l)k in a&&(a[k].value=l[k]);else a[b].value=l}else a[b].value=j;["json"].indexOf(g)<0&&a[b].value.forEach(function(a){var b;b=[];for(k in a)isNaN(a[k])?"false"===a[k].toLowerCase()?b.push(a[k]=!1):"true"===a[k].toLowerCase()?b.push(a[k]=!0):"null"===a[k].toLowerCase()?b.push(a[k]=null):"undefined"===a[k].toLowerCase()?b.push(a[k]=void 0):b.push(void 0):b.push(a[k]=parseFloat(a[k]));return b}),a[b].changed=!0,a[b].loaded=!0}else a.error.internal='Could not load data from: "'+i+'"';
return f&&d.timeEnd("loading "+b),c()})}},{"../../object/validate.coffee":171,"../console/print.coffee":53}],61:[function(a,b,c){var d=a("../fetch/value.coffee"),e=a("../../object/validate.coffee"),f=a("../../util/uniques.coffee"),g=function(a,b,c){var e=d3.nest(),g=[],k="temp"in a?["active","temp","total"]:[];c.length?c.forEach(function(b,c){e.key(function(c){return d(a,c,b)})}):e.key(function(a){return!0}),!a.axes||!a.axes.discrete||a.time&&a[a.axes.discrete].value===a.time.value||e.key(function(b){return d(a,b,a[a.axes.discrete].value)});var l=c.length&&a.id.nesting.indexOf(c[c.length-1])>=0,m=c.length&&l?c.length-1:0;l?a.id.nesting[m]:a.depth.value;e.rollup(function(b){if(1===b.length&&"d3plus"in b[0])return g.push(b[0]),b[0];b=b.reduce(function(a,b){return b.values instanceof Array?a.concat(b.values):(a.push(b),a)},[]);var e={d3plus:{data:{},depth:m}},j=d3.sum(b,function(a){return"d3plus"in a&&a.d3plus.merged?1:0});if(j===b.length)for(var l=0;l<b.length;l++){var n=b[l];e.d3plus.merged||(e.d3plus.merged=[]),e.d3plus.merged=e.d3plus.merged.concat(n.d3plus.merged),n.d3plus.text&&(e.d3plus.text=n.d3plus.text)}for(var o=0;o<k.length;o++){var p=k[o],q=a.aggs&&a.aggs.value[r]?a.aggs.value[r]:"sum";"d3plus"in b[0]&&p in b[0].d3plus?e.d3plus[p]=d3.sum(b,function(a){return a.d3plus[p]}):"function"==typeof q?e.d3plus[p]=q(b):e.d3plus[p]=d3[q](b,function(b){var c="total"===p?1:0;return a[p].value&&(c=d(a,b,a[p].value),"number"!=typeof c&&(c=c?1:0)),c})}for(var r in a.data.keys){if(r in e.d3plus.data)e[r]=e.d3plus[r];else{var s=a.aggs&&a.aggs.value[r]?a.aggs.value[r]:"sum",t=typeof s,u=a.data.keys[r],v=a.id.nesting.indexOf(r)>=0,w="time"in a&&r===a.time.value;if(r in e.d3plus.data&&(e[r]=e.d3plus[r]),"function"===t)e[r]=a.aggs.value[r](b);else if(w)e[r]=i(f(b,r));else if("number"!==u||"string"!==t||v){var y=h(b,r),z=1===y.length?y[0][r]:f(y,r);if(1===y.length)e[r]=z;else if(z&&z.length)z instanceof Array||(z=[z]),v&&a.id.nesting.indexOf(r)>m?e[r]=y:e[r]=z;else if(v){var A=a.id.nesting.indexOf(r)-1;A>=m&&(!("endPoint"in e.d3plus)||e.d3plus.endPoint>m)&&(e.d3plus.endPoint=m)}}else{var x=b.map(function(a){return a[r]});x=x.filter(function(a){return typeof a===u}),x.length&&(e[r]=d3[s](x))}}r in e&&e[r]instanceof Array&&1===e[r].length&&(e[r]=e[r][0])}for(var B=0;B<c.length;B++){var C=c[B];C in e||(e[C]=d(a,b[0],C))}return g.push(e),e});var o=function(b,d,e){if(b.children){"number"==a.data.keys[c[d]]&&(b.key=parseFloat(b.key)),e[c[d]]=b.key,delete b.key;for(var f in e)b[f]=e[f];d++,b.children.forEach(function(a){o(a,d,e)})}};return e=e.entries(b).map(j).map(function(a){return o(a,0,{}),a}),g},h=function(a,b){function d(a){a instanceof Array?a.forEach(d):e(a)&&b in a&&(a[b]instanceof Array?a[b].forEach(d):c.push(a))}var c=[];return d(a),c},i=function(a){function c(a){for(var d=0;d<a.length;d++){var e=a[d];e&&(e.constructor===Array?c(e):b.push(e))}}var b=[];return c(a),f(b)},j=function(a){return a.values&&a.values.length?(a.children=a.values.map(function(a){return j(a)}),delete a.values,a):a.values?a.values:a};b.exports=g},{"../../object/validate.coffee":171,"../../util/uniques.coffee":209,"../fetch/value.coffee":68}],62:[function(a,b,c){var d=a("../../array/sort.coffee"),e=a("./nest.js"),f=a("../fetch/value.coffee"),h=(a("../fetch/color.coffee"),a("../fetch/text.js"));b.exports=function(a,b,c){var g;if(g=a.size.threshold.value===!1?0:"number"==typeof a.size.threshold.value?a.size.threshold.value:"function"==typeof a.size.threshold.value?a.size.threshold.value(a):"number"==typeof a.types[a.type.value].threshold?a.types[a.type.value].threshold:"function"==typeof a.types[a.type.value].threshold?a.types[a.type.value].threshold(a):.02,"number"==typeof g&&g>0){var i=[],j=0===a.depth.value?0:{},k=[],l=[],m=[],n={},o=d3.nest();c&&o.key(function(b){return f(a,b,c)}),o.rollup(function(b){var d=b.length;a.aggs.value[a.size.value]?"function"==typeof a.aggs.value[a.size.value]?d=a.aggs.value[a.size.value](b):"string"==typeof a.aggs.value[a.size.value]&&(d=d3[a.aggs.value[a.size.value]](b,function(b){return f(a,b,a.size.value)})):d=d3.sum(b,function(b){return f(a,b,a.size.value)});var e=c?f(a,b[0],c):"all";return n[e]=d,d}).entries(b),b.forEach(function(b){var d=f(a,b,a.id.value),e=f(a,b,a.size.value),h=c?f(a,b,c):"all",j=e/n[h]>=g;if(j&&i.indexOf(d)<0&&(i.push(d),a.depth.value)){var k=f(a,b,a.id.nesting[a.depth.value-1]);l.indexOf(k)<0&&l.push(k)}});var p=b.filter(function(b){var c=f(a,b,a.id.value),d=i.indexOf(c)>=0,e=a.depth.value?f(a,b,a.id.nesting[a.depth.value-1]):null;if(null!==e&&l.indexOf(e)<0&&m.indexOf(e)<0&&m.push(e),!d){var g=f(a,b,a.size.value);g>0&&(0===a.depth.value?g>j&&(j=g):(e in j||(j[e]=0),g>j[e]&&(j[e]=g)),k.push(b))}return d});if(k.length>1){k=d(k,a.size.value,"desc",[],a);var q=a.id.nesting.slice(0,a.depth.value);a.types[a.type.value].requirements.indexOf(a.axes.discrete)>=0&&q.push(a[a.axes.discrete].value);var r=e(a,k,q);r.forEach(function(b){var c=a.id.nesting[a.depth.value-1],d=f(a,b,c);if(children=c?k.filter(function(b){return f(a,b,c)===d}):k,children.length>1){a.id.nesting.forEach(function(c,d){if(a.depth.value==d){var e=b[c];"string"==typeof e?b[c]="d3plus_other_"+e:b[c]="d3plus_other"}else d>a.depth.value&&delete b[c]}),a.color.value&&"string"===a.color.type&&(0===a.depth.value?b[a.color.value]=a.color.missing:b[a.color.value]=f(a,d,a.color.value,c)),a.icon.value&&(b[a.icon.value]=f(a,d,a.icon.value,c)),d&&(b.d3plus.depth=a.depth.value);var e;0===a.depth.value?(e=a.format.value(a.format.locale.value.ui.values,{key:"threshold",vars:a}),e+=" < "+a.format.value(j,{key:a.size.value,vars:a})):(e=h(a,b,a.depth.value-1),e=e.length?e[0].split(" < ")[0]:a.format.value(a.format.locale.value.ui.values,{key:"threshold",vars:a}),m.indexOf(d)<0&&(e+=" < "+a.format.value(j[d],{key:a.size.value,vars:a}))),m.indexOf(d)<0&&(e+=" ("+a.format.value(100*g,{key:"share",vars:a})+")"),b.d3plus.threshold=j,b.d3plus.merged=children,a.text.value&&(b[a.text.value]=e),b.d3plus.text=e}})}else r=k;return p.concat(r)}return b}},{"../../array/sort.coffee":36,"../fetch/color.coffee":64,"../fetch/text.js":67,"../fetch/value.coffee":68,"./nest.js":61}],63:[function(a,b,c){var d;d=a("../../font/sizes.coffee"),b.exports=function(a,b){var c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;if(u=b.values||a.data.time.ticks,q=b.style||{},h=b.limit||a.width.value,r={},k=a.data.time.periods,p=a.data.time.stepType,s=a.data.time.totalType,f=a.data.time.functions,g=a.data.time.getFormat,i=a.format.locale.value.format,a.time.format.value)r.format=a.data.time.format,r.values=u,r.sizes=d(u.map(function(a){return r.format(a)}),q);else for(j=k.indexOf(p);j<=k.indexOf(s);){if(t=u.filter(function(a){var b,c;if(j===k.indexOf(p))return!0;if(b=!0,c=j-1,j<0)return!0;for(;c>=k.indexOf(p)&&b;)b=!f[c](a),c--;return b}),k[j]===s)e=d3.locale(i).timeFormat(g(k[j],s));else{for(l=j,e=[];l<=k.indexOf(s);)m=l-1<k.indexOf(p)?l:l-1,m=k[m],o=k[l]===m&&p!==s,c=g(m,k[l],o),e.push([c,f[l]]),l++;e=d3.locale(i).timeFormat.multi(e)}if(n=d(t.map(function(a){return e(a)}),q),d3.sum(n,function(a){return a.width})<h||j===k.indexOf(s)){r.format=e,r.values=t,r.sizes=n;break}j++}return r}},{"../../font/sizes.coffee":101}],64:[function(a,b,c){var d,e,f,g,h,i,j;d=a("./value.coffee"),g=a("../../color/random.coffee"),i=a("../../color/validate.coffee"),j=a("../../object/validate.coffee"),h=a("../../util/uniques.coffee"),b.exports=function(a,b,c){var g,i,k,l,m,n;if(m=j(b),m&&"d3plus"in b&&"color"in b.d3plus)return b.d3plus.color;if(void 0===c&&(c=a.id.value),"number"==typeof c&&(c=a.id.nesting[c]),a.color.value){for(k=[],l=a.id.nesting.indexOf(c);l>=0;){if(i=a.id.nesting[l],n=h(b,a.color.value,d,a,i),1===n.length&&(n=n[0]),!(n instanceof Array)&&void 0!==n&&null!==n){g=e(a,b,n,c),k.indexOf(g)<0&&k.push(g);break}l--}return 1===k.length?k[0]:a.color.missing}return f(a,b,c)},e=function(a,b,c,d){return c?a.color.valueScale?a.color.valueScale(c):i(c)?c:f(a,c,d):a.color.value&&"function"==typeof a.color.valueScale?a.color.valueScale(0):f(a,b,d)},f=function(a,b,c){return j(b)&&(b=d(a,b,c)),b instanceof Array&&(b=b[0]),g(b,a.color.scale.value)}},{"../../color/random.coffee":48,"../../color/validate.coffee":52,"../../object/validate.coffee":171,"../../util/uniques.coffee":209,"./value.coffee":68}],65:[function(a,b,c){var d=a("../data/filter.js"),e=a("../data/nest.js"),f=a("../console/print.coffee"),g=a("../../string/format.js"),h=a("../../string/list.coffee");b.exports=function(a,b,c){if(!a.data.value)return[];void 0===c&&(c=a.depth.value);var i=a.id.nesting[c];if(!b||b instanceof Array||(b=[b]),!b&&"time"in a){b=[];var j=a.time.solo.value.length?"solo":"mute",k=a.time[j].value;if(k.length){b=[];for(var l=0;l<k.length;l++){var m=k[l];if("function"==typeof m)for(var n=0;n<a.data.time.values.length;n++){var o=a.data.time.values[n].getTime();m(o)&&b.push(o)}else if(m.constructor===Date)b.push(new Date(m).getTime());else{m+="",4===m.length&&parseInt(m)+""===m&&(m+="/01/01");var p=new Date(m);"Invalid Date"!==p&&b.push(p.getTime())}}"mute"===j&&(b=a.data.time.values.filter(function(a){return b.indexOf(a.getTime())<0}))}else b.push("all")}else b=["all"];if(b.indexOf("all")>=0&&a.data.time.values.length){b=a.data.time.values.slice(0);for(var q=0;q<b.length;q++)b[q]=b[q].getTime()}var r=[a.type.value,i,c].concat(a.data.filters).concat(b),s=a.data.solo.length?"solo":"mute",t=d3.keys(a.data.cache),u=a.types[a.type.value].filter||void 0;if(a.data[s].length)for(var v=0;v<a.data[s].length;v++){var w=a.data[s][v],x=a[w][s].value.slice(0);x.unshift(w),r=r.concat(x)}a.axes&&a.axes.discrete&&r.push(a.axes.discrete),r=r.join("_"),a.data.cacheID=r;for(var z=0;z<t.length;z++){var A=t[z].split("_").slice(1).join("_");if(A===r){r=(new Date).getTime()+"_"+r,a.data.cache[r]=a.data.cache[t[z]],delete a.data.cache[t[z]];break}}var B;if(a.data.cache[r])return a.dev.value&&f.comment("data already cached"),B=a.data.cache[r],"function"==typeof u&&(B=u(a,B)),B;var C=[];if(B=[],a.data.value&&a.data.value.length)for(var D=0;D<b.length;D++){var E=b[D];a.data.nested[E]?B=B.concat(a.data.nested[E][i]):C.push(E)}if(0===B.length&&C.length&&!a.error.internal){C.length>1&&(C=d3.extent(C)),C=C.map(function(b){return a.data.time.format(new Date(b))}),C=C.join(" - ");var F=a.format.locale.value.error.dataYear,G=a.format.locale.value.ui.and;C=h(C,G),a.error.internal=g(F,C),a.time.missing=!0}else{if(a.time&&(a.time.missing=!1),b.length>1){var H=!1;if(["x","y"].forEach(function(b){a[b].value===a.time.value&&"discrete"===a[b].scale.value&&(H=!0)}),!H){var I=a.id.nesting.slice(0,c+1);B=e(a,B,I)}}B=B?d(a,B):[],20===t.length&&(t.sort(),delete a.data.cache[t[0]]),r=(new Date).getTime()+"_"+r,a.data.cache[r]=B,"function"==typeof u&&(B=u(a,B)),a.dev.value&&f.comment("storing data in cache")}return B}},{"../../string/format.js":172,"../../string/list.coffee":173,"../console/print.coffee":53,"../data/filter.js":56,"../data/nest.js":61}],66:[function(a,b,c){var d,e,f;f=a("./value.coffee"),d=a("./color.coffee"),e=a("./text.js"),b.exports=function(a,b,c,g,h){var i,j,k,l,m;for(c instanceof Array||(c=[c]),g instanceof Array||(g=[g]),a&&void 0!==h&&"number"!=typeof h&&(h=a.id.nesting.indexOf(h)),l={},i=0,k=c.length;i<k;i++)j=c[i],m=a?g.indexOf(j)>=0?d(a,b,h):j===a.text.value?e(a,b,h):f(a,b,j,h):b[j],m instanceof Array&&(m=m[0]),m="string"==typeof m?m.toLowerCase():m,l[j]=m;return l}},{"./color.coffee":64,"./text.js":67,"./value.coffee":68}],67:[function(a,b,c){var d=a("./value.coffee"),e=a("../../object/validate.coffee"),f=a("../../util/uniques.coffee");b.exports=function(a,b,c){"number"!=typeof c&&(c=a.depth.value);var h,g=a.id.nesting[c];a.text.nesting&&e(a.text.nesting)?h=a.text.nesting[g]?a.text.nesting[g]:a.text.value:(h=[],a.text.value&&c===a.depth.value&&h.push(a.text.value),h.push(g)),h instanceof Array||(h=[h]);var i=[];if(e(b)&&"d3plus"in b&&b.d3plus.text)i.push(b.d3plus.text.toString()),i.push(a.format.value(b.d3plus.text.toString(),{vars:a,data:b}));else{var j=e(b)?b:void 0;j&&b[a.id.value]instanceof Array?b=b[a.id.value]:b instanceof Array||(b=[b]),h.forEach(function(c){var e=f(b,c,d,a,g);e.length&&(e.length>1&&(e=e.filter(function(a){return a instanceof Array||"string"==typeof a&&a.indexOf(" < ")<0})),e=e.map(function(b){return b instanceof Array?(b=b.filter(function(a){return a}),b.map(function(b){return a.format.value(b.toString(),{vars:a,data:j,key:c})})):b?a.format.value(b.toString(),{vars:a,data:j,key:c}):void 0}),1===e.length&&(e=e[0]),i.push(e))})}return i}},{"../../object/validate.coffee":171,"../../util/uniques.coffee":209,"./value.coffee":68}],68:[function(a,b,c){var d,e,f,g,h,i,j,k,l,m;l=a("../../object/validate.coffee"),k=a("../../util/uniques.coffee"),j=function(a,b,c,g){var h,i,j,m;if(i=l(b),"function"==typeof c&&i)return c(b,a);if(i){if(c in b)return b[c];if(h=a.data.cacheID+"_"+g,d(b,h,a),c in b.d3plus.data[h])return b.d3plus.data[h][c];if(g in b)b=b[g];else{if(!(a.id.value in b))return null;if(b=b[a.id.value],g!==c&&(j=f(a,b,g,a.id.value)),null===j&&(j=e(a,b,g,a.id.value)),null===j)return null;b=j}}return b instanceof Array&&!l(b[0])&&(b=k(b)),b instanceof Array&&l(b[0])&&(m=k(b,c),m.length)?m:(m=f(a,b,c,g))?m:m=e(a,b,c,g)},f=function(a,b,c,d){var e;return a.data.viz instanceof Array&&c in a.data.keys&&(e=k(i(a.data.viz,b,d),c)),e&&e.length?e:null},e=function(a,b,c,d){var e,f,g,h;if("attrs"in a&&a.attrs.value&&c in a.attrs.keys)if(e=l(a.attrs.value)&&d in a.attrs.value?a.attrs.value[d]:a.attrs.value,e instanceof Array){if(g=k(i(e,b,d),c),g.length)return g}else if(b instanceof Array){if(e=[function(){var a,c,d;if(f in e){for(d=[],a=0,c=b.length;a<c;a++)f=b[a],d.push(e[f]);return d}}()],e.length&&(h=k(e,c),h.length))return h}else if(b in e)return e[b][c];return null},i=function(a,b,c){return b instanceof Array?a.filter(function(a){return b.indexOf(a[c])>=0}):a.filter(function(a){return a[c]===b})},d=function(a,b,c){return"d3plus"in a||(a.d3plus={}),"data"in a.d3plus||(a.d3plus.data={}),!(c.data.changed||c.attrs&&c.attrs.changed)&&b in a.d3plus.data||(a.d3plus.data[b]={}),a},m=function(a,b,c,d,e){var f,g,h,i,j,k,m;if(null===e)return e;k="time"in a&&a.time.value===d,e instanceof Array||(e=[e]);for(h=i=0,j=e.length;i<j;h=++i)m=e[h],k&&null!==m&&m.constructor!==Date&&(m+="",4===m.length&&parseInt(m)+""===m&&(m+="/01/01"),g=new Date(m),"Invalid Date"!==g&&(e[h]=g));return 1===e.length&&(e=e[0]),null===e||!l(b)||"string"!=typeof d||d in b||(f=a.data.cacheID+"_"+c,b.d3plus.data[f][d]=e),e},h=function(a,b,c,d){var e,f,g,h,i;for(i=[],f=0,g=b.length;f<g;f++)e=b[f],l(e)?(h=j(a,e,c,d),i.push(m(a,e,d,c,h))):i.push(e);return"number"!=typeof i[0]&&(i=k(i)),1===i.length?i[0]:i},g=function(a,b,c,d){var e,f;return c?"number"==typeof c?c:(e=l(b),d||(d=a.id.value),e&&b.values instanceof Array?f=h(a,b.values,c,d):e&&b[c]instanceof Array?f=h(a,b[c],c,d):b instanceof Array?f=h(a,b,c,d):(f=j(a,b,c,d),f=m(a,b,d,c,f)),f):null},b.exports=g},{"../../object/validate.coffee":171,"../../util/uniques.coffee":209}],69:[function(a,b,c){b.exports=function(a){var b,c,d;return["div","svg"].indexOf(a)<0&&(a="div"),c={position:"absolute",left:"-9999px",top:"-9999px",visibility:"hidden",display:"block"},b="div"===a?{}:{position:"absolute"},d=d3.select("body").selectAll(a+".d3plus_tester").data([0]),d.enter().append(a).attr("class","d3plus_tester").style(c).attr(b),d}},{}],70:[function(a,b,c){b.exports={dev:{accepted:"{0} is not an accepted value for {1}, please use one of the following: {2}.",deprecated:"the {0} method has been removed, please update your code to use {1}.",noChange:"{0} was not updated because it did not change.",noContainer:"cannot find a container on the page matching {0}.",of:"of",oldStyle:"style properties for {0} have now been embedded directly into .{1}().",sameEdge:"edges cannot link to themselves. automatically removing self-referencing edge {0}.",set:"{0} has been set.",setLong:"{0} has been set to {1}.",setContainer:"please define a container div using .container()"},error:{accepted:"{0} is not an accepted {1} for {2} visualizations, please use one of the following: {3}.",connections:"no connections available for {0}.",data:"no data available",dataYear:"no data available for {0}.",lib:"{0} visualizations require loading the {1} library.",libs:"{0} visualizations require loading the following libraries: {1}.",method:"{0} visualizations require setting the {1} method.",methods:"{0} visualizations require setting the following methods: {1}."},format:{decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%A, %B %-d, %Y %X",date:"%-m/%-d/%Y",time:"%I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},lowercase:["a","an","and","as","at","but","by","for","from","if","in","into","near","nor","of","on","onto","or","per","that","the","to","with","via","vs","vs."],message:{data:"analyzing data",draw:"drawing visualization",initializing:"initializing {0}",loading:"loading data",tooltipReset:"resetting tooltips",ui:"updating ui"},method:{active:"active segments",color:"color",depth:"depth",dev:"verbose",focus:"focus",icon:"icon",id:"id",height:"height",labels:"labels",legend:"legend",margin:"margin",messages:"status messages",mode:"mode",mute:"hide",order:"order",search:"search",shape:"shape",size:"size",solo:"isolate",style:"style",temp:"temporary segments",text:"text",time:"time",timeline:"timeline",total:"total segments",type:"type",width:"width",x:"x axis",y:"y axis",zoom:"zoom"},time:["date","day","month","time","year"],timeFormat:{FullYear:"%Y",Month:"%B",MonthSmall:"%b",Date:"%A %-d",DateSmall:"%-d",Hours:"%I %p",Minutes:"%I:%M",Seconds:"%Ss",Milliseconds:"%Lms","FullYear-Month":"%b %Y","FullYear-Date":"%-m/%-d/%Y","Month-Date":"%b %-d","Hours-Minutes":"%I:%M %p","Hours-Seconds":"%I:%M:%S %p","Hours-Milliseconds":"%H:%M:%S.%L","Minutes-Seconds":"%I:%M:%S %p","Minutes-Milliseconds":"%H:%M:%S.%L","Seconds-Milliseconds":"%H:%M:%S.%L"},ui:{and:"and",back:"back",collapse:"click to collapse",error:"error",expand:"click to expand",including:"including",loading:"loading...",more:"{0} more",moreInfo:"click for more info",or:"or",noResults:"no results matching {0}.",primary:"primary connections",share:"share",total:"total",values:"values"},uppercase:["CEO","US$","kg","CEOs","CFO","CFOs","CNC","COO","COOs","CPU","CPUs","GDP","HVAC","ID","IT","R&D","TV","UI"],visualization:{bar:"Bar Chart",box:"Box Plot",bubbles:"Bubbles",chart:"Chart",geo_map:"Geo Map",line:"Line Plot",network:"Network",paths:"Paths",pie:"Pie Chart",rings:"Rings",scatter:"Scatter Plot",stacked:"Stacked Area",table:"Table",tree_map:"Tree Map"}}},{}],71:[function(a,b,c){b.exports={format:{decimal:",",thousands:".",grouping:[3],currency:[""," €"],dateTime:"%A, %e de %B de %Y, %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"],shortDays:["dom","lun","mar","mié","jue","vie","sáb"],months:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],shortMonths:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"]},dev:{accepted:"{0} no es un valor aceptado para {1}, por favor utilice uno de los siguientes: {2}.",deprecated:"el método {0} ha sido eliminado, por favor, actualiza tu código para utilizar {1}.",noChange:"{0} no se actualiza porque no cambió.",noContainer:"no se puede encontrar un contenedor en la página correspondiente a {0}.",of:"de",oldStyle:"propiedades de estilo para {0} ahora se han incorporado directamente en. {1} ().",sameEdge:"los vínculos no se pueden enlazar con si mismos. eliminando automáticamente el vínculo {0} que se autorreferencia.",set:"{0} se ha establecido.",setLong:"{0} ha sido establecido a {1}.",setContainer:"defina un div contenedor utilizando .container ()"},error:{accepted:"{0} no es un {1} aceptado para visualizaciones de {2}, por favor utilice uno de los siguientes: {3}.",connections:"no hay conexiones disponibles para {0}.",data:"No hay datos disponibles",dataYear:"no hay datos disponibles para {0}.",lib:"{0} visualizaciones requieren cargar las siguientes librerías: {1}.",libs:"{0} visualizaciones requieren cargar las siguientes librerías: {1}.",method:"{0} visualizaciones requieren establecer el ​​método {1}.",methods:"{0} visualizaciones requieren establecer los siguientes métodos: {1}."},lowercase:["una","y","en","pero","en","de","o","el","la","los","las","para","a","con"],method:{active:"segmentos activos",color:"color",depth:"profundidad",dev:"detallado",focus:"foco",icon:"ícono",id:"id",height:"alto",labels:"rótulo",legend:"leyenda",margin:"margen",messages:"mensajes de estado",mute:"ocultar",order:"orden",search:"búsqueda",shape:"forma",size:"tamaño",solo:"aislar",style:"estilo",temp:"segmentos temporales",text:"texto",time:"tiempo",timeline:"línea de tiempo",total:"segmentos totales",type:"tipo",width:"anchura",x:"eje x",y:"eje Y",zoom:"#ERROR!",mode:"modo"},time:["fecha","día","mes","hora","año"],visualization:{bubbles:"Burbujas",chart:"Tabla",geo_map:"Mapa Geo",line:"Línea Solar",network:"Red",rings:"Anillos",scatter:"Gráfico De Dispersión",stacked:"Área Apilada",tree_map:"Mapa de Árbol",bar:"Gráfico De Barras",box:"Diagrama de Cajas",paths:"Caminos",pie:"Gráfico de Pastel",table:"Tabla"},ui:{and:"y",back:"atrás",collapse:"click para cerrar",error:"error",expand:"haga clic para ampliar",loading:"Cargando ...",more:"{0} más",moreInfo:"clic para más información",noResults:"no se encontraron resultados para {0}.",primary:"relaciones principales",share:"porcentaje",total:"total",values:"valores",including:"Incluyendo",or:"o"},message:{data:"analizando los datos",draw:"visualizando",initializing:"inicializando {0}",loading:"cargando datos",tooltipReset:"restableciendo las descripciones emergentes",ui:"actualizando la interfaz de usuario"},uppercase:["CEO","US$","kg","CEOs","CFO","CFOs","CNC","COO","COOs","CPU","CPUs","PIB","HVAC","ID","TI","I&D","TV","UI"]}},{}],72:[function(a,b,c){b.exports={format:{decimal:",",thousands:".",grouping:[3],currency:[""," €"],dateTime:"%A, le %e %B %Y, %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],shortDays:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],months:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],shortMonths:["janv.","févr.","mars","avr.","mai","juin","juil.","août","sept.","oct.","nov.","déc."]},dev:{accepted:"{0} n'est pas une option valide pour {1}, les valeurs possibles sont: {2}.",deprecated:"{0} a été éliminé de la version courante, mettez à jour votre code source avec {1}.",noChange:"{0} n'a pas été mis à jour car inchangé.",noContainer:"impossible de trouver un contenant correspondant à {0}.",of:"de",oldStyle:"les propriétés de {0} ont été imbriquées dans .{1}().",sameEdge:"un arc ne peut pas boucler sur lui même. L'auto-référence est automatiquement éliminée {0}.",set:"{0} a été mis à jour.",setLong:"{0} a été mis à jour à {1}.",setContainer:"merci de choisir un div qui utilise .container()"},error:{accepted:"{0} n'est pas correct {1} pour {2} visualisations, merci d'utilisez une des options suivantes: {3}.",connections:"Pas de connections disponibles pour {0}.",data:"Pas de données disponibles",dataYear:"Pas de données disponibles pour {0}.",lib:"La visualisation de {0} nécessite le chargement de la librairie {1}.",libs:"La visualisation de {0} nécessite le chargement des librairies {1}.",method:"La visualisation du {0} exige la définition de {1}.",methods:"La visualisation du {0} exige les définitions de {1}."},lowercase:["un","une","de","des","et","mais","les","ou","pour","avec","comme","par","vers","si","dans","près","ni","dessus","que","le","la","via","sinon","alors"],method:{active:"segments actifs",color:"couleur",depth:"profondeur",dev:"verbeux",focus:"focus",icon:"ícone",id:"id",height:"hauteur",labels:"labels",legend:"légende",margin:"marge",messages:"messages",mute:"cacher",order:"ordre",search:"recherche",shape:"format",size:"taille",solo:"isoler",style:"style",temp:"segments temporaires",text:"texte",time:"temps",timeline:"ligne temporelle",total:"segments totaux",type:"type",width:"largeur",x:"axe x",y:"axe y",zoom:"zoom",mode:"mode"},time:["année","date","jour","heure","mois"],visualization:{bubbles:"Bulles",chart:"Graphique",geo_map:"Carte",line:"Courbes",network:"Réseau",rings:"Anneaux",scatter:"Nuage de points",stacked:"Aires empilées",tree_map:"Arbre",bar:"Diagramme en barres",box:"Boîtes à Moustaches",paths:"Chemins",pie:"Camembert",table:"Table"},ui:{and:"et",back:"retour",collapse:"clic pour réduire",error:"erreur",expand:"clic pour agrandir",loading:"chargement ...",more:"plus {0}",moreInfo:"clic pour plus d'information",noResults:"pas de résultat correspondant à {0}.",primary:"connections primaires",share:"part",total:"total",values:"valeurs",including:"incluant",or:"ou"},message:{data:"analyse des données",draw:"tracé en cours",initializing:"Initialisation {0}",loading:"chargement",tooltipReset:"réinitialisation des bulles",ui:"rafraichissement de l'interface"},uppercase:["CEO","US$","kg","CEOs","CFO","CFOs","CNC","COO","COOs","CPU","CPUs","PIB","HVAC","ID","IT","TV","UI"]}},{}],73:[function(a,b,c){b.exports={format:{decimal:",",thousands:".",grouping:[3],currency:[""," ден."],dateTime:"%A, %e %B %Y г. %X",date:"%d.%m.%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["недела","понеделник","вторник","среда","четврток","петок","сабота"],shortDays:["нед","пон","вто","сре","чет","пет","саб"],months:["јануари","февруари","март","април","мај","јуни","јули","август","септември","октомври","ноември","декември"],shortMonths:["јан","фев","мар","апр","мај","јун","јул","авг","сеп","окт","ное","дек"]},dev:{accepted:"{0} не е прифатенa вредноста за {1}, ве молиме користете еднa од следниве вредности: {2}.",deprecated:"{0} метод е отстранета, ве молиме обновете го вашиот код за да се користи {1}.",noChange:"{0} не е ажурирана, бидејќи немаше промени.",noContainer:"не можe да се најде контејнер на страницата кој се совпаѓа со {0}.",of:"на",oldStyle:"својствата за стилот за {0} сега се вградени директно во. {1} ().",sameEdge:"рабовите не може да имаат алка самите кон себе. автоматски ги отстранувам рабовите кои се само-референцираат {0}.",set:"{0} е наместен.",setLong:"{0} е поставен на {1}.",setContainer:"Ве молиме дефинирајте контејнер div користејќи .container()"},error:{accepted:"{0} не е прифатлива за {1} {2} визуелизација, ве молиме користете една од следниве: {3}.",connections:"не е достапна за врски {0}.",data:"нема податоци",dataYear:"Нема достапни податоци за {0}.",lib:"{0} визуализации бараат вчитување на библиотеката {1} .",libs:"{0} визуализации бараат вчитување следниве библиотеки: {1}.",method:"{0} визуализации бара поставување на {1} методот.",methods:"{0} визуализации бараат поставување на следниве методи: {1}."},lowercase:["a","и","во","но","на","или","да","се","со"],method:{active:"активни сегменти",color:"боја",depth:"длабочина",dev:"опширно",focus:"фокус",icon:"икона",id:"id",height:"висина",labels:"етикети",legend:"легенда",margin:"маргина",messages:"пораки за статусот",mute:"скрие",order:"цел",search:"барај",shape:"форма",size:"големина",solo:"изолирање",style:"стил",temp:"привремени сегменти",text:"текст",time:"време",timeline:"времеплов",total:"Вкупно сегменти",type:"тип",width:"ширина",x:"x оската",y:"оската y",zoom:"зум",mode:"режим"},time:["датум","ден","месец","време","година"],visualization:{bubbles:"Меурчиња",chart:"Шема",geo_map:"Гео мапа",line:"Линиски график",network:"Мрежа",rings:"Прстени",scatter:"Распрскан график",stacked:"Наредена површина",tree_map:"Мапа во вид на дрво",bar:"Бар табела",box:"Кутија Парцел",paths:"Патеки",pie:"Пита графикон",table:"Табела"},ui:{and:"и",back:"назад",collapse:"кликни за да се собере",error:"грешка",expand:"кликни за да се прошири",loading:"Се вчитува ...",more:"{0} повеќе",moreInfo:"кликнете за повеќе информации",noResults:"Не се пронајдени појавување на {0}.",primary:"основно врски",share:"удел",total:"Вкупниот",values:"вредности",including:"Вклучувајќи",or:"или"},message:{data:"анализа на податоци",draw:"цртање на визуелизација",initializing:"иницијализација {0}",loading:"податоци за вчитување",tooltipReset:"ресетирање на објаснувањата",ui:"ажурирање на кориничкиот интерфејс"},uppercase:["CEO","US$","kg","CEOs","CFO","CFOs","CNC","COO","COOs","CPU","CPUs","GDP","HVAC","ID","IT","R&D","TV","UI"]}},{}],74:[function(a,b,c){b.exports={format:{decimal:",",thousands:".",grouping:[3],currency:["R$",""],dateTime:"%A, %e de %B de %Y. %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"],shortDays:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"],months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],shortMonths:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"]},dev:{accepted:"{0} não é um valor válido para {1}, por favor use um dos seguintes procedimentos: {2}.",deprecated:"{0} método foi removido, por favor atualize seu código para utilizar {1}.",noChange:"{0} não foi atualizado porque ele não mudou.",noContainer:"Não foi possível encontrar um local na página correspondente a {0}.",of:"de",oldStyle:"propriedades de estilo para {0} já foi incorporado diretamente no. {1} ().",sameEdge:"bordas não podem vincular a si mesmos. removendo automaticamente borda de auto-referência {0}.",set:"{0} foi definido.",setLong:"{0} foi definida para {1}.",setContainer:"por favor, defina um div utilizando .container()"},error:{accepted:"{0} não é um {1} reconhecido para visualizações {2}, favor usar um dos seguintes procedimentos: {3}.",connections:"Não há conexões disponíveis para {0}.",data:"Não há dados disponíveis",dataYear:"Não há dados disponíveis para {0}.",lib:"A visualização {0} necessita que seja carregado a biblioteca {1}.",libs:"A visualização {0} necessita que seja carregado as bibliotecas {1}.",method:"A visualização {0} exige a definição do método {1}.",methods:"A visualização {0} exige a definição dos métodos {1}."},lowercase:["um","uma","e","como","em","no","na","mas","por","para","pelo","pela","de","do","da","se","perto","nem","ou","que","o","a","com","v"],method:{active:"segmentos activos",color:"cor",depth:"profundidade",dev:"verboso",focus:"foco",icon:"ícone",id:"identificador",height:"altura",labels:"etiquetas",legend:"legenda",margin:"margem",messages:"mensagens de status",mute:"ocultar",order:"ordenar",search:"pesquisar",shape:"forma",size:"tamanho",solo:"isolar",style:"estilo",temp:"segmentos temporários",text:"texto",time:"tempo",timeline:"linha do tempo",total:"segmentos no total",type:"tipo",width:"largura",x:"eixo x",y:"eixo y",zoom:"zoom",mode:"modo"},time:["data","dia","mês","hora","ano"],visualization:{bubbles:"Bolhas",chart:"Gráfico",geo_map:"Mapa",line:"Gráfico de Linha",network:"Rede",rings:"Anéis",scatter:"Dispersão",stacked:"Evolução",tree_map:"Tree Map",bar:"Gráfico de Barras",box:"Box Plot",paths:"Caminhos",pie:"Pie Chart",table:"Tabela"},ui:{and:"e",back:"voltar",collapse:"Clique para fechar",error:"erro",expand:"clique para expandir",loading:"carregando ...",more:"mais {0}",moreInfo:"Clique para mais informações",noResults:"nenhum resultado para {0}.",primary:"conexões primárias",share:"participação",total:"total",values:"valores",including:"Incluindo",or:"ou"},message:{data:"analisando dados",draw:"desenhando visualização",initializing:"inicializando {0}",loading:"carregando dados",tooltipReset:"redefinindo as dicas",ui:"atualizando interface"},uppercase:["CEO","US$","kg","CEOs","CFO","CFOs","CNC","COO","COOs","CPU","CPUs","PIB","HVAC","ID","TI","P&D","TV","IU"]}},{}],75:[function(a,b,c){
b.exports={format:{decimal:",",thousands:".",grouping:[3],currency:["€",""],dateTime:"%A, %e de %B de %Y. %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"],shortDays:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"],months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],shortMonths:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"]},dev:{accepted:"{0} não é um valor válido para {1}, por favor escolha uma das seguintes opções: {2}.",deprecated:"o método {0} foi removido, por favor atualize o seu código para usar {1}.",noChange:"{0} não foi atualizado porque não houve modificações.",noContainer:"Não foi possível encontrar um elemento na página correspondente a {0}.",of:"de",oldStyle:"as propriedades de {0} já foram incluídas em .{1}().",sameEdge:"bordas não podem vincular a si mesmos. removendo automaticamente borda de auto-referência {0}.",set:"{0} foi definido.",setLong:"{0} foi alterado para {1}.",setContainer:"por favor indique um elemento div através do método .container()"},error:{accepted:"{0} não é uma {1} válida para a visualização {2}, por favor escolha uma das seguintes: {3}.",connections:"não existem ligações disponíveis para {0}.",data:"não existem dados disponíveis",dataYear:"não existem dados disponíveis para {0}.",lib:"a visualização {0} necessita que a biblioteca {1} seja carregada.",libs:"a visualização {0} necessita que as seguintes bibliotecas sejam carregadas: {1}.",method:"A visualização {0} exige a definição do método {1}.",methods:"A visualização {0} exige a definição dos seguintes métodos {1}."},lowercase:["um","uma","e","como","em","no","na","mas","por","para","pelo","pela","de","do","da","se","perto","nem","ou","que","o","a","com","v"],method:{active:"segmentos activos",color:"cor",depth:"profundidade",dev:"verboso",focus:"foco",icon:"ícone",id:"identificador",height:"altura",labels:"etiquetas",legend:"legenda",margin:"margem",messages:"estado",order:"ordenar",search:"pesquisar",shape:"forma",size:"tamanho",style:"estilo",temp:"segmentos temporários",text:"texto",time:"tempo",timeline:"linha temporal",total:"segmentos no total",type:"tipo",width:"largura",x:"eixo x",y:"eixo y",zoom:"zoom",mode:"#ERROR!",mute:"ocultar",solo:"isolar"},time:["data","dia","mês","hora","ano"],visualization:{bubbles:"Bolhas",chart:"Diagrama",geo_map:"Mapa",line:"Gráfico de Linha",network:"Grafo",rings:"Anéis",scatter:"Gráfico de Dispersão",stacked:"Gráfico de Área",tree_map:"Tree Map",bar:"Gráfico de Barras",box:"Diagrama de Caixa e Bigodes",paths:"Caminhos",pie:"Gráfico de Setores",table:"Tabela"},ui:{and:"e",back:"voltar",collapse:"Clique para colapsar",error:"erro",expand:"clique para expandir",loading:"a carregar ...",more:"mais {0}",moreInfo:"Clique para mais informações",noResults:"nenhum resultado para {0}.",primary:"ligações principais",share:"proporção",total:"total",values:"valores",including:"Incluindo",or:"ou"},message:{data:"a analisar os dados",draw:"a desenhar a visualização",initializing:"a inicializar {0}",loading:"a carregar os dados",tooltipReset:"a actualizar as caixas de informação",ui:"a actualizar o interface"},uppercase:["CEO","US$","kg","CEOs","CFO","CFOs","CNC","COO","COOs","CPU","CPUs","PIB","HVAC","ID","TI","I&D","TV","IU"]}},{}],76:[function(a,b,c){b.exports={format:{decimal:",",thousands:" ",grouping:[3],currency:[""," руб."],dateTime:"%A, %e %B %Y г. %X",date:"%d.%m.%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"],shortDays:["вс","пн","вт","ср","чт","пт","сб"],months:["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],shortMonths:["янв","фев","мар","апр","май","июн","июл","авг","сен","окт","ноя","дек"]},dev:{accepted:"{0} не принимаются значение {1}, пожалуйста, используйте один из следующих: {2}.",deprecated:"Метод {0} был удален, пожалуйста, обновите ваш код, чтобы использовать {1}.",noChange:"{0} не обновлен, поскольку он не изменится.",noContainer:"не могу найти контейнер на странице соответствия {0}.",of:"из",oldStyle:"свойства стиля для {0} уже в настоящее время были встроен непосредственно в. {1} ().",sameEdge:"Края не может связать себя. автоматически удаляя автореферентных ребро {0}.",set:"{0} был установлен.",setLong:"{0} установлено значение {1}.",setContainer:"пожалуйста, определить контейнер DIV с помощью .container ()"},error:{accepted:"{0} не принимаются {1} для {2} визуализации, пожалуйста, используйте один из следующих: {3}.",connections:"нет соединения, доступные для {0}.",data:"данные недоступны",dataYear:"нет данных {0}.",lib:"{0} визуализации требуют загрузки {1} библиотеку.",libs:"{0} визуализации требуют загрузки следующих библиотек: {1}.",method:"{0} визуализации требуют установки {1} метода.",methods:"{0} визуализации требуют установки следующих методов: {1}."},lowercase:["и","как","в","но","для","из","если в","в","недалеко","ни","на","на","или","в","что","к","с","с помощью","против","против"],method:{active:"активные сегменты",color:"цвет",depth:"глубина",dev:"многословный",focus:"фокус",icon:"значок",id:"ID",height:"высота",labels:"надписи",legend:"легенда",margin:"поле",messages:"Сообщения о состоянии",mute:"скрывать",order:"порядок",search:"поиск",shape:"форма",size:"размер",solo:"изолировать",style:"стиль",temp:"временные сегменты",text:"текст",time:"время",timeline:"график",total:"всего сегментов",type:"тип",width:"ширина",x:"ось х",y:"Ось Y",zoom:"масштаб",mode:"режим"},time:["дата","день","месяц","время","год"],visualization:{bubbles:"Пузыри",chart:"График",geo_map:"Гео Карта",line:"Линия земля",network:"Сеть",rings:"Кольца",scatter:"Разброс земля",stacked:"С накоплением Площадь",tree_map:"Дерево Карта",bar:"Гистограмма",box:"Коробка земля",paths:"Пути",pie:"Круговая диаграмма",table:"Стол"},ui:{and:"и",back:"назад",collapse:"Щелкните, чтобы свернуть",error:"ошибка",expand:"щелкните, чтобы развернуть",loading:"загрузка ...",more:"{0} более",moreInfo:"нажмите для получения более подробной информации",noResults:"нет результатов, соответствующих {0}.",primary:"первичные соединения",share:"доля",total:"общее",values:"значения",including:"включая",or:"или"},message:{data:"Анализируя данные",draw:"рисунок визуализация",initializing:"инициализации {0}",loading:"загрузка данных",tooltipReset:"сброс подсказки",ui:"обновление пользовательского интерфейса"},uppercase:["ID"]}},{}],77:[function(a,b,c){b.exports={format:{decimal:".",thousands:",",grouping:[3],currency:["¥",""],dateTime:"%A %B %e %Y %X",date:"%Y/%-m/%-d",time:"%H:%M:%S",periods:["上午","下午"],days:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],shortDays:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],shortMonths:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},dev:{accepted:"{0}不是{1}的可接受值, 请用下列之一的值:{2}",deprecated:"{0}的方法已被移除, 请更新您的代码去使用{1}",noChange:"{0}没有更新, 因为它并没有改变。",noContainer:"无法在该页找到容器去匹配{0}",of:"的",oldStyle:"样式属性{0}现在已经直接嵌入到。{1}（）。",sameEdge:"边缘不能链接到自己。自动去除自我参照边缘{0}。",set:"{0}已经被设置。",setLong:"{0}被设置为{1}。",setContainer:"请使用()容器来定义div容器"},error:{accepted:"{0}对于{2}的可视化效果并不是一个可接受的{1}, 请使用如下的一个：{3}.",connections:"没有对{0}可用的连接。",data:"无可用数据",dataYear:"没有数据对{0}可用。",lib:"{0}的可视化要求装载{1}库。",libs:"{0}的可视化需要加载以下库：{1}。",method:"{0}的可视化要求设置{1}方法。",methods:"{0}的可视化要求设置以下方法：{1}。"},lowercase:["一个","和","在","但是","在...里","的","或者","这","向","与...一起"],method:{active:"活跃段",color:"颜色",depth:"深度",dev:"详细",focus:"焦点",icon:"图标",id:"身份认证",height:"高度",labels:"标签",legend:"图例注释",margin:"外边距",messages:"状态消息",mute:"隐藏",order:"规则",search:"搜索",shape:"形状",size:"大小",solo:"隔离",style:"样式",temp:"暂时性区段",text:"文本",time:"时间",timeline:"时间轴",total:"总段",type:"类型",width:"宽度",x:"X轴",y:"Y轴",zoom:"缩放",mode:"模式"},time:["日","星期","月","时间","年"],visualization:{bubbles:"气泡",chart:"图表",geo_map:"地理地图",line:"线图",network:"网络",rings:"特性",scatter:"散点图",stacked:"堆积面积图",tree_map:"树图",bar:"条图",box:"箱线图",paths:"路径",pie:"饼图",table:"表"},ui:{and:"和",back:"后面",collapse:"点击合并",error:"错误",expand:"单击以展开",loading:"载入中...",more:"{0}更多",moreInfo:"点击了解更多信息",noResults:"没有结果匹配{0}。",primary:"主要连接",share:"共享",total:"总",values:"值",including:"包括",or:"或"},message:{data:"分析数据",draw:"绘制可视化",initializing:"初始化{0}",loading:"加载数据",tooltipReset:"重置工具提示",ui:"更新UI"},uppercase:["CEO","US$","kg","CEOs","CFO","CFOs","CNC","COO","COOs","CPU","CPUs","GDP","HVAC","ID","电视","用户界面","研发"]}},{}],78:[function(a,b,c){b.exports={en_US:a("./languages/en_US.coffee"),es_ES:a("./languages/es_ES.js"),fr_FR:a("./languages/fr_FR.js"),mk_MK:a("./languages/mk_MK.js"),pt_BR:a("./languages/pt_BR.js"),pt_PT:a("./languages/pt_PT.js"),ru_RU:a("./languages/ru_RU.js"),zh_CN:a("./languages/zh_CN.js")}},{"./languages/en_US.coffee":70,"./languages/es_ES.js":71,"./languages/fr_FR.js":72,"./languages/mk_MK.js":73,"./languages/pt_BR.js":74,"./languages/pt_PT.js":75,"./languages/ru_RU.js":76,"./languages/zh_CN.js":77}],79:[function(a,b,c){var d,e,f,g,h,i,j,k,l;e=a("../../util/copy.coffee"),h=a("../console/print.coffee"),i=a("./process/detect.coffee"),j=a("./set.coffee"),k=a("../../string/format.js"),l=a("../../object/validate.coffee"),b.exports=function(a,b){var c,d,h;h=[];for(c in b)d=b[c],a[c]=e(d),a[c].initialized=g(a,a[c],c),h.push(a.self[c]=f(a,c));return h},g=function(a,b,c){var d,e,f,j,m;b.previous=!1,b.changed=!1,b.initialized=!1,"init"in b&&!("value"in b)&&(b.value=b.init(a),delete b.init),"process"in b&&(b.value=i(a,b,b.value));for(m in b)if("deprecates"===m)for(e=b[m]instanceof Array?b[m]:[b[m]],f=0,j=e.length;f<j;f++)d=e[f],a.self[d]=function(b,c){return function(d){var e;return e=a.format.locale.value.dev.deprecated,b="."+b+"()",h.error(k(e,b,"."+c+"()"),c),a.self}}(d,c);else"global"===m?c in a||(a[c]=[]):"value"!==m&&l(b[m])&&g(a,b[m],m);return!0},f=function(a,b){return function(c,e){var f,g,i,j,m,n,o,p;if(f="accepted"in a[b]?a[b].accepted:null,"function"==typeof f&&(f=f(a)),f instanceof Array||(f=[f]),c===Object)return a[b];if(!arguments.length&&f.indexOf(void 0)<0)return"value"in a[b]?a[b].value:a[b];if("style"===b&&"object"==typeof c){p=a.format.locale.value.dev.oldStyle;for(n in c)h.warning(k(p,'"'+n+'"',n),n),a.self[n](c[n])}if("font"===b){"string"==typeof c&&(c={family:c}),o=!0,i=function(a,b,c,d){l(a[c])&&b in a[c]&&(l(a[c][b])?a[c][b].process?a[c][b].value=a[c][b].process(d):a[c][b].value=d:a[c][b]=d)},g=function(a,b,c){var d;if(l(a)){if(o)for(d in a)i(a,b,d,c);else"font"in a&&i(a,b,"font",c);o=!1;for(d in a)g(a[d],b,c)}};for(j in c)m=c[j],"secondary"!==j&&(l(m)&&(m=m.value),m&&g(a,j,m))}return d(a,b,a,b,c),"function"==typeof e&&(a[b].callback=e),a[b].chainable===!1?a[b].value:a.self}},d=function(a,b,c,e,f){var g,h,i,k;if(["accepted","changed","initialized","previous","process"].indexOf(e)<0)if(k=l(f),i=l(c[e])&&"objectAccess"in c[e]&&c[e].objectAccess===!1,g=k&&(i||!("value"in f)&&!(d3.keys(f)[0]in c[e])),null===f||!k||g)j(a,b,c,e,f);else if(k)for(h in f)d(a,b,c[e],h,f[h])}},{"../../object/validate.coffee":171,"../../string/format.js":172,"../../util/copy.coffee":206,"../console/print.coffee":53,"./process/detect.coffee":87,"./set.coffee":93}],80:[function(a,b,c){b.exports=function(a){return a||(a=!1),{accepted:[!1,Array,Function,Number,Object,String],callback:{accepted:[!1,Function],value:!1},global:a,process:Array,value:[]}}},{}],81:[function(a,b,c){var d;d=a("../../../client/rtl.coffee"),b.exports=function(a){var b;return b=["left","center","right"],a===!1&&b.unshift(!1),b.indexOf(a)<0&&(a="left"),{accepted:b,process:function(a){return d?"left"===a?"right":"right"===a?"left":a:a},value:a}}},{"../../../client/rtl.coffee":42}],82:[function(a,b,c){b.exports=function(a){var b;return b=["line-through","none","overline","underline"],a===!1&&b.unshift(!1),b.indexOf(a)<0&&(a="none"),{accepted:b,value:a}}},{}],83:[function(a,b,c){var d,e;e=a("../../../font/validate.coffee"),d=["Helvetica Neue","HelveticaNeue","Helvetica","Arial","sans-serif"],b.exports=function(a){return void 0===a&&(a=d),{process:e,value:a}}},{"../../../font/validate.coffee":102}],84:[function(a,b,c){b.exports=function(a){var b;return b=["top","middle","bottom"],a===!1&&b.unshift(!1),b.indexOf(a)<0&&(a="bottom"),{accepted:b,mapping:{top:"0ex",middle:"0.5ex",bottom:"1ex"},process:function(a){return this.text=a,this.mapping[a]},value:a}}},{}],85:[function(a,b,c){b.exports=function(a){var b;return b=["capitalize","lowercase","none","uppercase"],a===!1&&b.unshift(!1),b.indexOf(a)<0&&(a="none"),{accepted:b,value:a}}},{}],86:[function(a,b,c){b.exports=function(a,b,c){var d;return b.history&&b.history.reset(),a.constructor===String?a.indexOf("/")>=0?(c.url=a,[]):(d=d3.selectAll(a),d.size()?d:(a.indexOf(".")>=0&&(c.url=a),[])):a}},{}],87:[function(a,b,c){var d,e;d=a("../../../util/copy.coffee"),e=a("../../../array/update.coffee"),b.exports=function(a,b,c){return b.process===Array?e(d(b.value),c):"object"==typeof b.process&&"string"==typeof c?b.process[c]:"function"==typeof b.process?b.process(c,a,b):c}},{"../../../array/update.coffee":37,"../../../util/copy.coffee":206}],88:[function(a,b,c){var d;d=a("../../../client/css.coffee"),b.exports=function(a,b,c){return a===!1||a.indexOf("fa-")<0||0===a.indexOf("fa-")&&d("font-awesome")?a:c.fallback}},{"../../../client/css.coffee":38}],89:[function(a,b,c){b.exports=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o;if("string"==typeof a){for(a=a.split(" "),c=d=0,g=a.length;d<g;c=++d)o=a[c],a[c]=parseFloat(o,10);a=1===a.length?a[0]:2===a.length?{top:a[0],right:a[1],bottom:a[0],left:a[1]}:3===a.length?{top:a[0],right:a[1],bottom:a[2],left:a[1]}:4===a.length?{top:a[0],right:a[1],bottom:a[2],left:a[3]}:0}if(n=["top","right","bottom","left"],"number"==typeof a)for(e=0,h=n.length;e<h;e++)m=n[e],b[m]=a;else for(f=0,i=n.length;f<i;f++)m=n[f],b[m]=a[m];for(b.css="",l=[],c=k=0,j=n.length;k<j;c=++k)m=n[c],c&&(b.css+=" "),l.push(b.css+=b[m]+"px");return l}},{}],90:[function(a,b,c){var d,e,f,g;d=a("../../array/contains.coffee"),e=a("../../string/format.js"),f=a("../../string/list.coffee"),g=a("../console/print.coffee"),b.exports=function(a,b,c,h,i){var j,k,l,m,n,o,p,q;if("function"==typeof b&&(b=b(a)),b instanceof Array||(b=[b]),k=d(b,c),k===!1&&void 0!==c){for(o=[],q=JSON.stringify(c),"string"!=typeof c&&(q='"'+q+'"'),m=0,n=b.length;m<n;m++)j=b[m],"string"==typeof j?o.push('"'+j+'"'):"function"==typeof j?o.push(j.toString().split("()")[0].substring(9)):void 0===j?o.push("undefined"):o.push(JSON.stringify(j));o=f(o,a.format.locale.value.ui.or),a.type&&["mode","shape"].indexOf(h)>=0?(p=a.format.locale.value.error.accepted,l=a.format.locale.value.visualization[a.type.value]||a.type.value,g.warning(e(p,q,h,l,o),h)):(p=a.format.locale.value.dev.accepted,g.warning(e(p,q,i,o),h))}return!k}},{"../../array/contains.coffee":35,"../../string/format.js":172,"../../string/list.coffee":173,"../console/print.coffee":53}],91:[function(a,b,c){b.exports=function(a){var b;return b=["auto","optimizeSpeed","crispEdges","geometricPrecision"],b.indexOf(a)>=0||(a="crispEdges"),{accepted:b,value:a}}},{}],92:[function(a,b,c){var d,e;e=a("../../object/validate.coffee"),d=function(a,b){var c;a.changed&&(a.changed=!1),"draw"===b&&(a.frozen=!1,a.update=!0,a.first=!1);for(c in a)c.indexOf("d3plus")<0&&e(a[c])&&d(a[c],c)},b.exports=d},{"../../object/validate.coffee":171}],93:[function(a,b,c){var d,e,f,g,h,i,j,k,l;d=a("../../util/copy.coffee"),e=a("../../util/d3selection.coffee"),l=a("../../object/validate.coffee"),f=a("../../object/merge.coffee"),g=a("../console/print.coffee"),h=a("./process/detect.coffee"),i=a("./rejected.coffee"),j=a("../../string/format.js"),k=a("../../array/update.coffee"),b.exports=function(a,b,c,m,n){var o,p,q,r,s,t,u,v,w,x,y,z,A,B;if(z="value"!==m&&m&&m!==b?'"'+m+'" '+a.format.locale.value.dev.of+" ."+b+"()":"."+b+"()",o="value"===m&&"accepted"in c?c.accepted:l(c[m])&&"accepted"in c[m]?c[m].accepted:[n],!i(a,o,n,b,z)){if(l(c[m])&&"value"in c[m]&&(x=m,c=c[m],m="value"),"value"===m&&"process"in c&&(n=h(a,c,n)),c[m]instanceof Array||c[m]!==n||void 0===n){if(c.changed=!0,c.loaded&&(c.loaded=!1),"history"in a&&"draw"!==b&&(p=d(c),p.method=b,a.history.chain.push(p)),c.previous=c[m],"id"in a&&"value"===m&&"nesting"in c)if("id"!==b){if("object"!=typeof c.nesting&&(c.nesting={}),l(n)){for(t in n)"string"==typeof n[t]&&(n[t]=[n[t]]);c.nesting=f(c.nesting,n),a.id.value in c.nesting||(c.nesting[a.id.value]=n[d3.keys(n)[0]])}else n instanceof Array?c.nesting[a.id.value]=n:c.nesting[a.id.value]=[n];c[m]=c.nesting[a.id.value][0]}else n instanceof Array?(c.nesting=n,"depth"in a&&a.depth.value<n.length?c[m]=n[a.depth.value]:(c[m]=n[0],"depth"in a&&(a.depth.value=0))):(c[m]=n,c.nesting=[n],"depth"in a&&(a.depth.value=0));else"depth"===b?(n>=a.id.nesting.length?a.depth.value=a.id.nesting.length-1:n<0?a.depth.value=0:a.depth.value=n,a.id.value=a.id.nesting[a.depth.value],"object"==typeof a.text.nesting&&(w=a.text.nesting[a.id.value],w&&(a.text.nesting[a.id.value]="string"==typeof w?[w]:w,a.text.value=w instanceof Array?w[0]:w))):l(c[m])&&l(n)?c[m]=f(c[m],n):c[m]=n;"value"===m&&c.global&&(s=c[m].length>0,u=x||m,u in a&&(s&&a.data[u].indexOf(b)<0||!s&&a.data[u].indexOf(b)>=0)&&(a.data[u]=k(a.data[u],b))),"value"===m&&c.dataFilter&&a.data&&a.data.filters.indexOf(b)<0&&a.data.filters.push(b),a.dev.value&&c.changed&&void 0!==c[m]&&(v=c[m]instanceof Array&&c[m].length>10,r=e(c[m]),A="function"==typeof c[m],B=v||r||A?null:"string"==typeof c[m]?c[m]:JSON.stringify(c[m]),null!==B&&B.length<260?(y=a.format.locale.value.dev.setLong,g.log(j(y,z,'"'+B+'"'))):(y=a.format.locale.value.dev.set,g.log(j(y,z))))}else y=a.format.locale.value.dev.noChange,a.dev.value&&g.comment(j(y,z));"value"===m&&c.callback&&!c.url&&(q="function"==typeof c.callback?c.callback:c.callback.value,q&&q(n,a.self))}}},{"../../array/update.coffee":37,"../../object/merge.coffee":170,"../../object/validate.coffee":171,"../../string/format.js":172,"../../util/copy.coffee":206,"../../util/d3selection.coffee":207,"../console/print.coffee":53,"./process/detect.coffee":87,"./rejected.coffee":90}],94:[function(a,b,c){var d=a("../console/print.coffee"),e=a("../../string/format.js");b.exports=function(a){if(a.dev.value){var b="analyzing edges list";d.time(b)}var c=a.types[a.type.value].requirements;c instanceof Array||(c=[c]);var f=c.indexOf("nodes")>=0&&!a.nodes.value;if(f){a.nodes.value=[];var g=[];a.nodes.changed=!0}a.edges.value.forEach(function(b){["source","target"].forEach(function(c){var d=typeof b[a.edges[c]];if("object"!==d)if("number"!==d||f)if(f&&g.indexOf(b[a.edges[c]])>=0)b[a.edges[c]]=a.nodes.value.filter(function(d){return d[a.id.value]===b[a.edges[c]]})[0];else{var e={};e[a.id.value]=b[a.edges[c]],b[a.edges[c]]=e}else b[a.edges[c]]=a.nodes.value[b[a.edges[c]]];var h=b[a.edges[c]];f&&g.indexOf(h[a.id.value])<0&&(g.push(h[a.id.value]),a.nodes.value.push(h))}),"keys"in a.data||(a.data.keys={}),a.id.value in a.data.keys||(a.data.keys[a.id.value]=typeof b[a.edges.source][a.id.value])}),a.edges.value=a.edges.value.filter(function(b){var c=b[a.edges.source][a.id.value],f=b[a.edges.target][a.id.value];if(c===f){var g=a.format.locale.value.dev.sameEdge;return d.warning(e(g,'"'+c+'"'),"edges"),!1}return!0}),a.edges.linked=!0,a.dev.value&&d.timeEnd(b)}},{"../../string/format.js":172,"../console/print.coffee":53}],95:[function(a,b,c){var d=a("./hideElement.js");b.exports=function(a){function c(a,c){[].forEach.call(c.attributes,function(b){if(/^data-/.test(b.name)){var c=b.name.substr(5).replace(/-(.)/g,function(a,b){return b.toUpperCase()});a[c]=b.value}}),b.forEach(function(b){null!==c.getAttribute(b)&&(a[b]=c.getAttribute(b))})}var b=[a.color.value,a.icon.value,a.keywords.value,a.alt.value,"style"];a.text.value||a.self.text("text"),b=b.concat(a.id.nesting),a.self.data({element:a.data.value});var e=a.data.element.value.node().tagName.toLowerCase(),f=a.data.element.value.attr("type"),g=[];if("select"===e){var h=a.data.element.value.node().id;h&&a.self.container({id:h}),a.data.element.value.selectAll("option").each(function(b,d){var e={};if(e.text=this.innerHTML,c(e,this),g.push(e),this.selected)for(var d=a.id.nesting.length-1;d>=0;d--){var f=a.id.nesting[d];if(f in e){a.self.focus(e[f]);break}}})}else if("input"===e&&"radio"===f){var i=a.data.element.value.node().getAttribute("name");i&&a.self.container({id:i}),a.data.element.value.each(function(b,e){var f={};c(f,this);var h=f[a.id.value]||this.id||!1;if(h&&isNaN(parseFloat(h))){var i=d3.select("label[for="+h+"]");i.empty()||(f.text=i.html(),i.call(d))}g.push(f),this.checked&&a.self.focus(f[a.id.value])})}!a.focus.value.length&&g.length&&(a.data.element.value.node().selectedIndex=0,a.self.focus(g[0][a.id.value]));var j=d3.select("legend[for="+a.container.id+"]");j.empty()||(a.self.title(j.html()),j.call(d));var k=!!a.container.value&&a.container.value.node().tagName.toLowerCase();return a.container.value!==!1&&"body"!==k||(a.container.value=d3.select(a.data.element.value.node().parentNode)),a.data.element.value.call(d),g}},{"./hideElement.js":96}],96:[function(a,b,c){b.exports=function(a){a.style("position","absolute","important").style("clip","rect(1px 1px 1px 1px)","important").style("clip","rect(1px, 1px, 1px, 1px)","important").style("width","1px","important").style("height","1px","important").style("margin","-1px","important").style("padding","0","important").style("border","0","important").style("overflow","hidden","important")}},{}],97:[function(a,b,c){var d=a("../console/print.coffee");b.exports=function(a){if(a.dev.value){var b="analyzing node positions";d.time(b)}var c=a.nodes.value.filter(function(a){return"number"==typeof a.x&&"number"==typeof a.y}).length;if(c===a.nodes.value.length)a.nodes.positions=!0;else{var e=d3.layout.force().size([a.width.viz,a.height.viz]).nodes(a.nodes.value).links(a.edges.value),f=a.edges.strength.value;f&&("string"==typeof f?e.linkStrength(function(a){return a[f]}):e.linkStrength(f));var g=50,h=.01;e.start();for(var i=g;i>0&&(e.tick(),!(e.alpha()<h));--i);e.stop(),a.nodes.positions=!0}a.dev.value&&d.timeEnd(b)}},{"../console/print.coffee":53}],98:[function(a,b,c){var d;d=a("numeric"),b.exports=function(a,b){var c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B;for(null==b&&(b={}),null==b.maxDegree&&(b.maxDegree=5),c=a.length,t=Number.MAX_VALUE,h=null,f=function(){var c,d,e;for(e=[],k=c=1,d=b.maxDegree+1;1<=d?c<d:c>d;k=1<=d?++c:--c)e.push(function(){var b,c,d;for(d=[],c=0,b=a.length;c<b;c++)s=a[c],d.push(Math.pow(s[0],k));return d}());return e}(),A=function(){var b,c,d;for(d=[],b=0,c=a.length;b<c;b++)s=a[b],d.push(s[1]);return d}(),m=p=0,v=1<<b.maxDegree;0<=v?p<v:p>v;m=0<=v?++p:--p){for(g=[function(){var a,b,d;for(d=[],u=a=0,b=c;0<=b?a<b:a>b;u=0<=b?++a:--a)d.push(1);return d}()],l=[0],n=r=0,w=b.maxDegree;0<=w?r<w:r>w;n=0<=w?++r:--r)(m&1<<n)>0&&(g.push(f[n]),l.push(n+1));e=d.transpose(g),o=l.length,i=d.dot(d.dot(d.inv(d.dot(g,e)),g),A),B=d.dot(e,i),x=d.sub(A,B),z=d.dot(x,x),y=z/(c-o),q=-.5*c*Math.log(2*Math.PI)-.5*c*Math.log(y)-z/(2*y),j=-2*q+o*(Math.log(c)-Math.log(2*Math.PI)),j<t&&(t=j,h=[l,i,B])}return h}},{numeric:7}],99:[function(a,b,c){var d;d=a("static-kdtree"),b.exports=function(a,b){var c,e,f,g,h,i,j,k,l,m,n,o;return null==b&&(b=10),o=d(a),j=function(){var c,d,e;for(e=[],c=0,d=a.length;c<d;c++)k=a[c],e.push(o.knn(k,b+1).slice(1));return e}(),n=function(b,c){var d,e,f,g,h,i;for(d=a[b],e=a[c],g=0,b=h=0,i=d.length;0<=i?h<i:h>i;b=0<=i?++h:--h)f=d[b]-e[b],g+=f*f;return g},g=function(){var c,d,f;for(f=[],e=c=0,d=a.length;0<=d?c<d:c>d;e=0<=d?++c:--c)f.push(n(e,j[e][b-1]));return f}(),l=function(a,b){return Math.max(n(a,b),g[b])},h=function(a){var c,d,e,f,g;for(f=0,g=j[a],d=0,e=g.length;d<e;d++)c=g[d],f+=l(a,c);return b/f},i=function(){var b,c,d;for(d=[],e=b=0,c=a.length;0<=c?b<c:b>c;e=0<=c?++b:--b)d.push(h(e));return d}(),m=function(){var d,g,h,k,l,m;for(m=[],e=d=0,k=a.length;0<=k?d<k:d>k;e=0<=k?++d:--d){for(c=0,l=j[e],g=0,h=l.length;g<h;g++)f=l[g],c+=i[f];c/=b,m.push([e,c/i[e]])}return m}(),m.sort(function(a,b){return b[1]-a[1]})}},{"static-kdtree":9}],100:[function(a,b,c){b.exports=function(a){var b,c,d;return c=d3.median(a),b=d3.median(a.map(function(a){return Math.abs(a-c)})),d=a.map(function(a,d){return[d,Math.abs(a-c)/b]}),d.sort(function(a,b){return b[1]-a[1]})}},{}],101:[function(a,b,c){var d,e,f;d=a("../core/font/tester.coffee"),b.exports=function(a,b,c){var g,h,i,j;return c||(c={}),i=c.parent||d("svg").append("text"),b=b||{},h=[],a instanceof Array||(a=[a]),j=i.selectAll("tspan").data(a),g={left:"0px",position:"absolute",top:"0px",x:0,y:0},j.enter().append("tspan").text(String).style(b).attr(g).each(function(a){if("function"==typeof c.mod)return c.mod(this)}).each(function(a){var b,c,d;return b=d3.select(this).selectAll("tspan"),b.size()?(d=[],b.each(function(){return d.push(f(this))}),d=d3.max(d)):d=f(this),c=e(this),h.push({height:c,text:a,width:d})}),j.remove(),c.parent||i.remove(),h},f=function(a){return a.getComputedTextLength()},e=function(a){return a.offsetHeight||a.getBoundingClientRect().height||a.parentNode.getBBox().height}},{"../core/font/tester.coffee":69}],102:[function(a,b,c){var d,e;d=a("../core/font/tester.coffee"),e=function(a){var b,c,f,g,h,i,j,k,l,m,n,o,p,q;for(a instanceof Array||(a=a.split(",")),h=0,j=a.length;h<j;h++)f=a[h],f.trim();if(g=a.join(", "),b=e.complete,g in b)return b[g];for(n=function(a){return p.append("span").style("font-family",a).style("font-size","32px").style("padding","0px").style("margin","0px").text("abcdefghiABCDEFGHI_!@#$%^&*()_+1234567890")},o=function(a,b){var c,d,e;return c=n(a),d=c.node().offsetWidth,e=b.node().offsetWidth,c.remove(),d!==e},p=d("div"),l=n("monospace"),m=n("sans-serif"),i=0,k=a.length;i<k;i++)if(c=a[i],q=o(c+",monospace",l),q||(q=o(c+",sans-serif",m)),q){q=c;break}return q||(q="sans-serif"),l.remove(),m.remove(),b[g]=q,q},e.complete={},b.exports=e},{"../core/font/tester.coffee":69}],103:[function(a,b,c){var d=a("../array/sort.coffee"),e=a("../core/methods/attach.coffee"),f=a("../core/data/format.js"),g=a("../core/data/keys.coffee"),h=a("../core/data/load.coffee"),i=a("../core/fetch/data.js"),j=a("../client/ie.js"),k=a("../core/methods/reset.coffee"),l=a("../core/console/print.coffee");b.exports=function(){var b={types:{auto:a("./types/auto.js"),button:a("./types/button/button.coffee"),drop:a("./types/drop/drop.coffee"),toggle:a("./types/toggle.js")}};return b.self=function(a){var c=b.data.value instanceof Array&&b.data.value.length>b.data.large;if(b.draw.timing=b.draw.first||c||j?0:b.timing.ui,b.data.value instanceof Array){if(b.dev.value&&l.group('drawing "'+b.type.value+'"'),b.data.changed&&(b.data.cache={},g(b,"data"),f(b)),b.data.viz=i(b),b.data.sort.value&&(b.data.changed||b.order.changed||b.order.sort.changed)&&d(b.data.viz,b.order.value||b.text.value,b.order.sort.value,b.color.value,b),b.focus.value===!1){var e=b.data.element.value;if(e&&"select"===e.node().tagName.toLowerCase()){var m=e.property("selectedIndex");m=m<0?0:m;var n=e.selectAll("option")[0][m],o=n.getAttribute("data-"+b.id.value)||n.getAttribute(b.id.value);o&&(b.focus.value=o)}b.focus.value===!1&&b.data.viz.length&&(b.focus.value=b.data.viz[0][b.id.value]),b.dev.value&&b.focus.value&&l.log('"value" set to "'+b.focus.value+'"')}var p=function(a,c){c="number"!=typeof c?1===b.id.nesting.length?0:b.id.nesting.length-1:c;var d=b.id.nesting[c];return c>0&&(!(d in a)||a[d]instanceof Array)?p(a,c-1):d};if(b.data.changed){"auto"===b.search.value?b.data.viz.length>10?(b.search.enabled=!0,b.dev.value&&l.log("Search enabled.")):(b.search.enabled=!1,b.dev.value&&l.log("Search disabled.")):b.search.enabled=b.search.value;var q=b.data.element.value?b.data.element.value.node().tagName.toLowerCase():"";if(b.data.element.value&&"select"===q){var r=[];for(var s in b.data.nested.all)r=r.concat(b.data.nested.all[s]);options=b.data.element.value.selectAll("option").data(r,function(a){var b=!!a&&p(a);return!!(a&&b in a)&&a[b]}),options.exit().remove(),options.enter().append("option"),options.each(function(a){var c=p(a),d=c===b.id.value?b.text.value||b.id.value:b.text.nesting!==!0&&c in b.text.nesting?b.text.nesting[c]:c;for(var e in a)"object"!=typeof a[e]&&(e===d&&d3.select(this).html(a[e]),["alt","value"].indexOf(e)>=0?d3.select(this).attr(e,a[e]):d3.select(this).attr("data-"+e,a[e]));a[c]===b.focus.value?this.selected=!0:this.selected=!1})}}else if(b.focus.changed&&b.data.element.value){var t=b.data.element.value.node().tagName.toLowerCase();if("select"===t)b.data.element.value.selectAll("option").each(function(a){a[p(a)]===b.focus.value?this.selected=!0:this.selected=!1});else{var t=b.data.element.value.attr("type").toLowerCase();"radio"===t&&b.data.element.value.each(function(a){this.value===b.focus.value?this.checked=!0:this.checked=!1})}}if("auto"!==b.type.value){if(!b.container.ui){b.container.ui=b.container.value.selectAll("div#d3plus_"+b.type.value+"_"+b.container.id).data(["container"]);var u=b.data.element.value?b.data.element.value[0][0]:null;if(u)if(u.id)u="#"+u.id;else{var v=u.getAttribute(b.id.value)?b.id.value:"data-"+b.id.value;u=u.getAttribute(v)?"["+v+"="+u.getAttribute(v)+"]":null}b.container.ui.enter().insert("div",u).attr("id","d3plus_"+b.type.value+"_"+b.container.id).style("position","relative").style("overflow","visible").style("vertical-align","top")}b.container.ui.style("display",b.ui.display.value),b.container.ui.transition().duration(b.draw.timing).style("margin",b.ui.margin.css);var w=b.container.ui.selectAll("div.d3plus_title").data(b.title.value?[b.title.value]:[]);w.enter().insert("div","#d3plus_"+b.type.value+"_"+b.container.id).attr("class","d3plus_title").style("display","inline-block"),w.style("color",b.font.color).style("font-family",b.font.family.value).style("font-size",b.font.size+"px").style("font-weight",b.font.weight).style("padding",b.ui.padding.css).style("border-color","transparent").style("border-style","solid").style("border-width",b.ui.border+"px").text(String).each(function(a){b.margin.left=this.offsetWidth})}if(b.data.value.length){var x=b.format.locale.value.visualization[b.type.value];b.dev.value&&l.time("drawing "+x),b.types[b.type.value](b),b.dev.value&&l.timeEnd("drawing "+x)}else!b.data.url||b.data.loaded&&!b.data.stream||h(b,"data",b.self.draw);b.dev.value&&l.timeEnd("total draw time"),k(b)}},e(b,{active:a("./methods/active.coffee"),alt:a("./methods/alt.coffee"),color:a("./methods/color.coffee"),config:a("./methods/config.coffee"),container:a("./methods/container.coffee"),data:a("./methods/data.js"),depth:a("./methods/depth.coffee"),dev:a("./methods/dev.coffee"),draw:a("./methods/draw.js"),focus:a("./methods/focus.coffee"),font:a("./methods/font.coffee"),format:a("./methods/format.coffee"),height:a("./methods/height.coffee"),history:a("./methods/history.coffee"),hover:a("./methods/hover.coffee"),icon:a("./methods/icon.coffee"),id:a("./methods/id.coffee"),keywords:a("./methods/keywords.coffee"),margin:a("./methods/margin.coffee"),open:a("./methods/open.coffee"),order:a("./methods/order.coffee"),remove:a("./methods/remove.coffee"),search:a("./methods/search.coffee"),select:a("./methods/select.coffee"),selectAll:a("./methods/selectAll.coffee"),text:a("./methods/text.coffee"),timing:a("./methods/timing.coffee"),title:a("./methods/title.coffee"),type:a("./methods/type.coffee"),ui:a("./methods/ui.coffee"),width:a("./methods/width.coffee")}),b.self}},{"../array/sort.coffee":36,"../client/ie.js":39,"../core/console/print.coffee":53,"../core/data/format.js":57,"../core/data/keys.coffee":59,"../core/data/load.coffee":60,"../core/fetch/data.js":65,"../core/methods/attach.coffee":79,"../core/methods/reset.coffee":92,"./methods/active.coffee":104,"./methods/alt.coffee":105,"./methods/color.coffee":106,"./methods/config.coffee":107,"./methods/container.coffee":108,"./methods/data.js":109,"./methods/depth.coffee":110,"./methods/dev.coffee":111,"./methods/draw.js":112,"./methods/focus.coffee":113,"./methods/font.coffee":114,"./methods/format.coffee":115,"./methods/height.coffee":116,
"./methods/history.coffee":117,"./methods/hover.coffee":118,"./methods/icon.coffee":119,"./methods/id.coffee":120,"./methods/keywords.coffee":121,"./methods/margin.coffee":122,"./methods/open.coffee":123,"./methods/order.coffee":124,"./methods/remove.coffee":125,"./methods/search.coffee":126,"./methods/select.coffee":127,"./methods/selectAll.coffee":128,"./methods/text.coffee":129,"./methods/timing.coffee":130,"./methods/title.coffee":131,"./methods/type.coffee":132,"./methods/ui.coffee":133,"./methods/width.coffee":134,"./types/auto.js":135,"./types/button/button.coffee":136,"./types/drop/drop.coffee":141,"./types/toggle.js":158}],104:[function(a,b,c){var d;d=a("../../core/methods/filter.coffee"),b.exports={accepted:[!1,Array,Function,Number,String],value:!1}},{"../../core/methods/filter.coffee":80}],105:[function(a,b,c){var d;d=a("../../core/methods/filter.coffee"),b.exports={accepted:[!1,Array,Function,Object,String],mute:d(!0),solo:d(!0),value:"alt"}},{"../../core/methods/filter.coffee":80}],106:[function(a,b,c){b.exports={accepted:[String],value:"color"}},{}],107:[function(a,b,c){b.exports={accepted:[Object],objectAccess:!1,process:function(a,b){var c,d;for(c in a)d=a[c],c in b.self&&b.self[c](d);return a},value:{}}},{}],108:[function(a,b,c){var d;d=a("../../util/d3selection.coffee"),b.exports={accepted:[!1,Array,Object,String],element:!1,id:"default",process:function(a){return a===!1?d3.select("body"):d(a)?a:a instanceof Array?d3.select(a[0][0]):d3.select(a)},value:d3.select("body")}},{"../../util/d3selection.coffee":207}],109:[function(a,b,c){var d=a("../../util/d3selection.coffee"),e=a("../../core/methods/process/data.coffee");b.exports={accepted:[!1,Array,Function,String],delimiter:{accepted:[String],value:"|"},element:{process:function(a,b){var c=!1;return d(a)?c=a:"string"!=typeof a||d3.select(a).empty()||(c=d3.select(a)),c&&b.self.container(d3.select(c.node().parentNode)),c},value:!1},filetype:{accepted:[!1,"json","xml","html","csv","dsv","tsv","txt"],value:!1},filters:[],large:400,mute:[],process:function(a,b){return"default"===b.container.id&&a.length&&b.self.container({id:"default"+a.length}),e(a,b,this)},solo:[],sort:{accepted:[Boolean],value:!1},value:!1}},{"../../core/methods/process/data.coffee":86,"../../util/d3selection.coffee":207}],110:[function(a,b,c){b.exports={accepted:[Number],value:0}},{}],111:[function(a,b,c){b.exports={accepted:[Boolean],value:!1}},{}],112:[function(a,b,c){var d=a("../../util/d3selection.coffee"),e=a("../../core/parse/hideElement.js"),f=a("../../core/parse/element.js"),g=a("../../core/console/print.coffee"),h=a("../../string/format.js");b.exports={accepted:[void 0,Function],first:!0,frozen:!1,process:function(a,b){if(this.initialized===!1)return this.initialized=!0,a;if(!b.data.value||b.data.value instanceof Array&&!d(b.data.value)?b.data.element.value&&b.data.element.value.call(e):b.data.value=f(b),void 0===a&&"function"==typeof this.value&&(a=this.value),b.container.value===!1){var c=b.format.locale.value.dev.setContainer;g.warning(c,"container")}else if(b.container.value.empty()){var c=b.format.locale.value.dev.noContainer;g.warning(h(c,'"'+b.container.value+'"'),"container")}else b.dev.value&&g.time("total draw time"),b.container.value.call(b.self);if("function"==typeof a&&b.history.chain.length){var i={};changes.forEach(function(a){var b=a.method;delete a.method,i[b]=a}),a(i),b.history.chain=[]}return a},update:!0,value:void 0}},{"../../core/console/print.coffee":53,"../../core/parse/element.js":95,"../../core/parse/hideElement.js":96,"../../string/format.js":172,"../../util/d3selection.coffee":207}],113:[function(a,b,c){b.exports={accepted:[!1,Number,String],deprecates:"highlight",process:function(a,b){var c,d,e,f,g,h,i,j,k,l;if(d=b.data.element.value,d&&["string","number"].indexOf(typeof a)>=0)if(e=d.node().tagName.toLowerCase(),f=d.attr("type"),"select"===e)for(l=d.selectAll("option"),g=h=0,j=l.length;h<j;g=++h)c=l[g],c&&c[b.id.value]===a&&(d.node().selectedIndex=g);else if("input"===e&&"radio"===f)for(i=0,k=d.length;i<k;i++)c=d[i],this.checked=c&&c[b.id.value]===a;return a},value:!1}},{}],114:[function(a,b,c){var d,e,f,g;f=a("../../core/methods/font/family.coffee"),d=a("../../core/methods/font/align.coffee"),e=a("../../core/methods/font/decoration.coffee"),g=a("../../core/methods/font/transform.coffee"),b.exports={align:d(),color:"#444444",decoration:e(),family:f(),secondary:{align:d(),color:"#444444",decoration:e(),family:f(),size:12,spacing:0,transform:g(),weight:200},size:12,spacing:0,transform:g(),weight:200}},{"../../core/methods/font/align.coffee":81,"../../core/methods/font/decoration.coffee":82,"../../core/methods/font/family.coffee":83,"../../core/methods/font/transform.coffee":85}],115:[function(a,b,c){var d,e,f,g;d=a("../../number/format.coffee"),e=a("../../core/locale/locale.coffee"),f=a("../../object/merge.coffee"),g=a("../../string/title.coffee"),b.exports={accepted:[Function,String],affixes:{accepted:[Object],objectAccess:!1,value:{}},deprecates:["number_format","text_format"],locale:{accepted:function(){return d3.keys(e)},process:function(a){var b,c;return b="en_US",c=e[b],a!==b&&(c=f(c,e[a])),this.language=a,c},value:"en_US"},number:{accepted:[!1,Function],value:!1},process:function(a,b){if("string"==typeof a)b.self.format({locale:a});else if("function"==typeof a)return a;return this.value},text:{accepted:[!1,Function],value:!1},value:function(a,b){var c,e,f;return b||(b={}),f=b.vars||{},f.time&&f.time.value&&b.key===f.time.value?(e=a.constructor===Date?a:new Date(a),f.data.time.format(e)):"number"==typeof a?(c=this.number.value||d)(a,b):"string"==typeof a?(c=this.text.value||g)(a,b):JSON.stringify(a)}}},{"../../core/locale/locale.coffee":78,"../../number/format.coffee":169,"../../object/merge.coffee":170,"../../string/title.coffee":175}],116:[function(a,b,c){b.exports={accepted:[!1,Number],max:600,secondary:!1,value:!1}},{}],117:[function(a,b,c){b.exports={back:function(){if(this.states.length)return this.states.pop()()},chain:[],reset:function(){var a;for(a=[];this.states.length;)a.push(this.states.pop()());return a},states:[]}},{}],118:[function(a,b,c){b.exports={accepted:[Boolean,Number,String],value:!1}},{}],119:[function(a,b,c){var d;d=a("../../core/methods/process/icon.coffee"),b.exports={accepted:[!1,Array,Function,Object,String],back:{accepted:[!1,String],fallback:"&#x276e;",opacity:1,process:d,rotate:0,value:"fa-angle-left"},button:{accepted:[!1,String],fallback:!1,opacity:1,process:d,rotate:0,value:!1},drop:{accepted:[!1,String],fallback:"&#x276f;",opacity:1,process:d,rotate:0,value:"fa-angle-down"},next:{accepted:[!1,String],fallback:"&#x276f;",opacity:1,process:d,rotate:0,value:"fa-angle-right"},select:{accepted:[!1,String],fallback:"&#x2713;",opacity:1,process:d,rotate:0,value:"fa-check"},style:{accepted:[Object,String],value:"default"},value:"icon"}},{"../../core/methods/process/icon.coffee":88}],120:[function(a,b,c){var d;d=a("../../core/methods/filter.coffee"),b.exports={accepted:[Array,String],dataFilter:!0,mute:d(!0),nesting:["value"],solo:d(!0),value:"value"}},{"../../core/methods/filter.coffee":80}],121:[function(a,b,c){var d;d=a("../../core/methods/filter.coffee"),b.exports={accepted:[!1,Array,Function,Object,String],mute:d(!0),solo:d(!0),value:"keywords"}},{"../../core/methods/filter.coffee":80}],122:[function(a,b,c){var d;d=a("../../core/methods/process/margin.coffee"),b.exports={accepted:[Number,Object,String],process:function(a){var b;return void 0===a&&(a=this.value),b=a,d(a,this),b},value:0}},{"../../core/methods/process/margin.coffee":89}],123:[function(a,b,c){b.exports={accepted:[Boolean],flipped:{accepted:[Boolean],value:!1},value:!1}},{}],124:[function(a,b,c){b.exports={accepted:[!1,Function,String],sort:{accepted:["asc","desc"],deprecates:["sort"],value:"asc"},value:!1}},{}],125:[function(a,b,c){b.exports={accepted:void 0,process:function(a,b){this.initialized&&b.container.value.remove()},value:void 0}},{}],126:[function(a,b,c){b.exports={accepted:["auto",Boolean],process:function(a){return"Boolean"==typeof a&&(this.enabled=a),a},term:"",value:"auto"}},{}],127:[function(a,b,c){b.exports={accepted:[String],chainable:!1,process:function(a,b){var c;return c=b.container.value,c&&a?c.select(a):a},value:void 0}},{}],128:[function(a,b,c){b.exports={accepted:[String],chainable:!1,process:function(a,b){var c;return c=b.container.value,c&&a?c.selectAll(a):a},value:void 0}},{}],129:[function(a,b,c){var d;d=a("../../core/methods/filter.coffee"),b.exports={accepted:[!1,String],nesting:!0,mute:d(!0),solo:d(!0),secondary:{accepted:[!1,String],nesting:!0,value:!1},value:!1}},{"../../core/methods/filter.coffee":80}],130:[function(a,b,c){b.exports={mouseevents:60,ui:200}},{}],131:[function(a,b,c){var d,e,f,g;d=a("../../core/methods/font/decoration.coffee"),e=a("../../core/methods/font/family.coffee"),g=a("../../core/methods/font/transform.coffee"),f=a("../../string/strip.js"),b.exports={accepted:[!1,Function,String],font:{align:"center",color:"#444444",decoration:d(),family:e(),size:16,transform:g(),weight:400},link:!1,process:function(a,b){var c;return 0===b.container.id.indexOf("default")&&a&&(c=f(a).toLowerCase(),b.self.container({id:c})),a},value:!1}},{"../../core/methods/font/decoration.coffee":82,"../../core/methods/font/family.coffee":83,"../../core/methods/font/transform.coffee":85,"../../string/strip.js":174}],132:[function(a,b,c){b.exports={accepted:function(a){return d3.keys(a.types)},value:"auto"}},{}],133:[function(a,b,c){var d,e,f,g,h;f=a("../../core/methods/font/family.coffee"),d=a("../../core/methods/font/align.coffee"),e=a("../../core/methods/font/decoration.coffee"),g=a("../../core/methods/process/margin.coffee"),h=a("../../core/methods/font/transform.coffee"),b.exports={align:d("center"),border:1,color:{primary:{process:function(a,b){var c;return c=this.value,b.ui.color.secondary.value||(b.ui.color.secondary.value=d3.rgb(c).darker(.75).toString()),a},value:"#ffffff"},secondary:{value:!1}},display:{acceped:["block","inline-block"],value:"inline-block"},font:{align:d("center"),color:"#444",decoration:e(),family:f(),size:11,transform:h(),weight:200},margin:{process:function(a){var b;return void 0===a&&(a=this.value),b=a,g(a,this),b},value:5},padding:{process:function(a){var b;return void 0===a&&(a=this.value),b=a,g(a,this),b},value:5}}},{"../../core/methods/font/align.coffee":81,"../../core/methods/font/decoration.coffee":82,"../../core/methods/font/family.coffee":83,"../../core/methods/font/transform.coffee":85,"../../core/methods/process/margin.coffee":89}],134:[function(a,b,c){b.exports={accepted:[!1,Number],secondary:!1,value:!1}},{}],135:[function(a,b,c){b.exports=function(a){var b=a.data.value.length;1===b?a.self.type("button").draw():b<5?a.self.type("toggle").draw():a.self.type("drop").draw()}},{}],136:[function(a,b,c){b.exports=function(b){var c,d,e,f,g,h,i,j;return h=a("../../../core/console/print.coffee"),e=a("./functions/color.coffee"),f=a("./functions/icons.js"),g=a("./functions/mouseevents.coffee"),i=a("./functions/style.js"),c=b.container.ui.selectAll("div.d3plus_node").data(b.data.viz,function(a){return a[b.id.value]}),b.dev.value&&h.time("enter"),c.enter().append("div").attr("class","d3plus_node").call(e,b).call(i,b).call(f,b).call(g,b),b.dev.value&&h.timeEnd("enter"),b.draw.update||b.draw.timing?(b.dev.value&&h.time("ordering"),c.order(),b.dev.value&&h.timeEnd("ordering"),j=c):(d=[b.focus.previous,b.focus.value,b.hover.previous,b.hover.value].filter(function(a){return a}),j=c.filter(function(a){return d.indexOf(a[b.id.value])>=0})),b.dev.value&&h.time("update"),b.draw.timing?j.transition().duration(b.draw.timing).call(e,b).call(i,b):j.call(e,b).call(i,b),j.call(f,b).call(g,b),b.dev.value&&h.timeEnd("update"),c.exit().remove()}},{"../../../core/console/print.coffee":53,"./functions/color.coffee":137,"./functions/icons.js":138,"./functions/mouseevents.coffee":139,"./functions/style.js":140}],137:[function(a,b,c){b.exports=function(b,c){var d,e,f;return d=a("../../../../color/legible.coffee"),e=a("../../../../color/lighter.coffee"),f=a("../../../../color/text.coffee"),b.style("background-color",function(a){var b;return b=c.focus.value===a[c.id.value]?c.ui.color.secondary.value:c.ui.color.primary.value,c.hover.value===a[c.id.value]&&(b=d3.rgb(b).darker(.15).toString()),b}).style("color",function(a){var b,e,g;return g=c.focus.value===a[c.id.value]?.75:1,e=a[c.icon.value]&&c.data.viz.length<c.data.large,b=!e&&a[c.color.value]?d(a[c.color.value]):f(d3.select(this).style("background-color")),b=d3.rgb(b),"rgba("+b.r+","+b.g+","+b.b+","+g+")"}).style("border-color",c.ui.color.secondary.value)}},{"../../../../color/legible.coffee":45,"../../../../color/lighter.coffee":46,"../../../../color/text.coffee":51}],138:[function(a,b,c){var d=a("../../../../client/prefix.coffee"),e=a("../../../../client/rtl.coffee");b.exports=function(a,b){var c="right"===b.font.align.value&&!e||e&&"right"===b.font.align.value;a.each(function(a,f){var g=["label"];a[b.icon.value]&&b.data.viz.length<=b.data.large&&g.push("icon");var h=b.icon.button.value;a[b.id.value]===b.focus.value&&b.icon.select.value?(h=b.icon.select.value,g.push("selected")):h&&a.d3plus.icon!==!1&&g.push("selected");var i=0,j=d3.select(this).selectAll("div.d3plus_button_element").data(g,function(a){return a});j.enter().append("div").style("display",function(a){return"label"===a?"block":"absolute"}),j.order().attr("class",function(a){var b="";return"selected"===a&&0===h.indexOf("fa-")&&(b=" fa "+h),"d3plus_button_element d3plus_button_"+a+b}).html(function(c){if("label"===c){var d=b.text.value&&b.text.value in a&&!(a[b.text.value]instanceof Array)?b.text.value:b.id.value;return b.format.value(a[d])}return"selected"===c&&h.indexOf("fa-")<0?h:""}).style("background-image",function(c){return"icon"===c?"url('"+a[b.icon.value]+"')":"none"}).style("background-color",function(c){return"icon"===c&&"knockout"===a.style?a[b.color.value]||b.ui.color.primary.value:"transparent"}).style("background-size","100%").style("text-align",function(a){return"label"===a?b.font.align.value:"center"}).style("position",function(a){return"label"==a?"static":"absolute"}).style("width",function(a){return"label"===a?"auto":(i=b.height.value?b.height.value-(b.ui.padding.top+b.ui.padding.bottom)-2*b.ui.border:b.font.size+b.ui.border,i+"px")}).style("height",function(a){return"icon"===a?i+"px":"auto"}).style("margin-top",function(a){if("label"===a)return"0px";if(this.offsetHeight||this.getBoundingClientRect().height)var c=this.offsetHeight||this.getBoundingClientRect().height;else if("selected"===a)var c=b.font.size;else var c=i;return-c/2+"px"}).style("top",function(a){return"label"===a?"auto":"50%"}).style("left",function(a){return"icon"===a&&!c||"selected"===a&&c?b.ui.padding.left+"px":"auto"}).style("right",function(a){return"icon"===a&&c||"selected"===a&&!c?b.ui.padding.right+"px":"auto"}).style(d()+"transition",function(a){return"selected"===a?b.draw.timing/1e3+"s":"none"}).style(d()+"transform",function(a){var c="selected"===a?b.icon.select.rotate:"none";return"string"==typeof c?c:"rotate("+c+"deg)"}).style("opacity",function(a){return"selected"===a?b.icon.select.opacity:1}),j.exit().remove();var k=d3.select(this).selectAll(".d3plus_button_label");if(i>0){var l=b.ui.padding;l=3===g.length?l.top+"px "+(2*l.right+i)+"px "+l.bottom+"px "+(2*l.left+i)+"px":g.indexOf("icon")>=0&&!e||g.indexOf("selected")>=0&&e?l.top+"px "+l.right+"px "+l.bottom+"px "+(2*l.left+i)+"px":l.top+"px "+(2*l.right+i)+"px "+l.bottom+"px "+l.left+"px",k.style("padding",l)}else k.style("padding",b.ui.padding.css);if("number"==typeof b.width.value){var m=b.width.value;m-=parseFloat(k.style("padding-left"),10),m-=parseFloat(k.style("padding-right"),10),m-=2*b.ui.border,m+="px"}else var m="auto";k.style("width",m)})}},{"../../../../client/prefix.coffee":41,"../../../../client/rtl.coffee":42}],139:[function(a,b,c){b.exports=function(b,c,d){var e,f;return d=a("./color.coffee"),e=a("../../../../client/pointer.coffee"),f=a("../../../../client/ie.js"),b.on(e.over,function(a,b){return c.self.hover(a[c.id.value]),f||!c.draw.timing?d3.select(this).style("cursor","pointer").call(d,c):d3.select(this).style("cursor","pointer").transition().duration(c.timing.mouseevents).call(d,c)}).on(e.out,function(a){return c.self.hover(!1),f||!c.draw.timing?d3.select(this).style("cursor","auto").call(d,c):d3.select(this).style("cursor","auto").transition().duration(c.timing.mouseevents).call(d,c)}).on(e.click,function(a){return c.self.focus(a[c.id.value]).draw()})}},{"../../../../client/ie.js":39,"../../../../client/pointer.coffee":40,"./color.coffee":137}],140:[function(a,b,c){b.exports=function(a,b){a.style("position","relative").style("margin",b.ui.margin.css).style("display",b.ui.display.value).style("border-style","solid").style("border-width",b.ui.border+"px").style("font-family",b.font.family.value).style("font-size",b.font.size+"px").style("font-weight",b.font.weight).style("letter-spacing",b.font.spacing+"px")}},{}],141:[function(a,b,c){b.exports=function(b){var c,d,e,f,g,h,i,j,k,l,m;return e=a("./functions/element.coffee"),f=a("./functions/keyboard.coffee"),m=a("./functions/window.js"),l=a("./functions/width.js"),c=a("./functions/button.js"),i=a("./functions/selector.js"),j=a("./functions/title.js"),h=a("./functions/search.js"),g=a("./functions/list.js"),d=a("./functions/data.js"),k=a("./functions/update.js"),b.margin.top=0,b.margin.title=0,e(b),f(b),m(b),l(b),c(b),i(b),j(b),h(b),g(b),d(b),k(b)}},{"./functions/button.js":144,"./functions/data.js":145,"./functions/element.coffee":146,"./functions/keyboard.coffee":149,"./functions/list.js":150,"./functions/search.js":152,"./functions/selector.js":153,"./functions/title.js":154,"./functions/update.js":155,"./functions/width.js":156,"./functions/window.js":157}],142:[function(a,b,c){b.exports=function(a,b,c){var d=[],c=c||a.active.value;if(c instanceof Array)for(var e=0;e<c.length;e++)d.push(this(a,b,c[e]));else{var f=typeof c;"number"===f?d.push(a.depth.value===c):"function"===f?d.push(c(b)):d.push(b===c)}return d.indexOf(!0)>=0}},{}],143:[function(a,b,c){var d=a("../../../../core/console/print.coffee");b.exports=function(a){a.dev.value&&d.time("rotating arrow");var b="&#x276f;"===a.icon.drop.value?90:0;if(a.open.value!=a.open.flipped.value)var c=180+b;else var c=b;a.container.button.icon({select:{opacity:a.open.value?.5:1,rotate:c}}).draw(),a.dev.value&&d.timeEnd("rotating arrow")}},{"../../../../core/console/print.coffee":53}],144:[function(a,b,c){var d=a("../../../../util/copy.coffee"),e=a("../../../../client/pointer.coffee"),f=a("../../../form.js"),g=a("../../../../core/console/print.coffee");b.exports=function(a){if("button"in a.container||(a.dev.value&&g.time("creating main button"),a.container.button=f().container(a.container.ui).type("button").ui({margin:0}),a.dev.value&&g.timeEnd("creating main button")),a.focus.changed||a.data.changed||a.depth.changed){var b=a.depth.value,c=d(a.data.value.filter(function(c){for(var d=!1,e=0;e<a.id.nesting.length;e++){var f=a.id.nesting[e];if(d=f in c&&c[f]===a.focus.value){b=e;break}}return d})[0]);c||(c=a.container.button.data()[0]||a.data.viz[0]),a.container.button.data([c]).id(a.id.nesting).depth(b)}var h=a.hover.value===!0&&a.focus.value;a.container.button.draw({update:a.draw.update}).focus("").font(a.font).hover(h).icon({button:a.icon.drop.value,select:a.icon.drop.value,value:a.icon.value}).text(a.text.value).timing({ui:a.draw.timing}).ui({color:a.ui.color,padding:a.ui.padding.css}).width(a.width.value).draw();var i=a.container.button.container(Object).ui;a.margin.top+=i.node().offsetHeight||i.node().getBoundingClientRect().height,i.on(e.click,function(){a.self.open(!a.open.value).draw()})}},{"../../../../client/pointer.coffee":40,"../../../../core/console/print.coffee":53,"../../../../util/copy.coffee":206,"../../../form.js":103}],145:[function(a,b,c){var d=a("../../../../string/format.js"),e=a("../../../../string/strip.js");b.exports=function(a){if(a.data.url&&!a.data.loaded){var b={};b[a.text.value||a.id.value]=a.format.value(a.format.locale.value.ui.loading),a.data.filtered=[b],a.data.changed="loading"!==a.data.lastFilter,a.data.lastFilter="loading"}else if(a.open.value)if(a.search.term){var c=e(a.search.term).split("_"),f=[a.id.value,a.text.value,a.alt.value,a.keywords.value];f=f.filter(function(a){return a}),c=c.filter(function(a){return""!==a});var g=[],h=[],i=[],j=[];if(a.id.nesting.forEach(function(b){j=j.concat(a.data.nested.all[b])}),j.forEach(function(b){var d=!1;f.forEach(function(f){if(!d&&f in b&&"string"==typeof b[f]){var j=b[f].toLowerCase();if([a.text.value,a.id.value].indexOf(f)>=0&&0===j.indexOf(a.search.term))g.push(b),d=!0;else if(j.indexOf(a.search.term)>=0)h.push(b),d=!0;else{var k=e(j).split("_");for(var l in k){if(d)break;for(var m in c)if(0===k[l].indexOf(c[m])){i.push(b),d=!0;break}}}}})}),a.data.filtered=d3.merge([g,h,i]),a.data.filtered.forEach(function(a,b){a.d3plus_order=b}),a.data.changed=!0,a.data.lastFilter="search",0===a.data.filtered.length){var k={},l=a.format.value(a.format.locale.value.ui.noResults);k[a.text.value||a.id.value]=d(l,'"'+a.search.term+'"'),a.data.filtered=[k]}}else a.data.filtered=a.data.viz,a.data.changed="viz"!==a.data.lastFilter,a.data.lastFilter="viz",a.id.nesting.length>1&&a.depth.value<a.id.nesting.length-1&&(a.data.filtered=a.data.filtered.filter(function(b){return"endPoint"in b.d3plus&&b.d3plus.endPoint===a.depth.value&&(b.d3plus.icon=!1),!0}),a.data.changed="depth"!==a.data.lastFilter,a.data.lastFilter="depth");else a.data.filtered=[]}},{"../../../../string/format.js":172,"../../../../string/strip.js":174}],146:[function(a,b,c){b.exports=function(a){if(a.data.element.value)return a.data.element.value.on("focus."+a.container.id,function(){return a.self.hover(!0).draw()}),a.data.element.value.on("blur."+a.container.id,function(){var b;if(b=!a.search.enabled||d3.event.relatedTarget!==a.container.value.select("input").node())return a.self.open(!1).hover(!1).draw()}),a.data.element.value.on("change."+a.container.id,function(){return a.self.focus(this.value).draw()}),a.data.element.value.on("keydown.cancel_"+a.container.id,function(){if(9!==d3.event.keyCode)return d3.event.preventDefault()})}},{}],147:[function(a,b,c){b.exports=function(a){var b=a.height.secondary,c=a.container.button.container().node().getBoundingClientRect(),d=window.innerHeight-c.bottom-2*a.ui.border-a.ui.margin.top-a.ui.margin.bottom-a.ui.padding.top-a.ui.padding.bottom;d<3*c.height&&(d=c.top-10,a.self.open({flipped:!0})),"number"!=typeof b&&(b=d),b>a.height.max&&(b=a.height.max),a.self.height({secondary:b})}},{}],148:[function(a,b,c){var d,e,f,g;d=a("./active.js"),e=a("../../../../util/copy.coffee"),f=a("../../../form.js"),g=a("../../../../core/console/print.coffee"),b.exports=function(a){var b,c,h;a.open.value&&(a.dev.value&&g.time("updating list items"),"items"in a.container||(a.container.items=f().container(a.container.list).type("button").ui({border:0,display:"block",margin:0}).width(!1)),c=a.draw.timing?a.data.large:1,h=e(a.order),h.value=a.search.term.length?"d3plus_order":a.order.value,b=a.depth.value===a.id.nesting.length-1,(a.focus.changed||a.container.items.focus()===!1)&&a.container.items.focus(a.focus.value,function(b){var c,e,f,g;e=a.data.filtered.filter(function(c){return c[a.id.value]===b})[0],a.depth.value<a.id.nesting.length-1&&a.id.nesting[a.depth.value+1]in e?(f=a.depth.value,g=a.id.solo.value,a.history.states.push(function(){return a.self.depth(f).id({solo:g}).draw()}),a.self.depth(a.depth.value+1).id({solo:[b]}).draw()):(a.depth.changed||a.self.open(!1),c=b!==a.focus.value,c&&a.active.value&&(c=d(a,b)),c&&a.self.focus(b).draw())}),a.data.changed&&a.container.items.data({large:c,value:a.data.filtered}),a.container.items.active(a.active.value).data({sort:a.data.sort.value}).draw({update:a.draw.update}).font(a.font.secondary).hover(a.hover.value).id(a.id.value).icon({button:!b&&a.icon.next,select:!!b&&a.icon.select,value:a.icon.value}).order(h).text(a.text.secondary.value||a.text.value).timing({ui:a.draw.timing}).ui({color:{primary:1===a.id.nesting.length?a.ui.color.primary.value:a.ui.color.secondary.value,secondary:a.ui.color.secondary.value},padding:a.ui.padding.css}).draw(),a.dev.value&&g.timeEnd("updating list items"))}},{"../../../../core/console/print.coffee":53,"../../../../util/copy.coffee":206,"../../../form.js":103,"./active.js":142}],149:[function(a,b,c){b.exports=function(a){return d3.select(window).on("keydown."+a.container.id,function(){var b,c,d,e,f,g,h,i,j,k,l,m,n;if(j=d3.event.keyCode,a.open.value||a.hover.value===!0){for(l=a.hover.value===!0?"focus":"hover",h=!1,m=a.data.filtered,g=i=0,k=m.length;i<k;g=++i)if(b=m[g],b[a.id.value]===a[l].value){h=g;break}if(9===j&&a.open.value&&(!a.search.enabled||a.search.enabled&&!d3.event.shiftKey))return a.self.open(!1).hover(!1).draw();if([38,40].indexOf(j)>=0)return h===!1?h=0:38===j?a.open.value&&(h<=0?h=a.data.filtered.length-1:h-=1):40===j&&a.open.value&&(h>=a.data.filtered.length-1?h=0:h+=1),f="boolean"!=typeof a.hover.value?a.data.filtered[h][a.id.value]:a.focus.value,a.self.hover(f).open(!0).draw();if(13===j)return"boolean"!=typeof a.hover.value?(c=a.data.filtered.filter(function(b){return b[a.id.value]===a.hover.value})[0],d=a.depth.value,d<a.id.nesting.length-1&&a.id.nesting[d+1]in c?(n=a.id.solo.value,e=function(){return a.self.depth(d).id({solo:n}).draw()},a.history.states.push(e),a.self.depth(a.depth.value+1).id({solo:[a.hover.value]}).draw()):a.self.focus(a.hover.value).hover(!0).draw()):a.self.hover(a.focus.value).open(!0).draw();if(27===j){if(a.open.value)return a.self.open(!1).hover(!0).draw();if(a.hover.value===!0)return a.self.hover(!1).draw()}}})}},{}],150:[function(a,b,c){var d=a("../../../../core/console/print.coffee");b.exports=function(a){a.dev.value&&d.time("populating list"),a.container.list=a.container.selector.selectAll("div.d3plus_drop_list").data(["list"]),a.container.list.enter().append("div").attr("class","d3plus_drop_list").attr("id","d3plus_drop_list_"+a.container.id).style("overflow-y","auto").style("overflow-x","hidden"),a.dev.value&&d.timeEnd("populating list")}},{"../../../../core/console/print.coffee":53}],151:[function(a,b,c){var d=a("../../../../core/console/print.coffee");b.exports=function(a){if(a.open.value){a.dev.value&&d.time("calculating height");var b=!1;if("none"==a.container.selector.style("display"))var b=!0;b&&a.container.selector.style("display","block");var c=a.container.selector.style("height"),e=a.container.selector.property("scrollTop"),f=a.container.list.style("max-height"),g=a.container.list.property("scrollTop");a.container.selector.style("height","auto"),a.container.list.style("max-height","200000px"),a.container.listHeight=parseFloat(a.container.selector.style("height"),10),a.container.list.style("max-height",f).property("scrollTop",g),a.container.selector.style("height",c).property("scrollTop",e);var h=!1;if(a.container.listHeight>a.height.secondary&&(a.container.listHeight=a.height.secondary,h=!0),b&&a.container.selector.style("display","none"),a.dev.value&&d.timeEnd("calculating height"),h){a.dev.value&&d.time("calculating scroll position");var i=a.container.list.select("div").selectAll("div.d3plus_node"),j=i[0][0],k="boolean"!=typeof a.hover.value?a.hover.value:a.focus.value;i.each(function(b,c){b[a.id.value]===k&&(j=this)});var b=!1;"none"===a.container.selector.style("display")&&(b=!0,a.container.selector.style("display","block"));var l=j.offsetTop,m=j.offsetHeight||j.getBoundingClientRect().height,n=a.container.list.property("scrollTop");b&&a.container.selector.style("display","none"),b||a.data.changed||a.depth.changed?a.container.listScroll=l:(a.container.listScroll=n,l<n?a.container.listScroll=l:l+m>n+a.height.secondary-a.search.height&&(a.container.listScroll=l-(a.height.secondary-m-a.search.height))),a.dev.value&&d.timeEnd("calculating scroll position")}else a.container.listScroll=0}else a.container.listScroll=a.container.list.property("scrollTop"),a.container.listHeight=0}},{"../../../../core/console/print.coffee":53}],152:[function(a,b,c){var d=a("../../../../client/prefix.coffee"),e=a("../../../../core/console/print.coffee");b.exports=function(b){function h(a){a.style("padding",b.ui.padding.css).style("display","block").style("background-color",d3.rgb(b.ui.color.primary.value).darker(.15).toString())}function i(a){var c=b.width.secondary-2*b.ui.padding.left-2*b.ui.padding.right+2*b.ui.border;a.style("padding",b.ui.padding.left/2+b.ui.padding.right/2+"px").style("width",c+"px").style("border-width","0px").style("font-family",b.font.secondary.family.value).style("font-size",b.font.secondary.size+"px").style("font-weight",b.font.secondary.weight).style("text-align",b.font.secondary.align).style("outline","none").style(d()+"border-radius","0").attr("placeholder",b.format.value(b.format.locale.value.method.search))}b.dev.value&&e.time("creating search");var c=a("./data.js"),f=a("./items.coffee"),g=a("./update.js");b.container.search=b.container.selector.selectAll("div.d3plus_drop_search").data(b.search.enabled?["search"]:[]),b.draw.timing?(b.container.search.transition().duration(b.draw.timing).call(h),b.container.search.select("input").transition().duration(b.draw.timing).call(i)):(b.container.search.call(h),b.container.search.select("input").call(i)),b.container.search.enter().insert("div","#d3plus_drop_list_"+b.container.id).attr("class","d3plus_drop_search").attr("id","d3plus_drop_search_"+b.container.id).call(h).append("input").attr("id","d3plus_drop_input_"+b.container.id).style("-webkit-appearance","none").call(i),b.container.search.select("input").on("keyup."+b.container.id,function(a){var d=this.value;b.search.term!==d&&(b.search.term=d,c(b),f(b),g(b))}),b.container.search.exit().remove();var j=b.container.selector.style("display");b.container.selector.style("display","block"),b.search.height=b.search.enabled?b.container.search.node().offsetHeight||b.container.search.node().getBoundingClientRect().height:0,b.container.selector.style("display",j),b.search.enabled&&(b.margin.title+=b.search.height),b.dev.value&&e.timeEnd("creating search")}},{"../../../../client/prefix.coffee":41,"../../../../core/console/print.coffee":53,"./data.js":145,"./items.coffee":148,"./update.js":155}],153:[function(a,b,c){b.exports=function(a){a.container.selector=a.container.ui.selectAll("div.d3plus_drop_selector").data(["selector"]),a.container.selector.enter().append("div").attr("class","d3plus_drop_selector").style("position","absolute").style("top","0px").style("z-index","-1").style("overflow","hidden"),a.container.selector.style("padding",a.ui.border+"px")}},{}],154:[function(a,b,c){var d=a("../../../../client/pointer.coffee"),e=a("../../../../color/lighter.coffee"),f=a("../../../../core/console/print.coffee"),g=a("../../../../color/text.coffee");b.exports=function(a){function l(b){b.style("padding",a.ui.padding.css).style("display","block").style("background-color",a.ui.color.secondary.value).style("font-family",a.font.secondary.family.value).style("font-size",a.font.secondary.size+"px").style("font-weight",a.font.secondary.weight).style("text-align",a.font.secondary.align).style("color",g(a.ui.color.secondary.value))}function m(b){if(!b.empty()){var c=0===a.icon.back.value.indexOf("fa-")?" fa "+a.icon.back.value:"";c="d3plus_drop_back"+c;var d=0===a.icon.back.value.indexOf("fa-")?"":a.icon.back.value;b.style("position","absolute").attr("class",c).style("top",a.ui.padding.top+a.font.secondary.size/2/2.5+"px").html(d)}}function n(b){var c=h?a.focus.value:a.format.locale.value.ui.back;b.text(a.format.value(c)).style("padding","0px "+(a.ui.padding.left+a.ui.padding.right)+"px")}if(a.open.value){a.dev.value&&f.time("creating title and back button");var c=1===a.id.solo.value.length&&a.depth.value>0,h=c,i=a.container.button.data(Object).viz[0];h=!0;for(var j=0;j<a.id.nesting.length;j++){var k=a.id.nesting[j];if(k in i&&i[k]===a.focus.value){h=!1;break}}a.container.title=a.container.selector.selectAll("div.d3plus_drop_title").data(c?["title"]:[]),
a.draw.timing?(a.container.title.transition().duration(a.draw.timing).call(l),a.container.title.select("div.d3plus_drop_title_text").transition().duration(a.draw.timing).call(n)):(a.container.title.call(l),a.container.title.select("div.d3plus_drop_title_text").call(n)),a.container.title.select("span.d3plus_drop_back").call(m);var o=a.container.title.enter().insert("div","#d3plus_drop_list_"+a.container.id).attr("class","d3plus_drop_title").attr("id","d3plus_drop_title_"+a.container.id).call(l);o.append("span").attr("id","d3plus_drop_back_"+a.container.id).attr("class","d3plus_drop_back").call(m),o.append("div").attr("id","d3plus_drop_title_text_"+a.container.id).attr("class","d3plus_drop_title_text").call(n),a.container.title.on(d.over,function(b,c){var d=e(a.ui.color.secondary.value);d3.select(this).style("cursor","pointer").transition().duration(a.timing.mouseevents).style("background-color",d).style("color",g(d))}).on(d.out,function(b){var c=a.ui.color.secondary.value;d3.select(this).style("cursor","auto").transition().duration(a.timing.mouseevents).style("background-color",c).style("color",g(c))}).on(d.click,function(b){a.history.back()}),a.container.title.exit().remove(),c&&(a.margin.title+=a.container.title.node().offsetHeight||a.container.title.node().getBoundingClientRect().height),a.dev.value&&f.timeEnd("creating title and back button")}}},{"../../../../client/pointer.coffee":40,"../../../../color/lighter.coffee":46,"../../../../color/text.coffee":51,"../../../../core/console/print.coffee":53}],155:[function(a,b,c){var d=a("./items.coffee"),e=a("./height.js"),f=a("../../../../core/console/print.coffee"),g=a("./scroll.js"),h=a("./arrow.js");b.exports=function(a){function b(b){var c=a.open.flipped.value;b.style("top",function(){return c?"auto":a.margin.top-a.ui.border+"px"}).style("bottom",function(){return c?a.margin.top+a.ui.border+"px":"auto"})}function c(c){c.style("left",function(){return"left"===a.font.align.value?a.margin.left+"px":"center"===a.font.align.value?a.margin.left-(a.width.secondary-a.width.value)/2+"px":"auto"}).style("right",function(){return"right"===a.font.align.value?"0px":"auto"}).style("height",a.container.listHeight+"px").style("padding",a.ui.border+"px").style("background-color",a.ui.color.secondary.value).style("z-index",function(){return a.open.value?"9999":"-1"}).style("width",a.width.secondary-2*a.ui.border+"px").style("opacity",a.open.value?1:0).call(b)}function i(c){c.style("display",a.open.value?null:"none").call(b),a.search.enabled&&a.open.value&&a.container.selector.select("div.d3plus_drop_search input").node().focus()}function k(a){return function(){var b=d3.interpolateNumber(this.scrollTop,a);return function(a){this.scrollTop=b(a)}}}a.draw.timing?a.container.ui.transition().duration(a.draw.timing).each("start",function(){a.open.value&&d3.select(this).style("z-index",9999)}).style("margin",a.ui.margin.css).each("end",function(){a.open.value||d3.select(this).style("z-index","auto")}):a.container.ui.style("margin",a.ui.margin.css).style("z-index",function(){return a.open.value?9999:"auto"}),d(a),e(a),g(a),h(a),a.dev.value&&f.time("drawing list");var j=a.open.value?a.height.secondary-a.margin.title:0;a.draw.timing?(a.container.selector.transition().duration(a.draw.timing).each("start",function(){d3.select(this).style("display",a.open.value?"block":null)}).call(c).each("end",function(){d3.select(this).transition().duration(a.draw.timing).call(i)}),a.container.list.transition().duration(a.draw.timing).style("width",a.width.secondary-2*a.ui.border+"px").style("max-height",j+"px").tween("scroll",k(a.container.listScroll))):(a.container.selector.call(c).call(i),a.container.list.style("width",a.width.secondary-2*a.ui.border+"px").style("max-height",j+"px").property("scrollTop",a.container.listScroll)),a.dev.value&&f.timeEnd("drawing list")}},{"../../../../core/console/print.coffee":53,"./arrow.js":143,"./height.js":147,"./items.coffee":148,"./scroll.js":151}],156:[function(a,b,c){var d=a("../../../../util/copy.coffee"),e=a("../../../../core/font/tester.coffee"),f=a("../../../form.js"),g=a("../../../../core/console/print.coffee"),h=a("../../../../object/validate.coffee");b.exports=function(a){function l(c){var d="primary"===c?"value":c,h="value"===d?a.icon.drop.value:a.icon.select.value||a.icon.drop.value,i="value"===d?a.text.value:a.text.secondary.value||a.text.value,j="value"===d?a.font:a.font.secondary;a.dev.value&&g.time("calculating "+c+" width");var k=f().container(e()).data({large:9999,value:b}).draw({update:!1}).font(j).icon({button:h,value:a.icon.value}).id(a.id.value).timing({ui:0}).text(i||a.id.value).type("button").ui({border:"primary"===c?a.ui.border:0,display:"inline-block",margin:0,padding:a.ui.padding.css}).width(!1).draw(),l=[];k.selectAll("div.d3plus_node").each(function(a){l.push(this.offsetWidth+1)}).remove();var m={};m[d]=d3.max(l),a.self.width(m),a.dev.value&&g.timeEnd("calculating "+c+" width")}var b=[];for(var i in a.data.nested.all){var j=a.data.nested.all[i],k=h(a.text.nesting)&&i in a.text.nesting?a.text.nesting[i][0]:i;[a.id.value,a.text.value].indexOf(k)<0&&(j=d(j),j.forEach(function(b){b[a.text.value||a.id.value]=b[k]})),b=b.concat(j)}"number"!=typeof a.width.value&&l("primary"),"number"!=typeof a.width.secondary&&(a.text.secondary.value&&a.text.value!==a.text.secondary.value?l("secondary"):a.self.width({secondary:a.width.value}))}},{"../../../../core/console/print.coffee":53,"../../../../core/font/tester.coffee":69,"../../../../object/validate.coffee":171,"../../../../util/copy.coffee":206,"../../../form.js":103}],157:[function(a,b,c){var d=a("../../../../util/child.coffee"),e=function(a,b){if(void 0===b)var b=window;d3.select(b).on("click."+a.container.id,function(){var b=d3.event.target||d3.event.toElement,c=b.parentNode;c&&["d3plus_node","d3plus_drop_title"].indexOf(c.className)>=0&&(b=c.parentNode),b&&c&&!d(a.container.ui,b)&&(a.open.value||a.hover.value)&&a.self.open(!1).hover(!1).draw()});try{var c=window.parent.location.host===window.location.host}catch(a){var c=!1}c&&b.self!==window.top&&e(a,b.parent)};b.exports=e},{"../../../../util/child.coffee":204}],158:[function(a,b,c){var d=a("../form.js");b.exports=function(a){"buttons"in a.container||(a.container.buttons=d().container(a.container.ui).type("button"));var b=a.data.viz.length,c=!!a.width.value&&a.width.value/b,e=a.container.ui.selectAll("div.d3plus_toggle").data(a.data.viz,function(b){return b[a.id.value]});e.enter().append("div").attr("class","d3plus_toggle").style("display","inline-block").style("vertical-align","top"),e.order().each(function(b){"form"in b.d3plus||(b.d3plus.form=d().container(d3.select(this)));var e=a.id.nesting.length>a.depth.value?a.id.nesting[a.depth.value+1]:a.id.value;b[e]instanceof Array?b.d3plus.form.container({id:a.container.id+"_"+b[a.id.value]}).data(b[e]).id(a.id.nesting.slice(1)).type("drop"):b.d3plus.form.data([b]).id(a.id.value).type("button"),b.d3plus.form.color(a.color).focus(a.focus.value,function(b){b!==a.focus.value&&a.self.focus(b).draw()}).hover(a.hover.value).icon({select:!1,value:a.icon.value}).font(a.font).format(a.format).order(a.order).text(a.text.value).ui({border:a.ui.border,color:a.ui.color,display:"inline-block",margin:0,padding:a.ui.padding.css}).width(c).draw()}),a.data.element.value&&a.data.element.value.on("focus."+a.container.id,function(){a.self.focus(this.value).hover(this.value).draw()}).on("blur."+a.container.id,function(){a.self.hover(!1).draw()})}},{"../form.js":103}],159:[function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o;i=a("../core/console/print.coffee"),n=a("simplify-js"),b.exports=function(a,b){var c,e,g,j,k,m,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va;if(a.length<3)return i.error("polygon has to have at least 3 points"),null;if(w=[],q=.5,k=5,null==b&&(b={}),null==b.maxAspectRatio&&(b.maxAspectRatio=15),null==b.minWidth&&(b.minWidth=0),null==b.minHeight&&(b.minHeight=0),null==b.tolerance&&(b.tolerance=.02),null==b.nTries&&(b.nTries=20),null!=b.angle&&(b.angle instanceof Array?m=b.angle:"number"==typeof b.angle?m=[b.angle]:"string"!=typeof b.angle||isNaN(b.angle)||(m=[Number(b.angle)])),null==m&&(m=d3.range(-90,90+k,k)),null!=b.aspectRatio&&(b.aspectRatio instanceof Array?r=b.aspectRatio:"number"==typeof b.aspectRatio?r=[b.aspectRatio]:"string"!=typeof b.aspectRatio||isNaN(b.aspectRatio)||(r=[Number(b.aspectRatio)])),null!=b.origin&&b.origin instanceof Array&&(Y=b.origin[0]instanceof Array?b.origin:[b.origin]),p=Math.abs(d3.geom.polygon(a).area()),0===p)return i.error("polygon has 0 area"),null;if(da=d3.extent(a,function(a){return a[0]}),T=da[0],O=da[1],ea=d3.extent(a,function(a){return a[1]}),U=ea[0],P=ea[1],ra=Math.min(O-T,P-U)*b.tolerance,qa=function(){var b,c,d;for(d=[],b=0,c=a.length;b<c;b++)Z=a[b],d.push({x:Z[0],y:Z[1]});return d}(),ra>0&&(qa=n(qa,ra),a=function(){var a,b,c;for(c=[],a=0,b=qa.length;a<b;a++)Z=qa[a],c.push([Z.x,Z.y]);return c}()),b.vdebug&&w.push({type:"simplify",poly:a}),fa=d3.extent(a,function(a){return a[0]}),T=fa[0],O=fa[1],ga=d3.extent(a,function(a){return a[1]}),U=ga[0],P=ga[1],s=[[T,U],[O,U],[O,P],[T,P]],ha=[O-T,P-U],u=ha[0],t=ha[1],ta=Math.min(u,t)/50,null==Y)for(Y=[],v=d3.geom.polygon(a).centroid(),f(v,a)&&Y.push(v);Y.length<b.nTries;)oa=Math.random()*u+T,pa=Math.random()*t+U,na=[oa,pa],f(na,a)&&Y.push(na);for(b.vdebug&&w.push({type:"origins",points:Y}),J=0,M=null,A=0,E=m.length;A<E;A++)for(g=m[A],j=-g*Math.PI/180,b.vdebug&&w.push({type:"angle",angle:g}),y=B=0,F=Y.length;B<F;y=++B)for(W=Y[y],ia=d(a,W,j),_=ia[0],ba=ia[1],ja=d(a,W,j+Math.PI/2),$=ja[0],aa=ja[1],V=[],null!=_&&null!=ba&&V.push([(_[0]+ba[0])/2,(_[1]+ba[1])/2]),null!=$&&null!=aa&&V.push([($[0]+aa[0])/2,($[1]+aa[1])/2]),b.vdebug&&w.push({type:"modifOrigin",idx:y,p1W:_,p2W:ba,p1H:$,p2H:aa,modifOrigins:V}),C=0,G=V.length;C<G;C++)if(X=V[C],b.vdebug&&w.push({type:"origin",cx:X[0],cy:X[1]}),ka=d(a,X,j),_=ka[0],ba=ka[1],null!==_&&null!==ba&&(S=Math.min(o(X,_),o(X,ba)),N=2*Math.sqrt(S),la=d(a,X,j+Math.PI/2),$=la[0],aa=la[1],null!==$&&null!==aa&&(R=Math.min(o(X,$),o(X,aa)),L=2*Math.sqrt(R),!(N*L<J))))for(null!=r?e=r:(Q=Math.max(1,b.minWidth/L,J/(L*L)),K=Math.min(b.maxAspectRatio,N/b.minHeight,N*N/J),e=d3.range(Q,K+q,q)),I=0,H=e.length;I<H;I++)if(c=e[I],D=Math.max(b.minWidth,Math.sqrt(J*c)),ma=Math.min(N,L*c),!(ma*L<J))for(ma-D>=ta&&b.vdebug&&w.push({type:"aRatio",aRatio:c});ma-D>=ta;)sa=(D+ma)/2,x=sa/c,ua=X[0],va=X[1],ca=[[ua-sa/2,va-x/2],[ua+sa/2,va-x/2],[ua+sa/2,va+x/2],[ua-sa/2,va+x/2]],ca=l(ca,j,X),h(ca,a)?(z=!0,J=sa*x,M={cx:ua,cy:va,width:sa,height:x,angle:g},D=sa):(z=!1,ma=sa),b.vdebug&&w.push({type:"rectangle",cx:ua,cy:va,width:sa,height:x,areaFraction:sa*x/p,angle:g,insidePoly:z});return[M,J,w]},o=function(a,b){var c,d;return c=b[0]-a[0],d=b[1]-a[1],c*c+d*d},j=function(a,b,c){var d,e,f,g,h;return h=b[1]<c[1]?[b,c]:[c,b],d=h[0],e=h[1],a[1]!==e[1]&&a[1]!==d[1]||(a[1]+=Number.MIN_VALUE),!(a[1]>e[1]||a[1]<d[1])&&(!(a[0]>d[0]&&a[0]>e[0])&&(a[0]<d[0]&&a[0]<e[0]||(f=(e[1]-d[1])/(e[0]-d[0]),g=(a[1]-d[1])/(a[0]-d[0]),g>f)))},f=function(a,b){var c,d,e,f,g;for(f=-1,g=b.length,d=b[g-1],e=0;++f<g;)c=d,d=b[f],j(a,c,d)&&e++;return e%2!==0},g=function(a,b,c){var d,e,f;return d=1e-9,e=a[0],f=a[1],!(e<Math.min(b[0],c[0])-d||e>Math.max(b[0],c[0])+d||f<Math.min(b[1],c[1])-d||f>Math.max(b[1],c[1])+d)},e=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n;return l=1e-9,h=a[0]-b[0],j=a[1]-b[1],i=c[0]-d[0],k=c[1]-d[1],g=h*k-j*i,Math.abs(g)<l?null:(e=a[0]*b[1]-a[1]*b[0],f=c[0]*d[1]-c[1]*d[0],m=(e*i-f*h)/g,n=(e*k-f*j)/g,[m,n])},m=function(a,b,c,d){var f;return f=e(a,b,c,d),null!=f&&(g(f,a,b)&&g(f,c,d))},h=function(a,b){var c,d,e,g,h,i,j,k;for(h=-1,j=a.length,k=b.length,e=a[j-1];++h<j;)for(c=e,e=a[h],i=-1,g=b[k-1];++i<k;)if(d=g,g=b[i],m(c,e,d,g))return!1;return f(a[0],b)},k=function(a,b,c){var d,e,f,g;return null==c&&(c=[0,0]),f=a[0]-c[0],g=a[1]-c[1],d=Math.cos(b),e=Math.sin(b),[d*f-e*g+c[0],e*f+d*g+c[1]]},l=function(a,b,c){var d,e,f,g;for(g=[],d=0,e=a.length;d<e;d++)f=a[d],g.push(k(f,b,c));return g},d=function(a,b,c){var d,f,h,i,j,k,l,m,n,p,q,r,s,t,u;for(j=1e-9,b=[b[0]+j*Math.cos(c),b[1]+j*Math.sin(c)],t=b[0],u=b[1],r=[t+Math.cos(c),u+Math.sin(c)],l=0,Math.abs(r[0]-t)<j&&(l=1),k=-1,p=a.length,f=a[p-1],m=Number.MAX_VALUE,n=Number.MAX_VALUE,h=null,i=null;++k<p;)d=f,f=a[k],q=e(b,r,d,f),null!=q&&g(q,d,f)&&(s=o(b,q),q[l]<b[l]?s<m&&(m=s,h=q):q[l]>b[l]&&s<n&&(n=s,i=q));return[h,i]}},{"../core/console/print.coffee":53,"simplify-js":8}],160:[function(a,b,c){b.exports=function(a,b,c){var d,e,f,g;return e={x:0,y:0},a<0&&(a=2*Math.PI+a),"square"===c?(f=45*(Math.PI/180),a<=Math.PI?a<Math.PI/2?a<f?(e.x+=b,g=Math.tan(a)*b,e.y+=g):(e.y+=b,d=b/Math.tan(a),e.x+=d):a<Math.PI-f?(e.y+=b,d=b/Math.tan(Math.PI-a),e.x-=d):(e.x-=b,g=Math.tan(Math.PI-a)*b,e.y+=g):a<3*Math.PI/2?a<f+Math.PI?(e.x-=b,g=Math.tan(a-Math.PI)*b,e.y-=g):(e.y-=b,d=b/Math.tan(a-Math.PI),e.x-=d):a<2*Math.PI-f?(e.y-=b,d=b/Math.tan(2*Math.PI-a),e.x+=d):(e.x+=b,g=Math.tan(2*Math.PI-a)*b,e.y-=g)):(e.x+=b*Math.cos(a),e.y+=b*Math.sin(a)),e}},{}],161:[function(a,b,c){var d;d=a("../geom/offset.coffee"),b.exports=function(a){var b,c,e,f,g,h,i,j,k,l,m,n,o,p,q,r;for(a=a.slice(1).slice(0,-1).split(/L|A/),l=[],e=0,g=a.length;e<g;e++)if(k=a[e],k=k.split(" "),1===k.length)l.push(k[0].split(",").map(function(a){return parseFloat(a)}));else{for(m=l[l.length-1],f=k.pop().split(",").map(function(a){return parseFloat(a)}),n=parseFloat(k.shift().split(",")[0]),r=Math.sqrt(Math.pow(f[0]-m[0],2)+Math.pow(f[1]-m[1],2)),b=Math.acos((n*n+n*n-r*r)/(2*n*n)),j="1"===k[1].split(",")[0],j&&(b=2*Math.PI-b),h=b/(2*Math.PI)*(n*Math.PI*2),o=h/5,p=Math.atan2(-m[1],-m[0])-Math.PI,q=b/o,c=q;c<b;)i=d(p+c,n),l.push([i.x,i.y]),c+=q;l.push(f)}return l}},{"../geom/offset.coffee":160}],162:[function(a,b,c){var d,e,f;d={},"undefined"!=typeof window&&(window.d3plus=d),b.exports=d,d.version="1.7.4 - Viridian",d.repo="https://github.com/alexandersimoes/d3plus/",d.array={comparator:a("./array/comparator.coffee"),contains:a("./array/contains.coffee"),sort:a("./array/sort.coffee"),update:a("./array/update.coffee")},d.client={css:a("./client/css.coffee"),ie:a("./client/ie.js"),pointer:a("./client/pointer.coffee"),prefix:a("./client/prefix.coffee"),rtl:a("./client/rtl.coffee"),scrollbar:a("./client/scrollbar.coffee"),touch:a("./client/touch.coffee")},d.color={legible:a("./color/legible.coffee"),lighter:a("./color/lighter.coffee"),mix:a("./color/mix.coffee"),random:a("./color/random.coffee"),scale:a("./color/scale.coffee"),sort:a("./color/sort.coffee"),text:a("./color/text.coffee"),validate:a("./color/validate.coffee")},d.data={bestRegress:a("./data/bestRegress.coffee"),lof:a("./data/lof.coffee"),mad:a("./data/mad.coffee")},d.font={sizes:a("./font/sizes.coffee"),validate:a("./font/validate.coffee")},d.form=a("./form/form.js"),d.geom={largestRect:a("./geom/largestRect.coffee"),offset:a("./geom/offset.coffee"),path2poly:a("./geom/path2poly.coffee")},d.network={cluster:a("./network/cluster.coffee"),distance:a("./network/distance.coffee"),normalize:a("./network/normalize.coffee"),shortestPath:a("./network/shortestPath.coffee"),smallestGap:a("./network/smallestGap.coffee"),subgraph:a("./network/subgraph.coffee")},d.number={format:a("./number/format.coffee")},d.object={merge:a("./object/merge.coffee"),validate:a("./object/validate.coffee")},d.string={format:a("./string/format.js"),list:a("./string/list.coffee"),strip:a("./string/strip.js"),title:a("./string/title.coffee")},d.textwrap=a("./textwrap/textwrap.coffee"),d.tooltip={create:a("./tooltip/create.js"),move:a("./tooltip/move.coffee"),remove:a("./tooltip/remove.coffee")},d.util={buckets:a("./util/buckets.coffee"),child:a("./util/child.coffee"),closest:a("./util/closest.coffee"),copy:a("./util/copy.coffee"),d3selection:a("./util/d3selection.coffee"),dataurl:a("./util/dataURL.coffee"),uniques:a("./util/uniques.coffee")},d.viz=a("./viz/viz.coffee"),f=a("./client/css.coffee"),e=a("./core/console/print.coffee"),f("d3plus.css")&&e.warning("d3plus.css has been deprecated, you do not need to load this file.",d.repo+"releases/tag/v1.4.0")},{"./array/comparator.coffee":34,"./array/contains.coffee":35,"./array/sort.coffee":36,"./array/update.coffee":37,"./client/css.coffee":38,"./client/ie.js":39,"./client/pointer.coffee":40,"./client/prefix.coffee":41,"./client/rtl.coffee":42,"./client/scrollbar.coffee":43,"./client/touch.coffee":44,"./color/legible.coffee":45,"./color/lighter.coffee":46,"./color/mix.coffee":47,"./color/random.coffee":48,"./color/scale.coffee":49,"./color/sort.coffee":50,"./color/text.coffee":51,"./color/validate.coffee":52,"./core/console/print.coffee":53,"./data/bestRegress.coffee":98,"./data/lof.coffee":99,"./data/mad.coffee":100,"./font/sizes.coffee":101,"./font/validate.coffee":102,"./form/form.js":103,"./geom/largestRect.coffee":159,"./geom/offset.coffee":160,"./geom/path2poly.coffee":161,"./network/cluster.coffee":163,"./network/distance.coffee":164,"./network/normalize.coffee":165,"./network/shortestPath.coffee":166,"./network/smallestGap.coffee":167,"./network/subgraph.coffee":168,"./number/format.coffee":169,"./object/merge.coffee":170,"./object/validate.coffee":171,"./string/format.js":172,"./string/list.coffee":173,"./string/strip.js":174,"./string/title.coffee":175,"./textwrap/textwrap.coffee":199,"./tooltip/create.js":200,"./tooltip/move.coffee":201,"./tooltip/remove.coffee":202,"./util/buckets.coffee":203,"./util/child.coffee":204,"./util/closest.coffee":205,"./util/copy.coffee":206,"./util/d3selection.coffee":207,"./util/dataURL.coffee":208,"./util/uniques.coffee":209,"./viz/viz.coffee":324}],163:[function(a,b,c){var d;d=a("./normalize.coffee"),b.exports=function(a,b){var c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I;if(p=[],null==b&&(b={}),(null==b.nodes||"object"!=typeof b.nodes)&&(F=d(a,b),a=F[0],b=F[1],null===b))return null;m=b.distance,C=b.nodeid,I=b.startpoint,o=b.endpoint,D=b.nodes,E={};for(r in D)E[r]={node:D[r].node,degree:0};for(y=0,x={},q=0,v=a.length;q<v;q++)n=a[q],e=C(I(n)),f=C(o(n)),e in x||(x[e]={}),f in x||(x[f]={}),f in x[e]||(x[e][f]=0,x[f][e]=0,y++,E[e].degree+=1,E[f].degree+=1);j={},c=0;for(r in E)B=E[r],j[r]={score:B.degree/(2*y),nodes:[r]};for(e in x)for(f in x[e])x[e][f]=1/(2*y)-E[e].degree*E[f].degree/(4*y*y);for(s=0;s<1e3;){l=-1,z=void 0,A=void 0;for(e in x)for(f in x[e])x[e][f]>l&&(l=x[e][f],z=e,A=f);if(l<0)break;for(u in x[z])u!==A&&(u in x[A]?x[A][u]+=x[z][u]:x[A][u]=x[z][u]-2*j[A].score*j[u].score,x[u][A]=x[A][u]),delete x[u][z];for(u in x[A])u in x[z]||u===A||(x[A][u]-=2*j[z].score*j[u].score,x[u][A]=x[A][u]);for(G=j[z].nodes,t=0,w=G.length;t<w;t++)B=G[t],j[A].nodes.push(B);j[A].score+=j[z].score,b.vdebug&&p.push({type:"merge",father:A,child:z,nodes:j[A].nodes}),delete j[z],delete x[z],c+=l,s++}return i=function(){var a;a=[];for(g in j)k=j[g],a.push([g,k.nodes.length]);return a}(),i.sort(function(a,b){return b[1]-a[1]}),H=function(){var a,b,c;for(c=[],a=0,b=i.length;a<b;a++)h=i[a],c.push(j[h[0]].nodes);return c}(),[H,p]}},{"./normalize.coffee":165}],164:[function(a,b,c){b.exports=function(a,b){var c,d;return a instanceof Array||(a=[a.x,a.y]),b instanceof Array||(b=[b.x,b.y]),c=Math.abs(a[0]-b[0]),d=Math.abs(a[1]-b[1]),Math.sqrt(c*c+d*d)}},{}],165:[function(a,b,c){var d;d=a("../core/console/print.coffee"),b.exports=function(a,b){var c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H;if(E=b.source,G=b.target,g=b.directed,h=b.distance,A=b.nodeid,F=b.startpoint,k=b.endpoint,c=b.K,H=b.vdebug,g||(g=!1),null==c&&(c=1),null==A?A=function(a){return a}:"string"==typeof A&&(A=function(a){return function(b){return b[a]}}(A)),null!=E&&"object"==typeof E&&(E=A(E)),null!=G&&"object"==typeof G&&(G=A(G)),null==F?F=function(a){return a.source}:"string"==typeof F&&(F=function(a){return function(b){return b[a]}}(F)),null==k?k=function(a){return a.target}:"string"==typeof k&&(k=function(a){return function(b){return b[a]}}(k)),null==h)h=function(a){return 1};else if("number"==typeof h)h=function(a){return function(b){return a}}(h);else if("string"==typeof h)h=function(a){return function(b){return b[a]}}(h);else if(h instanceof Array){for(j={},m=r=0,u=a.length;r<u;m=++r)i=a[m],e=A(F(i)),f=A(k(i)),j[e+"_"+f]=h[m];h=function(a){return e=A(F(a)),f=A(k(a)),j[e+"_"+f]}}for(B={},s=0,v=a.length;s<v;s++){for(i=a[s],y=F(i),z=k(i),p=A(y),q=A(z),C=[y,z],t=0,w=C.length;t<w;t++)x=C[t],n=A(x),n in B||(B[n]={node:x,outedges:[]});B[p].outedges.push(i),g||B[q].outedges.push(i)}return l=null,0===a.length?l="The length of edges is 0":c<0?l="K can not have negative value":null==h(a[0])?l="Check the distance function/attribute":null==F(a[0])?l="Check the startpoint function/attribute":null==k(a[0])?l="Check the endpoint function/attribute":(o=A(F(a[0])),null==o||"string"!=(D=typeof o)&&"number"!==D?l="Check the nodeid function/attribute":null==E||E in B?null==G||G in B||(l="The target is not in the graph"):l="The source is not in the graph"),null!=l?(d.error(l),null):[a,{source:E,target:G,directed:g,distance:h,nodeid:A,startpoint:F,endpoint:k,K:c,nodes:B,vdebug:H}]}},{"../core/console/print.coffee":53}],166:[function(a,b,c){var d,e;d=a("heap"),e=a("./normalize.coffee"),b.exports=function(a,b,c){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H;if(null==c&&(c={}),c.source=b,(null==c.nodes||"object"!=typeof c.nodes)&&(z=e(a,c),a=z[0],c=z[1],null===c))return null;b=c.source,F=c.target,j=c.directed,k=c.distance,w=c.nodeid,E=c.startpoint,m=c.endpoint,f=c.K,x=c.nodes;for(q in x)v=x[q],v.count=0;for(o=new d(function(a,b){return a.distance-b.distance}),H={},null==F&&(H[b]=!0),o.push({edge:null,target:b,distance:0}),u=0,D=[];!o.empty()&&(u=Math.max(u,o.size()),y=o.pop(),G=y.target,x[G].count++,null==F?D.push(y):G===F&&D.push(y),D.length!==f);)if(x[G].count<=f)for(A=x[G].outedges,p=0,s=A.length;p<s;p++){if(l=A[p],g=w(E(l)),i=w(m(l)),j||i!==G||(B=[i,g],g=B[0],i=B[1]),null==F){if(H[i])continue;H[i]=!0}h=y.distance+k(l),o.push({edge:l,previous:y,target:i,distance:h})}for(n=function(b){for(a=[];null!=b.edge;)a.push(b.edge),b=b.previous;return a.reverse()},r=0,t=D.length;r<t;r++)C=D[r],null!=F&&(delete C.target,C.edges=n(C)),delete C.edge,delete C.previous;return D}},{"./normalize.coffee":165,heap:5}],167:[function(a,b,c){var d;d=a("./distance.coffee"),b.exports=function(a,b){var c,e;return b||(b={}),c=[],e=d3.geom.quadtree().x(function(a){return b.accessor?b.accessor(a)[0]:a[0]}).y(function(a){return b.accessor?b.accessor(a)[1]:a[1]}),e(a).visit(function(a){var e,f,g,h,i,j,k,l;if(!a.leaf)for(k=a.nodes,e=0,g=k.length;e<g;e++)if(i=k[e],i&&i.point)if(b.origin)c.push(d(i,b));else for(l=a.nodes,f=0,h=l.length;f<h;f++)j=l[f],j&&j.point&&j.point!==i.point&&c.push(d(i,j));return!1}),b.all?c.sort(function(a,b){return a-b}):d3.min(c)}},{"./distance.coffee":164}],168:[function(a,b,c){var d;d=a("./normalize.coffee"),b.exports=function(a,b,c){var e,f,g,h,i,j,k,l,m,n,o,p;return null==c&&(c={}),c.source=b,null!=c.nodes&&"object"==typeof c.nodes||(n=d(a,c),a=n[0],c=n[1],null!==c)?(b=c.source,g=c.directed,h=c.distance,l=c.nodeid,o=c.startpoint,j=c.endpoint,e=c.K,m=c.nodes,p={},p[b]=!0,f=function(a,b){var c,d,i,k,n,q,r,s,t;for(r=m[a].outedges,t=[],k=0,n=r.length;k<n;k++)i=r[k],c=l(o(i)),d=l(j(i)),g||d!==a||(s=[d,c],c=s[0],d=s[1]),d in p?t.push(void 0):(q=b+h(i),q<=e?(p[d]=!0,t.push(f(d,q))):t.push(void 0));return t},f(b,0),{nodes:function(){var a;a=[];for(k in p)a.push(m[k].node);return a}(),edges:function(){var b,c,d;for(d=[],b=0,c=a.length;b<c;b++)i=a[b],l(o(i))in p&&l(j(i))in p&&d.push(i);return d}()}):null}},{"./normalize.coffee":165}],169:[function(a,b,c){var d;d=a("../core/locale/languages/en_US.coffee"),b.exports=function(a,b){var c,e,f,g,h,i,j,k,l,m,n,o;return b||(b={}),i="locale"in b?b.locale:d,m=i.time.slice(),e=d3.locale(i.format),b||(b={}),n=b.vars||{},f=b.key,g=!("labels"in b)||b.labels,h=a.toString().split(".")[0].length,n.time&&n.time.value&&m.push(n.time.value),"string"==typeof f&&m.indexOf(f.toLowerCase())>=0?j=a:"share"===f?(j=0===a?0:a>=100?e.numberFormat(",f")(a):a>99?e.numberFormat(".3g")(a):e.numberFormat(".2g")(a),j+="%"):a<10&&a>-10?(h=a.toString().split("."),k=1,h.length>1&&(k=d3.min([parseFloat(h[1]).toString().length,2]),-1<a&&a<1||(o=h[1].length-parseFloat(h[1]).toString().length,k+=1+o)),j=e.numberFormat("."+k+"g")(a)):h>3?(l=d3.formatPrefix(a).symbol,l=l.replace("G","B"),a=d3.formatPrefix(a).scale(a),a=e.numberFormat(".3g")(a),a=a.replace(i.format.decimal,"."),a=parseFloat(a)+"",a=a.replace(".",i.format.decimal),j=a+l):j=3===h?e.numberFormat(",f")(a):0===a?0:a===parseInt(a,10)?e.numberFormat(".2")(a):e.numberFormat(".3g")(a),g&&f&&"format"in n&&f in n.format.affixes.value?(c=n.format.affixes.value[f],c[0]+j+c[1]):j}},{"../core/locale/languages/en_US.coffee":70}],170:[function(a,b,c){var d,e;d=a("../util/d3selection.coffee"),e=a("./validate.coffee"),b.exports=function(a,b){var c,f;return c=function(a,b,f){var g,h,i;h=[];for(g in a)i=a[g],"undefined"!=typeof i?!f&&e(i)?("object"!=typeof b[g]&&(b[g]={}),h.push(c(i,b[g],0===g.indexOf("d3plus")))):!d(i)&&i instanceof Array?h.push(b[g]=i.slice(0)):h.push(b[g]=i):h.push(void 0);return h},f={},a&&c(a,f),b&&c(b,f),f}},{"../util/d3selection.coffee":207,"./validate.coffee":171}],171:[function(a,b,c){b.exports=function(a){return a&&a.constructor===Object}},{}],172:[function(a,b,c){b.exports=function(){var a=Array.prototype.slice.call(arguments),b=a.shift();return b.unkeyed_index=0,b.replace(/\{(\w*)\}/g,function(c,d){if(""===d&&(d=b.unkeyed_index,b.unkeyed_index++),d==+d)return"undefined"!==a[d]?a[d]:c;for(var e=0;e<a.length;e++)if("object"==typeof a[e]&&"undefined"!=typeof a[e][d])return a[e][d];return c}.bind(b))}},{}],173:[function(a,b,c){var d,e;d=a("./format.js"),e=a("../core/locale/languages/en_US.coffee").ui,b.exports=function(a,b,c,f){var g;return a instanceof Array?(a=a.slice(0),b||(b=e.and),f||(f=e.moreText),2===a.length?a.join(" "+b+" "):(c&&a.length>c&&(g=a.length-c+1,a=a.slice(0,c-1),a[c-1]=d(f,g)),a.length>1&&(a[a.length-1]=b+" "+a[a.length-1]),a.join(", "))):a}},{"../core/locale/languages/en_US.coffee":70,"./format.js":172}],174:[function(a,b,c){b.exports=function(a){var b=["!","@","#","$","%","^","&","*","(",")","[","]","{","}",".",",","/","\\","|","'",'"',";",":","<",">","?","=","+"],c=[[/[\300-\306]/g,"A"],[/[\340-\346]/g,"a"],[/[\310-\313]/g,"E"],[/[\350-\353]/g,"e"],[/[\314-\317]/g,"I"],[/[\354-\357]/g,"i"],[/[\322-\330]/g,"O"],[/[\362-\370]/g,"o"],[/[\331-\334]/g,"U"],[/[\371-\374]/g,"u"],[/[\321]/g,"N"],[/[\361]/g,"n"],[/[\307]/g,"C"],[/[\347]/g,"c"]];return a+="",""+a.replace(/[^A-Za-z0-9\-_]/g,function(a){if(" "===a)return"_";if(b.indexOf(a)>=0)return"";for(var d=a,e=0;e<c.length;e++)if(new RegExp(c[e][0]).test(a)){d=c[e][1];break}return d})}},{}],175:[function(a,b,c){var d;d=a("../core/locale/languages/en_US.coffee"),b.exports=function(a,b){var c,e,f,g,h;return a?(b||(b={}),f=b.key,"."===a.charAt(a.length-1)?a.charAt(0).toUpperCase()+a.substr(1):(g="locale"in this?this.locale.value:d,h=g.lowercase.map(function(a){return a.toLowerCase()}),e=g.uppercase,e=e.concat(e.map(function(a){return a+"s"})),c=e.map(function(a){return a.toLowerCase()}),a.replace(/[^\s!-#%-\x2A,-\/:;\x3F@\x5B-\x5D_\x7B}\u00A1\u00A7\u00AB\u00B6\u00B7\u00BB\u00BF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u0AF0\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E3B\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]*/g,function(b,d){var f,g;return b?(f=c.indexOf(b.toLowerCase()),g=f>=0?e[f]:h.indexOf(b.toLowerCase())>=0&&0!==d&&d!==a.length-1?b.toLowerCase():b.charAt(0).toUpperCase()+b.substr(1).toLowerCase()):""}))):""}},{"../core/locale/languages/en_US.coffee":70}],176:[function(a,b,c){var d,e;d=a("./foreign.coffee"),e=a("./tspan.coffee"),b.exports=function(a){a.text.html.value?d(a):e(a)}},{"./foreign.coffee":177,"./tspan.coffee":180}],177:[function(a,b,c){b.exports=function(a){var b,c,d,e,f;f=a.container.value,d=f.attr("font-family")||f.style("font-family"),b=a.align.value||f.attr("text-anchor")||f.style("text-anchor"),c=f.attr("fill")||f.style("fill"),e=f.attr("opacity")||f.style("opacity"),b="end"===b?"right":"middle"===b?"center":"left",d3.select(f.node().parentNode).append("foreignObject").attr("width",a.width.value+"px").attr("height",a.height.value+"px").attr("x","0px").attr("y","0px").append("xhtml:div").style("font-family",d).style("font-size",a.size.value[1]+"px").style("color",c).style("text-align",b).style("opacity",e).text(a.text.current)}},{}],178:[function(a,b,c){b.exports=function(a){var b,c,d,e,f,g,h,i,j,k;if(c=a.container.value,e=c.node().previousElementSibling,g=e?e.tagName.toLowerCase():"",e&&(e=d3.select(e)),a.container.x=a.x.value||parseFloat(c.attr("x"),10),a.container.y=a.y.value||parseFloat(c.attr("y"),10),e&&(a.shape.accepted.indexOf(g)>=0&&a.self.shape(g),"rect"===g?(j=parseFloat(e.attr("x"),10)||0,k=parseFloat(e.attr("y"),10)||0,a.padding.value===!1&&(b=Math.abs(j-a.container.x),b&&a.self.padding(b)),a.container.x||(a.container.x=j+a.padding.value),a.container.y||(a.container.y=k+a.padding.value),a.width.value||(i=parseFloat(e.attr("width")),a.self.width(i)),a.height.value||(d=parseFloat(e.attr("height")),a.self.height(d))):"circle"===g?(f=parseFloat(e.attr("r"),10),j=parseFloat(e.attr("cx"),10)||0,j-=f,k=parseFloat(e.attr("cy"),10)||0,k-=f,a.padding.value===!1&&(b=Math.abs(j-a.container.x),b&&a.self.padding(b)),a.container.x||(a.container.x=j+a.padding.value),a.container.y||(a.container.y=k+a.padding.value),a.width.value||a.self.width(2*f,10),a.height.value||a.self.height(2*f,10)):(a.width.value||a.self.width(500),a.height.value||a.self.height(500))),a.container.x||(a.container.x=0),a.container.y||(a.container.y=0),a.width.inner=a.width.value-2*a.padding.value,a.height.inner=a.height.value-2*a.padding.value,h=c.attr("font-size")||c.style("font-size"),h=parseFloat(h,10),a.container.fontSize=h,a.container.dy=parseFloat(c.attr("dy"),10),!a.size.value)return a.resize.value?a.self.size([4,80]):a.self.size([h/2,h])}},{}],179:[function(a,b,c){b.exports=function(a){var b;if(a.text.value||(b=a.container.value.text(),b&&(b.indexOf("tspan")>=0&&(b.replace(/\<\/tspan\>\<tspan\>/g," "),b.replace(/\<\/tspan\>/g,""),b.replace(/\<tspan\>/g,"")),b=b.replace(/(\r\n|\n|\r)/gm,""),b=b.replace(/^\s+|\s+$/g,""),a.self.text(b))),a.text.value instanceof Array?a.text.phrases=a.text.value.filter(function(a){return["string","number"].indexOf(typeof a)>=0}):a.text.phrases=[a.text.value+""],!a.align.value)return a.container.align=a.container.value.style("text-anchor")||a.container.value.attr("text-anchor")}},{}],180:[function(a,b,c){b.exports=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F;return m=function(b,e){var f;return b||(b=""),f=!p||e?a.container.value.append("tspan"):a.container.value.insert("tspan","tspan"),f.attr("x",D+"px").attr("dx",c+"px").attr("dy",d+"px").style("baseline-shift","0%").attr("dominant-baseline","alphabetic").text(b)},l=a.rotate.value===-90||90===a.rotate.value,A=l?a.height.inner:a.width.inner,
h=l?a.width.inner:a.height.inner,b="circle"===a.shape.value?"middle":a.align.value||a.container.align||"start",c="end"===b?A:"middle"===b?A/2:0,z=a.valign.value||"top",D=a.container.x,f=a.resize.value?a.size.value[1]:a.container.fontSize||a.size.value[0],d=a.container.dy||1.1*f,w=null,o=null,B=null,p=!1,F=0,"circle"===a.shape.value&&("middle"===z?F=h/d%1*d/2:"end"===z&&(F=h/d%1*d)),a.container.value.attr("text-anchor",b).attr("font-size",f+"px").style("font-size",f+"px").attr("x",a.container.x).attr("y",a.container.y),y=function(){if(w.remove(),p?(i++,w=a.container.value.select("tspan")):(i--,w=d3.select(a.container.value.node().lastChild)),!w.empty())return B=w.text().match(/[^\s-]+-?/g),e()},j=function(){var b;return"circle"===a.shape.value?(b=(i-1)*d+F,b>h/2&&(b+=d),2*Math.sqrt(b*(2*(A/2)-b))):A},e=function(){var b,c;return B&&B.length?(c=B.pop(),b=c.charAt(c.length-1),1===c.length&&a.text.split.value.indexOf(c)>=0?e():(a.text.split.value.indexOf(b)>=0&&(c=c.substr(0,c.length-1)),w.text(B.join(" ")+" "+c+"..."),w.node().getComputedTextLength()>j()?e():void 0)):y()},n=function(b){var c,d,e;if(c=w.text(),p?(e=a.text.current.charAt(a.text.current.length-o.length-1),d=" "===e?" ":"",o=b+d+o,w.text(b+d+c)):(e=a.text.current.charAt(o.length),d=" "===e?" ":"",o+=d+b,w.text(c+d+b)),w.node().getComputedTextLength()>j())return w.text(c),w=m(b),p?i--:i++},v=1,i=null,k=null,C=function(){var b,c,e,f,g;for(a.container.value.selectAll("tspan").remove(),a.container.value.html(""),B=a.text.words.slice(0),p&&B.reverse(),o=B[0],w=m(B.shift(),!0),i=v,b=0,c=B.length;b<c;b++){if(g=B[b],i*d>h){y();break}for(n(g),f=!0;f;)e=a.text.current.charAt(o.length+1),f=a.text.split.value.indexOf(e)>=0,f&&n(e)}return i*d>h&&y(),k=Math.abs(i-v)+1},C(),k=i,"circle"===a.shape.value&&(u=h-k*d,u>d&&("middle"===z?(v=(u/d/2>>0)+1,C()):"bottom"===z&&(p=!0,v=h/d>>0,C()))),"top"===z?E=0:(g=k*d,E="middle"===z?h/2-g/2:h-g),E-=.2*d,x="translate(0,"+E+")",180===a.rotate.value||a.rotate.value===-180?(s=a.container.x+A/2,t=a.container.y+h/2):(q=a.rotate.value<0?A:h,s=a.container.x+q/2,t=a.container.y+q/2),r="rotate("+a.rotate.value+", "+s+", "+t+")",a.container.value.attr("transform",r+x)}},{}],181:[function(a,b,c){var d,e,f,g;d=a("./flow.coffee"),e=a("../../font/sizes.coffee"),g=function(a){var b;a.text.phrases.length&&(a.text.current=a.text.phrases.shift()+"",a.text.words=a.text.current.match(a.text.break),b=a.text.current.charAt(0),b!==a.text.words[0].charAt(0)&&(a.text.words[0]=b+a.text.words[0]),a.container.value.text(""),a.resize.value?f(a):d(a))},b.exports=g,f=function(a){var b,c,f,h,i,j,k,l,m,n,o,p,q,r,s,t,u;for(u=[],k=0;k<a.text.words.length;)b=k===a.text.words.length-1?"":" ",u.push(a.text.words[k]+b),k++;n=a.rotate.value===-90||90===a.rotate.value,s=n?a.height.inner:a.width.inner,i=n?a.width.inner:a.height.inner,o=Math.floor(a.size.value[1]),l="circle"===a.shape.value?.75*s:s,q=e(u,{"font-size":o+"px",parent:a.container.value}),m=d3.max(q,function(a){return a.width}),c=1.165+s/i*.11,r=d3.sum(q,function(b){var c;return c=a.container.dy||1.2*o,b.width*c})*c,h="circle"===a.shape.value?Math.PI*Math.pow(s/2,2):l*i,(m>l||r>h)&&(f=Math.sqrt(h/r),t=l/m,p=d3.min([f,t]),o=d3.max([a.size.value[0],Math.floor(o*p)])),j=Math.floor(.8*i),o>j&&(o=j),m*(o/a.size.value[1])<=l?(o!==a.size.value[1]&&a.self.size([a.size.value[0],o]),d(a)):g(a)}},{"../../font/sizes.coffee":101,"./flow.coffee":176}],182:[function(a,b,c){b.exports={accepted:[!1,"start","middle","end","left","center","right"],process:function(a){var b;return b=["left","center","right"].indexOf(a),b>=0&&(a=this.accepted[b+1]),a},value:!1}},{}],183:[function(a,b,c){b.exports={accepted:[Object],objectAccess:!1,process:function(a,b){var c,d;for(c in a)d=a[c],c in b.self&&b.self[c](d);return a},value:{}}},{}],184:[function(a,b,c){var d;d=a("../../util/d3selection.coffee"),b.exports={accepted:[!1,Array,Object,String],element:!1,id:"default",process:function(a){return a!==!1&&(d(a)?a:a instanceof Array?d3.select(a[0][0]):d3.select(a))},value:!1}},{"../../util/d3selection.coffee":207}],185:[function(a,b,c){b.exports={accepted:[Boolean],value:!1}},{}],186:[function(a,b,c){var d,e;d=a("../../core/console/print.coffee"),e=a("../../string/format.js"),b.exports={accepted:[void 0],process:function(a,b){var c;return this.initialized===!1?a:(b.container.value===!1?(c=b.format.locale.value.dev.setContainer,d.warning(c,"container")):b.container.value.empty()?(c=b.format.locale.value.dev.noContainer,d.warning(e(c,'"'+b.container.value+'"'),"container")):(b.dev.value&&d.time("total draw time"),b.container.value.call(b.self)),a)},value:void 0}},{"../../core/console/print.coffee":53,"../../string/format.js":172}],187:[function(a,b,c){var d,e;d=a("../../core/locale/locale.coffee"),e=a("../../object/merge.coffee"),b.exports={accepted:[Function,String],locale:{accepted:function(){return d3.keys(d)},process:function(a){var b,c;return b="en_US",c=d[b],a!==b&&(c=e(c,d[a])),this.language=a,c},value:"en_US"},process:function(a,b){if(this.initialized&&"string"==typeof a)b.self.format({locale:a});else if("function"==typeof a)return a;return this.value},value:"en_US"}},{"../../core/locale/locale.coffee":78,"../../object/merge.coffee":170}],188:[function(a,b,c){b.exports={accepted:[!1,Number],value:!1}},{}],189:[function(a,b,c){b.exports={accepted:[!1,Number],value:!1}},{}],190:[function(a,b,c){b.exports={accepted:[Boolean],value:!1}},{}],191:[function(a,b,c){b.exports={accepted:[-180,-90,0,90,180],value:0}},{}],192:[function(a,b,c){b.exports={accepted:["circle","square"],value:!1}},{}],193:[function(a,b,c){b.exports={accepted:[Array,!1],value:!1}},{}],194:[function(a,b,c){b.exports={accepted:[!1,Array,Number,String],html:{accepted:[Boolean],value:!1},init:function(a){var b;return b=this.split.value,this.break=new RegExp("[^\\s\\"+b.join("\\")+"]+\\"+b.join("?\\")+"?","g"),!1},split:{accepted:[Array],value:["-","/",";",":","&"]}}},{}],195:[function(a,b,c){b.exports={accepted:[!1,"top","middle","bottom"],value:!1}},{}],196:[function(a,b,c){b.exports={accepted:[!1,Number],value:!1}},{}],197:[function(a,b,c){b.exports={accepted:[!1,Number],value:!1}},{}],198:[function(a,b,c){b.exports={accepted:[!1,Number],value:!1}},{}],199:[function(a,b,c){var d,e,f,g,h;d=a("../core/methods/attach.coffee"),f=a("./helpers/parseSize.coffee"),e=a("../core/console/print.coffee"),g=a("./helpers/parseText.coffee"),h=a("./helpers/wrap.coffee"),b.exports=function(){var b;return b={self:function(a){return a.each(function(){f(b),b.size.value[0]<=b.height.inner?(g(b),h(b)):b.container.value.html(""),b.dev.value&&e.timeEnd("total draw time")}),b.self}},d(b,{align:a("./methods/align.coffee"),config:a("./methods/config.coffee"),container:a("./methods/container.coffee"),dev:a("./methods/dev.coffee"),draw:a("./methods/draw.coffee"),format:a("./methods/format.coffee"),height:a("./methods/height.coffee"),padding:a("./methods/padding.coffee"),resize:a("./methods/resize.coffee"),rotate:a("./methods/rotate.coffee"),text:a("./methods/text.coffee"),shape:a("./methods/shape.coffee"),size:a("./methods/size.coffee"),valign:a("./methods/valign.coffee"),width:a("./methods/width.coffee"),x:a("./methods/x.coffee"),y:a("./methods/y.coffee")}),b.self}},{"../core/console/print.coffee":53,"../core/methods/attach.coffee":79,"./helpers/parseSize.coffee":178,"./helpers/parseText.coffee":179,"./helpers/wrap.coffee":181,"./methods/align.coffee":182,"./methods/config.coffee":183,"./methods/container.coffee":184,"./methods/dev.coffee":185,"./methods/draw.coffee":186,"./methods/format.coffee":187,"./methods/height.coffee":188,"./methods/padding.coffee":189,"./methods/resize.coffee":190,"./methods/rotate.coffee":191,"./methods/shape.coffee":192,"./methods/size.coffee":193,"./methods/text.coffee":194,"./methods/valign.coffee":195,"./methods/width.coffee":196,"./methods/x.coffee":197,"./methods/y.coffee":198}],200:[function(a,b,c){function m(){d3.selectAll("div.d3plus_tooltip_data_desc").style("height","0px"),d3.selectAll("div.d3plus_tooltip_data_help").style("background-color","#ccc")}var d=a("../core/locale/languages/en_US.coffee"),e=a("../client/pointer.coffee"),f=a("../color/legible.coffee"),g=a("./move.coffee"),h=a("../client/prefix.coffee"),i=a("../client/rtl.coffee"),j=a("./remove.coffee"),k=a("../string/list.coffee"),l=a("../color/text.coffee");b.exports=function(a){var b=a.fullscreen?250:200,c=h();a.width=a.width||b,a.max_width=a.max_width||386,a.id=a.id||"default",a.size=a.fullscreen||a.html?"large":"small",a.offset=a.offset||0,a.arrow_offset=a.arrow?8:0,a.x=a.x||0,a.y=a.y||0,a.parent=a.parent||d3.select("body"),a.curtain=a.curtain||"#fff",a.curtainopacity=a.curtainopacity||.8,a.background=a.background||"#fff",a.fontcolor=a.fontcolor||"#444",a.fontfamily=a.fontfamily||"sans-serif",a.fontweight=a.fontweight||"normal",a.fontsize=a.fontsize||"12px",a.style=a.style||"default",a.zindex="small"==a.size?2e3:500,a.locale=a.locale||d;var n=a.parent?a.parent.node().offsetHeight||a.parent.node().getBoundingClientRect().height:0;if(a.iconsize||(a.iconsize="small"==a.size?22:50),a.parent.node()===document.body?a.limit=[window.innerWidth+window.scrollX,window.innerHeight+window.scrollY]:a.limit=[parseFloat(a.parent.style("width"),10),parseFloat(a.parent.style("height"),10)],a.title instanceof Array){var o=a.locale.ui.and,p=a.locale.ui.more;a.title=k(a.title,o,3,p)}if(j(a.id),a.anchor={},a.fullscreen)a.anchor.x="center",a.anchor.y="center",a.x=a.parent?a.parent.node().offsetWidth/2:window.innerWidth/2,a.y=a.parent?n/2:window.innerHeight/2;else if(a.align){var q=a.align.split(" ");a.anchor.y=q[0],q[1]?a.anchor.x=q[1]:a.anchor.x="center"}else a.anchor.x="center",a.anchor.y="top";var r=a.width-30;if(a.fullscreen){a.parent.append("div").attr("id","d3plus_tooltip_curtain_"+a.id).attr("class","d3plus_tooltip_curtain").style("background-color",a.curtain).style("opacity",a.curtainopacity).style("position","absolute").style("z-index",499).style("top","0px").style("right","0px").style("bottom","0px").style("left","0px").on(e.click,function(){j(a.id)})}var t=a.parent.append("div").datum(a).attr("id","d3plus_tooltip_id_"+a.id).attr("class","d3plus_tooltip d3plus_tooltip_"+a.size).style("color",a.fontcolor).style("font-family",a.fontfamily).style("font-weight",a.fontweight).style("font-size",a.fontsize+"px").style(c+"box-shadow","0px 1px 3px rgba(0, 0, 0, 0.25)").style("position","absolute").on(e.out,m);a.max_height&&t.style("max-height",a.max_height+"px"),a.fixed?(t.style("z-index",500),a.mouseevents=!0):t.style("z-index",2e3);var u=t.append("div").datum(a).attr("class","d3plus_tooltip_container").style("background-color",a.background).style("padding","6px");if(a.fullscreen&&a.html){w=a.parent?.75*a.parent.node().offsetWidth:.75*window.innerWidth,N=a.parent?.75*n:.75*window.innerHeight,u.style("width",w+"px").style("height",N+"px");var v=u.append("div").attr("class","d3plus_tooltip_body").style("padding-right","6px").style("display","inline-block").style("z-index",1).style("width",a.width+"px")}else{if("auto"==a.width){var w="auto";u.style("max-width",a.max_width+"px")}else var w=a.width-14+"px";var v=u.style("width",w)}if(a.title||a.icon)var x=v.append("div").attr("class","d3plus_tooltip_header").style("position","relative").style("z-index",1);if(a.fullscreen){t.append("div").attr("class","d3plus_tooltip_close").style("background-color",a.color).style("color",l(a.color)).style("position","absolute").style(c+"box-shadow","0 1px 3px rgba(0, 0, 0, 0.25)").style("font-size","20px").style("height","18px").style("line-height","14px").style("text-align","center").style("right","16px").style("top","-10px").style("width","18px").style("z-index",10).html("&times;").on(e.over,function(){d3.select(this).style("cursor","pointer").style(c+"box-shadow","0 1px 3px rgba(0, 0, 0, 0.5)")}).on(e.out,function(){d3.select(this).style("cursor","auto").style(c+"box-shadow","0 1px 3px rgba(0, 0, 0, 0.25)")}).on(e.click,function(){j(a.id)})}if(a.mouseevents){if(a.mouseevents!==!0){var z=d3.select(a.mouseevents).on(e.out),A=function(){var b=d3.event.toElement||d3.event.relatedTarget;if(b)var c="string"==typeof b.className?b.className:b.className.baseVal,d=0==c.indexOf("d3plus_tooltip");else var d=!1;b&&(B(t.node(),b)||B(a.mouseevents,b)||d)||(z(d3.select(a.mouseevents).datum()),m(),d3.select(a.mouseevents).on(e.out,z))},B=function(a,b){for(var c=b.parentNode;null!==c;){if(c==a)return!0;c=c.parentNode}return!1};d3.select(a.mouseevents).on(e.out,A),t.on(e.out,A);var C=d3.select(a.mouseevents).on(e.move);C&&t.on(e.move,C)}}else t.style("pointer-events","none");if(a.arrow){t.append("div").attr("class","d3plus_tooltip_arrow").style("background-color",a.background).style(c+"box-shadow","0px 1px 3px rgba(0, 0, 0, 0.25)").style("position","absolute").style("bottom","-5px").style("height","10px").style("left","50%").style("margin-left","-5px").style("width","10px").style(c+"transform","rotate(45deg)").style("z-index",-1)}if(a.icon){var E=x.append("div").attr("class","d3plus_tooltip_icon").style("width",a.iconsize+"px").style("height",a.iconsize+"px").style("z-index",1).style("background-position","50%").style("background-size","100%").style("background-image","url("+a.icon+")").style("display","inline-block").style("margin","0px 3px 3px 0px");"knockout"==a.style&&E.style("background-color",a.color),r-=E.node().offsetWidth}if(a.title){var F=a.max_width-6;a.icon&&(F-=a.iconsize+6),F+="px";x.append("div").attr("class","d3plus_tooltip_title").style("max-width",F).style("color",a.icon?a.fontcolor:f(a.color)).style("vertical-align","top").style("width",r+"px").style("display","inline-block").style("overflow","hidden").style("text-overflow","ellipsis").style("word-wrap","break-word").style("z-index",1).style("font-size","large"===a.size?"18px":"16px").style("line-height","large"===a.size?"20px":"17px").style("padding","large"===a.size?"3px 6px":"3px").text(a.title)}if(a.description){v.append("div").attr("class","d3plus_tooltip_description").style("font-size","12px").style("padding","6px").text(a.description)}if(a.data||a.html&&!a.fullscreen)var I=v.append("div").attr("class","d3plus_tooltip_data_container").style("overflow-y","auto").style("z-index",-1);if(a.data){var J=0,K={},L=null;a.data.forEach(function(b,d){b.group&&L!=b.group&&(L=b.group,I.append("div").attr("class","d3plus_tooltip_data_title").style("font-size","12px").style("font-weight","bold").style("padding","6px 3px 0px 3px").text(b.group));var g=I.append("div").attr("class","d3plus_tooltip_data_block").style("font-size","12px").style("padding","3px 6px").style("position","relative").datum(b);b.highlight===!0?g.style("color",f(a.color)):(b.allColors||b.highlight!==a.color)&&g.style("color",f(b.highlight));var j=g.append("div").attr("class","d3plus_tooltip_data_name").style("display","inline-block").html(b.name).on(e.out,function(){d3.event.stopPropagation()});if(b.link&&j.style("cursor","pointer").on(e.click,b.link),b.value instanceof Array){var k=a.locale.ui.and,l=a.locale.ui.more;b.value=list(b.value,k,3,l)}var n=g.append("div").attr("class","d3plus_tooltip_data_value").style("display","block").style("position","absolute").style("text-align","right").style("top","3px").html(b.value).on(e.out,function(){d3.event.stopPropagation()});if(i?n.style("left","6px"):n.style("right","6px"),a.mouseevents&&b.desc){var o=g.append("div").attr("class","d3plus_tooltip_data_desc").style("color","#888").style("overflow","hidden").style(c+"transition","height 0.5s").style("width","85%").text(b.desc).on(e.out,function(){d3.event.stopPropagation()}),p=o.node().offsetHeight||o.node().getBoundingClientRect().height;o.style("height","0px");var q=j.append("div").attr("class","d3plus_tooltip_data_help").style("background-color","#ccc").style(c+"border-radius","5px").style("color","#fff").style("cursor","pointer").style("display","inline-block").style("font-size","8px").style("font-weight","bold").style("height","10px").style("margin","3px 0px 0px 3px").style("padding-right","1px").style("text-align","center").style("width","10px").style("vertical-align","top").style(h+"transition","background-color 0.5s").text("?").on(e.over,function(){var a=d3.select(this.parentNode.parentNode).style("color");d3.select(this).style("background-color",a),o.style("height",p+"px")}).on(e.out,function(){d3.event.stopPropagation()});j.style("cursor","pointer").on(e.over,function(){m();var a=d3.select(this.parentNode).style("color");q.style("background-color",a),o.style("height",p+"px")}),g.on(e.out,function(){d3.event.stopPropagation(),m()})}var r=parseFloat(n.style("width"),10);r>a.width/2&&(r=a.width/2),r>J&&(J=r),d!=a.data.length-1&&(b.group&&b.group==a.data[d+1].group||!b.group&&!a.data[d+1].group)&&I.append("div").attr("class","d3plus_tooltip_data_seperator").style("background-color","#ddd").style("display","block").style("height","1px").style("margin","0px 3px")}),I.selectAll(".d3plus_tooltip_data_name").style("width",function(){var a=parseFloat(d3.select(this.parentNode).style("width"),10);return a-J-30+"px"}),I.selectAll(".d3plus_tooltip_data_value").style("width",J+"px").each(function(a){var b=parseFloat(d3.select(this).style("height"),10);K[a.name]=b}),I.selectAll(".d3plus_tooltip_data_name").style("min-height",function(a){return K[a.name]+"px"})}a.html&&!a.fullscreen&&(I.append("div").html(a.html),a.js&&a.js(u));var M=v.append("div").attr("class","d3plus_tooltip_footer").style("font-size","10px").style("position","relative").style("text-align","center");if(a.footer&&M.html(a.footer),a.height=t.node().offsetHeight||t.node().getBoundingClientRect().height,a.html&&a.fullscreen){var N=a.height-12,w=t.node().offsetWidth-a.width-44;u.append("div").attr("class","d3plus_tooltip_html").style("width",w+"px").style("height",N+"px").style("display","inline-block").style("vertical-align","top").style("overflow-y","auto").style("padding","0px 12px").style("position","absolute").html(a.html),a.js&&a.js(u)}if(a.width=t.node().offsetWidth,"center"!=a.anchor.y?a.height+=a.arrow_offset:a.width+=a.arrow_offset,a.data||!a.fullscreen&&a.html){if(a.fullscreen)var N=a.height;else var O=a.fixed?n-a.y-10:n-10,N=a.height<O?a.height:O;N-=parseFloat(u.style("padding-top"),10),N-=parseFloat(u.style("padding-bottom"),10),x&&(N-=x.node().offsetHeight||x.node().getBoundingClientRect().height,N-=parseFloat(x.style("padding-top"),10),N-=parseFloat(x.style("padding-bottom"),10)),M&&(N-=M.node().offsetHeight||M.node().getBoundingClientRect().height,N-=parseFloat(M.style("padding-top"),10),N-=parseFloat(M.style("padding-bottom"),10)),I.style("max-height",N+"px")}a.height=t.node().offsetHeight||t.node().getBoundingClientRect().height,g(a.x,a.y,a.id)}},{"../client/pointer.coffee":40,"../client/prefix.coffee":41,"../client/rtl.coffee":42,"../color/legible.coffee":45,"../color/text.coffee":51,"../core/locale/languages/en_US.coffee":70,"../string/list.coffee":173,"./move.coffee":201,"./remove.coffee":202}],201:[function(a,b,c){var d;b.exports=function(a,b,c){var e,f,g;return c||(c="default"),g=d3.select("div#d3plus_tooltip_id_"+c),g.node()&&(e=g.datum(),e.cx=a,e.cy=b,e.fixed||(f="body"===e.parent.node().tagName.toLowerCase()?[window.scrollX,window.scrollY]:[0,0],"center"!==e.anchor.y?("right"===e.anchor.x?e.x=e.cx-e.arrow_offset-4:"center"===e.anchor.x?e.x=e.cx-e.width/2:"left"===e.anchor.x&&(e.x=e.cx-e.width+e.arrow_offset+2),"bottom"===e.anchor.y?e.flip=e.cy+e.height+e.offset<=e.limit[1]:"top"===e.anchor.y&&(e.flip=e.cy-e.height-e.offset<f[1]),e.flip?e.y=e.cy+e.offset+e.arrow_offset:e.y=e.cy-e.height-e.offset-e.arrow_offset):(e.y=e.cy-e.height/2,"right"===e.anchor.x?e.flip=e.cx+e.width+e.offset<=e.limit[0]:"left"===e.anchor.x&&(e.flip=e.cx-e.width-e.offset<f[0]),"center"===e.anchor.x?(e.flip=!1,e.x=e.cx-e.width/2):e.flip?e.x=e.cx+e.offset+e.arrow_offset:e.x=e.cx-e.width-e.offset),e.x<f[0]?e.x=f[0]:e.x+e.width>e.limit[0]&&(e.x=e.limit[0]-e.width),e.y<f[1]?e.y=f[1]:e.y+e.height>e.limit[1]&&(e.y=e.limit[1]-e.height)),g.style("top",e.y+"px").style("left",e.x+"px"),e.arrow&&g.selectAll(".d3plus_tooltip_arrow").call(d)),g},d=function(a){return a.style("bottom",function(a){return"center"===a.anchor.y||a.flip?"auto":"-5px"}).style("right",function(a){return"center"!==a.anchor.y||a.flip?"auto":"-5px"}).style("top",function(a){return"center"!==a.anchor.y&&a.flip?"-5px":"center"===a.anchor.y?"50%":"auto"}).style("left",function(a){return"center"===a.anchor.y&&a.flip?"-5px":"center"!==a.anchor.y?"50%":"auto"}).style("margin-left",function(a){var b;return"center"===a.anchor.y?"auto":(b="right"===a.anchor.x?-a.width/2+a.arrow_offset/2:"left"===a.anchor.x?a.width/2-2*a.arrow_offset-5:-5,a.cx-a.width/2-5<b?(b=a.cx-a.width/2-5,b<2-a.width/2&&(b=2-a.width/2)):-(a.limit[0]-a.cx-a.width/2+5)>b&&(b=-(a.limit[0]-a.cx-a.width/2+5),b>a.width/2-11&&(b=a.width/2-11)),b+"px")}).style("margin-top",function(a){var b;return"center"!==a.anchor.y?"auto":(b="bottom"===a.anchor.y?-a.height/2+a.arrow_offset/2-1:"top"===a.anchor.y?a.height/2-2*a.arrow_offset-2:-9,a.cy-a.height/2-a.arrow_offset<b?(b=a.cy-a.height/2-a.arrow_offset,b<4-a.height/2&&(b=4-a.height/2)):-(a.limit[1]-a.cy-a.height/2+a.arrow_offset)>b&&(b=-(a.limit[1]-a.cy-a.height/2+a.arrow_offset),b>a.height/2-22&&(b=a.height/2-22)),b+"px")})}},{}],202:[function(a,b,c){b.exports=function(a){return a?(d3.selectAll("div#d3plus_tooltip_curtain_"+a).remove(),d3.selectAll("div#d3plus_tooltip_id_"+a).remove()):(d3.selectAll("div.d3plus_tooltip_curtain").remove(),d3.selectAll("div.d3plus_tooltip").remove())}},{}],203:[function(a,b,c){b.exports=function(a,b){var c,d;return c=[],d=1/(b-1)*(a[1]-a[0]),d3.range(a[0],a[1]+d,d)}},{}],204:[function(a,b,c){var d;d=a("./d3selection.coffee"),b.exports=function(a,b){var c;if(!a||!b)return!1;for(d(a)&&(a=a.node()),d(a)&&(b=b.node()),c=b.parentNode;null!==c;){if(c===a)return!0;c=c.parentNode}return!1}},{"./d3selection.coffee":207}],205:[function(a,b,c){b.exports=function(a,b){var c;return c=a[0],a.forEach(function(a){if(Math.abs(b-a)<Math.abs(b-c))return c=a}),c}},{}],206:[function(a,b,c){var d,e,f;e=a("../object/merge.coffee"),f=a("../object/validate.coffee"),d=function(a){var b;return f(a)?e(a):a instanceof Array?(b=[],a.forEach(function(a){return b.push(d(a))}),b):a},b.exports=d},{"../object/merge.coffee":170,"../object/validate.coffee":171}],207:[function(a,b,c){var d;d=a("../client/ie.js"),b.exports=function(a){return d?"object"==typeof a&&a instanceof Array&&"size"in a&&"select"in a:a instanceof d3.selection}},{"../client/ie.js":39}],208:[function(a,b,c){b.exports=function(a,b){var c;c=new Image,c.src=a,c.crossOrigin="Anonymous",c.onload=function(){var a,c;a=document.createElement("canvas"),a.width=this.width,a.height=this.height,c=a.getContext("2d"),c.drawImage(this,0,0),b.call(this,a.toDataURL("image/png")),a=null}}},{}],209:[function(a,b,c){var d,e;d=a("../object/validate.coffee"),e=function(a,b,c,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u;if(void 0===a)return[];if(f&&void 0===g&&(g=f.id.value),a instanceof Array||(a=[a]),q=[],void 0===b)return a.reduce(function(a,b){var c;return c=JSON.stringify(b),q.indexOf(c)<0&&(a.indexOf(b)<0&&a.push(b),q.push(c)),a},[]);if(u=[],h=function(a){var b;if(void 0!==a&&null!==a&&(b=JSON.stringify(a),q.indexOf(b)<0))return u.push(a),q.push(b)},"function"==typeof c&&f)for(j=0,m=a.length;j<m;j++)for(i=a[j],t=e(c(f,i,b,g)),k=0,n=t.length;k<n;k++)s=t[k],h(s);else if("function"==typeof b)for(l=0,o=a.length;l<o;l++)i=a[l],t=b(i),h(t);else for(r=0,p=a.length;r<p;r++)i=a[r],d(i)&&(t=i[b],h(t));return u.sort(function(a,b){return a-b})},b.exports=e},{"../object/validate.coffee":171}],210:[function(a,b,c){b.exports=function(a){var b,c,d,e,f;for(a.container.value.style("position",function(){var a,b;return a=d3.select(this).style("position"),b=["absolute","fixed"].indexOf(a)>=0,b?a:"relative"}).html(""),e=["width","height"],c=0,d=e.length;c<d;c++)f=e[c],a[f].value||(b=function(c){var d,e;return void 0===c.tagName||["BODY","HTML"].indexOf(c.tagName)>=0?(e=window["inner"+f.charAt(0).toUpperCase()+f.slice(1)],d=document!==c&&d3.select(c),d&&("width"===f?(e-=parseFloat(d.style("margin-left"),10),e-=parseFloat(d.style("margin-right"),10),e-=parseFloat(d.style("padding-left"),10),e-=parseFloat(d.style("padding-right"),10)):(e-=parseFloat(d.style("margin-top"),10),e-=parseFloat(d.style("margin-bottom"),10),e-=parseFloat(d.style("padding-top"),10),e-=parseFloat(d.style("padding-bottom"),10))),a[f].value=e<=20?a[f].small:e):(e=parseFloat(d3.select(c).style(f),10),"number"==typeof e&&e>0?a[f].value=e:"BODY"!==c.tagName?b(c.parentNode):void 0)},b(a.container.value.node()),1===d3.selectAll("body > *:not(script)").size()&&d3.select("body").style("overflow","hidden"));a.container.value.style("width",a.width.value+"px").style("height",a.height.value+"px")}},{}],211:[function(a,b,c){var d=a("../../core/data/format.js"),e=a("../../core/data/color.js"),f=a("../../core/data/keys.coffee"),g=a("../../core/data/load.coffee"),h=a("./ui/drawer.js"),i=a("./ui/legend.js"),j=a("./ui/timeline.coffee"),k=a("./errorCheck.js"),l=a("../../core/fetch/data.js"),m=a("./finish.js"),n=a("./focus/tooltip.coffee"),o=a("./focus/viz.js"),p=a("./ui/history.coffee"),q=a("../../core/parse/edges.js"),r=a("../../core/parse/nodes.js"),s=a("../../core/console/print.coffee"),t=a("../../tooltip/remove.coffee"),u=a("./types/run.coffee"),v=a("./shapes/draw.js"),w=a("../../string/format.js"),x=a("./svg/enter.js"),y=a("./svg/update.js"),z=a("./ui/titles.js"),A=a("../../object/validate.coffee");b.exports=function(a){var b=[],c=a.type.value,B=a.format.locale.value,C=B.message.ui,D=B.message.draw,E=["data","attrs","coords","nodes","edges"];if(E.forEach(function(c){a.error.value||a[c].loaded||!a[c].url||b.push({function:function(a,b){g(a,c,b)},message:B.message.loading,wait:!0})}),a.draw.update){var F=B.visualization[c]||c,G=a.types[c].setup||!1,H=a.types[c].requirements||[],I=w(B.message.initializing,F),J=B.message.data;H instanceof Array||(H=[H]),F=F.toLowerCase(),a.error.value||"function"!=typeof G||b.push({function:function(a){if(a.dev.value){var b="running "+F+" setup";s.time(b)}G(a),a.dev.value&&s.timeEnd(b)},message:I}),a.container.changed&&b.push({function:x,message:I}),c in a.g.apps||b.push({function:function(a){if(a.dev.value){var b="creating "+F+" group";s.time(b)}a.g.apps[c]=a.g.app.selectAll("g#"+c).data([c]),a.g.apps[c].enter().append("g").attr("id",c).attr("opacity",0),a.dev.value&&s.timeEnd(b)},message:I}),a.data.changed&&b.push({function:function(a){a.data.cache={},delete a.nodes.restricted,delete a.edges.restricted,f(a,"data")},message:J}),a.attrs.changed&&b.push({function:function(a){f(a,"attrs")},message:J}),b.push({function:function(a){if(!a.color.type||a.color.changed||a.data.changed||a.attrs.changed||a.id.changed||a.depth.changed||a.time.fixed.value&&(a.time.solo.changed||a.time.mute.changed)){if(a.color.valueScale=!1,a.dev.value){var b="checking color type";s.time(b)}if(a.color.type=!1,a.color.value){var c=a.color.value;A(c)&&(c=c[a.id.value]?c[a.id.value]:c[d3.keys(c)[0]]),a.data.keys&&c in a.data.keys?a.color.type=a.data.keys[c]:a.attrs.keys&&c in a.attrs.keys&&(a.color.type=a.attrs.keys[c])}else a.data.keys&&(a.color.type=a.data.keys[a.id.value]);a.dev.value&&s.timeEnd(b)}},message:J}),H.indexOf("edges")>=0&&a.edges.value&&(!a.edges.linked||a.edges.changed)&&b.push({function:q,message:J}),H.indexOf("nodes")>=0&&a.edges.value&&(!a.nodes.positions||a.nodes.changed)&&b.push({function:r,message:J}),(a.data.changed||a.time.changed||a.time.format.changed||a.id.changed||a.x.scale.changed&&[a.x.scale.value,a.x.scale.previous].indexOf("discrete")>=0||a.y.scale.changed&&[a.y.scale.value,a.y.scale.previous].indexOf("discrete")>=0)&&b.push({function:d,message:J}),a.error.value||b.push({function:function(a){var b=a.time.fixed.value?null:["all"];if(a.dev.value){var c=b?"fetching pool data":"fetching data";s.time(c)}a.data.pool=l(a,b),a.dev.value&&s.timeEnd(c),b?(a.dev.value&&s.time("fetching data for current year"),a.data.viz=l(a),a.dev.value&&s.timeEnd("fetching data for current year")):a.data.viz=a.data.pool,a.draw.timing=a.data.viz.length<a.data.large?a.timing.transitions:0},message:J}),a.error.value||b.push({check:function(a){return a.color.value&&"number"===a.color.type&&a.color.valueScale===!1},function:e,message:J})}return b.push({function:function(a){if(a.dev.value){var b=a.format.locale.value.message.tooltipReset;s.time(b)}a.type.previous&&c!==a.type.previous&&t(a.type.previous),t(c),a.dev.value&&s.timeEnd(b)},message:C}),a.error.value||b.push({function:k,message:C}),b.push({function:function(a){if(a.margin.process(),z(a),!a.error.value)if(a.draw.update)h(a),j(a),i(a);else{a.dev.value&&s.time("calculating margins");var b=a.container.value.select("div#d3plus_drawer").node().offsetHeight||a.container.value.select("div#d3plus_drawer").node().getBoundingClientRect().height,c=a.g.timeline.node().getBBox();c=a.timeline.value?c.height+a.ui.padding:0;var d=a.g.legend.node().getBBox();d=a.legend.value?d.height+a.ui.padding:0,a.margin.bottom+=b+c+d,a.dev.value&&s.timeEnd("calculating margins")}p(a),a.height.viz-=a.margin.top+a.margin.bottom,a.width.viz-=a.margin.left+a.margin.right},message:C}),a.error.value||b.push({function:n,message:C}),b.push({function:y,message:D}),!a.error.value&&a.draw.update&&b.push({function:[u,v],message:D}),b.push({function:[o,m],message:D}),b}},{"../../core/console/print.coffee":53,"../../core/data/color.js":55,"../../core/data/format.js":57,"../../core/data/keys.coffee":59,"../../core/data/load.coffee":60,"../../core/fetch/data.js":65,"../../core/parse/edges.js":94,"../../core/parse/nodes.js":97,"../../object/validate.coffee":171,"../../string/format.js":172,"../../tooltip/remove.coffee":202,"./errorCheck.js":212,"./finish.js":213,"./focus/tooltip.coffee":214,"./focus/viz.js":215,"./shapes/draw.js":224,"./svg/enter.js":235,"./svg/update.js":236,"./types/run.coffee":239,"./ui/drawer.js":240,"./ui/history.coffee":241,"./ui/legend.js":242,"./ui/timeline.coffee":244,"./ui/titles.js":245}],212:[function(a,b,c){var d=a("../../core/fetch/text.js"),e=a("../../core/console/print.coffee"),f=a("../../core/methods/rejected.coffee"),g=a("../../string/format.js"),h=a("../../string/list.coffee");b.exports=function(a){a.dev.value&&e.time("checking for errors");var b=["id"],c=a.types[a.type.value].requirements;c&&(c instanceof Array?b=b.concat(a.types[a.type.value].requirements):b.push(c));var i=[];if(b.forEach(function(b){if("string"==typeof b)a[b].value||i.push('"'+b+'"');else if("function"==typeof b){var c=b(a);!c.status&&c.text&&i.push('"'+c.text+'"')}}),i.length>1){var j=a.format.locale.value.error.methods,k=a.format.locale.value.visualization[a.type.value]||a.type.value,l=a.format.locale.value.ui.and;i=h(i,l),a.error.internal=g(j,k,i)}else if(1===i.length){var j=a.format.locale.value.error.method,k=a.format.locale.value.visualization[a.type.value]||a.type.value;a.error.internal=g(j,k,i[0])}if(!a.error.internal&&b.indexOf("edges")>=0&&b.indexOf("focus")>=0){var m=a.edges.connections(a.focus.value[0],a.id.value);if(0==m.length){var n=d(a,a.focus.value[0],a.depth.value),j=a.format.locale.value.error.connections;a.error.internal=g(j,'"'+n+'"')}}var b=["d3"];a.types[a.type.value].libs&&(b=b.concat(a.types[a.type.value].libs));var i=[];if(b.forEach(function(a){window[a]||i.push('"'+a+'"')}),i.length>1){var j=a.format.locale.value.error.libs,k=a.format.locale.value.visualization[a.type.value],l=a.format.locale.value.ui.and;i=h(i,l),a.error.internal=g(j,k,i)}else if(1===i.length){var j=a.format.locale.value.error.lib,k=a.format.locale.value.visualization[a.type.value];a.error.internal=g(j,k,i[0])}var o=a.shape.accepted(a);o instanceof Array||(o=[o]);var p=a.shape.value;if(p&&!f(a,o,p,"shape")||a.self.shape(o[0]),"modes"in a.types[a.type.value]){var q=a.types[a.type.value].modes;q instanceof Array||(q=[q]);var r=a.type.mode.value;r&&!f(a,q,r,"mode")||a.self.type({mode:q[0]})}a.dev.value&&e.timeEnd("checking for errors")}},{"../../core/console/print.coffee":53,"../../core/fetch/text.js":67,"../../core/methods/rejected.coffee":90,
"../../string/format.js":172,"../../string/list.coffee":173}],213:[function(a,b,c){var d=a("./shapes/edges.js"),e=a("./ui/message.js"),f=a("../../core/methods/reset.coffee"),g=a("../../core/console/print.coffee"),h=a("./shapes/labels.js"),i=a("../../string/title.coffee"),j=a("./zoom/bounds.coffee"),k=a("./zoom/labels.coffee"),l=a("./zoom/mouse.coffee");b.exports=function(a){if(!a.error.value){var b=a.zoom.viewport||a.zoom.bounds;a.types[a.type.value].zoom&&a.zoom.value&&b?(a.dev.value&&g.time("calculating zoom"),a.draw.first||a.zoom.reset?j(a,b,0):(a.type.changed||a.focus.changed||a.height.changed||a.width.changed||a.nodes.changed||a.legend.changed||a.timeline.changed||a.ui.changed)&&j(a,b),a.dev.value&&g.timeEnd("calculating zoom")):(a.zoom.bounds=[[0,0],[a.width.viz,a.height.viz]],a.zoom.scale=1,j(a))}var c=a.zoom.size?a.zoom.size.width:a.width.viz,m=a.zoom.size?a.zoom.size.height:a.height.viz,n=a.zoom.bounds?a.zoom.bounds[0][0]:0,o=a.zoom.bounds?a.zoom.bounds[0][1]:0;if(a.g.overlay.attr("width",c).attr("height",m).attr("x",n).attr("y",o),a.error.value||(a.draw.update?(d(a),h(a,"data"),a.edges.label&&setTimeout(function(){h(a,"edges")},a.draw.timing+200)):a.types[a.type.value].zoom&&a.zoom.value&&a.draw.timing&&setTimeout(function(){k(a)},a.draw.timing)),!a.error.value){var p=a.types[a.type.value].requirements||[];p instanceof Array||(p=[p]);var q=p.indexOf("data")>=0;a.error.internal||a.data.viz&&a.returned.nodes.length||!q||(a.error.internal=a.format.locale.value.error.data)}var r=a.type.previous;if(r&&a.type.value!=r&&a.g.apps[r]&&(a.dev.value&&g.time('hiding "'+r+'"'),a.draw.timing?a.g.apps[r].transition().duration(a.draw.timing).attr("opacity",0):a.g.apps[r].attr("opacity",0),a.dev.value&&g.timeEnd()),!a.error.value){var s=q&&0===a.data.viz.length||a.error.internal||a.error.value?0:a.focus.value.length&&a.types[a.type.value].zoom&&a.zoom.value?1-a.tooltip.curtain.opacity:1,t=a.draw.timing;a.group.transition().duration(t).attr("opacity",s),a.g.data.transition().duration(t).attr("opacity",s),a.g.edges.transition().duration(t).attr("opacity",s)}a.error.value?e(a,a.error.value):a.error.internal?(a.error.internal=i(a.error.internal),g.warning(a.error.internal),e(a,a.error.internal),a.error.internal=null):e(a),setTimeout(function(){f(a),a.types[a.type.value].zoom&&a.zoom.value?(a.g.zoom.datum(a).call(a.zoom.behavior.on("zoom",l)),a.zoom.scroll.value||a.g.zoom.on("mousewheel.zoom",null).on("MozMousePixelScroll.zoom",null).on("wheel.zoom",null),a.zoom.click.value||a.g.zoom.on("dblclick.zoom",null),a.zoom.pan.value||a.g.zoom.on("mousedown.zoom",null).on("mousemove.zoom",null)):a.g.zoom.call(a.zoom.behavior.on("zoom",null)).on("dblclick.zoom",null).on("mousedown.zoom",null).on("mousemove.zoom",null).on("mousewheel.zoom",null).on("MozMousePixelScroll.zoom",null).on("touchstart.zoom",null).on("wheel.zoom",null)},a.draw.timing)}},{"../../core/console/print.coffee":53,"../../core/methods/reset.coffee":92,"../../string/title.coffee":175,"./shapes/edges.js":225,"./shapes/labels.js":227,"./ui/message.js":243,"./zoom/bounds.coffee":246,"./zoom/labels.coffee":248,"./zoom/mouse.coffee":249}],214:[function(a,b,c){var d,e,f,g;d=a("../tooltip/create.js"),e=a("../../../core/fetch/value.coffee"),f=a("../../../core/console/print.coffee"),g=a("../../../tooltip/remove.coffee"),b.exports=function(a){var b,c,h;c=a.focus,!a.error.internal&&1===c.value.length&&c.value.length&&!a.small&&c.tooltip.value?(a.dev.value&&f.time("drawing focus tooltip"),b=a.data.pool.filter(function(b){return e(a,b,a.id.value)===c.value[0]}),b.length>=1?b=b[0]:(b={},b[a.id.value]=c.value[0]),h=a.labels.padding,d({anchor:"top left",arrow:!1,data:b,fullscreen:!1,id:"visualization_focus",length:"long",maxheight:a.height.viz-2*h,mouseevents:!0,offset:0,vars:a,width:a.tooltip.large,x:a.width.value-a.margin.right-h,y:a.margin.top+h}),a.width.viz-=a.tooltip.large+2*h,a.dev.value&&f.timeEnd("drawing focus tooltip")):g("visualization_focus")}},{"../../../core/console/print.coffee":53,"../../../core/fetch/value.coffee":68,"../../../tooltip/remove.coffee":202,"../tooltip/create.js":237}],215:[function(a,b,c){var d=a("../../../client/pointer.coffee"),f=a("../../../client/ie.js"),g=a("../../../core/fetch/value.coffee"),h=a("../../../core/console/print.coffee"),i=a("../../../util/uniques.coffee");b.exports=function(a){if(a.g.edge_focus.selectAll("g").remove(),a.g.data_focus.selectAll("g").remove(),a.focus.value.length&&a.types[a.type.value].zoom&&a.zoom.value){a.dev.value&&h.time("drawing focus elements");var b=a.g.edges.selectAll("g");if(b.size()>0){b.each(function(b){var c=b[a.edges.source][a.id.value],d=b[a.edges.target][a.id.value];if(c==a.focus.value[0]||d==a.focus.value[0]){var e=a.g.edge_focus.node().appendChild(this.cloneNode(!0));d3.select(e).datum(b).attr("opacity",1).selectAll("line, path").datum(b)}});var c=a.edges.arrows.value;a.g.edge_focus.selectAll("line, path").attr("vector-effect","non-scaling-stroke").style("stroke",a.color.focus).style("stroke-width",function(){return f&&a.types[a.type.value].zoom?0:a.edges.size.value?d3.select(this).style("stroke-width"):2*a.data.stroke.width}).attr("marker-start",function(b){var d=a.edges.arrows.direction.value;if("bucket"in b.d3plus)var e="_"+b.d3plus.bucket;else var e="";return"source"==d&&c?"url(#d3plus_edge_marker_focus"+e+")":"none"}).attr("marker-end",function(b){var d=a.edges.arrows.direction.value;if("bucket"in b.d3plus)var e="_"+b.d3plus.bucket;else var e="";return"target"==d&&c?"url(#d3plus_edge_marker_focus"+e+")":"none"}),a.g.edge_focus.selectAll("text").style("fill",a.color.focus)}var j=i(a.edges.connections(a.focus.value[0],a.id.value,!0),a.id.value,g,a);j.push(a.focus.value[0]);var k=[],l=[],m=[0],n=[0];a.g.data.selectAll("g").each(function(b){if(j.indexOf(b[a.id.value])>=0){var c=a.g.data_focus.node().appendChild(this.cloneNode(!0)),c=d3.select(c).datum(b).attr("opacity",1);"coordinates"==a.shape.value?a.zoom.viewport=a.path.bounds(a.zoom.coords[b.d3plus.id]):"d3plus"in b&&("x"in b.d3plus&&k.push(b.d3plus.x),"y"in b.d3plus&&l.push(b.d3plus.y),"r"in b.d3plus?(m.push(b.d3plus.r),n.push(b.d3plus.r)):("width"in b.d3plus&&m.push(b.d3plus.width/2),"height"in b.d3plus&&n.push(b.d3plus.height/2)));for(e in d){var f=d3.select(this).on(d[e]);f&&c.on(d[e],f)}}});if(k.length&&l.length){var p=d3.extent(k),q=d3.extent(l),r=d3.max(m),s=d3.max(n);a.zoom.viewport=[[p[0]-r,q[0]-s],[p[1]+r,q[1]+s]]}a.g.data_focus.selectAll("path").style("stroke-width",f&&a.types[a.type.value].zoom?0:2*a.data.stroke.width),a.dev.value&&h.timeEnd("drawing focus elements")}else a.zoom.viewport=!1}},{"../../../client/ie.js":39,"../../../client/pointer.coffee":40,"../../../core/console/print.coffee":53,"../../../core/fetch/value.coffee":68,"../../../util/uniques.coffee":209}],216:[function(a,b,c){var d,e,f,g;g=a("./style.coffee"),e=a("../../../geom/largestRect.coffee"),f=a("../../../geom/path2poly.coffee"),d={start:{},end:{}},b.exports=function(a,b,c,h){var i,j,k,l;i=d3.svg.arc().innerRadius(0).outerRadius(function(a){return a.d3plus.r}).startAngle(function(a){return a.d3plus.startAngle}).endAngle(function(a){return a.d3plus.endAngle}),k=function(b){var c,d;return a.labels.value&&(b.d3plus.label?b.d3plus_label=b.d3plus.label:(c=f(i(b)),d=e(c,{angle:0}),d[0]?b.d3plus_label={w:d[0].width,h:d[0].height,x:d[0].cx,y:d[0].cy}:delete b.d3plus_label)),[b]},a.draw.timing?(l=d3.svg.arc().innerRadius(0).outerRadius(function(a){return a.d3plus.r}).startAngle(function(a){return void 0===d.start[a.d3plus.id]&&(d.start[a.d3plus.id]=0),isNaN(d.start[a.d3plus.id])&&(d.start[a.d3plus.id]=a.d3plus.startAngle),d.start[a.d3plus.id]}).endAngle(function(a){return void 0===d.end[a.d3plus.id]&&(d.end[a.d3plus.id]=0),isNaN(d.end[a.d3plus.id])&&(d.end[a.d3plus.id]=a.d3plus.endAngle),d.end[a.d3plus.id]}),j=function(a,b){return a.attrTween("d",function(a){var c,e,f,g;return void 0===b?(g=a.d3plus.startAngle,c=a.d3plus.endAngle):0===b&&(g=0,c=0),f=d3.interpolate(d.start[a.d3plus.id],g),e=d3.interpolate(d.end[a.d3plus.id],c),function(b){return d.start[a.d3plus.id]=f(b),d.end[a.d3plus.id]=e(b),l(a)}})},c.append("path").attr("class","d3plus_data").call(g,a).attr("d",l),b.selectAll("path.d3plus_data").data(k).transition().duration(a.draw.timing).call(g,a).call(j),h.selectAll("path.d3plus_data").transition().duration(a.draw.timing).call(j,0)):(c.append("path").attr("class","d3plus_data"),b.selectAll("path.d3plus_data").data(k).call(g,a).attr("d",i))}},{"../../../geom/largestRect.coffee":159,"../../../geom/path2poly.coffee":161,"./style.coffee":231}],217:[function(a,b,c){var d=a("../../../core/fetch/text.js"),e=a("../../../font/sizes.coffee"),f=a("../../../geom/largestRect.coffee"),g=a("./style.coffee");b.exports=function(a,b,c,h){var i=d3.svg.area().x(function(a){return a.d3plus.x}).y0(function(a){return a.d3plus.y0}).y1(function(a){return a.d3plus.y}).interpolate(a.shape.interpolate.value),j=d3.svg.area().x(function(a){return a.d3plus.x}).y0(function(a){return a.d3plus.y0}).y1(function(a){return a.d3plus.y0}).interpolate(a.shape.interpolate.value);c.append("path").attr("class","d3plus_data").attr("d",function(a){return j(a.values)}).call(g,a);var k={"font-weight":a.labels.font.weight,"font-family":a.labels.font.family.value};b.selectAll("path.d3plus_data").data(function(b){if(a.labels.value&&b.values.length>1){var c=d3.max(b.values,function(a){return a.d3plus.y0-a.d3plus.y}),g=!1;if(c>a.labels.font.size){var h=[],i=[],j=d(a,b);b.values.forEach(function(a){h.push([a.d3plus.x,a.d3plus.y]),i.push([a.d3plus.x,a.d3plus.y0])}),h=h.concat(i.reverse());var l=null;if(j.length){var m=e(j[0],k);l=m[0].width/m[0].height}g=f(h,{angle:d3.range(-70,71,1),aspectRatio:l,tolerance:0})}if(g&&g[0]){var n={w:~~g[0].width,h:~~g[0].height,x:~~g[0].cx,y:~~g[0].cy,angle:g[0].angle*-1,padding:2,names:j};0!==g[0].angle?n.translate={x:n.x,y:n.y}:n.translate=!1,n.w>=10&&n.h>=10&&(b.d3plus_label=n)}}return[b]}),a.draw.timing?b.selectAll("path.d3plus_data").transition().duration(a.draw.timing).attr("d",function(a){return i(a.values)}).call(g,a):b.selectAll("path.d3plus_data").attr("d",function(a){return i(a.values)}).call(g,a)}},{"../../../core/fetch/text.js":67,"../../../font/sizes.coffee":101,"../../../geom/largestRect.coffee":159,"./style.coffee":231}],218:[function(a,b,c){var f=(a("../../../core/fetch/text.js"),a("../../../geom/largestRect.coffee"),a("./style.coffee"));b.exports=function(a,b,c,d){function e(a){a.attr("transform","scale(1)")}function g(a){a.attr("transform",function(a){var b=Math.min(a.d3plus.width,a.d3plus.height),c=Math.floor(b/16);return"scale("+c+")"})}c.append("path").attr("class","d3plus_data").attr("d","M5-6.844L3.594-5.407L-2,0.188l-1.594-1.594L-5-2.844L-7.844,0l1.438,1.406l3,3L-2,5.843l1.406-1.438l7-7L7.844-4L5-6.844z").call(e).call(f,a),b.selectAll("path.d3plus_data").data(function(a){return[a]}),a.draw.timing?b.selectAll("path.d3plus_data").transition().duration(a.draw.timing).call(g).call(f,a):b.selectAll("path.d3plus_data").call(g).call(f,a)}},{"../../../core/fetch/text.js":67,"../../../geom/largestRect.coffee":159,"./style.coffee":231}],219:[function(a,b,c){var d,e,f,g;e=a("../../../core/fetch/value.coffee"),d=a("../../../core/fetch/color.coffee"),f=a("../../../color/lighter.coffee"),g=a("./segments.coffee"),b.exports=function(a,b,c){var e,h,i,j;return h=a.d3plus.shape||b.shape.value,"line"===b.shape.value&&"circle"!==h?"none":"area"===b.shape.value||"active"===h||"line"===b.shape.value?d(b,a):"temp"===h?c?d(b,a):"url(#d3plus_hatch_"+a.d3plus.id+")":a.d3plus.static?f(d(b,a),.75):(e=g(b,a,"active"),i=g(b,a,"temp"),j=g(b,a,"total"),!b.active.value&&!b.temp.value||e===!0||e&&j&&e>=j&&!i||e&&!j?d(b,a):b.active.spotlight.value?"#eee":f(d(b,a),.75))}},{"../../../color/lighter.coffee":46,"../../../core/fetch/color.coffee":64,"../../../core/fetch/value.coffee":68,"./segments.coffee":230}],220:[function(a,b,c){var d,e,f,g,h,i,j,k;d=a("../../../util/copy.coffee"),e=a("../../../network/distance.coffee"),f=a("../../../core/fetch/text.js"),g=a("../../../font/sizes.coffee"),i=a("../../../geom/largestRect.coffee"),j=a("../../../geom/path2poly.coffee"),k=a("./style.coffee"),h={},b.exports=function(a,b,c,l){var m,n;return m=d3.geo[a.coords.projection.value]().center(a.coords.center),a.zoom.scale||(a.zoom.scale=1),a.zoom.area=1/a.zoom.scale/a.zoom.scale,a.path=d3.geo.path().projection(m),c.append("path").attr("id",function(a){return a.id}).attr("class","d3plus_data").attr("d",a.path).call(k,a),a.draw.timing?b.selectAll("path.d3plus_data").transition().duration(a.draw.timing).call(k,a):b.selectAll("path.d3plus_data").call(k,a),n=a.old_height!==a.height.viz||a.height.changed||a.old_width!==a.width.viz||a.width.changed,a.old_height=a.height.viz,a.old_width=a.width.viz,a.coords.changed||n||a.coords.mute.changed||a.coords.solo.changed||a.type.changed?(a.zoom.bounds=null,a.zoom.reset=!0,a.zoom.coords={},b.each(function(b){var c,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E;if(b.geometry.coordinates.length>1){for(r=[],k=[],c=0,E=d(b),u=d(b),b.geometry.coordinates=b.geometry.coordinates.filter(function(b,d){var e;return E.geometry.coordinates=[b],e=a.path.area(E),e>0&&(k.push(e),e>c&&(u.geometry.coordinates=[b],c=e),!0)}),n=a.path.centroid(u),A=d(b),B=b.geometry.coordinates,s=t=0,v=B.length;t<v;s=++t)m=B[s],E.geometry.coordinates=[m],r.push(e(a.path.centroid(E),n));q=r.reduce(function(a,b,c){return b&&a.push(k[c]/b),a},[]),p=d3.quantile(q,a.coords.threshold.value),A.geometry.coordinates=A.geometry.coordinates.filter(function(a,b){var c,d;return d=r[b],c=k[b],0===d||c/d>p}),o=u.geometry.coordinates[0],o&&"MultiPolygon"===u.geometry.type&&(o=o[0],u.geometry.coordinates[0]=o,u.geometry.type="Polygon")}else A=b,u=b,o=b.geometry.coordinates[0];return a.zoom.coords[b.d3plus.id]=A,l=a.path.bounds(A),w=f(a,b),delete b.d3plus_label,o&&w.length&&(x=j(a.path(u)),D={"font-weight":a.labels.font.weight,"font-family":a.labels.font.family.value},y=null,1===w[0].split(" ").length&&(C=g(w[0],D)[0],y=C.width/C.height),z=i(x,{angle:0,aspectRatio:y}),z&&(z=z[0],b.d3plus_label={anchor:"middle",valign:"center",h:z.height,w:z.width,x:z.cx,y:z.cy,names:w})),h[b.id]=b.d3plus_label,a.zoom.bounds?(a.zoom.bounds[0][0]>l[0][0]&&(a.zoom.bounds[0][0]=l[0][0]),a.zoom.bounds[0][1]>l[0][1]&&(a.zoom.bounds[0][1]=l[0][1]),a.zoom.bounds[1][0]<l[1][0]&&(a.zoom.bounds[1][0]=l[1][0]),a.zoom.bounds[1][1]<l[1][1]?a.zoom.bounds[1][1]=l[1][1]:void 0):a.zoom.bounds=l})):a.focus.value.length?void 0:(a.zoom.viewport=!1,b.each(function(a){return a.d3plus_label=h[a.id]}))}},{"../../../core/fetch/text.js":67,"../../../font/sizes.coffee":101,"../../../geom/largestRect.coffee":159,"../../../geom/path2poly.coffee":161,"../../../network/distance.coffee":164,"../../../util/copy.coffee":206,"./style.coffee":231}],221:[function(a,b,c){var d=a("./style.coffee");b.exports=function(a,b,c,e){function f(a){a.attr("d",d3.svg.symbol().type("cross").size(10))}function g(a){a.attr("d",d3.svg.symbol().type("cross").size(function(a){var b=Math.min(a.d3plus.width,a.d3plus.height);return d3.scale.pow().exponent(2)(b/2)}))}c.append("path").attr("class","d3plus_data").call(f).call(d,a),b.selectAll("path.d3plus_data").data(function(a){return[a]}),a.draw.timing?b.selectAll("path.d3plus_data").transition().duration(a.draw.timing).call(g).call(d,a):b.selectAll("path.d3plus_data").call(g).call(d,a)}},{"./style.coffee":231}],222:[function(a,b,c){var d=a("./style.coffee");b.exports=function(a,b,c,e){function f(a){a.attr("d",d3.svg.symbol().type("diamond").size(10))}function g(a){a.attr("d",d3.svg.symbol().type("diamond").size(function(a){var b=Math.min(a.d3plus.width,a.d3plus.height);return d3.scale.pow().exponent(2)(b/2)}))}c.append("path").attr("class","d3plus_data").call(f).call(d,a),b.selectAll("path.d3plus_data").data(function(a){return[a]}),a.draw.timing?b.selectAll("path.d3plus_data").transition().duration(a.draw.timing).call(g).call(d,a):b.selectAll("path.d3plus_data").call(g).call(d,a)}},{"./style.coffee":231}],223:[function(a,b,c){var d=a("./style.coffee");b.exports=function(a,b,c,e){function g(b,c,d,e){if(!c)var c=0;if("number"!=typeof d)var d=void 0;if("number"!=typeof e)var e=void 0;b.attrTween("d",function(b){if(void 0==d)var g=b.d3plus.r?b.d3plus.r:d3.max([b.d3plus.width,b.d3plus.height]);else var g=d;if(void 0==e)var h=b.d3plus.segments[b.d3plus.shape];else var h=e;a.arcs[b.d3plus.shape][b.d3plus.id]||(a.arcs[b.d3plus.shape][b.d3plus.id]={r:0},a.arcs[b.d3plus.shape][b.d3plus.id].a=2*Math.PI);var i=d3.interpolate(a.arcs[b.d3plus.shape][b.d3plus.id].r,g+c),j=d3.interpolate(a.arcs[b.d3plus.shape][b.d3plus.id].a,h);return function(c){return a.arcs[b.d3plus.shape][b.d3plus.id].r=i(c),a.arcs[b.d3plus.shape][b.d3plus.id].a=j(c),f(b)}})}function h(a){return a.d3plus.label?a.d3plus_label=a.d3plus.label:delete a.d3plus_label,[a]}a.arcs||(a.arcs={donut:{},active:{},temp:{}});var f=d3.svg.arc().startAngle(0).endAngle(function(b){var c=a.arcs[b.d3plus.shape][b.d3plus.id].a;return c>2*Math.PI?2*Math.PI:c}).innerRadius(function(b){if(b.d3plus.static)return 0;var c=a.arcs[b.d3plus.shape][b.d3plus.id].r;return c*a.data.donut.size}).outerRadius(function(b){return a.arcs[b.d3plus.shape][b.d3plus.id].r});a.draw.timing?(e.selectAll("path.d3plus_data").transition().duration(a.draw.timing).call(g,0,0).each("end",function(b){delete a.arcs[b.d3plus.shape][b.d3plus.id]}),b.selectAll("path.d3plus_data").data(h).transition().duration(a.draw.timing).call(g).call(d,a),c.append("path").attr("class","d3plus_data").transition().duration(0).call(g,0,0).call(d,a).transition().duration(a.draw.timing).call(g).call(d,a)):(e.selectAll("path.d3plus_data").each(function(b){delete a.arcs[b.d3plus.shape][b.d3plus.id]}),c.append("path").attr("class","d3plus_data"),b.selectAll("path.d3plus_data").data(h).call(g).call(d,a))}},{"./style.coffee":231}],224:[function(a,b,c){var d=a("../../../util/child.coffee"),e=a("../../../util/closest.coffee"),f=a("../tooltip/create.js"),g=a("../../../client/pointer.coffee"),h=a("../../../core/fetch/value.coffee"),i=a("../../../core/fetch/color.coffee"),j=a("../../../core/fetch/text.js"),k=a("../../../color/legible.coffee"),l=a("../../../core/console/print.coffee"),m=a("../../../tooltip/remove.coffee"),n=a("./segments.coffee"),o=a("./fill.js"),p=a("../../../string/strip.js"),q=a("../../../client/touch.coffee"),r=a("../zoom/propagation.coffee"),s=a("../../../util/uniques.coffee"),t=a("../../../object/validate.coffee"),u=a("../zoom/direction.coffee"),v={arc:a("./arc.coffee"),area:a("./area.js"),check:a("./check.js"),coordinates:a("./coordinates.coffee"),cross:a("./cross.js"),diamond:a("./diamond.js"),donut:a("./donut.js"),line:a("./line.js"),rect:a("./rect.coffee"),triangle_down:a("./triangle_down.js"),triangle_up:a("./triangle_up.js"),whisker:a("./whisker.coffee")};b.exports=function(a){function y(b){if(!b.d3plus.id){b.d3plus.id="";for(var c=0;c<=a.depth.value;c++)b.d3plus.id+=h(a,b,a.id.nesting[c])+"_";b.d3plus.id+=E,["x","y"].forEach(function(c){if("discrete"==a[c].scale.value){var d=h(a,b,a[c].value);d.constructor===Date&&(d=d.getTime()),b.d3plus.id+="_"+d}}),b.d3plus.id=p(b.d3plus.id)}return b}function z(b,c){var d=a.types[a.type.value].scale,e=1;d&&(t[d]&&a.shape.value in d?e=d[a.shape.value]:"function"==typeof d?e=d(a,a.shape.value):"number"==typeof d&&(e=d)),e=c?e:1,b.attr("transform",function(a){if(["line","area","coordinates"].indexOf(E)<0){var b=a.d3plus.x||0,c=a.d3plus.y||0;return"translate("+b+","+c+")scale("+e+")"}return"scale("+e+")"})}function J(b){if(b&&a.g.edges.selectAll("g").size()>0){a.g.edge_hover.selectAll("*").remove(),a.g.edges.selectAll("g").each(function(c){var d=b[a.id.value],e=c[a.edges.source][a.id.value],f=c[a.edges.target][a.id.value];if(e==d||f==d){var g=a.g.edge_hover.node().appendChild(this.cloneNode(!0));d3.select(g).datum(c).attr("opacity",1).selectAll("line, path").datum(c)}});var c=a.edges.arrows.value;a.g.edge_hover.attr("opacity",0).selectAll("line, path").style("stroke",a.color.primary).style("stroke-width",function(){return a.edges.size.value?d3.select(this).style("stroke-width"):2*a.data.stroke.width}).attr("marker-start",function(b){var d=a.edges.arrows.direction.value;if("bucket"in b.d3plus)var e="_"+b.d3plus.bucket;else var e="";return"source"==d&&c?"url(#d3plus_edge_marker_highlight"+e+")":"none"}).attr("marker-end",function(b){var d=a.edges.arrows.direction.value;if("bucket"in b.d3plus)var e="_"+b.d3plus.bucket;else var e="";return"target"==d&&c?"url(#d3plus_edge_marker_highlight"+e+")":"none"}),a.g.edge_hover.selectAll("text").style("fill",a.color.primary),a.draw.timing?(a.g.edge_hover.transition().duration(a.timing.mouseevents).attr("opacity",1),a.g.edges.transition().duration(a.timing.mouseevents).attr("opacity",.5)):a.g.edge_hover.attr("opacity",1)}else a.draw.timing?(a.g.edge_hover.transition().duration(a.timing.mouseevents).attr("opacity",0).transition().selectAll("*").remove(),a.g.edges.transition().duration(a.timing.mouseevents).attr("opacity",1)):a.g.edge_hover.selectAll("*").remove()}var b=a.returned.nodes||[],c=a.returned.edges||[];a.draw.timing=b.length<a.data.large&&c.length<a.edges.large?a.timing.transitions:0;var w={arc:"arc",area:"area",check:"check",circle:"rect",coordinates:"coordinates",cross:"cross",donut:"donut",diamond:"diamond",line:"line",plus:"cross",rect:"rect",square:"rect",triangle_down:"triangle_down",triangle:"triangle_up",triangle_up:"triangle_up",whisker:"whisker"},x={};b.forEach(function(b){var c=b.d3plus&&b.d3plus.shape?b.d3plus.shape:a.shape.value;c in w&&(b.d3plus&&(b.d3plus.shape=c),c=w[c],x[c]||(x[c]=[]),x[c].push(b))});for(var A in w)if(!(w[A]in x)||0===d3.keys(x).length){var B=a.g.data.selectAll("g.d3plus_"+w[A]);a.draw.timing?B.transition().duration(a.draw.timing).attr("opacity",0).remove():B.remove()}for(var E in x){var F=a.g.data.selectAll("g.d3plus_"+E).data(x[E],function(b){if(b.d3plus||(b.d3plus={}),"coordinates"===E)return b.d3plus.id=b.id,b.id;if(!b.d3plus.id)if(b.values)b.values.forEach(function(a){a=y(a),a.d3plus.shape="circle"}),b.d3plus.id=b.key;else if(b=y(b),!b.d3plus.segments){b.d3plus.segments={donut:2*Math.PI};var c=n(a,b,"active"),d=n(a,b,"temp"),e=n(a,b,"total");e&&(c?b.d3plus.segments.active=c/e*(2*Math.PI):b.d3plus.segments.active=0,d?b.d3plus.segments.temp=d/e*(2*Math.PI)+b.d3plus.segments.active:b.d3plus.segments.temp=0)}return!!b.d3plus&&b.d3plus.id});if(a.draw.timing)var G=F.exit().transition().duration(a.draw.timing).attr("opacity",0).remove();else var G=F.exit().remove();a.draw.timing?F.transition().duration(a.draw.timing).call(z):F.call(z);var H=a.draw.timing?0:1,I=F.enter().append("g").attr("class","d3plus_"+E).attr("opacity",H).call(z);a.draw.timing&&I.transition().duration(a.draw.timing).attr("opacity",1),F.order(),a.dev.value&&l.time('drawing "'+E+'" shapes'),v[E](a,F,I,G,z),a.dev.value&&l.timeEnd('drawing "'+E+'" shapes'),["rect","donut"].indexOf(E)>=0&&a.types[a.type.value].fill&&(a.dev.value&&l.time('filling "'+E+'" shapes'),o(a,F,I,G,z),a.dev.value&&l.timeEnd('filling "'+E+'" shapes'))}if(J(),!q&&a.tooltip.value)a.g.data.selectAll("g").on(g.over,function(b){if(!(a.draw.frozen||b.d3plus&&b.d3plus.static)){if(d3.select(this).style("cursor","pointer").transition().duration(a.timing.mouseevents).call(z,!0),d3.select(this).selectAll(".d3plus_data").transition().duration(a.timing.mouseevents).attr("opacity",1),a.covered=!1,b.values&&a.axes.discrete){var c="x"===a.axes.discrete?0:1,d=d3.mouse(a.container.value.node())[c],h=s(b.values,function(b){return b.d3plus[a.axes.discrete]}),i=e(h,d);b.d3plus_data=b.values[h.indexOf(i)],b.d3plus=b.values[h.indexOf(i)].d3plus}var j=b.d3plus_data?b.d3plus_data:b;f({vars:a,data:j}),"function"==typeof a.mouse?a.mouse(b.d3plus_data||b,a):a.mouse[g.over]&&a.mouse[g.over](b.d3plus_data||b,a),J(b)}}).on(g.move,function(b){if(!(a.draw.frozen||b.d3plus&&b.d3plus.static)){a.types[a.type.value].tooltip||"follow";if(b.values&&a.axes.discrete){var d="x"===a.axes.discrete?0:1,h=d3.mouse(a.container.value.node())[d],i=s(b.values,function(b){return b.d3plus[a.axes.discrete]}),j=e(i,h);b.d3plus_data=b.values[i.indexOf(j)],b.d3plus=b.values[i.indexOf(j)].d3plus}var k=b.d3plus_data?b.d3plus_data:b;f({vars:a,data:k}),"function"==typeof a.mouse?a.mouse(b.d3plus_data||b,a):a.mouse[g.move]&&a.mouse[g.move](b.d3plus_data||b,a)}}).on(g.out,function(b){var c=d(this,d3.event.toElement);c||a.draw.frozen||b.d3plus&&b.d3plus.static||(d3.select(this).transition().duration(a.timing.mouseevents).call(z),d3.select(this).selectAll(".d3plus_data").transition().duration(a.timing.mouseevents).attr("opacity",a.data.opacity),a.covered||m(a.type.value),"function"==typeof a.mouse?a.mouse(b.d3plus_data||b,a):a.mouse[g.out]&&a.mouse[g.out](b.d3plus_data||b,a),J())});else{var K=function(){r(a,d3.event)};a.g.data.selectAll("g").on(g.over,K).on(g.move,K).on(g.out,K)}a.g.data.selectAll("g").on(g.click,function(b){if(!(d3.event.defaultPrevented||a.draw.frozen||b.d3plus&&b.d3plus.static)){"function"==typeof a.mouse?a.mouse(b.d3plus_data||b,a):a.mouse[g.out]?a.mouse[g.out](b.d3plus_data||b,a):a.mouse[g.click]&&a.mouse[g.click](b.d3plus_data||b,a);var c=u(b.d3plus_data||b,a),d=a.id.solo.value,e=j(a,b)[0],l=k(i(a,b)),n=a.title.sub.value||!1,o=a.title.sub.font.color,p=a.title.total.font.color;if(b.d3plus.threshold&&b.d3plus.merged&&a.zoom.value)a.history.states.push(function(){a.self.id({solo:d}).title({sub:{font:{color:o},value:n},total:{font:{color:p}}}).draw()}),a.self.id({solo:d.concat(s(b.d3plus.merged,a.id.value,h,a))}).title({sub:{font:{color:l},value:e},total:{font:{color:l}}}).draw();else if(1===c&&a.zoom.value){var q=h(a,b.d3plus_data||b,a.id.value);a.history.states.push(function(){a.self.depth(a.depth.value-1).id({solo:d}).title({sub:{font:{color:o},value:n},total:{font:{color:p}}}).draw()}),a.self.depth(a.depth.value+1).id({solo:d.concat(q)}).title({sub:{font:{color:l},value:e},total:{font:{color:l}}}).draw()}else if(c===-1&&a.zoom.value&&a.history.states.length&&!a.tooltip.value.long)a.history.back();else if(a.types[a.type.value].zoom&&a.zoom.value)J(),d3.select(this).transition().duration(a.timing.mouseevents).call(z),d3.select(this).selectAll(".d3plus_data").transition().duration(a.timing.mouseevents).attr("opacity",a.data.opacity),m(a.type.value),a.draw.update=!1,b&&b[a.id.value]!=a.focus.value[0]?a.self.focus(b[a.id.value]).draw():a.self.focus(!1).draw();else if(a.types[a.type.value].requirements.indexOf("focus")<0){J();var r=b.d3plus_data?b.d3plus_data:b;f({vars:a,data:r})}}})}},{"../../../client/pointer.coffee":40,"../../../client/touch.coffee":44,"../../../color/legible.coffee":45,"../../../core/console/print.coffee":53,"../../../core/fetch/color.coffee":64,"../../../core/fetch/text.js":67,"../../../core/fetch/value.coffee":68,"../../../object/validate.coffee":171,"../../../string/strip.js":174,"../../../tooltip/remove.coffee":202,"../../../util/child.coffee":204,"../../../util/closest.coffee":205,"../../../util/uniques.coffee":209,"../tooltip/create.js":237,"../zoom/direction.coffee":247,"../zoom/propagation.coffee":250,"./arc.coffee":216,"./area.js":217,"./check.js":218,"./coordinates.coffee":220,"./cross.js":221,"./diamond.js":222,"./donut.js":223,"./fill.js":226,"./line.js":228,"./rect.coffee":229,"./segments.coffee":230,"./triangle_down.js":232,"./triangle_up.js":233,"./whisker.coffee":234}],225:[function(a,b,c){var d=a("../../../util/buckets.coffee"),e=a("../../../geom/offset.coffee");b.exports=function(a){function l(b){b.attr("opacity",0).style("stroke-width",0).style("stroke",a.background.value).style("fill","none")}function m(b){var c=a.edges.arrows.value;b.attr("opacity",function(b){return"number"===j?i:"function"===j?i(b,a):k(b[i])}).style("stroke-width",function(b){return a.edges.scale(b[a.edges.size.value])}).style("stroke",a.edges.color).attr("marker-start",function(b){var d=a.edges.arrows.direction.value;if("bucket"in b.d3plus)var e="_"+b.d3plus.bucket;else var e="";return"source"==d&&c?"url(#d3plus_edge_marker_default"+e+")":"none"}).attr("marker-end",function(b){var d=a.edges.arrows.direction.value;if("bucket"in b.d3plus)var e="_"+b.d3plus.bucket;else var e="";return"target"==d&&c?"url(#d3plus_edge_marker_default"+e+")":"none"}).attr("vector-effect","non-scaling-stroke").attr("pointer-events","none")}function n(b){b.attr("x1",function(b){return b[a.edges.source].d3plus.edges[b[a.edges.target][a.id.value]].x}).attr("y1",function(b){return b[a.edges.source].d3plus.edges[b[a.edges.target][a.id.value]].y}).attr("x2",function(b){return b[a.edges.target].d3plus.edges[b[a.edges.source][a.id.value]].x}).attr("y2",function(b){return b[a.edges.target].d3plus.edges[b[a.edges.source][a.id.value]].y})}function p(a){a.attr("d",function(a){return o(a.d3plus.spline)})}function q(b){if(delete b.d3plus_label,a.g.edges.selectAll("line, path").size()<a.edges.large&&a.edges.label&&b[a.edges.label]){if("spline"in b.d3plus)var c=this.getTotalLength(),d=this.getPointAtLength(c/2),e=this.getPointAtLength(c/2-.1*c),f=this.getPointAtLength(c/2+.1*c),g=Math.atan2(f.y-e.y,f.x-e.x),h=g*(180/Math.PI),j=(this.parentNode.getBBox(),.8*c),k=d.x,l=d.y;else var n=(this.getBBox(),b[a.edges.source]),o=b[a.edges.target],p={x:n.d3plus.edges[o[a.id.value]].x,y:n.d3plus.edges[o[a.id.value]].y},q={x:o.d3plus.edges[n[a.id.value]].x,y:o.d3plus.edges[n[a.id.value]].y},r=q.x-p.x,s=q.y-p.y,d={x:q.x-r/2,y:q.y-s/2},g=Math.atan2(s,r),h=g*(180/Math.PI),c=Math.sqrt(r*r+s*s),j=c,k=d.x,l=d.y;j+=2*a.labels.padding;var t=0;a.edges.arrows.value&&(t="number"==typeof a.edges.arrows.value?a.edges.arrows.value:8,t/=a.zoom.behavior.scaleExtent()[1],j-=2*t),(h<-90||h>90)&&(h-=180),j*a.zoom.behavior.scaleExtent()[0]>20&&(b.d3plus_label={x:k,y:l,translate:{x:k,y:l},w:j,h:15+2*a.labels.padding,angle:h,anchor:"middle",valign:"center",color:a.edges.color,resize:!1,names:[a.format.value(b[a.edges.label])],background:1})}}var b=a.returned.edges||[],c=a.zoom.behavior.scaleExtent()[0];if("string"==typeof a.edges.size.value){var f=d3.extent(b,function(b){return b[a.edges.size.value]}),g=d3.min(a.returned.nodes||[],function(a){return a.d3plus.r})*(2*a.edges.size.scale);a.edges.scale=d3.scale.sqrt().domain(f).range([a.edges.size.min,g*c])}else{var h="number"==typeof a.edges.size.value?a.edges.size.value:a.edges.size.min;a.edges.scale=function(){return h}}var i=a.edges.opacity.value,j=typeof i;if(a.edges.opacity.changed&&"string"===j)var k=a.edges.opacity.scale.value.domain(d3.extent(b,function(a){return a[i]})).range([a.edges.opacity.min.value,1]);var o=d3.svg.line().interpolate(a.edges.interpolate.value),r=a.edges.arrows.value?"string"==typeof a.edges.size.value?["default_0","default_1","default_2","highlight_0","highlight_1","highlight_2","focus_0","focus_1","focus_2"]:["default","highlight","focus"]:[];if("string"==typeof a.edges.size.value)for(var s=d(a.edges.scale.range(),4),t=[],u=0;u<3;u++)t.push(s[u+1]+(s[1]-s[0])*(u+2)*2);else var v="number"==typeof a.edges.arrows.value?a.edges.arrows.value:8,t="number"==typeof a.edges.size.value?a.edges.size.value/v:v;var w=a.defs.selectAll(".d3plus_edge_marker").data(r,String),x=function(b){b.attr("d",function(b){var c=b.split("_");if(2==c.length&&a.edges.scale){c=parseInt(c[1]);var d=t[c]}else var d=t;return"target"==a.edges.arrows.direction.value?"M 0,-"+d/2+" L "+.85*d+",0 L 0,"+d/2+" L 0,-"+d/2:"M 0,-"+d/2+" L -"+.85*d+",0 L 0,"+d/2+" L 0,-"+d/2}).attr("fill",function(b){var c=b.split("_")[0];return"default"==c?a.edges.color:"focus"==c?a.color.focus:a.color.primary}).attr("transform","scale("+1/c+")")};a.draw.timing?(w.exit().transition().duration(a.draw.timing).attr("opacity",0).remove(),w.select("path").transition().duration(a.draw.timing).attr("opacity",1).call(x)):(w.exit().remove(),w.select("path").attr("opacity",1).call(x));var y=a.draw.timing?0:1,z=w.enter().append("marker").attr("id",function(a){return"d3plus_edge_marker_"+a}).attr("class","d3plus_edge_marker").attr("orient","auto").attr("markerUnits","userSpaceOnUse").style("overflow","visible").append("path").attr("opacity",y).attr("vector-effect","non-scaling-stroke").call(x);a.draw.timing&&z.transition().duration(a.draw.timing).attr("opacity",1);
var A="string"==typeof a.edges.size.value?d(a.edges.scale.domain(),4):null,B=a.edges.arrows.direction.value,C=b.filter(function(b){if(b.d3plus||(b.d3plus={}),b.d3plus.id="edge_"+b[a.edges.source][a.id.value]+"_"+b[a.edges.target][a.id.value],b.d3plus.spline!==!0){if(A){var d=b[a.edges.size.value];b.d3plus.bucket=d<A[1]?0:d<A[2]?1:2;var f=.85*t[b.d3plus.bucket]/c}else{delete b.d3plus.bucket;var f=.85*t/c}var g=b[a.edges.source],h=b[a.edges.target];if(!g.d3plus||!h.d3plus)return!1;var i=Math.atan2(g.d3plus.y-h.d3plus.y,g.d3plus.x-h.d3plus.x),j=Math.atan2(h.d3plus.y-g.d3plus.y,h.d3plus.x-g.d3plus.x),k="source"==B&&a.edges.arrows.value?g.d3plus.r+f:g.d3plus.r,l="target"==B&&a.edges.arrows.value?h.d3plus.r+f:h.d3plus.r,m=e(i,k,a.shape.value),n=e(j,l,a.shape.value);return"edges"in g.d3plus||(g.d3plus.edges={}),g.d3plus.edges[h[a.id.value]]={x:g.d3plus.x-m.x,y:g.d3plus.y-m.y},"edges"in h.d3plus||(h.d3plus.edges={}),h.d3plus.edges[g[a.id.value]]={x:h.d3plus.x-n.x,y:h.d3plus.y-n.y},!0}return!1}),D=a.g.edges.selectAll("g.d3plus_edge_line").data(C,function(a){return a.d3plus.id}),E=b.filter(function(b){if(b.d3plus.spline){if(A){var d=b[a.edges.size.value];b.d3plus.bucket=d<A[1]?0:d<A[2]?1:2;var f=.85*t[b.d3plus.bucket]/c}else{delete b.d3plus.bucket;var f=.85*t/c}var g=b[a.edges.source],h=b[a.edges.target],i=g.d3plus.edges?g.d3plus.edges[h[a.id.value]]||{}:{},j=h.d3plus.edges?h.d3plus.edges[g[a.id.value]]||{}:{},k=a.edges.arrows.value&&"source"==B?f:0,l=a.edges.arrows.value&&"target"==B?f:0,m=.1,n=g.d3plus.x>h.d3plus.x?1-m:1+m,o=g.d3plus.x>h.d3plus.x?1+m:1-m,p="number"==typeof i.angle?i.angle:Math.atan2(g.d3plus.y-h.d3plus.y,g.d3plus.x-h.d3plus.x)*n,q=e(p,g.d3plus.r+k,a.shape.value),r="number"==typeof j.angle?j.angle:Math.atan2(h.d3plus.y-g.d3plus.y,h.d3plus.x-g.d3plus.x)*o,s=e(r,h.d3plus.r+l,a.shape.value),u=[g.d3plus.x-q.x,g.d3plus.y-q.y],v=!!i.offset&&e(p,i.offset),w=v?[u[0]-v.x,u[1]-v.y]:u,x=[h.d3plus.x-s.x,h.d3plus.y-s.y],y=!!j.offset&&e(r,j.offset),z=y?[x[0]-y.x,x[1]-y.y]:x,C=z[0]-w[0],D=z[1]-w[1],E="number"==typeof i.radius?i.radius:Math.sqrt(C*C+D*D)/4,F="number"==typeof j.radius?j.radius:Math.sqrt(C*C+D*D)/4,G=e(p,E-g.d3plus.r-2*k),H=e(r,F-h.d3plus.r-2*l);b.d3plus.spline=[u,x];var I=Math.abs(Math.atan2(g.d3plus.y-h.d3plus.y,g.d3plus.x-h.d3plus.x)).toFixed(5),J=Math.abs(p).toFixed(5),K=Math.abs(r-Math.PI).toFixed(5);return(J!==K||[J,K].indexOf(I)<0)&&(b.d3plus.spline.splice(1,0,[w[0]-G.x,w[1]-G.y],[z[0]-H.x,z[1]-H.y]),v&&b.d3plus.spline.splice(1,0,w),y&&b.d3plus.spline.splice(b.d3plus.spline.length-1,0,z)),!0}return!1}),F=a.g.edges.selectAll("g.d3plus_edge_path").data(E,function(a){return a.d3plus.id});a.draw.timing?(D.exit().transition().duration(a.draw.timing).attr("opacity",0).remove(),F.exit().transition().duration(a.draw.timing).attr("opacity",0).remove(),D.selectAll("text.d3plus_label, rect.d3plus_label_bg").transition().duration(a.draw.timing/2).attr("opacity",0).remove(),F.selectAll("text.d3plus_label, rect.d3plus_label_bg").transition().duration(a.draw.timing/2).attr("opacity",0).remove(),D.selectAll("line").data(function(a){return[a]}).transition().duration(a.draw.timing).call(n).call(m).each("end",q),F.selectAll("path").data(function(a){return[a]}).transition().duration(a.draw.timing).call(p).call(m).each("end",q),D.enter().append("g").attr("class","d3plus_edge_line").append("line").call(n).call(l).transition().duration(a.draw.timing).call(m).each("end",q),F.enter().append("g").attr("class","d3plus_edge_path").append("path").call(p).call(l).transition().duration(a.draw.timing).call(m).each("end",q)):(D.exit().remove(),F.exit().remove(),D.selectAll("text.d3plus_label, rect.d3plus_label_bg").remove(),F.selectAll("text.d3plus_label, rect.d3plus_label_bg").remove(),D.selectAll("line").data(function(a){return[a]}).call(n).call(m).call(q),F.selectAll("path").data(function(a){return[a]}).call(p).call(m).call(q),D.enter().append("g").attr("class","d3plus_edge_line").append("line").call(n).call(l).call(m).call(q),F.enter().append("g").attr("class","d3plus_edge_path").append("path").call(p).call(l).call(m).call(q))}},{"../../../geom/offset.coffee":160,"../../../util/buckets.coffee":203}],226:[function(a,b,c){var d=a("../../../util/copy.coffee"),e=a("../../../core/fetch/color.coffee"),g=(a("../../../core/fetch/value.coffee"),a("./segments.coffee")),h=a("./style.coffee");b.exports=function(a,b,c,f){function i(a){a.attr("x",0).attr("y",0).attr("width",0).attr("height",0)}function j(b,c){c||(c=0),b.attr("x",function(a){var b=a.d3plus.r?2*a.d3plus.r:a.d3plus.width;return-b/2-c/2}).attr("y",function(a){var b=a.d3plus.r?2*a.d3plus.r:a.d3plus.height;return-b/2-c/2}).attr("width",function(a){var b=a.d3plus.r?2*a.d3plus.r:a.d3plus.width;return b+c}).attr("height",function(a){var b=a.d3plus.r?2*a.d3plus.r:a.d3plus.height;return b+c}).attr("rx",function(b){var d=b.d3plus.r?2*b.d3plus.r:b.d3plus.width,e=["circle","donut"].indexOf(a.shape.value)>=0;return e?(d+c)/2:0}).attr("ry",function(b){var d=b.d3plus.r?2*b.d3plus.r:b.d3plus.height,e=["circle","donut"].indexOf(a.shape.value)>=0;return e?(d+c)/2:0}).attr("shape-rendering",function(b){return["square"].indexOf(a.shape.value)>=0?a.shape.rendering.value:"auto"})}function l(b,c,d,e){c||(c=0),"number"!=typeof d&&(d=void 0),"number"!=typeof e&&(e=void 0),b.attrTween("d",function(b){if(void 0===d)var f=b.d3plus.r?b.d3plus.r:d3.max([b.d3plus.width,b.d3plus.height]);else var f=d;if(void 0===e)var g=b.d3plus.segments[b.d3plus.shape];else var g=e;a.arcs[b.d3plus.shape][b.d3plus.id]||(a.arcs[b.d3plus.shape][b.d3plus.id]={r:0},a.arcs[b.d3plus.shape][b.d3plus.id].a="donut"===b.d3plus.shape?2*Math.PI:0);var h=d3.interpolate(a.arcs[b.d3plus.shape][b.d3plus.id].r,f+c),i=d3.interpolate(a.arcs[b.d3plus.shape][b.d3plus.id].a,g);return function(c){return a.arcs[b.d3plus.shape][b.d3plus.id].r=h(c),a.arcs[b.d3plus.shape][b.d3plus.id].a=i(c),k(b)}})}a.arcs||(a.arcs={donut:{},active:{},temp:{}});var k=d3.svg.arc().startAngle(0).endAngle(function(b){var c=a.arcs[b.d3plus.shape][b.d3plus.id].a;return c>2*Math.PI?2*Math.PI:c}).innerRadius(function(b){if(b.d3plus.static||"donut"!==a.shape.value)return 0;var c=a.arcs[b.d3plus.shape][b.d3plus.id].r;return c*a.data.donut.size}).outerRadius(function(b){var c=a.arcs[b.d3plus.shape][b.d3plus.id].r;return"donut"===a.shape.value?c:2*c});b.each(function(b){function r(b){b.attr("stroke",n).attr("stroke-width",1).attr("shape-rendering",a.shape.rendering.value)}var c=g(a,b,"active"),f=g(a,b,"temp"),k=g(a,b,"total"),m=d3.select(this),n=e(a,b),o=[],p=[];if(k&&a.types[a.type.value].fill){if(f){var q=d(b);q.d3plus.shape="temp",o.push(q),p=["temp"]}if(c&&(c<k||f)){var q=d(b);q.d3plus.shape="active",o.push(q)}}var s=a.defs.selectAll("pattern#d3plus_hatch_"+b.d3plus.id).data(p);a.draw.timing?(s.selectAll("rect").transition().duration(a.draw.timing).style("fill",n),s.selectAll("line").transition().duration(a.draw.timing).style("stroke",n)):(s.selectAll("rect").style("fill",n),s.selectAll("line").style("stroke",n));var t=s.enter().append("pattern").attr("id","d3plus_hatch_"+b.d3plus.id).attr("patternUnits","userSpaceOnUse").attr("x","0").attr("y","0").attr("width","10").attr("height","10").append("g");t.append("rect").attr("x","0").attr("y","0").attr("width","10").attr("height","10").attr("fill",n).attr("fill-opacity",.25),t.append("line").attr("x1","0").attr("x2","10").attr("y1","0").attr("y2","10").call(r),t.append("line").attr("x1","-1").attr("x2","1").attr("y1","9").attr("y2","11").call(r),t.append("line").attr("x1","9").attr("x2","11").attr("y1","-1").attr("y2","1").call(r);var u=o.length?[b]:[],v=m.selectAll("#d3plus_clip_"+b.d3plus.id).data(u);v.enter().insert("clipPath",".d3plus_mouse").attr("id","d3plus_clip_"+b.d3plus.id).append("rect").attr("class","d3plus_clipping").call(i),a.draw.timing?(v.selectAll("rect").transition().duration(a.draw.timing).call(j),v.exit().transition().delay(a.draw.timing).remove()):(v.selectAll("rect").call(j),v.exit().remove());var w=m.selectAll("path.d3plus_fill").data(o);w.transition().duration(a.draw.timing).call(h,a).call(l),w.enter().insert("path","rect.d3plus_mouse").attr("class","d3plus_fill").attr("clip-path","url(#d3plus_clip_"+b.d3plus.id+")").transition().duration(0).call(h,a).call(l,0,void 0,0).transition().duration(a.draw.timing).call(l).call(h,a),w.exit().transition().duration(a.draw.timing).call(l,0,void 0,0).remove()})}},{"../../../core/fetch/color.coffee":64,"../../../core/fetch/value.coffee":68,"../../../util/copy.coffee":206,"./segments.coffee":230,"./style.coffee":231}],227:[function(a,b,c){var d=a("../../../util/copy.coffee"),e=a("../../../core/fetch/text.js"),f=a("../../../core/fetch/value.coffee"),g=a("../../../color/mix.coffee"),h=a("../../../core/console/print.coffee"),j=(a("../../../client/rtl.coffee"),a("./segments.coffee")),k=a("./color.coffee"),l=a("../../../string/list.coffee"),m=a("../../../color/text.coffee"),n=a("../../../textwrap/textwrap.coffee");b.exports=function(a,b){var c=a.types[a.type.value].zoom?a.zoom.behavior.scaleExtent():[1,1],i=a.g[b].selectAll("g"),o=function(b){b.attr("opacity",function(b){var d=parseFloat(d3.select(this).attr("font-size"),10);return b.visible=d*(a.zoom.scale/c[1])>=2,b.visible?1:0})};if(remove=function(b){a.draw.timing?b.transition().duration(a.draw.timing).attr("opacity",0).remove():b.remove()},style=function(b){var d="bottom"===a.labels.valign.value?"top":"bottom";b.attr("font-weight",a.labels.font.weight).attr("font-family",a.labels.font.family.value).attr("pointer-events",function(a){return a.mouse?"auto":"none"}).attr("fill",function(b){if(b.color)return b.color;var c=k(b.parent,a),d=m(c),e=b.text?.15:1;return g(c,d,.2,e)}).each(function(b){if(b.resize instanceof Array){b.resize[0],b.resize[1]}var g=b.resize,h=!0;if(b.text){g instanceof Array||(g=[9,50],h=b.resize);var i=b.y-b.h*c[1]/2+b.padding/2;"bottom"===d&&(i+=b.h*c[1]/2),n().align("center").container(d3.select(this)).height(b.h*c[1]/2).padding(b.padding/2).resize(h).size(g).text(a.format.value(100*b.text,{key:"share",vars:a})).width(b.w*c[1]).valign(d).x(b.x-b.w*c[1]/2+b.padding/2).y(i).draw()}else{b.resize instanceof Array||(g=[7,40*(c[1]/c[0])],h=b.resize);var j="bottom"===a.labels.valign.value?b.share:0;n().align(b.anchor||a.labels.align.value).container(d3.select(this)).height(b.h*c[1]-b.share).padding(b.padding/2).resize(h).size(g).shape(b.shape||"square").text(b.names).valign(a.labels.valign.value).width(b.w*c[1]).x(b.x-b.w*c[1]/2+b.padding/2).y(b.y-b.h*c[1]/2+b.padding/2+j).draw()}}).attr("transform",function(a){var b=d3.select(this).attr("transform")||"",d=a.angle||0,e=a.translate&&a.translate.x?a.translate.x:0,f=a.translate&&a.translate.y?a.translate.y:0;return b.length&&(b=b.split(")").slice(-3).join(")")),"rotate("+d+","+e+","+f+")scale("+1/c[1]+")translate("+(a.x*c[1]-a.x)+","+(a.y*c[1]-a.y)+")"+b})},"edges"===b||a.labels.value){if(a.dev.value){var p="drawing "+b+" labels";h.time(p)}i.each(function(b){function E(b){var d="string"==typeof h.background?h.background:"none"===a.background.value?"#ffffff":a.background.value,e="string"==typeof h.background?h.background:d,f=h.angle||0,g=h.translate?A.x+A.width/2:0,i=h.translate?A.y+A.height/2:0,j="scale("+1/c[1]+")rotate("+f+","+g+","+i+")";b.attr("fill",e).attr(A).attr("transform",j)}var g=b.d3plus&&"label"in b.d3plus&&!b.d3plus.label,h=b.d3plus_label||null,i=b.d3plus_share,k=b.d3plus.text?b.d3plus.text:h&&h.names?h.names:a.labels.text.value?f(a,b,a.labels.text.value):e(a,b),m=h&&"group"in h?h.group:d3.select(this),n=0,p=a.types[a.type.value].fill;if(k instanceof Array||(k=[k]),h)if(["line","area"].indexOf(a.shape.value)>=0)var q=!0;else if(b&&"d3plus"in b)var r=j(a,b,"active"),s=j(a,b,"temp"),t=j(a,b,"total"),q=!s&&!r||r>=t||!r&&s>=t;if(g||!(h&&h.force||q)&&p)delete b.d3plus_label,d3.select(this).selectAll("text#d3plus_label_"+b.d3plus.id+", rect#d3plus_label_bg_"+b.d3plus.id).call(remove),a.g.labels.selectAll("text#d3plus_label_"+b.d3plus.id+", rect#d3plus_label_bg_"+b.d3plus.id).call(remove);else{if(i&&b.d3plus.share&&i.w-2*a.labels.padding>=10&&i.h-2*a.labels.padding>=10&&"middle"!=a.labels.valign.value){i.resize=a.labels.resize.value!==!1&&(!(i&&"resize"in i)||i.resize),i.padding=a.labels.padding,i.text=b.d3plus.share,i.parent=b;var u=m.selectAll("text#d3plus_share_"+b.d3plus.id).data([i],function(a){return a.w+""+a.h+a.text});a.draw.timing&&1===a.zoom.scale?(u.transition().duration(a.draw.timing/2).call(style),u.enter().append("text").attr("id","d3plus_share_"+b.d3plus.id).attr("class","d3plus_share").attr("opacity",0).call(style).transition().duration(a.draw.timing/2).delay(a.draw.timing/2).attr("opacity",1)):(u.attr("opacity",1).call(style),u.enter().append("text").attr("id","d3plus_share_"+b.d3plus.id).attr("class","d3plus_share").attr("opacity",1).call(style)),n=u.node().getBBox().height+a.labels.padding,u.exit().call(remove)}else m.selectAll("text.d3plus_share").call(remove);if(h&&(h.resize=a.labels.resize.value!==!1&&(!(h&&"resize"in h)||h.resize),h.padding="number"==typeof h.padding?h.padding:a.labels.padding),h&&h.w*c[1]-h.padding>=20&&h.h*c[1]-h.padding>=10&&k.length){for(var v=a.format.locale.value.ui.and,w=a.format.locale.value.ui.more,x=0;x<k.length;x++)k[x]instanceof Array&&(k[x]=l(k[x],v,3,w));h.names=k,h.share=n,h.parent=b;var u=m.selectAll("text#d3plus_label_"+b.d3plus.id).data([h],function(a){return!!a&&a.w+"_"+a.h+"_"+a.x+"_"+a.y+"_"+a.names.join("_")}),y=h.resize?void 0:a.labels.font.size*c[0]+"px";if(a.draw.timing&&1===a.zoom.scale?(u.transition().duration(a.draw.timing/2).call(style).call(o),u.enter().append("text").attr("font-size",y).attr("id","d3plus_label_"+b.d3plus.id).attr("class","d3plus_label").attr("opacity",0).call(style).transition().duration(a.draw.timing/2).delay(a.draw.timing/2).call(o)):(u.attr("opacity",1).call(style).call(o),u.enter().append("text").attr("font-size",y).attr("id","d3plus_label_"+b.d3plus.id).attr("class","d3plus_label").call(style).call(o)),u.exit().call(remove),0===u.size()||0===u.selectAll("tspan").size())delete b.d3plus_label,d3.select(this).selectAll("text#d3plus_label_"+b.d3plus.id+", rect#d3plus_label_bg_"+b.d3plus.id).call(remove),a.g.labels.selectAll("text#d3plus_label_"+b.d3plus.id+", rect#d3plus_label_bg_"+b.d3plus.id).call(remove);else{if(h.background){var z=["background"],A=d(u.node().getBBox());A.width+=a.labels.padding*c[0],A.height+=a.labels.padding*c[0],A.x-=a.labels.padding*c[0]/2,A.y-=a.labels.padding*c[0]/2;var B=u.attr("transform").split(")");A.y+=parseFloat(B[B.length-2].split(",")[1])}else var z=[],A={};var C=m.selectAll("rect#d3plus_label_bg_"+b.d3plus.id).data(z),D="number"==typeof h.background?h.background:"string"==typeof h.background?1:.6;a.draw.timing?(C.exit().transition().duration(a.draw.timing).attr("opacity",0).remove(),C.transition().duration(a.draw.timing).attr("opacity",D).call(E),C.enter().insert("rect",".d3plus_label").attr("id","d3plus_label_bg_"+b.d3plus.id).attr("class","d3plus_label_bg").attr("opacity",0).call(E).transition().duration(a.draw.timing).attr("opacity",D)):(C.exit().remove(),C.enter().insert("rect",".d3plus_label").attr("id","d3plus_label_bg_"+b.d3plus.id).attr("class","d3plus_label_bg"),C.attr("opacity",D).call(E))}}else delete b.d3plus_label,d3.select(this).selectAll("text#d3plus_label_"+b.d3plus.id+", rect#d3plus_label_bg_"+b.d3plus.id).call(remove),a.g.labels.selectAll("text#d3plus_label_"+b.d3plus.id+", rect#d3plus_label_bg_"+b.d3plus.id).call(remove)}}),a.dev.value&&h.timeEnd(p)}else{if(a.dev.value){var p="removing "+b+" labels";h.time(p)}i.selectAll("text.d3plus_label, rect.d3plus_label_bg").call(remove),a.g.labels.selectAll("text.d3plus_label, rect.d3plus_label_bg").call(remove),a.dev.value&&h.timeEnd(p)}}},{"../../../client/rtl.coffee":42,"../../../color/mix.coffee":47,"../../../color/text.coffee":51,"../../../core/console/print.coffee":53,"../../../core/fetch/text.js":67,"../../../core/fetch/value.coffee":68,"../../../string/list.coffee":173,"../../../textwrap/textwrap.coffee":199,"../../../util/copy.coffee":206,"./color.coffee":219,"./segments.coffee":230}],228:[function(a,b,c){function i(a){a.attr("x",function(a){return a.d3plus.x}).attr("y",function(a){return a.d3plus.y}).attr("width",0).attr("height",0)}function j(a,b){void 0===b&&(b=0),a.attr("x",function(a){var c=a.d3plus.r?2*a.d3plus.r:a.d3plus.width;return a.d3plus.x-(c/2+b/2)}).attr("y",function(a){var c=a.d3plus.r?2*a.d3plus.r:a.d3plus.height;return a.d3plus.y-(c/2+b/2)}).attr("width",function(a){var c=a.d3plus.r?2*a.d3plus.r:a.d3plus.width;return c+b}).attr("height",function(a){var c=a.d3plus.r?2*a.d3plus.r:a.d3plus.height;return c+b}).attr("rx",function(a){var c=a.d3plus.r?2*a.d3plus.r:a.d3plus.width;return(c+b)/2}).attr("ry",function(a){var c=a.d3plus.r?2*a.d3plus.r:a.d3plus.height;return(c+b)/2})}function k(a,b,c,d){var e=a.draw.timing?a.timing.mouseevents:0,f=d?c*d:c;e?(d3.select(b.parentNode).selectAll("path.d3plus_line").transition().duration(e).style("stroke-width",f),d3.select(b.parentNode).selectAll("rect").transition().duration(e).style("stroke-width",c).call(j,d)):(d3.select(b.parentNode).selectAll("path.d3plus_line").style("stroke-width",f),d3.select(b.parentNode).selectAll("rect").style("stroke-width",c).call(j,d))}var d=a("../../../util/copy.coffee"),e=a("../../../util/closest.coffee"),f=a("../../../client/pointer.coffee"),g=a("./style.coffee"),h=a("../../../core/fetch/value.coffee");b.exports=function(a,b,c,l){var m=d3.svg.line().x(function(a){return a.d3plus.x}).y(function(a){return a.d3plus.y}).interpolate(a.shape.interpolate.value),n=2*a.data.stroke.width,o=n<15?15:n,p=a[a.axes.discrete],q=p.ticks.values.map(function(a){return a.constructor===Date?a.getTime():a});b.each(function(b){var c=!1,l=[],r=[],s=d(b),t=d3.select(this);s.values=[],s.segment_key=s.key,b.values.forEach(function(f,g,i){var j=h(a,f,p.value);j.constructor===Date&&(j=j.getTime());var k=q.indexOf(e(q,j));c===!1||c===k-1?(s.values.push(f),s.segment_key+="_"+k):(s.values.length>1?l.push(s):r.push(s.values[0]),s=d(b),s.values=[f]),g===i.length-1&&(s.values.length>1?l.push(s):r.push(s.values[0])),c=k});var u=t.selectAll("path.d3plus_line").data(l,function(a){return a.d3plus||(a.d3plus={}),a.d3plus.shape="line",a.segment_key}),v=t.selectAll("rect.d3plus_anchor").data(r,function(b){return b.d3plus||(b.d3plus={}),b.d3plus.r=2*a.data.stroke.width,b.d3plus.id});a.draw.timing?(u.exit().transition().duration(a.draw.timing).attr("opacity",0).remove(),u.transition().duration(a.draw.timing).attr("d",function(a){return m(a.values)}).call(g,a),u.enter().append("path").attr("class","d3plus_line").style("stroke-linecap","round").attr("d",function(a){return m(a.values)}).call(g,a).attr("opacity",0).transition().duration(a.draw.timing).attr("opacity",1),v.enter().append("rect").attr("class","d3plus_anchor").attr("id",function(a){return a.d3plus.id}).call(i).call(g,a),v.transition().duration(a.draw.timing).call(j).call(g,a),v.exit().transition().duration(a.draw.timing).call(i).remove()):(u.exit().remove(),u.enter().append("path").attr("class","d3plus_line").style("stroke-linecap","round"),u.attr("d",function(a){return m(a.values)}).call(g,a),v.enter().append("rect").attr("class","d3plus_anchor").attr("id",function(a){return a.d3plus.id}),v.exit().remove(),v.call(j).call(g,a));var w=t.selectAll("path.d3plus_mouse").data(l,function(a){return a.segment_key});w.enter().append("path").attr("class","d3plus_mouse").attr("d",function(a){return m(a.values)}).style("stroke","black").style("stroke-width",o).style("fill","none").style("stroke-linecap","round").attr("opacity",0),w.on(f.over,function(b){a.draw.frozen||k(a,this,n,2)}).on(f.out,function(b){a.draw.frozen||k(a,this,n,0)}),a.draw.timing?w.transition().duration(a.draw.timing).attr("d",function(a){return m(a.values)}).style("stroke-width",o):w.attr("d",function(a){return m(a.values)}).style("stroke-width",o),w.exit().remove()})}},{"../../../client/pointer.coffee":40,"../../../core/fetch/value.coffee":68,"../../../util/closest.coffee":205,"../../../util/copy.coffee":206,"./style.coffee":231}],229:[function(a,b,c){var d;d=a("./style.coffee"),b.exports=function(a,b,c,e){var f,g,h;return f=function(b){var c,d;return a.labels.value&&!b.d3plus.label?(d=b.d3plus.r?2*b.d3plus.r:b.d3plus.width,c=b.d3plus.r?2*b.d3plus.r:b.d3plus.height,b.d3plus_label={w:d,h:c,x:0,y:0},b.d3plus_share={w:d,h:c,x:0,y:0},b.d3plus_label.shape="circle"===b.d3plus.shape?"circle":"square"):b.d3plus.label?b.d3plus_label=b.d3plus.label:delete b.d3plus_label,[b]},g=function(a){return a.attr("x",function(a){return a.d3plus.init&&"x"in a.d3plus.init?a.d3plus.init.x:a.d3plus.init&&"width"in a.d3plus.init?-a.d3plus.width/2:0}).attr("y",function(a){return a.d3plus.init&&"y"in a.d3plus.init?a.d3plus.init.y:a.d3plus.init&&"height"in a.d3plus.init?-a.d3plus.height/2:0}).attr("width",function(a){return a.d3plus.init&&"width"in a.d3plus.init?a.d3plus.init.width:0}).attr("height",function(a){return a.d3plus.init&&"height"in a.d3plus.init?a.d3plus.init.height:0})},h=function(b){return b.attr("x",function(a){var b;return b=a.d3plus.r?2*a.d3plus.r:a.d3plus.width,-b/2}).attr("y",function(a){var b;return b=a.d3plus.r?2*a.d3plus.r:a.d3plus.height,-b/2}).attr("width",function(a){return a.d3plus.r?2*a.d3plus.r:a.d3plus.width}).attr("height",function(a){return a.d3plus.r?2*a.d3plus.r:a.d3plus.height}).attr("rx",function(a){var b,c;return b="circle"===a.d3plus.shape,c=a.d3plus.r?2*a.d3plus.r:a.d3plus.width,b?(c+2)/2:0}).attr("ry",function(a){var b,c;return c="circle"===a.d3plus.shape,b=a.d3plus.r?2*a.d3plus.r:a.d3plus.height,c?(b+2)/2:0}).attr("transform",function(a){return"rotate"in a.d3plus?"rotate("+a.d3plus.rotate+")":""}).attr("shape-rendering",function(b){return"square"!==b.d3plus.shape||"rotate"in b.d3plus?"auto":a.shape.rendering.value})},a.draw.timing?(c.append("rect").attr("class","d3plus_data").call(g).call(d,a),b.selectAll("rect.d3plus_data").data(f).transition().duration(a.draw.timing).call(h).call(d,a),e.selectAll("rect.d3plus_data").transition().duration(a.draw.timing).call(g)):(c.append("rect").attr("class","d3plus_data"),b.selectAll("rect.d3plus_data").data(f).call(h).call(d,a))}},{"./style.coffee":231}],230:[function(a,b,c){var d;d=a("../../../core/fetch/value.coffee"),b.exports=function(a,b,c){var e;return e=a[c].value,e?c in b.d3plus?b.d3plus[c]:d(a,b,e):b.d3plus[c]}},{"../../../core/fetch/value.coffee":68}],231:[function(a,b,c){var d,e;d=a("./color.coffee"),e=a("../../../client/ie.js"),b.exports=function(a,b){return a.attr("fill",function(a){return a.d3plus&&a.d3plus.spline?"none":d(a,b)}).style("stroke",function(a){var c;return a.d3plus&&a.d3plus.stroke?a.d3plus.stroke:(c=a.values?d(a.values[0],b):d(a,b,!0),d3.rgb(c).darker(.6))}).style("stroke-width",function(a){var c;return e&&b.types[b.type.value].zoom?0:(c="line"===a.d3plus.shape?2:1,b.data.stroke.width*c)}).attr("opacity",b.data.opacity).attr("vector-effect","non-scaling-stroke")}},{"../../../client/ie.js":39,"./color.coffee":219}],232:[function(a,b,c){var d=a("./style.coffee");b.exports=function(a,b,c,e){function f(a){a.attr("d",d3.svg.symbol().type("triangle-down").size(10))}function g(a){a.attr("d",d3.svg.symbol().type("triangle-down").size(function(a){var b=Math.min(a.d3plus.width,a.d3plus.height);return d3.scale.pow().exponent(2)(b/2)}))}c.append("path").attr("class","d3plus_data").call(f).call(d,a),b.selectAll("path.d3plus_data").data(function(a){return[a]}),a.draw.timing?b.selectAll("path.d3plus_data").transition().duration(a.draw.timing).call(g).call(d,a):b.selectAll("path.d3plus_data").call(g).call(d,a)}},{"./style.coffee":231}],233:[function(a,b,c){var d=a("./style.coffee");b.exports=function(a,b,c,e){function f(a){a.attr("d",d3.svg.symbol().type("triangle-up").size(10))}function g(a){a.attr("d",d3.svg.symbol().type("triangle-up").size(function(a){var b=Math.min(a.d3plus.width,a.d3plus.height);return d3.scale.pow().exponent(2)(b/2)}))}c.append("path").attr("class","d3plus_data").call(f).call(d,a),b.selectAll("path.d3plus_data").data(function(a){return[a]}),a.draw.timing?b.selectAll("path.d3plus_data").transition().duration(a.draw.timing).call(g).call(d,a):b.selectAll("path.d3plus_data").call(g).call(d,a)}},{"./style.coffee":231}],234:[function(a,b,c){b.exports=function(a,b,c,d){var e,f,g,h,i,j,k,l,m;f=function(a){return a.d3plus.text?a.d3plus_label={w:l,h:l,x:0,y:0,background:"#fff",resize:!1,angle:["left","right"].indexOf(a.d3plus.position)>=0?90:0}:a.d3plus.label?a.d3plus_label=a.d3plus.label:delete a.d3plus_label,[a]},m=function(b){return b.style("stroke-width",a.data.stroke.width).style("stroke","#444").attr("fill","none").attr("shape-rendering",a.shape.rendering.value)},g=function(a){return a.attr("x1",0).attr("x2",0).attr("y1",0).attr("y2",0)},k=function(a){return a.attr("x1",function(a){var b,c,d;return["top","bottom"].indexOf(a.d3plus.position)>=0?0:(b=a.d3plus.offset||0,c=a.d3plus.width||0,d=b<0?-c:c,d+b)}).attr("x2",function(a){return["top","bottom"].indexOf(a.d3plus.position)>=0?0:a.d3plus.offset||0}).attr("y1",function(a){var b,c,d;return["left","right"].indexOf(a.d3plus.position)>=0?0:(c=a.d3plus.offset||0,b=a.d3plus.height||0,d=c<0?-b:b,d+c)}).attr("y2",function(a){return["left","right"].indexOf(a.d3plus.position)>=0?0:a.d3plus.offset||0}).attr("marker-start","url(#d3plus_whisker_marker)")},h=a.defs.selectAll("#d3plus_whisker_marker").data([0]),h.enter().append("marker").attr("id","d3plus_whisker_marker").attr("markerUnits","userSpaceOnUse").style("overflow","visible").append("line"),e=b.datum(),e?(j=e.d3plus.position,i=["top","bottom"].indexOf(j)>=0?"horizontal":"vertical",l="horizontal"===i?e.d3plus.width:e.d3plus.height):(i="horizontal",l=0),h.select("line").attr("x1","horizontal"===i?-l/2:0).attr("x2","horizontal"===i?l/2:0).attr("y1","vertical"===i?-l/2:0).attr("y2","vertical"===i?l/2:0).call(m).style("stroke-width",2*a.data.stroke.width),a.draw.timing?(c.append("line").attr("class","d3plus_data").call(m).call(g),b.selectAll("line.d3plus_data").data(f).transition().duration(a.draw.timing).call(m).call(k),d.selectAll("line.d3plus_data").transition().duration(a.draw.timing).call(g)):(c.append("line").attr("class","d3plus_data"),b.selectAll("line.d3plus_data").data(f).call(m).call(k))}},{}],235:[function(a,b,c){var d=a("../../../client/pointer.coffee"),e=a("../../../client/prefix.coffee"),f=a("../../../core/console/print.coffee"),g=a("../../../client/touch.coffee"),h=a("../zoom/propagation.coffee");b.exports=function(a){a.dev.value&&f.time("creating SVG elements"),a.svg=a.container.value.selectAll("svg#d3plus").data([0]),a.svg.enter().insert("svg","#d3plus_message").attr("id","d3plus").attr("width",a.width.value).attr("height",a.height.value).attr("xmlns","http://www.w3.org/2000/svg").attr("xmlns:xmlns:xlink","http://www.w3.org/1999/xlink"),a.g.bg=a.svg.selectAll("rect#bg").data(["bg"]),a.g.bg.enter().append("rect").attr("id","bg").attr("fill",a.background.value).attr("width",a.width.value).attr("height",a.height.value),a.g.timeline=a.svg.selectAll("g#timeline").data(["timeline"]),a.g.timeline.enter().append("g").attr("id","timeline").attr("transform","translate(0,"+a.height.value+")"),a.g.legend=a.svg.selectAll("g#key").data(["key"]),a.g.legend.enter().append("g").attr("id","key").attr("transform","translate(0,"+a.height.value+")"),a.g.footer=a.svg.selectAll("g#footer").data(["footer"]),a.g.footer.enter().append("g").attr("id","footer").attr("transform","translate(0,"+a.height.value+")");var b="clipping_"+a.container.id;if(a.g.clipping=a.svg.selectAll("#clipping").data(["clipping"]),a.g.clipping.enter().append("clipPath").attr("id",b).append("rect").attr("width",a.width.viz).attr("height",a.height.viz),a.g.container=a.svg.selectAll("g#container").data(["container"]),a.g.container.enter().append("g").attr("id","container").attr("clip-path","url(#"+b+")").attr("transform","translate("+a.margin.left+","+a.margin.top+")"),a.g.zoom=a.g.container.selectAll("g#zoom").data(["zoom"]),a.g.zoom.enter().append("g").attr("id","zoom"),a.g.viz=a.g.zoom.selectAll("g#d3plus_viz").data(["d3plus_viz"]),a.g.viz.enter().append("g").attr("id","d3plus_viz"),a.g.overlay=a.g.viz.selectAll("rect#d3plus_overlay").data([{id:"d3plus_overlay"}]),a.g.overlay.enter().append("rect").attr("id","d3plus_overlay").attr("width",a.width.value).attr("height",a.height.value).attr("opacity",0),g){var c=function(){h(a,d3.event)};a.g.overlay.on(d.over,c).on(d.move,c).on(d.out,c)}else a.g.overlay.on(d.move,function(b){a.types[a.type.value].zoom&&a.zoom.pan.value&&a.zoom.behavior.scaleExtent()[0]<a.zoom.scale?d3.select(this).style("cursor",e()+"grab"):d3.select(this).style("cursor","auto")}).on(d.up,function(b){a.types[a.type.value].zoom&&a.zoom.pan.value&&a.zoom.behavior.scaleExtent()[0]<a.zoom.scale?d3.select(this).style("cursor",e()+"grab"):d3.select(this).style("cursor","auto")}).on(d.down,function(b){a.types[a.type.value].zoom&&a.zoom.pan.value&&a.zoom.behavior.scaleExtent()[0]<a.zoom.scale?d3.select(this).style("cursor",e()+"grabbing"):d3.select(this).style("cursor","auto")});a.g.app=a.g.viz.selectAll("g#app").data(["app"]),a.g.app.enter().append("g").attr("id","app"),a.g.edges=a.g.viz.selectAll("g#edges").data(["edges"]),a.g.edges.enter().append("g").attr("id","edges").attr("opacity",0),a.g.edge_focus=a.g.viz.selectAll("g#focus").data(["focus"]),a.g.edge_focus.enter().append("g").attr("id","focus"),a.g.edge_hover=a.g.viz.selectAll("g#edge_hover").data(["edge_hover"]),a.g.edge_hover.enter().append("g").attr("id","edge_hover").attr("opacity",0),a.g.data=a.g.viz.selectAll("g#data").data(["data"]),a.g.data.enter().append("g").attr("id","data").attr("opacity",0),a.g.data_focus=a.g.viz.selectAll("g#data_focus").data(["data_focus"]),a.g.data_focus.enter().append("g").attr("id","data_focus"),a.g.labels=a.g.viz.selectAll("g#d3plus_labels").data(["d3plus_labels"]),a.g.labels.enter().append("g").attr("id","d3plus_labels"),a.defs=a.svg.selectAll("defs").data(["defs"]),a.defs.enter().append("defs"),a.dev.value&&f.timeEnd("creating SVG elements")}},{"../../../client/pointer.coffee":40,"../../../client/prefix.coffee":41,"../../../client/touch.coffee":44,"../../../core/console/print.coffee":53,"../zoom/propagation.coffee":250}],236:[function(a,b,c){var d=a("../../../core/console/print.coffee");b.exports=function(a){a.dev.value&&d.time("updating SVG elements"),a.draw.timing?(a.container.value.transition().duration(a.draw.timing).style("width",a.width.value+"px").style("height",a.height.value+"px"),a.svg.transition().duration(a.draw.timing).attr("width",a.width.value).attr("height",a.height.value),a.g.bg.transition().duration(a.draw.timing).attr("width",a.width.value).attr("height",a.height.value),a.g.clipping.select("rect").transition().duration(a.draw.timing).attr("width",a.width.viz).attr("height",a.height.viz),a.g.container.transition().duration(a.draw.timing).attr("transform","translate("+a.margin.left+","+a.margin.top+")")):(a.container.value.style("width",a.width.value+"px").style("height",a.height.value+"px"),a.svg.attr("width",a.width.value).attr("height",a.height.value),a.g.bg.attr("width",a.width.value).attr("height",a.height.value),a.g.clipping.select("rect").attr("width",a.width.viz).attr("height",a.height.viz),a.g.container.attr("transform","translate("+a.margin.left+","+a.margin.top+")")),a.dev.value&&d.timeEnd("updating SVG elements")}},{"../../../core/console/print.coffee":53}],237:[function(a,b,c){var d=a("../../../array/sort.coffee"),e=a("../../../tooltip/create.js"),f=a("../../../core/data/nest.js"),g=a("./data.js"),h=a("../../../core/fetch/color.coffee"),i=a("../../../core/fetch/text.js"),j=a("../../../core/fetch/value.coffee"),k=a("../../../object/merge.coffee"),l=a("../../../tooltip/remove.coffee"),m=a("../shapes/segments.coffee"),n=a("../../../util/uniques.coffee"),o=a("../../../object/validate.coffee"),p=a("../zoom/direction.coffee");b.exports=function(a){function H(p){function V(a){return"string"==typeof b[a].value?b[a].value:b.format.locale.value.method[a]}var A,r="depth"in a?a.depth:q,u={},B=b.id.nesting[r+1]in c?r+1:r,C=b.id.nesting[B],D="merged"in c.d3plus?c.d3plus.merged:c[C];
D instanceof Array||(D=[D]);var H=j(b,c,b.size.value);if(b.tooltip.children.value){if(D=D.slice(0),D.length>1&&o(D[0])&&(D=f(b,D,[C])),b.size.value&&o(D[0])){var I=[],J=D.filter(function(a){var c=j(b,a,b.size.value);return!(null===c||"d3plus"in a&&a.d3plus.merged)||void I.push(a)});d(J,b.size.value,"desc",[],b),D=J.concat(I)}var K="short"===x?3:b.data.large,L=D.length,M=d3.min([L,K]);A={values:[]};for(var O=0;O<M&&D.length;O++){var P=D.shift(),Q=i(b,P,B)[0],R=o(P)?j(b,P,C,B):P;if(R!==c[b.id.nesting[r]]&&Q&&!A[Q]){var S=o(P)?j(b,P,b.size.value,C):null,T=h(b,P,C);A[Q]=!S||S instanceof Array?"":b.format.value(S,{key:b.size.value,vars:b,data:P});var U={};U[Q]=A[Q],A.values.push(U),T&&(A.d3plus_colors||(A.d3plus_colors={}),A.d3plus_colors[Q]=T)}else O--}L>M&&(A.d3plusMore=L-M)}c.d3plus.tooltip&&(u=k(u,c.d3plus.tooltip)),b.tooltip.size.value&&(H&&"number"!=typeof b.size.value&&(u[V("size")]=H),b.axes.opposite&&b[b.axes.opposite].value!==b.size.value&&(u[V(b.axes.opposite)]=j(b,c,b[b.axes.opposite].value)),b.color.valueScale&&(u[V("color")]=j(b,c,b.color.value)));var W=m(b,c,"active"),X=m(b,c,"temp"),Y=m(b,c,"total");"number"==typeof W&&W>0&&Y&&(u[V("active")]=W+"/"+Y+" ("+b.format.value(W/Y*100,{key:"share",vars:b,data:c})+")"),"number"==typeof X&&X>0&&Y&&(u[V("temp")]=X+"/"+Y+" ("+b.format.value(X/Y*100,{key:"share",vars:b,data:c})+")"),b.tooltip.share.value&&c.d3plus.share&&(u.share=b.format.value(100*c.d3plus.share,{key:"share",vars:b,data:c}));var B="depth"in a?a.depth:q,Z=a.title||i(b,c,B)[0],$=n(c,b.icon.value,j,b,b.id.nesting[B]),_=g(b,c,x,u,A,B);if($=1===$.length&&"string"==typeof $[0]&&$[0],_.length>0||y||!c.d3plus_label&&"short"==x&&Z||c.d3plus_label&&(!("visible"in c.d3plus_label)||"visible"in c.d3plus_label&&c.d3plus_label.visible===!1)){Z||(Z=R);var B="d3plus"in c&&"merged"in c.d3plus?q-1:"depth"in a?a.depth:q;if(B<0&&(B=0),B=b.id.nesting[B],"string"==typeof b.icon.style.value)var aa=b.icon.style.value;else if("object"==typeof b.icon.style.value&&b.icon.style.value[B])var aa=b.icon.style.value[B];else var aa="default";if(a.width)var ba=a.width;else if(w||0!=_.length)var ba=b.tooltip.small;else var ba="auto";var ca="long"!==a.length?d3.select("body"):b.container.value;!a.description&&c&&b.tooltip.sub.value&&(a.description=j(b,c,b.tooltip.sub.value)),e({align:z,arrow:t,locale:b.format.locale.value,background:b.tooltip.background,curtain:b.tooltip.curtain.color,curtainopacity:b.tooltip.curtain.opacity,fontcolor:b.tooltip.font.color,fontfamily:b.tooltip.font.family.value,fontsize:b.tooltip.font.size,fontweight:b.tooltip.font.weight,data:_,color:h(b,c),allColors:!0,footer:a.footer===!1?a.footer:y,fullscreen:w,html:p,js:a.js,icon:$,id:v,max_height:a.maxheight,max_width:b.tooltip.small,mouseevents:s,offset:G,parent:ca,style:aa,title:Z,description:a.description,width:ba,x:E,y:F})}else l(v)}"d3plus"in a.data||(a.data.d3plus={});var b=a.vars,c=a.data,q="d3plus"in c&&"depth"in c.d3plus?c.d3plus.depth:b.depth.value,s=(a.ex,!!a.mouseevents&&a.mouseevents),t=!("arrow"in a)||a.arrow,u=j(b,c,b.id.value),v=a.id||b.type.value;if(!d3.event||"click"!=d3.event.type||!b.tooltip.html.value&&!b.tooltip.value.long||"fullscreen"in a){var w=!1,z=a.anchor||b.tooltip.anchor,x=a.length||"short",A=p(c,b);if(A===-1){var B=b.id.nesting[q-1];j(b,u,B)}if(1===A&&b.zoom.value)var D=b.format.value(b.format.locale.value.ui.expand);else if(A===-1&&b.zoom.value&&b.history.states.length&&!b.tooltip.value.long)var D=b.format.value(b.format.locale.value.ui.collapse);else if(b.small||"short"!=x||!b.tooltip.html.value&&!b.tooltip.value.long||1===b.focus.value.length&&b.focus.value[0]==u)if("long"==x)var D=b.footer.value||"";else var D="";else var D=b.format.locale.value.ui.moreInfo;var y=!!D.length&&b.format.value(D,{key:"footer",vars:b})}else{var w=!0,t=!1,s=!0,x="long",y=b.footer.value;b.covered=!0}if("x"in a)var E=a.x;else if("static"===b.types[b.type.value].tooltip){var E=c.d3plus.x;b.zoom.translate&&b.zoom.scale&&(E=b.zoom.translate[0]+E*b.zoom.scale),E+=b.margin.left,"long"!==a.length&&(F+=window.scrollX,E+=b.container.value.node().getBoundingClientRect().left,E+=parseFloat(b.container.value.style("padding-left"),10))}else var E=d3.mouse(d3.select("html").node())[0];if("y"in a)var F=a.y;else if("static"==b.types[b.type.value].tooltip){var F=c.d3plus.y;b.zoom.translate&&b.zoom.scale&&(F=b.zoom.translate[1]+F*b.zoom.scale),F+=b.margin.top,"long"!==a.length&&(F+=window.scrollY,F+=b.container.value.node().getBoundingClientRect().top,F+=parseFloat(b.container.value.style("padding-top"),10))}else var F=d3.mouse(d3.select("html").node())[1];if("offset"in a)var G=a.offset;else if("static"==b.types[b.type.value].tooltip){var G=c.d3plus.r?c.d3plus.r:c.d3plus.height/2;b.zoom.scale&&(G*=b.zoom.scale)}else var G=3;if(w||"long"===a.length)if("string"==typeof b.tooltip.html.value)H(b.tooltip.html.value);else if("function"==typeof b.tooltip.html.value)H(b.tooltip.html.value(u));else if(b.tooltip.html.value&&"object"==typeof b.tooltip.html.value&&b.tooltip.html.value.url){var I=b.tooltip.html.value.url;"function"==typeof I&&(I=I(u)),d3.json(I,function(a){var c=b.tooltip.html.value.callback?b.tooltip.html.value.callback(a):a;H(c)})}else H(a.html);else H(a.html)}},{"../../../array/sort.coffee":36,"../../../core/data/nest.js":61,"../../../core/fetch/color.coffee":64,"../../../core/fetch/text.js":67,"../../../core/fetch/value.coffee":68,"../../../object/merge.coffee":170,"../../../object/validate.coffee":171,"../../../tooltip/create.js":200,"../../../tooltip/remove.coffee":202,"../../../util/uniques.coffee":209,"../shapes/segments.coffee":230,"../zoom/direction.coffee":247,"./data.js":238}],238:[function(a,b,c){var d=a("../../../util/copy.coffee"),e=a("../../../core/fetch/value.coffee"),f=a("../../../core/fetch/color.coffee"),g=a("../../../core/fetch/text.js"),h=a("../../../color/legible.coffee"),i=a("../../../object/merge.coffee"),j=a("../../../client/prefix.coffee"),k=a("../../../string/format.js"),l=a("../../../object/validate.coffee");b.exports=function(a,b,c,m,n,o){function u(c,d){if(a.attrs.value[d])var f=d;else var f=null;d&&(d=a.format.value(d));var g=q[c]||e(a,b,c,f);if(l(g))v.push({name:a.format.value(c),value:a.format.value(g.value,{key:g.key,vars:a}),group:d});else if(null!=g&&"undefined"!=g&&!(g instanceof Array)&&("string"==typeof g&&g.indexOf("d3plus_other")<0||"string"!=typeof g)){var h=a.format.locale.value.ui[c]?a.format.value(a.format.locale.value.ui[c]):a.format.value(c),i=s.indexOf(c)>=0;g instanceof Array?g.forEach(function(d){d=a.format.value(d,{key:c,vars:a,data:b})}):g=a.format.value(g,{key:c,vars:a,data:b});var j={name:h,value:g,highlight:i,group:d};if(a.descs.value)if("function"==typeof a.descs.value){var k=a.descs.value(c);"string"==typeof k&&(j.desc=k)}else c in a.descs.value&&(j.desc=a.descs.value[c]);v.push(j)}}if(a.small)return[];if(!c)var c="long";if("long"==c)var p="short";else var p="long";var q={};if(m&&"string"==typeof m)m=[m];else if(m&&"object"==typeof m){q=i(q,m);var m=[];for(var r in q)m.push(r)}else if(!m)var m=[];var s=[];if(a.tooltip.value instanceof Array)var t=a.tooltip.value;else if("string"==typeof a.tooltip.value)var t=[a.tooltip.value];else{if(a.tooltip.value[a.id.nesting[o]])var t=a.tooltip.value[a.id.nesting[o]];else var t=a.tooltip.value;t instanceof Array||(t=t[c]?t[c]:t[p]?[]:i({"":[]},t)),"string"==typeof t?t=[t]:t instanceof Array||(t=i({"":[]},t))}var v=[];if(t.constructor===Array&&(t={"":t}),a.id.nesting.length&&o<a.id.nesting.length-1){var t=d(t);a.id.nesting.forEach(function(a,b){b>o&&t[a]&&delete t[a]})}for(var w in t){t[w].constructor!==Array&&(t[w]=[t[w]]);for(var x=m.length;x>0;x--)t[w].indexOf(m[x-1])>=0&&m.splice(x-1,1)}if(a.tooltip.value.long&&"object"==typeof a.tooltip.value.long){for(var w in a.tooltip.value.long)for(var x=m.length;x>0;x--){var z=m[x-1];a.tooltip.value.long[w].indexOf(z)>=0&&(t[w]||(t[w]=[]),t[w].push(z),m.splice(x-1,1))}}m.length&&(t[""]||(t[""]=[]),t[""]=t[""].concat(m));for(var w in t)t[w].forEach(function(a){u(a,w)});if(n){var A=a.format.locale.value.ui.including,B=n.d3plus_colors;n.values.forEach(function(b){var c=d3.keys(b)[0];v.push({group:a.format.value(A),highlight:!(!B||!B[c])&&B[c],name:c,value:b[c]})}),n.d3plusMore&&v.push({group:a.format.value(A),highlight:!0,name:k(a.format.locale.value.ui.more,n.d3plusMore),value:""})}if(a.tooltip.connections.value&&"long"===c){var C=a.edges.connections(b[a.id.value],a.id.value,!0);C.length&&C.forEach(function(b){var c=a.data.viz.filter(function(c){return c[a.id.value]===b[a.id.value]}),c=c.length?c[0]:b,d=g(a,c)[0],e=f(a,c),i=a.tooltip.font.size,k="square"==a.shape.value?0:i;styles=["background-color: "+e,"border-color: "+h(e),"border-style: solid","border-width: "+a.data.stroke.width+"px","display: inline-block","height: "+i+"px","left: 0px","position: absolute","width: "+i+"px","top: 0px",j()+"border-radius: "+k+"px"],node="<div style='"+styles.join("; ")+";'></div>";var l=function(){a.self.focus([c[a.id.value]]).draw()};v.push({group:a.format.value(a.format.locale.value.ui.primary),highlight:!1,link:l,name:"<div id='d3plustooltipfocuslink_"+c[a.id.value]+"' class='d3plus_tooltip_focus_link' style='position:relative;padding-left:"+1.5*i+"px;'>"+node+d+"</div>"})})}return v}},{"../../../client/prefix.coffee":41,"../../../color/legible.coffee":45,"../../../core/fetch/color.coffee":64,"../../../core/fetch/text.js":67,"../../../core/fetch/value.coffee":68,"../../../object/merge.coffee":170,"../../../object/validate.coffee":171,"../../../string/format.js":172,"../../../util/copy.coffee":206}],239:[function(a,b,c){var d;d=a("../../../core/console/print.coffee"),b.exports=function(a){var b,c,e,f,g,h,i,j,k,l;if(a.group=a.g.apps[a.type.value],a.mouse={},l=a.types[a.type.value],j=l.requirements||[],e=j.indexOf("data")>=0,f=!e||e&&a.data.viz.length,!a.error.internal&&f){for(b=a.format.locale.value.visualization[a.type.value],a.dev.value&&d.time("running "+b),i=a.data.viz,g=0,h=i.length;g<h;g++)c=i[g],c.d3plus&&(delete c.d3plus.shape,delete c.d3plus.label,delete c.d3plus.rotate,delete c.d3plus.share);k=l(a),a.dev.value&&d.timeEnd("running "+b)}else k=null;a.returned={nodes:[],edges:null},k instanceof Array?a.returned.nodes=k:k&&(k.nodes&&(a.returned.nodes=k.nodes),k.edges&&(a.returned.edges=k.edges))}},{"../../../core/console/print.coffee":53}],240:[function(a,b,c){var d=a("../../../util/copy.coffee"),e=a("../../../form/form.js"),f=a("../../../core/console/print.coffee"),g=a("../../../object/validate.coffee");b.exports=function(a){var b=a.ui.value&&a.ui.value.length,c=a.ui.position.value;a.dev.value&&b&&f.time("drawing custom UI elements");var h=a.container.value.selectAll("div#d3plus_drawer").data(["d3plus_drawer"]);h.enter().append("div").attr("id","d3plus_drawer");var i={};a.ui.position.accepted.forEach(function(b){i[b]=b==c?a.margin.bottom+"px":"auto"}),h.style("text-align",a.ui.align.value).style("position","absolute").style("width",a.width.value-2*a.ui.padding+"px").style("height","auto").style(i);var j=h.selectAll("div.d3plus_drawer_ui").data(b?a.ui.value:[],function(a){return a.method||!1});j.enter().append("div").attr("class","d3plus_drawer_ui").style("padding",a.ui.padding+"px").style("display","inline-block").each(function(b){var d,f,c=d3.select(this);"string"==typeof b.method&&b.method in a?(d=a[b.method].value,f=function(c){c!==a[b.method].value&&a.self[b.method](c).draw()}):(d=b.value[0],g(d)&&(d=d[d3.keys(d)[0]]),"function"==typeof b.method&&(f=function(c){b.method(c,a.self)})),b.form=e().container(c).data({sort:!1}).focus(d,f).id("id").text("text")}),j.each(function(b){var e,c=[];b.label?e=b.label:"string"==typeof b.method&&b.method in a&&(e=a.format.locale.value.method[b.method]||b.method),b.value.forEach(function(b){var d={};g(b)?(d.id=b[d3.keys(b)[0]],d.text=a.format.value(d3.keys(b)[0])):(d.id=b,d.text=a.format.value(b)),c.push(d)});var f=d(a.ui.font);f.align=d(a.font.align),f.secondary=d(f),b.form.data(c).font(f).format(a.format.locale.language).title(a.format.value(e)).type(b.type||"auto").ui({align:a.ui.align.value,padding:a.ui.padding,margin:0}).width(b.width||!1).draw()}),j.exit().remove();var k=h.node().offsetHeight||h.node().getBoundingClientRect().height;k&&(a.margin[c]+=k),a.dev.value&&b&&f.timeEnd("drawing custom UI elements")}},{"../../../core/console/print.coffee":53,"../../../form/form.js":103,"../../../object/validate.coffee":171,"../../../util/copy.coffee":206}],241:[function(a,b,c){var d,e,f,g;d=a("../../../client/pointer.coffee"),e=a("../../../color/lighter.coffee"),f=a("../../../core/console/print.coffee"),g=a("../../../client/css.coffee"),b.exports=function(a){var b,c,h,i,j,k,l,m,n,o,p,q,r,s,t,u;return!a.small&&a.history.states.length>0?(a.dev.value&&f.time("drawing back button"),b=a.container.value.selectAll("div#d3plus_back_button").data(["d3plus_back_button"]).style("position","relative").style("z-index",1900),n=14,c=a.title.sub.font.color,j=a.title.sub.font.family.value,t="bold",m=a.title.sub.padding,u="5px 0px",q=!1,a.title.sub.value&&["start","left"].indexOf(a.title.sub.font.align)<0?q="sub":a.title.total.value&&["start","left"].indexOf(a.title.total.font.align)<0?q="total":a.title.value&&["start","left"].indexOf(a.title.font.align)<0&&(q="title"),q?(o=function(a){var b;return b=a.attr("transform").split(","),b=b[b.length-1],parseFloat(b.substring(0,b.length-1))},r=a.svg.select(".d3plus_title."+q),s=o(r)+o(r.select("text"))):(s=a.margin.top-a.title.padding,l=n+2*m,a.margin.top+=l),h=parseFloat(a.container.value.style("padding-top"),10),s+=h,h=parseFloat(a.container.value.style("padding-left"),10),k=a.margin.left+n/2+h,p=function(a){return a.style("position","absolute").style("left",k+"px").style("top",s+"px").style("color",c).style("font-family",j).style("font-weight",t).style("font-size",n+"px").style("margin",u)},i=b.enter().append("div").attr("id","d3plus_back_button").style("opacity",0).call(p).html(function(){var b;return b=g("font-awesome")?"<i class='fa fa-angle-left' style='margin-top:2px;margin-right:4px;'></i>":"&laquo; ",b+a.format.value(a.format.locale.value.ui.back)}),b.on(d.over,function(){if(!a.small&&a.history.states.length>0)return d3.select(this).style("cursor","pointer").transition().duration(a.timing.mouseevents).style("color",e(c,.25))}).on(d.out,function(){if(!a.small&&a.history.states.length>0)return d3.select(this).style("cursor","auto").transition().duration(a.timing.mouseevents).style("color",c)}).on(d.click,function(){return a.history.back()}).transition().duration(a.draw.timing).style("opacity",1).call(p),a.dev.value?f.timeEnd("drawing back button"):void 0):a.container.value.selectAll("div#d3plus_back_button").transition().duration(a.draw.timing).style("opacity",0).remove()}},{"../../../client/css.coffee":38,"../../../client/pointer.coffee":40,"../../../color/lighter.coffee":46,"../../../core/console/print.coffee":53}],242:[function(a,b,c){var d=a("../../../array/sort.coffee"),e=a("../../../util/buckets.coffee"),f=a("../../../util/copy.coffee"),g=a("../tooltip/create.js"),h=a("../../../core/data/nest.js"),i=a("../../../util/dataURL.coffee"),j=a("../../../client/pointer.coffee"),k=a("../../../core/fetch/value.coffee"),l=a("../../../core/fetch/color.coffee"),m=a("../../../core/fetch/text.js"),n=a("../../../core/console/print.coffee"),o=a("../../../tooltip/remove.coffee"),p=a("../../../color/text.coffee"),q=a("../../../util/uniques.coffee"),r=a("../../../string/strip.js"),s=a("../../../textwrap/textwrap.coffee"),t=a("../../../client/touch.coffee"),u=a("../../../object/validate.coffee");b.exports=function(a){function L(b){b.attr("transform",function(b,d){var e=K+d*(a.ui.padding+c);return"translate("+e+","+a.ui.padding+")"})}function M(b){b.attr("width",c).attr("height",c).attr("fill",function(b){d3.select(this.parentNode).select("text").remove();var d=q(b,a.icon.value,k,a,A),e=l(a,b,A);if(a.legend.icons.value&&1===d.length&&"string"==typeof d[0]){d=d[0];var h,f=r(d+"_"+e),g=a.icon.style.value,j=a.defs.selectAll("pattern#"+f).data([f]);h="string"==typeof g?a.icon.style.value:u(g)&&g[A]?g[A]:"default",e="knockout"==h?e:"none",j.select("rect").transition().duration(a.draw.timing).attr("fill",e).attr("width",c).attr("height",c),j.select("image").transition().duration(a.draw.timing).attr("width",c).attr("height",c);var n=j.enter().append("pattern").attr("id",f).attr("width",c).attr("height",c);return n.append("rect").attr("fill",e).attr("width",c).attr("height",c),n.append("image").attr("xlink:href",d).attr("width",c).attr("height",c).each(function(a){0===d.indexOf("/")||d.indexOf(window.location.hostname)>=0?i(d,function(a){j.select("image").attr("xlink:href",a)}):j.select("image").attr("xlink:href",d)}),"url(#"+f+")"}var o;if(o=a.legend.text.value?[k(a,b,a.legend.text.value,z)]:m(a,b,z),1===o.length&&!(o[0]instanceof Array)&&o[0].length){var t=d3.select(this.parentNode).append("text");t.attr("font-size",a.legend.font.size+"px").attr("font-weight",a.legend.font.weight).attr("font-family",a.legend.font.family.value).attr("fill",p(e)).attr("x",0).attr("y",0).each(function(b){s().align("middle").container(d3.select(this)).height(c).padding(a.ui.padding).resize(a.labels.resize.value).text(o[0]).width(c).valign("middle").draw()}),t.select("tspan").empty()&&t.remove()}return e})}var b=!0,c=0;if(!a.error.internal&&a.color.value&&!a.small&&a.legend.value)if(a.color.valueScale)if(a.color.valueScale){a.dev.value&&n.time("drawing color scale"),a.g.legend.selectAll("g.d3plus_color").transition().duration(a.draw.timing).attr("opacity",0).remove();var P=a.color.valueScale.domain(),G=a.color.valueScale.range();P.length<=2&&(P=e(P,6));var Q=a.g.legend.selectAll("g.d3plus_scale").data(["scale"]);Q.enter().append("g").attr("class","d3plus_scale").attr("opacity",0);var R=Q.selectAll("#d3plus_legend_heatmap").data(["heatmap"]);R.enter().append("linearGradient").attr("id","d3plus_legend_heatmap").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%").attr("spreadMethod","pad");var S=R.selectAll("stop").data(d3.range(0,G.length));S.enter().append("stop").attr("stop-opacity",1),S.attr("offset",function(a){return Math.round(a/(G.length-1)*100)+"%"}).attr("stop-color",function(a){return G[a]}),S.exit().remove();var T=Q.selectAll("rect#gradient").data(["gradient"]);T.enter().append("rect").attr("id","gradient").attr("x",function(b){return"middle"==a.legend.align?a.width.value/2:"end"==a.legend.align?a.width.value:0}).attr("y",a.ui.padding).attr("width",0).attr("height",a.legend.gradient.height).attr("stroke",a.legend.font.color).attr("stroke-width",1).style("fill","url(#d3plus_legend_heatmap)");var U=Q.selectAll("text.d3plus_tick").data(d3.range(0,P.length));U.enter().append("text").attr("class","d3plus_tick").attr("x",function(b){return"middle"==a.legend.align?a.width.value/2:"end"==a.legend.align?a.width.value:0}).attr("y",function(b){return this.getBBox().height+a.legend.gradient.height+2*a.ui.padding});var V=0;U.order().attr("font-weight",a.legend.font.weight).attr("font-family",a.legend.font.family.value).attr("font-size",a.legend.font.size+"px").style("text-anchor",a.legend.font.align).attr("fill",a.legend.font.color).text(function(b){return a.format.value(P[b],{key:key,vars:a})}).attr("y",function(b){return this.getBBox().height+a.legend.gradient.height+2*a.ui.padding}).each(function(a){var b=this.offsetWidth;b>V&&(V=b)}),V+=2*a.labels.padding;var I=V*(P.length-1);if(I+V<a.width.value){I+V<a.width.value/2&&(I=a.width.value/2,V=I/P.length,I-=V);var K;K="start"==a.legend.align?a.ui.padding:"end"==a.legend.align?a.width.value-a.ui.padding-I:a.width.value/2-I/2,U.transition().duration(a.draw.timing).attr("x",function(a){return K+V*a}),U.exit().transition().duration(a.draw.timing).attr("opacity",0).remove();var W=Q.selectAll("rect.d3plus_tick").data(d3.range(0,P.length));W.enter().append("rect").attr("class","d3plus_tick").attr("x",function(b){return"middle"==a.legend.align?a.width.value/2:"end"==a.legend.align?a.width.value:0}).attr("y",a.ui.padding).attr("width",0).attr("height",a.ui.padding+a.legend.gradient.height).attr("fill",a.legend.font.color),W.transition().duration(a.draw.timing).attr("x",function(a){var b=0===a?1:0;return K+V*a-b}).attr("y",a.ui.padding).attr("width",1).attr("height",a.ui.padding+a.legend.gradient.height).attr("fill",a.legend.font.color),W.exit().transition().duration(a.draw.timing).attr("width",0).remove(),T.transition().duration(a.draw.timing).attr("x",function(b){return"middle"==a.legend.align?a.width.value/2-I/2:"end"==a.legend.align?a.width.value-I-a.ui.padding:a.ui.padding}).attr("y",a.ui.padding).attr("width",I).attr("height",a.legend.gradient.height),Q.transition().duration(a.draw.timing).attr("opacity",1),a.dev.value&&n.timeEnd("drawing color scale")}else b=!1}else b=!1;else{a.dev.value&&n.time("grouping data by colors");var v;if(a.nodes.value&&a.types[a.type.value].requirements.indexOf("nodes")>=0){if(v=f(a.nodes.restriced||a.nodes.value),a.data.viz.length)for(var w=0;w<v.length;w++){var x=a.data.viz.filter(function(b){return b[a.id.value]===v[w][a.id.value]});x.length&&(v[w]=x[0])}}else v=a.data.viz;var y=function(b){return l(a,b,z)},z=0,A=a.id.value,B=a.id.nesting.indexOf(a.color.value);if(B>=0)z=B,A=a.id.nesting[B];else for(var C=0;C<=a.depth.value;C++){z=C,A=a.id.nesting[C];var D=q(v,function(b){return k(a,b,A)}),E=q(v,y);if(D.length>=E.length&&E.length>1)break}var F=[a.color.value],G=h(a,v,F,[]);a.dev.value&&n.timeEnd("grouping data by color");var H=a.width.value;c=a.legend.size;var I=c*G.length+a.ui.padding*(G.length+1);if(c instanceof Array){a.dev.value&&n.time("calculating legend size");for(var w=c[1];w>=c[0];w--)if(I=w*G.length+a.ui.padding*(G.length+1),H>=I){c=w;break}a.dev.value&&n.timeEnd("calculating legend size")}else"number"!=typeof c&&c!==!1&&(c=30);if(H<I||1==G.length)b=!1;else{I-=2*a.ui.padding,a.dev.value&&n.time("sorting legend");var J=a[a.legend.order.value].value;d(G,J,a.legend.order.sort.value,a.color.value,a,z),a.dev.value&&n.timeEnd("sorting legend"),a.dev.value&&n.time("drawing legend");var K;K="start"==a.legend.align?a.ui.padding:"end"==a.legend.align?H-a.ui.padding-I:H/2-I/2,a.g.legend.selectAll("g.d3plus_scale").transition().duration(a.draw.timing).attr("opacity",0).remove();var N={},O=a.g.legend.selectAll("g.d3plus_color").data(G,function(b){var c=l(a,b,A);return c in N||(N[c]=-1),N[c]++,N[c]+"_"+c});O.enter().append("g").attr("class","d3plus_color").attr("opacity",0).call(L).append("rect").attr("class","d3plus_color").call(M),O.order().transition().duration(a.draw.timing).call(L).attr("opacity",1).selectAll("rect.d3plus_color").call(M),O.exit().transition().duration(a.draw.timing).attr("opacity",0).remove(),!t&&a.legend.tooltip.value&&O.on(j.over,function(b,d){d3.select(this).style("cursor","pointer");var o,p,e=this.getBoundingClientRect(),f=e.left+c/2+window.scrollX,h=e.top+c/2+window.scrollY+5,i=k(a,b,A),l=a.id.nesting.indexOf(A),n=l>=0?m(a,b,l)[0]:a.format.value(k(a,b,a.color.value,A),{key:a.color.value,vars:a,data:b});if(a.legend.filters.value&&!(i instanceof Array)){o="<div style='text-align:center;'>";var q=a.format.locale.value;o+="<div class='mute'>"+a.format.value(q.method.mute)+"</div>",o+="<div class='solo'>"+a.format.value(q.method.solo)+"</div>",o+="</div>",p=function(b){var c={border:"1px solid #ccc",display:"inline-block",margin:"1px 2px",padding:"3px 5px"};b.select(".mute").style(c).on(j.over,function(){d3.select(this).style("cursor","pointer")}).on(j.click,function(){var b=a.id.mute.value;a.history.states.push(function(){a.self.id({mute:b}).draw()}),a.self.id({mute:i}).draw()}),b.select(".solo").style(c).on(j.over,function(){d3.select(this).style("cursor","pointer")}).on(j.click,function(){var b=a.id.solo.value;a.history.states.push(function(){a.self.id({solo:b}).draw()}),a.self.id({solo:i}).draw()})}}g({data:b,html:o,js:p,depth:z,footer:!1,vars:a,x:f,y:h,mouseevents:this,title:n,offset:.4*c})}).on(j.out,function(b){o(a.type.value)}),a.dev.value&&n.timeEnd("drawing legend")}}else b=!1;if(a.legend.value&&key&&b){if(a.dev.value&&n.time("positioning legend"),c)var X=c+a.ui.padding;else var Y=a.g.legend.node().getBBox(),X=Y.height+Y.y;0===a.margin.bottom&&(a.margin.bottom+=a.ui.padding),a.margin.bottom+=X,a.g.legend.transition().duration(a.draw.timing).attr("transform","translate(0,"+(a.height.value-a.margin.bottom)+")"),a.dev.value&&n.timeEnd("positioning legend")}else a.dev.value&&n.time("hiding legend"),a.g.legend.transition().duration(a.draw.timing).attr("transform","translate(0,"+a.height.value+")"),a.dev.value&&n.timeEnd("hiding legend")}},{"../../../array/sort.coffee":36,"../../../client/pointer.coffee":40,"../../../client/touch.coffee":44,"../../../color/text.coffee":51,"../../../core/console/print.coffee":53,"../../../core/data/nest.js":61,"../../../core/fetch/color.coffee":64,"../../../core/fetch/text.js":67,"../../../core/fetch/value.coffee":68,"../../../object/validate.coffee":171,"../../../string/strip.js":174,"../../../textwrap/textwrap.coffee":199,"../../../tooltip/remove.coffee":202,"../../../util/buckets.coffee":203,"../../../util/copy.coffee":206,"../../../util/dataURL.coffee":208,"../../../util/uniques.coffee":209,"../tooltip/create.js":237}],243:[function(a,b,c){var d=a("../../../client/pointer.coffee");b.exports=function(a,b){function g(b){b.style(e).style("position","absolute").style("background","white").style("text-align","center").style("left",function(){return"center"==f?"50%":"0px"}).style("width",function(){return"center"==f?"auto":a.width.value+"px"}).style("margin-left",function(){return"center"==f?-(this.offsetWidth/2)+"px":"0px"}).style("top",function(){return"center"==f?"50%":"top"==f?"0px":"auto"}).style("bottom",function(){return"bottom"==f?"0px":"auto"}).style("margin-top",function(){if("large"==c){var a=this.offsetHeight||this.getBoundingClientRect().height;return-a/2+"px"}return"0px"})}b=a.messages.value?b:null;var c=a.messages.style.value||(b===a.error.internal?"large":a.messages.style.backup);if("large"===c)var e=a.messages,f="center";else{if(a.footer.value)var e=a.footer;else if(a.title.value)var e=a.title;else if(a.title.sub.value)var e=a.title.sub;else if(a.title.total.value)var e=a.title.total;else var e=a.title.sub;var f=e.position}var e={color:e.font.color,"font-family":e.font.family.value,"font-weight":e.font.weight,"font-size":e.font.size+"px",padding:e.padding+"px"};a.g.message=a.container.value.selectAll("div#d3plus_message").data(["message"]);var h=a.g.message.enter().append("div").attr("id","d3plus_message").attr("opacity",0);h.append("div").attr("class","d3plus_message_text").style("display","block"),a.g.message.select(".d3plus_message_text").text(b?b:a.g.message.text());var i=navigator.onLine,j=75,k=a.g.message.selectAll(".d3plus_message_branding").data(a.messages.branding.value&&"center"===f?[0]:[]);k.enter().append("div").attr("class","d3plus_message_branding").style("margin-top","15px").style("padding-top","0px").style("display","block").style("font-size","11px").style("background-size",j+"px").style("background-position","center 10px").style("background-repeat","no-repeat").style("cursor","pointer").on(d.click,function(){window.open("http://www.d3plus.org/","_blank")}),k.text(i?"Powered by:":"Powered by D3plus").style("background-color",i?"white":"transparent").style("background-image",i?"url('http://d3plus.org/assets/img/d3plus-icon.png')":"none").style("min-width",i?j+"px":"auto").style("height",i?j+"px":"auto"),k.exit().remove(),a.g.message.style("display",b?"inline-block":"none").call(g).style("opacity",b?1:0)}},{"../../../client/pointer.coffee":40}],244:[function(a,b,c){var d,e,f,g,h,i,j,k,l,m;d=a("../../../util/closest.coffee"),e=a("../../../client/css.coffee"),g=a("../../../font/sizes.coffee"),f=a("../../../client/pointer.coffee"),h=a("../../../color/mix.coffee"),j=a("../../../client/prefix.coffee"),k=a("../../../core/console/print.coffee"),l=a("../../../color/text.coffee"),m=a("../../../core/data/time.coffee"),i=!1,b.exports=function(a){var b,c,g,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa;if(!a.timeline.value||a.error.internal&&a.data.missing||a.small||!a.data.time||!(a.data.time.values.length>1))return a.g.timeline.transition().duration(a.draw.timing).attr("transform","translate(0,"+a.height.value+")");if(a.dev.value&&k.time("drawing timeline"),S={"font-weight":a.ui.font.weight,"font-family":a.ui.font.family.value,"font-size":a.ui.font.size+"px","text-anchor":"middle"},fa=a.data.time.ticks.map(function(a){return new Date(a)}),X=m(a,{values:fa,style:S}),aa=X.values.map(Number),W=X.format,a.time.solo.value.length)for(v=d3.extent(a.time.solo.value),u=w=0,z=v.length;w<z;u=++w)r=v[u],r.constructor!==Date&&(r+="",4===r.length&&parseInt(r)+""===r&&(r+="/01/01"),r=new Date(r),v[u]=r);else v=d3.extent(fa);if(ea=fa.slice(),ca=d3.max(X.sizes.map(function(a){return a.height})),x=~~d3.max(X.sizes.map(function(a){return a.width}))+1,x+=2*a.ui.padding,Z=ca+2*a.ui.padding,_=x*fa.length,K=Z,b=a.width.value-2*a.ui.padding,a.timeline.play.value&&(b-=K+a.ui.padding),aa.length<fa.length||b<x*aa.length){for(D=x,x=(b-x)/fa.length,_=x*fa.length,$=1,U=~~(D/(_/aa.length))+1;U<aa.length-1&&(aa.length-1)%U!==0;)U++;aa=aa.filter(function(a,b){return b%U===0})}else $=0,B=new Date(fa[0]),O=a.data.time.stepType,B["set"+O](B["get"+O]()+fa.length),ea.push(B);return M=new Date(v[0]),M=d(ea,M),s=new Date(v[1]),$||s["set"+a.data.time.stepType](s["get"+a.data.time.stepType]()+1),s=d(ea,s),da=ea.map(Number),C=da.indexOf(+M),A=da.indexOf(+s),n=[M,s],N="start"===a.timeline.align?a.ui.padding:"end"===a.timeline.align?a.width.value-a.ui.padding-_:a.width.value/2-_/2,a.timeline.play.value&&(N+=(K+a.ui.padding)/2),P=function(){return clearInterval(i),i=!1,F.call(G,"icon")},p=function(){var a,b,c;if(null!==d3.event.sourceEvent){if(i&&P(),n=g.extent(),c=d(ea,n[0]),b=d(ea,n[1]),c===b&&(C=da.indexOf(+c),c<n[0]||0===C?b=ea[C+1]:c=ea[C-1]),C=da.indexOf(+c),A=da.indexOf(+b),A-C>=1)a=[c,b];else if(C+1<=fa.length)a=[c,ea[C+1]];else{for(a=[c],u=1;u<=1;)C+u<=fa.length?a.push(ea[C+u]):a.unshift(ea[C-(C+u-fa.length)]),u++;a=[a[0],a[a.length-1]]}return n=a,Q.attr("fill",R),d3.select(this).call(g.extent(a))}},L=function(){var b;return A-C===fa.length-$?b=[]:(b=da.filter(function(a,b){return b>=C&&b<A+$}),b=b.map(function(a){return new Date(a)})),J(),a.self.time({solo:b}).draw()},q=function(){var b,c,e,f;if(null!==d3.event.sourceEvent&&(a.time.solo.value.length?(f=d3.extent(a.time.solo.value),e=da.indexOf(+d(ea,f[0])),c=da.indexOf(+d(ea,f[1])),b=e!==C||c!==A):b=A-C!==fa.length-$,b))return L()},E=a.g.timeline.selectAll("rect.d3plus_timeline_play").data(a.timeline.play.value?[0]:[]),I=function(b){return b.attr("width",K+1).attr("height",Z+1).attr("fill",a.ui.color.primary.value).attr("stroke",a.ui.color.primary.value).attr("stroke-width",1).attr("x",N-K-1-a.ui.padding).attr("y",a.ui.padding)},E.enter().append("rect").attr("class","d3plus_timeline_play").attr("shape-rendering","crispEdges").attr("opacity",0).call(I),E.transition().duration(a.draw.timing).call(I),E.exit().transition().duration(a.draw.timing).attr("opacity",0).remove(),F=a.g.timeline.selectAll("text.d3plus_timeline_playIcon").data(a.timeline.play.value?[0]:[]),G=function(b,c){var d;return c=a.timeline.play[c],e("font-awesome")?(c=c.awesome,d="FontAwesome"):(c=c.fallback,d="inherit"),b.style("font-family",d).text(c)},H=function(b){var c;return c=Z/2+a.ui.padding+1,b.attr("fill",l(a.ui.color.primary.value)).attr(S).attr("x",N-(K-1)/2-a.ui.padding).attr("y",c).attr("dy","0.5ex").call(G,i?"pause":"icon")},F.enter().append("text").attr("class","d3plus_timeline_playIcon").call(H).style("pointer-events","none").attr("opacity",0),F.call(H).transition().duration(a.draw.timing).attr("opacity",1),F.exit().transition().duration(a.draw.timing).attr("opacity",0).remove(),J=function(){return A-C===fa.length-$?(E.on(f.hover,null).on(f.click,null).transition().duration(a.draw.timing).attr("opacity",.3),F.transition().duration(a.draw.timing).attr("opacity",.3)):(E.on(f.over,function(){
return d3.select(this).style("cursor","pointer")}).on(f.out,function(){return d3.select(this).style("cursor","auto")}).on(f.click,function(){return i?P():(F.call(G,"pause"),A===fa.length?(A-=C,C=0):(C++,A++),L(),i=setInterval(function(){return A===fa.length-$?P():(C++,A++,L())},a.timeline.play.timing.value))}).transition().duration(a.draw.timing).attr("opacity",1),F.transition().duration(a.draw.timing).attr("opacity",1))},J(),R=function(b){var c,d,e;return d=$?b<=n[1]:b<n[1],b>=n[0]&&d?(e=1,c=l(a.ui.color.secondary.value)):(e=.5,c=l(a.ui.color.primary.value)),c=d3.rgb(c),"rgba("+c.r+","+c.g+","+c.b+","+e+")"},c=a.g.timeline.selectAll("rect.d3plus_timeline_background").data(["background"]),c.enter().append("rect").attr("class","d3plus_timeline_background").attr("shape-rendering","crispEdges").attr("width",_+2).attr("height",Z+2).attr("fill",a.ui.color.primary.value).attr("x",N-1).attr("y",a.ui.padding),c.transition().duration(a.draw.timing).attr("width",_+2).attr("height",Z+2).attr("fill",a.ui.color.primary.value).attr("x",N-1).attr("y",a.ui.padding),V=a.g.timeline.selectAll("g#ticks").data(["ticks"]),V.enter().append("g").attr("id","ticks").attr("transform","translate("+a.width.value/2+","+a.ui.padding+")"),o=a.g.timeline.selectAll("g#brush").data(["brush"]),o.enter().append("g").attr("id","brush"),y=a.g.timeline.selectAll("g#labels").data(["labels"]),y.enter().append("g").attr("id","labels"),Q=y.selectAll("text").data(fa,function(a,b){return b}),Q.enter().append("text").attr("y",0).attr("dy","0.5ex").attr("x",0),ba=d3.time.scale().domain(d3.extent(ea)).rangeRound([0,_]),Q.order().attr(S).text(function(a,b){return aa.indexOf(+a)>=0?W(a):""}).attr("opacity",function(b,c){return a.data.time.dataSteps.indexOf(c)>=0?1:.4}).attr("fill",R).attr("transform",function(b,c){var d,e;return d=N+ba(b),$||(d+=x/2),e=Z/2+a.ui.padding+1,$&&(e+=Z),"translate("+Math.round(d)+","+Math.round(e)+")"}),Q.exit().transition().duration(a.draw.timing).attr("opacity",0).remove(),g=d3.svg.brush().x(ba).extent(n).on("brush",p).on("brushend",q),T=a.axes.discrete&&a[a.axes.discrete].value===a.time.value?a[a.axes.discrete].ticks.color:a.x.ticks.color,V.attr("transform","translate("+N+","+a.ui.padding+")").transition().duration(a.draw.timing).call(d3.svg.axis().scale(ba).orient("top").ticks(function(){return ea}).tickFormat("").tickSize(-Z).tickPadding(0)).selectAll("line").attr("stroke-width",1).attr("shape-rendering","crispEdges").attr("stroke",function(b){return aa.indexOf(+b)>=0?T:h(T,a.background.value,.4,1)}),V.selectAll("path").attr("fill","none"),o.attr("transform","translate("+N+","+a.ui.padding+")").attr("opacity",1).call(g),Q.attr("pointer-events","none"),o.selectAll("rect.background").attr("fill","none").style("visibility","visible").attr("height",Z).attr("shape-rendering","crispEdges").on(f.move,function(){var b;return b=a.timeline.hover.value,["grab","grabbing"].indexOf(b)>=0&&(b=j()+b),d3.select(this).style("cursor",b)}),o.selectAll("rect.extent").attr("opacity",.75).attr("height",Z).attr("fill",a.ui.color.secondary.value).attr("shape-rendering","crispEdges").on(f.move,function(){var b;return b=a.timeline.hover.value,["grab","grabbing"].indexOf(b)>=0&&(b=j()+b),d3.select(this).style("cursor",b)}),a.timeline.handles.value?(t=o.selectAll("g.resize").selectAll("rect.d3plus_handle").data(["d3plus_handle"]),t.enter().insert("rect","rect").attr("class","d3plus_handle"),t.attr("fill",a.timeline.handles.color).attr("transform",function(b){var c;return c="resize e"===this.parentNode.className.baseVal?-a.timeline.handles.size:0,"translate("+c+",0)"}).attr("width",a.timeline.handles.size).style("visibility","visible").attr("shape-rendering","crispEdges").attr("opacity",a.timeline.handles.opacity),o.selectAll("g.resize").selectAll("rect").attr("height",Z)):o.selectAll("g.resize").remove(),Y=a.g.timeline.node().getBBox(),0===a.margin.bottom&&(a.margin.bottom+=a.ui.padding),a.margin.bottom+=Y.height+Y.y,a.g.timeline.transition().duration(a.draw.timing).attr("transform","translate(0,"+Math.round(a.height.value-a.margin.bottom-a.ui.padding/2)+")"),a.margin.bottom+=a.ui.padding,a.dev.value?k.time("drawing timeline"):void 0}},{"../../../client/css.coffee":38,"../../../client/pointer.coffee":40,"../../../client/prefix.coffee":41,"../../../color/mix.coffee":47,"../../../color/text.coffee":51,"../../../core/console/print.coffee":53,"../../../core/data/time.coffee":63,"../../../font/sizes.coffee":101,"../../../util/closest.coffee":205}],245:[function(a,b,c){var d=a("../../../client/pointer.coffee"),e=a("../../../core/fetch/value.coffee"),f=a("../../../core/console/print.coffee"),g=a("../../../client/rtl.coffee"),h=a("../../../textwrap/textwrap.coffee");b.exports=function(a){function r(b){b.attr("font-size",function(a){return a.style.font.size}).attr("fill",function(b){return b.link?a.links.font.color:b.style.font.color}).attr("font-family",function(b){return b.link?a.links.font.family.value:b.style.font.family.value}).attr("font-weight",function(b){return b.link?a.links.font.weight:b.style.font.weight}).style("text-decoration",function(b){return b.link?a.links.font.decoration.value:b.style.font.decoration.value}).style("text-transform",function(b){return b.link?a.links.font.transform.value:b.style.font.transform.value})}function u(a){var b=a.style.font.align;return"center"==b?"middle":"left"==b&&!g||"right"==b&&g?"start":"left"==b&&g||"right"==b&&!g?"end":b}var b=a.size.value?a.size.value:"number"===a.color.type&&a.color.value;if(a.data.viz&&a.title.total.value&&!a.small)if(b){a.dev.value&&f.time("calculating total value");var i=a.data.pool;a.focus.value.length&&(i=a.data.viz.filter(function(b){return b[a.id.value]==a.focus.value[0]}));var c,j=a.aggs.value[b]||"sum";if(j.constructor===Function?c=j(i):(i=i.reduce(function(c,d){var f=e(a,d,b);return f instanceof Array?c=c.concat(f):c.push(f),c},[]),c=d3[j](i)),0!==c&&null!==c&&void 0!==c||(c=!1),"number"==typeof c){var k="";if(a.data.mute.length||a.data.solo.length||a.focus.value.length){var l=d3.sum(a.data.value,function(c){if(a.time.solo.value.length>0)var d=a.time.solo.value.indexOf(e(a,c,a.time.value))>=0;else if(a.time.mute.value.length>0)var d=a.time.solo.value.indexOf(e(a,c,a.time.value))<0;else var d=!0;if(d)return e(a,c,b)});if(l>c){var k=c/l*100,m=a.format.value(l,{key:a.size.value,vars:a});k=" ("+a.format.value(k,{key:"share",vars:a})+" of "+m+")"}}c=a.format.value(c,{key:a.size.value,vars:a});var n=a.title.total.value,o=n.prefix||a.format.value(a.format.locale.value.ui.total)+": ";c=o+c,n.suffix?c+=n.suffix:null,c+=k}a.dev.value&&f.timeEnd("calculating total value")}else var c=!1;else var c=!1;var p=[];if(a.footer.value&&p.push({link:a.footer.link,style:a.footer,type:"footer",value:a.footer.value}),!a.small){if(a.title.value){var q=a.title.value;"function"==typeof q&&(q=q(a.self)),p.push({link:a.title.link,style:a.title,type:"title",value:q})}if(a.title.sub.value){var q=a.title.sub.value;"function"==typeof q&&(q=q(a.self)),p.push({link:a.title.sub.link,style:a.title.sub,type:"sub",value:q})}a.title.total.value&&c&&p.push({link:a.title.total.link,style:a.title.total,type:"total",value:c})}a.dev.value&&f.time("drawing titles");var s=a.svg.selectAll("g.d3plus_title").data(p,function(a){return a.type}),t=a.title.width||a.width.value-a.margin.left-a.margin.right;s.enter().append("g").attr("class",function(a){return"d3plus_title "+a.type}).attr("opacity",0).append("text").call(r),s.each(function(b){var c=d3.select(this).select("text").call(r),d=u(b);h().align(d).container(c).height(a.height.value/8).size(!1).text(b.value).width(t).draw(),b.y=a.margin[b.style.position],a.margin[b.style.position]+=this.getBBox().height+2*b.style.padding}).on(d.over,function(b){b.link&&d3.select(this).transition().duration(a.timing.mouseevents).style("cursor","pointer").select("text").attr("fill",a.links.hover.color).attr("font-family",a.links.hover.family.value).attr("font-weight",a.links.hover.weight).style("text-decoration",a.links.hover.decoration.value).style("text-transform",a.links.hover.transform.value)}).on(d.out,function(b){b.link&&d3.select(this).transition().duration(a.timing.mouseevents).style("cursor","auto").select("text").call(r)}).on(d.click,function(a){if(a.link){var b="/"!=a.link.charAt(0)?"_blank":"_self";window.open(a.link,b)}}).attr("opacity",1).attr("transform",function(b){var c=b.style.position,d="top"==c?0+b.y:a.height.value-b.y;"bottom"==c?d-=this.getBBox().height+b.style.padding:d+=b.style.padding;var e=u(b);if("start"===e)var f=a.margin.left+a.title.padding;else{d3.select(this).select("text").node().getBBox().width;f="middle"===e?a.width.value/2-t/2:a.width.value-t-a.margin.right-a.title.padding}return"translate("+f+","+d+")"}),s.exit().transition().duration(a.draw.timing).attr("opacity",0).remove(),a.margin.top>0&&(a.margin.top+=a.title.padding),a.margin.bottom>0&&(a.margin.bottom+=a.title.padding);var v=a.title.height;v&&a.margin[a.title.position]<v&&(a.margin[a.title.position]=v),a.dev.value&&f.timeEnd("drawing titles")}},{"../../../client/pointer.coffee":40,"../../../client/rtl.coffee":42,"../../../core/console/print.coffee":53,"../../../core/fetch/value.coffee":68,"../../../textwrap/textwrap.coffee":199}],246:[function(a,b,c){var d,e;d=a("./labels.coffee"),e=a("./transform.coffee"),b.exports=function(a,b,c){var f,g,h,i,j,k,l,m,n;return b||(b=a.zoom.bounds),"number"!=typeof c&&(c=a.timing.transitions),a.zoom.size={height:b[1][1]-b[0][1],width:b[1][0]-b[0][0]},n=a.types[a.type.value],h=a.coords.fit.value,f="auto"===h||n.requirements.indexOf("coords")<0?d3.max([a.zoom.size.width/a.width.viz,a.zoom.size.height/a.height.viz]):a.zoom.size[h]/a["app_"+h],j=d3.min([a.width.viz,a.height.viz]),k=n.zoom?2*a.coords.padding:0,l=(j-k)/j/f,g=a.zoom.behavior.scaleExtent(),g[0]!==g[1]&&b!==a.zoom.bounds||a.zoom.behavior.scaleExtent([l,16*l]),i=a.zoom.behavior.scaleExtent()[1],l>i&&(l=i),a.zoom.scale=l,m=[a.width.viz/2-a.zoom.size.width*l/2-b[0][0]*l,a.height.viz/2-a.zoom.size.height*l/2-b[0][1]*l],a.zoom.translate=m,a.zoom.behavior.translate(m).scale(l),a.zoom.size={height:a.zoom.bounds[1][1]-a.zoom.bounds[0][1],width:a.zoom.bounds[1][0]-a.zoom.bounds[0][0]},a.zoom.reset=!1,d(a),e(a,c)}},{"./labels.coffee":248,"./transform.coffee":251}],247:[function(a,b,c){b.exports=function(a,b){var c,d,e;return d=b.id.nesting.length-1,c=b.depth.value,e=b.id.nesting[b.depth.value+1],b.types[b.type.value].nesting===!1?0:(a.d3plus.merged||e in a&&c<d)&&(!a||e in a)?1:c!==d&&(!a||e in a)||!b.small&&b.tooltip.html.value?0:-1}},{}],248:[function(a,b,c){var d;d=a("../../../core/console/print.coffee"),b.exports=function(a){var b,c;if(a.dev.value&&d.time("determining label visibility"),c=a.zoom.behavior.scaleExtent(),b=function(b){return b.attr("opacity",function(b){var d;return b||(b={}),d=parseFloat(d3.select(this).attr("font-size"),10),b.visible=d*(a.zoom.scale/c[1])>=2,b.visible?1:0})},a.draw.timing?a.g.viz.selectAll("text.d3plus_label").transition().duration(a.draw.timing).call(b):a.g.viz.selectAll("text.d3plus_label").call(b),a.dev.value)return d.timeEnd("determining label visibility")}},{"../../../core/console/print.coffee":53}],249:[function(a,b,c){var d,e;d=a("./labels.coffee"),e=a("./transform.coffee"),b.exports=function(a){var b,c,f,g,h,i,j,k,l,m,n;return c=d3.event.sourceEvent?d3.event.sourceEvent.type:null,h=d3.event.translate,g=d3.event.scale,f=a.zoom.bounds,k=(a.width.viz-a.zoom.size.width*g)/2,j=k>0?k:0,i=k>0?a.width.viz-k:a.width.viz,n=(a.height.viz-a.zoom.size.height*g)/2,m=n>0?n:0,l=n>0?a.height.viz-n:a.height.viz,h[0]+f[0][0]*g>j?h[0]=-f[0][0]*g+j:h[0]+f[1][0]*g<i&&(h[0]=i-f[1][0]*g),h[1]+f[0][1]*g>m?h[1]=-f[0][1]*g+m:h[1]+f[1][1]*g<l&&(h[1]=l-f[1][1]*g),a.zoom.behavior.translate(h).scale(g),a.zoom.translate=h,a.zoom.scale=g,"wheel"===c?(b=a.draw.timing?100:250,clearTimeout(a.zoom.wheel),a.zoom.wheel=setTimeout(function(){return d(a)},b)):d(a),"dblclick"===c?e(a,a.timing.transitions):e(a,0)}},{"./labels.coffee":248,"./transform.coffee":251}],250:[function(a,b,c){b.exports=function(a,b){var c,d,e,f;d=a.zoom,b||(b=d3.event),f=d.scale>d.behavior.scaleExtent()[0],c=a.types[a.type.value].zoom&&d.value&&d.scroll.value,e=b.touches&&b.touches.length>1&&c,e||f||b.stopPropagation()}},{}],251:[function(a,b,c){b.exports=function(a,b){var c;return"number"!=typeof b&&(b=a.timing.transitions),c="translate("+a.zoom.translate+")",c+="scale("+a.zoom.scale+")",b?a.g.viz.transition().duration(b).attr("transform",c):a.g.viz.attr("transform",c)}},{}],252:[function(a,b,c){var d;d=a("../../core/methods/filter.coffee"),b.exports={accepted:[!1,Function,Object,String],deprecates:"active_var",mute:d(!0),solo:d(!0),spotlight:{accepted:[Boolean],deprecates:"spotlight",value:!1},value:!1}},{"../../core/methods/filter.coffee":80}],253:[function(a,b,c){b.exports={accepted:[Object],deprecated:"nesting_aggs",objectAccess:!1,value:{}}},{}],254:[function(a,b,c){var d;d=a("../../core/methods/process/data.coffee"),b.exports={accepted:[!1,Array,Object,String],delimiter:{accepted:String,value:"|"},filetype:{accepted:[!1,"json","xml","html","csv","dsv","tsv","txt"],value:!1},keys:{},process:d,value:!1}},{"../../core/methods/process/data.coffee":86}],255:[function(a,b,c){var d;d=a("../../core/methods/rendering.coffee"),b.exports={background:{color:"#fafafa",rendering:d(),stroke:{color:"#ccc",width:1}},mirror:{accepted:[Boolean],deprecates:["mirror_axis","mirror_axes"],value:!1}}},{"../../core/methods/rendering.coffee":91}],256:[function(a,b,c){b.exports={accepted:[String],value:"#ffffff"}},{}],257:[function(a,b,c){var d,e;d=a("../../core/methods/filter.coffee"),e=a("../../color/scale.coffee"),b.exports={accepted:[!1,Array,Function,Object,String],deprecates:"color_var",focus:"#444444",heatmap:["#282F6B","#419391","#AFD5E8","#EACE3F","#B35C1E","#B22200"],missing:"#eeeeee",mute:d(!0),primary:"#d74b03",range:["#B22200","#FFEE8D","#759143"],scale:{accepted:[Array,Function,"d3plus","category10","category20","category20b","category20c"],process:function(a){return a instanceof Array?d3.scale.ordinal().range(a):"d3plus"===a?e:"string"==typeof a?d3.scale[a]():a},value:"d3plus"},solo:d(!0),secondary:"#e5b3bb",value:!1}},{"../../color/scale.coffee":49,"../../core/methods/filter.coffee":80}],258:[function(a,b,c){b.exports={accepted:[Array,Function,String],index:{accepted:[Boolean],value:!0},process:function(a,b){return"string"==typeof a&&(a=[a]),a},value:!1}},{}],259:[function(a,b,c){b.exports={accepted:[Object],objectAccess:!1,process:function(a,b){var c,d;for(c in a)d=a[c],c in b.self&&b.self[c](d);return a},value:{}}},{}],260:[function(a,b,c){var d;d=a("../../util/d3selection.coffee"),b.exports={accepted:[!1,Array,Object,String],id:"default",process:function(a){return a!==!1&&(d(a)?a:a instanceof Array?d3.select(a[0][0]):d3.select(a))},value:!1}},{"../../util/d3selection.coffee":207}],261:[function(a,b,c){var d,e;d=a("../../core/methods/filter.coffee"),e=a("../../core/methods/process/data.coffee"),b.exports={accepted:[!1,Array,Function,Object,String],center:[0,0],filetype:{accepted:["json"],value:"json"},fit:{accepted:["auto","height","width"],value:"auto"},mute:d(!1),padding:20,process:e,projection:{accepted:["mercator","equirectangular"],value:"mercator"},solo:d(!1),threshold:{accepted:[Number],value:.9},value:!1}},{"../../core/methods/filter.coffee":80,"../../core/methods/process/data.coffee":86}],262:[function(a,b,c){var d,e,f;d=a("../../core/fetch/value.coffee"),e=a("../../client/ie.js"),f=a("../../string/strip.js"),b.exports={accepted:[void 0,!0,Array,String],chainable:!1,data:[],process:function(a,b){var c,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O;if(void 0===b.returned)return[];if(a=a||b.cols.value,a instanceof Array?i=a:"string"==typeof a&&(i=[a]),k=[],N=[],b.title.value?(M=b.title.value,"function"==typeof M&&(M=M(b.self)),M=f(M),C=250,M=M.substr(0,C)):M="D3plus Visualization Data",a===!0)for(i=d3.keys(b.data.keys),k.push(i),I=b.data.value,p=0,s=I.length;p<s;p++){for(l=I[p],L=[],q=0,t=i.length;q<t;q++)g=i[q],O=l[g],"string"===b.data.keys[g]&&(O='"'+O+'"'),L.push(O);k.push(L)}else{for(i||(i=[b.id.value],b.time.value&&i.push(b.time.value),b.size.value&&i.push(b.size.value),b.text.value&&i.push(b.text.value)),r=0,u=i.length;r<u;r++)g=i[r],N.push(b.format.value(g));for(k.push(N),J=b.returned.nodes,B=0,v=J.length;B<v;B++)if(E=J[B],null!=E.values&&E.values instanceof Array)for(K=E.values,D=0,w=K.length;D<w;D++){for(O=K[D],L=[],F=0,x=i.length;F<x;F++)h=i[F],O=d(b,O,h),"string"==typeof O&&(O='"'+O+'"'),L.push(O);k.push(L)}else{for(L=[],G=0,y=i.length;G<y;G++)h=i[G],L.push(d(b,E,h));k.push(L)}}for(j="data:text/csv;charset=utf-8,",o=H=0,z=k.length;H<z;o=++H)g=k[o],m=g.join(","),j+=o<k.length?m+"\n":m;return e?(c=new Blob([j],{type:"text/csv;charset=utf-8;"}),navigator.msSaveBlob(c,M+".csv")):(n=encodeURI(j),A=document.createElement("a"),A.setAttribute("href",n),A.setAttribute("download",M+".csv"),A.click()),this.data=k,i},value:void 0}},{"../../client/ie.js":39,"../../core/fetch/value.coffee":68,"../../string/strip.js":174}],263:[function(a,b,c){var d;d=a("../../core/methods/process/data.coffee"),b.exports={accepted:[!1,Array,Function,String],cache:{},delimiter:{accepted:[String],value:"|"},donut:{size:.35},filetype:{accepted:[!1,"json","xml","html","csv","dsv","tsv","txt"],value:!1},filters:[],keys:{},mute:[],large:400,opacity:.9,padding:{accepted:[Number],value:1},process:function(a,b){return"default"===b.container.id&&a.length&&b.self.container({id:"default"+a.length}),d(a,b,this)},solo:[],stroke:{width:1},value:!1}},{"../../core/methods/process/data.coffee":86}],264:[function(a,b,c){b.exports={accepted:[Function,Number],value:0}},{}],265:[function(a,b,c){b.exports={accepted:[!1,Function,Object],value:!1}},{}],266:[function(a,b,c){b.exports={accepted:[Boolean],value:!1}},{}],267:[function(a,b,c){var d=a("../../core/console/print.coffee"),e=a("../../string/format.js");b.exports={accepted:[void 0,Function],first:!0,frozen:!1,process:function(a,b){if(this.initialized===!1)return this.initialized=!0,a;if(void 0===a&&"function"==typeof this.value&&(a=this.value),b.container.value===!1){var c=b.format.locale.value.dev.setContainer;d.warning(c,"container")}else if(b.container.value.empty()){var c=b.format.locale.value.dev.noContainer;d.warning(e(c,'"'+b.container.value+'"'),"container")}else b.dev.value&&d.time("total draw time"),b.container.value.call(b.self);if("function"==typeof a&&b.history.chain.length){var f={};changes.forEach(function(a){var b=a.method;delete a.method,f[b]=a}),a(f),b.history.chain=[]}return a},update:!0,value:void 0}},{"../../core/console/print.coffee":53,"../../string/format.js":172}],268:[function(a,b,c){var d=a("../../core/methods/process/data.coffee");b.exports={accepted:[!1,Array,Function,String],arrows:{accepted:[Boolean,Number],direction:{accepted:["source","target"],value:"target"},value:!1},color:"#d0d0d0",connections:function(a,b,c){var d=this;if(!d.value)return[];if(!b)var b="id";var e=d.restricted||d.value,f=[];if(!a)return e;var g=e.filter(function(e){var g=!1;return e[d.source][b]==a?(g=!0,c&&f.push(e[d.target])):e[d.target][b]==a&&(g=!0,c&&f.push(e[d.source])),g});return c?f:g},delimiter:{accepted:[String],value:"|"},filetype:{accepted:[!1,"json","xml","html","csv","dsv","tsv","txt"],value:!1},interpolate:{accepted:["basis","cardinal","linear","monotone","step"],value:"basis"},label:!1,large:100,limit:{accepted:[!1,Function,Number],value:!1},opacity:{accepted:[Function,Number,String],min:{accepted:[Number],value:.25},scale:{accepted:[Function],value:d3.scale.linear()},value:1},process:d,size:{accepted:[!1,Number,String],min:1,scale:.5,value:!1},source:"source",strength:{accepted:[!1,Function,Number,String],value:!1},target:"target",value:!1}},{"../../core/methods/process/data.coffee":86}],269:[function(a,b,c){b.exports={accepted:[Boolean,String],value:!1}},{}],270:[function(a,b,c){b.exports={accepted:[!1,Array,Function,Number,String],deprecates:"highlight",process:function(a){return a===!1?[]:a instanceof Array?a:[a]},tooltip:{accepted:[Boolean],value:!0},value:[]}},{}],271:[function(a,b,c){var d,e,f,g;d=a("../../core/methods/font/align.coffee"),e=a("../../core/methods/font/decoration.coffee"),f=a("../../core/methods/font/family.coffee"),g=a("../../core/methods/font/transform.coffee"),b.exports={align:d(),color:"#444444",decoration:e(),family:f(),secondary:{align:d(),color:"#444444",decoration:e(),family:f(),size:12,spacing:0,transform:g(),weight:200},size:12,spacing:0,transform:g(),weight:200}},{"../../core/methods/font/align.coffee":81,"../../core/methods/font/decoration.coffee":82,"../../core/methods/font/family.coffee":83,"../../core/methods/font/transform.coffee":85}],272:[function(a,b,c){var d,e,f;e=a("../../core/methods/font/family.coffee"),d=a("../../core/methods/font/decoration.coffee"),f=a("../../core/methods/font/transform.coffee"),b.exports={accepted:[!1,Number,String],font:{align:"center",color:"#444",decoration:d(),family:e(),size:11,transform:f(),weight:200},link:!1,padding:0,position:"bottom",value:!1}},{"../../core/methods/font/decoration.coffee":82,"../../core/methods/font/family.coffee":83,"../../core/methods/font/transform.coffee":85}],273:[function(a,b,c){var d,e,f,g;d=a("../../number/format.coffee"),e=a("../../core/locale/locale.coffee"),f=a("../../object/merge.coffee"),g=a("../../string/title.coffee"),b.exports={accepted:[Function,String],affixes:{accepted:[Object],objectAccess:!1,value:{}},deprecates:["number_format","text_format"],locale:{accepted:function(){return d3.keys(e)},process:function(a){var b,c;return b="en_US",c=e[b],a!==b&&(c=f(c,e[a])),this.language=a,c},value:"en_US"},number:{accepted:[!1,Function],value:!1},process:function(a,b){if("string"==typeof a)b.self.format({locale:a});else if("function"==typeof a)return a;return this.value},text:{accepted:[!1,Function],value:!1},value:function(a,b){var c,e,f;return b||(b={}),b.locale||(b.locale=this.locale.value),f=b.vars||{},f.time&&f.time.value&&b.key===f.time.value?(e=a.constructor===Date?a:new Date(a),f.data.time.format(e)):"number"==typeof a?(c=this.number.value||d)(a,b):"string"==typeof a?(c=this.text.value||g)(a,b):JSON.stringify(a)}}},{"../../core/locale/locale.coffee":78,"../../number/format.coffee":169,"../../object/merge.coffee":170,"../../string/title.coffee":175}],274:[function(a,b,c){b.exports={accepted:[!1,Number],max:600,secondary:!1,small:200,value:!1}},{}],275:[function(a,b,c){var d,e,f,g,h,i,j;d=a("../../../core/methods/font/align.coffee"),e=a("../../../core/methods/font/decoration.coffee"),f=a("../../../core/methods/font/family.coffee"),g=a("../../../core/methods/filter.coffee"),h=a("../../../core/methods/font/position.coffee"),i=a("../../../core/methods/rendering.coffee"),j=a("../../../core/methods/font/transform.coffee"),b.exports=function(a){return{accepted:[Array,Boolean,Function,Object,String],affixes:{accepted:[Boolean],separator:{accepted:[Boolean,Array],value:!0},value:!1},axis:{accepted:[Boolean],color:"#444",font:{color:!1,decoration:e(!1),family:f(""),size:!1,transform:j(!1),weight:!1},rendering:i(),value:!0},dataFilter:!0,deprecates:[a+"axis",a+"axis_val",a+"axis_var"],domain:{accepted:[!1,Array],value:!1},grid:{accepted:[Boolean],color:"#ccc",rendering:i(),value:!0},label:{accepted:[Boolean,String],fetch:function(b){return this.value===!0?b.format.value(b[a].value,{key:a,vars:b}):this.value},font:{color:"#444",decoration:e(),family:f(),size:12,transform:j(),weight:200},padding:3,value:!0},lines:{accept:[!1,Array,Number,Object],dasharray:{accepted:[Array,String],process:function(a){return a instanceof Array&&(a=a.filter(function(a){return!isNaN(a)}),a=a.length?a.join(", "):"none"),a},value:"10, 10"},color:"#888",font:{align:d("right"),color:"#444",background:{accepted:[Boolean],value:!0},decoration:e(),family:f(),padding:{accepted:[Number],value:10},position:h("middle"),size:12,transform:j(),weight:200},process:Array,rendering:i(),width:1,value:[]},mouse:{accept:[Boolean],dasharray:{accepted:[Array,String],process:function(a){return a instanceof Array&&(a=a.filter(function(a){return!isNaN(a)}),a=a.length?a.join(", "):"none"),a},value:"none"},rendering:i(),width:2,value:!0},mute:g(!0),padding:{accepted:[Number],value:.1},range:{accepted:[!1,Array],value:!1},scale:{accepted:["linear","log","discrete","share"],deprecates:["layout","unique_axis",a+"axis_scale"],process:function(b,c){var d,e,f,g;for(f=["log","discrete","share"],d=0,e=f.length;d<e;d++)g=f[d],g===b?c.axes[g]=a:c.axes[g]===a&&(c.axes[g]=!1);return"discrete"===b&&(c.axes.opposite="x"===a?"y":"x"),b},value:"linear"},solo:g(!0),stacked:{accepted:[Boolean],process:function(b,c){return b||c.axes.stacked!==a?b&&(c.axes.stacked=a):c.axes.stacked=!1,b},value:!1},ticks:{color:"#ccc",font:{color:"#666",decoration:e(),family:f(),size:10,transform:j(),weight:200},rendering:i(),size:10,width:1},value:!1,zerofill:{accepted:[Boolean],value:!1}}}},{"../../../core/methods/filter.coffee":80,"../../../core/methods/font/align.coffee":81,"../../../core/methods/font/decoration.coffee":82,"../../../core/methods/font/family.coffee":83,"../../../core/methods/font/position.coffee":84,"../../../core/methods/font/transform.coffee":85,"../../../core/methods/rendering.coffee":91}],276:[function(a,b,c){b.exports={accepted:[Boolean],back:function(){if(this.states.length)return this.states.pop()()},chain:[],reset:function(){var a;for(a=[];this.states.length;)a.push(this.states.pop()());return a},states:[],value:!0}},{}],277:[function(a,b,c){var d;d=a("../../core/methods/process/icon.coffee"),b.exports={accepted:[!1,Array,Function,Object,String],back:{accepted:[!1,String],fallback:"&#x276e;",opacity:1,process:d,rotate:0,value:"fa-angle-left"},deprecates:"icon_var",style:{accepted:[Object,String],deprecates:"icon_style",value:"default"},value:!1}},{"../../core/methods/process/icon.coffee":88}],278:[function(a,b,c){var d;d=a("../../core/methods/filter.coffee"),b.exports={accepted:[Array,String],dataFilter:!0,deprecates:["id_var","nesting"],grouping:{accepted:[Boolean],value:!0},mute:d(!0),nesting:["id"],solo:d(!0),value:"id"}},{"../../core/methods/filter.coffee":80}],279:[function(a,b,c){var d,e,f;d=a("../../core/methods/font/decoration.coffee"),e=a("../../core/methods/font/family.coffee"),f=a("../../core/methods/font/transform.coffee"),b.exports={accepted:[Boolean],align:{accepted:["start","middle","end","left","center","right"],process:function(a){var b;return b=["left","center","right"].indexOf(a),b>=0&&(a=this.accepted[b]),a},value:"middle"},font:{decoration:d(),family:e(),size:11,transform:f(),weight:200},padding:7,resize:{accepted:[Boolean],value:!0},text:{accepted:[!1,Function,String],value:!1},segments:2,valign:{accepted:[!1,"top","middle","bottom"],value:"middle"},value:!0}},{"../../core/methods/font/decoration.coffee":82,"../../core/methods/font/family.coffee":83,"../../core/methods/font/transform.coffee":85}],280:[function(a,b,c){var d;d=a("../../core/methods/font/family.coffee"),b.exports={accepted:[Boolean],align:"middle",filters:{accepted:[Boolean],value:!1},font:{align:"middle",color:"#444444",family:d(),size:10,weight:200},gradient:{height:10},icons:{accepted:[Boolean],value:!0},order:{accepted:["color","id","size","text"],sort:{accepted:["asc","desc"],value:"asc"},value:"color"},size:[8,30],tooltip:{accepted:[Boolean],value:!0},text:{accepted:[!1,Function,String],value:!1},value:!0}},{"../../core/methods/font/family.coffee":83}],281:[function(a,b,c){var d,e,f;d=a("../../core/methods/font/decoration.coffee"),e=a("../../core/methods/font/family.coffee"),f=a("../../core/methods/font/transform.coffee"),b.exports={font:{color:"#444444",decoration:d(),family:e(),transform:f(),weight:200},hover:{color:"#444444",decoration:d(),family:e(),transform:f(),weight:200}}},{"../../core/methods/font/decoration.coffee":82,"../../core/methods/font/family.coffee":83,"../../core/methods/font/transform.coffee":85}],282:[function(a,b,c){var d;d=a("../../core/methods/process/margin.coffee"),b.exports={accepted:[Number,Object,String],process:function(a){var b;return void 0===a&&(a=this.value),b=a,d(a,this),b},value:0}},{"../../core/methods/process/margin.coffee":89}],283:[function(a,b,c){var d,e,f;d=a("../../core/methods/font/decoration.coffee"),e=a("../../core/methods/font/family.coffee"),f=a("../../core/methods/font/transform.coffee"),b.exports={accepted:[Boolean,String],branding:{accepted:[Boolean],value:!1},font:{color:"#444",decoration:d(),family:e(),size:16,transform:f(),weight:200},padding:5,style:{accepted:[!1,"small","large"],value:!1},value:!0}},{"../../core/methods/font/decoration.coffee":82,"../../core/methods/font/family.coffee":83,"../../core/methods/font/transform.coffee":85}],284:[function(a,b,c){var d;d=a("../../core/methods/process/data.coffee"),b.exports={accepted:[!1,Array,Function,String],delimiter:{accepted:[String],value:"|"},filetype:{accepted:[!1,"json","xml","html","csv","dsv","tsv","txt"],value:!1},overlap:.6,process:d,value:!1}},{"../../core/methods/process/data.coffee":86}],285:[function(a,b,c){b.exports={accepted:[Boolean,Function,String],agg:{accepted:[!1,Function,"sum","min","max","mean","median"],value:!1},deprecates:["sort"],sort:{accepted:["asc","desc"],value:"desc"},value:!1}},{}],286:[function(a,b,c){var d;d=a("../../core/methods/rendering.coffee"),b.exports={accepted:function(a){var b;return b=a.types[a.type.value].shapes,!b||b instanceof Array||(b=[b]),b.length?b:["square"]},interpolate:{accepted:["basis","basis-open","cardinal","cardinal-open","linear","monotone","step","step-before","step-after"],deprecates:"stack_type",value:"linear"},rendering:d(),value:!1}},{"../../core/methods/rendering.coffee":91}],287:[function(a,b,c){var d;d=a("../../core/methods/filter.coffee"),b.exports={accepted:[!1,Function,Number,Object,String],dataFilter:!0,deprecates:["value","value_var"],mute:d(!0),scale:{accepted:[Function],deprecates:"size_scale",max:{accepted:[Function,Number],value:function(a){return Math.floor(d3.max([d3.min([a.width.viz,a.height.viz])/15,6]))}},min:{accepted:[Function,Number],value:3},value:d3.scale.sqrt()},solo:d(!0),threshold:{accepted:[Boolean,Function,Number],value:!1},value:!1}},{"../../core/methods/filter.coffee":80}],288:[function(a,b,c){b.exports={value:!1}},{}],289:[function(a,b,c){var d;d=a("../../core/methods/filter.coffee"),b.exports={accepted:[!1,Function,Object,String],deprecates:["else_var","else"],mute:d(!0),solo:d(!0),value:!1}},{"../../core/methods/filter.coffee":80}],290:[function(a,b,c){var d;d=a("../../core/methods/filter.coffee"),b.exports={accepted:[Array,Boolean,Function,Object,String],deprecates:["name_array","text_var"],nesting:!0,mute:d(!0),solo:d(!0),value:!1}},{"../../core/methods/filter.coffee":80}],291:[function(a,b,c){var d;d=a("../../core/methods/filter.coffee"),b.exports={accepted:[Array,Boolean,Function,Object,String],dataFilter:!0,deprecates:["year","year_var"],fixed:{accepted:[Boolean],deprecates:["static_axis","static_axes"],value:!0},format:{accepted:[!1,Array,Function,String],value:!1},mute:d(!1),solo:d(!1),value:!1}},{"../../core/methods/filter.coffee":80}],292:[function(a,b,c){b.exports={accepted:[Boolean],align:"middle",hover:{accepted:["all-scroll","col-resize","crosshair","default","grab","grabbing","move","pointer"],value:"pointer"},handles:{accepted:[Boolean],color:"#666",opacity:1,size:3,stroke:"#666",value:!0},height:{accepted:[Number],value:23},play:{accepted:[Boolean],icon:{accepted:[!1,String],awesome:"",fallback:"►"},pause:{accepted:[!1,String],awesome:"",fallback:"❚❚"},timing:{accepted:[Number],value:1500},value:!0},value:!0}},{}],293:[function(a,b,c){b.exports={mouseevents:60,transitions:600,ui:200}},{}],294:[function(a,b,c){var d,e,f,g;d=a("../../core/methods/font/decoration.coffee"),e=a("../../core/methods/font/family.coffee"),g=a("../../core/methods/font/transform.coffee"),f=a("../../string/strip.js"),b.exports={accepted:[!1,Function,String],font:{align:"center",color:"#444444",decoration:d(),family:e(),size:16,transform:g(),weight:400
},height:!1,link:!1,padding:2,position:"top",process:function(a,b){var c;return 0===b.container.id.indexOf("default")&&a&&(c=f(a).toLowerCase(),b.self.container({id:c})),a},sub:{accepted:[!1,Function,String],deprecates:"sub_title",font:{align:"center",color:"#444444",decoration:d(),family:e(),size:12,transform:g(),weight:200},link:!1,padding:1,position:"top",value:!1},total:{accepted:[Boolean,Object],deprecates:"total_bar",font:{align:"center",color:"#444444",decoration:d(),family:e(),size:12,transform:g(),weight:200,value:!1},link:!1,padding:1,position:"top",value:!1},width:!1,value:!1}},{"../../core/methods/font/decoration.coffee":82,"../../core/methods/font/family.coffee":83,"../../core/methods/font/transform.coffee":85,"../../string/strip.js":174}],295:[function(a,b,c){var d,e;d=a("../../core/methods/font/family.coffee"),e=a("../../core/methods/font/transform.coffee"),b.exports={accepted:[Boolean,Array,Function,Object,String],anchor:"top center",background:"#ffffff",children:{accepted:[Boolean],value:!0},connections:{accepted:[Boolean],value:!0},curtain:{color:"#ffffff",opacity:.8},deprecates:"tooltip_info",extent:{accepted:[Boolean],value:!0},font:{color:"#444",family:d(),size:12,transform:e(),weight:200},html:{accepted:[!1,Function,Object,String],deprecates:"click_function",value:!1},iqr:{accepted:[Boolean],value:!0},large:250,share:{accepted:[Boolean],value:!0},size:{accepted:[Boolean],value:!0},small:225,sub:{accepted:[!1,Function,String],value:!1},value:!0}},{"../../core/methods/font/family.coffee":83,"../../core/methods/font/transform.coffee":85}],296:[function(a,b,c){var d;d=a("../../core/methods/filter.coffee"),b.exports={accepted:[!1,Function,Object,String],deprecates:["total_var"],mute:d(!0),solo:d(!0),value:!1}},{"../../core/methods/filter.coffee":80}],297:[function(a,b,c){b.exports={accepted:function(a){return d3.keys(a.types)},mode:{accepted:function(a){return a.types[a.type.value].modes||[!1]},value:!1},value:"tree_map"}},{}],298:[function(a,b,c){var d,e,f,g;f=a("../../core/methods/font/family.coffee"),d=a("../../core/methods/font/align.coffee"),e=a("../../core/methods/font/decoration.coffee"),g=a("../../core/methods/font/transform.coffee"),b.exports={accepted:[Array,Boolean],align:d("center"),border:1,color:{primary:{process:function(a,b){var c;return c=this.value,b.ui.color.secondary.value||(b.ui.color.secondary.value=d3.rgb(c).darker(.75).toString()),a},value:"#ffffff"},secondary:{value:!1}},display:{acceped:["block","inline-block"],value:"inline-block"},font:{align:"center",color:"#444",decoration:e(),family:f(),size:11,transform:g(),weight:200},margin:5,padding:5,position:{accepted:["top","right","bottom","left"],value:"bottom"},value:!1}},{"../../core/methods/font/align.coffee":81,"../../core/methods/font/decoration.coffee":82,"../../core/methods/font/family.coffee":83,"../../core/methods/font/transform.coffee":85}],299:[function(a,b,c){b.exports={accepted:[!1,Number],secondary:!1,small:200,value:!1}},{}],300:[function(a,b,c){b.exports={accepted:[Boolean],behavior:d3.behavior.zoom().scaleExtent([1,1]).duration(0),click:{accepted:[Boolean],value:!0},pan:{accepted:[Boolean],value:!0},scroll:{accepted:[Boolean],deprecates:"scroll_zoom",value:!0},value:!0}},{}],301:[function(a,b,c){var d,e,f,g,h,i,j=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};e=a("../../core/fetch/value.coffee"),f=a("./helpers/graph/draw.coffee"),g=a("./helpers/graph/nest.coffee"),h=a("./helpers/graph/stack.coffee"),i=a("../../util/uniques.coffee"),d=function(a){var b,c,d,g,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L;if(l=a.axes.discrete,p="x"===l?"height":"width",J="x"===l?"width":"height",C=a.axes.opposite,d="x"===l?"left":"top",z="x"===l?"top":"left",f(a,{buffer:!0,zero:a.axes.opposite}),o=a.x.domain.viz.concat(a.y.domain.viz),o.indexOf(void 0)>=0)return[];for(y=a.data.viz,a.axes.stacked&&h(a,y),H=a.axes[J]/a[a.axes.discrete].ticks.values.length,D=a[a.axes.discrete].padding.value,D<1&&(D*=H),2*D>H&&(D=.1*H),w=H-2*D,a.axes.stacked||(F=a[l].value,j.call(a.id.nesting,F)>=0?(b=d3.nest().key(function(b){return e(a,b,a[l].value)}).entries(y),n=d3.max(b,function(a){return a.values.length})):(b=i(y,a.id.value,e,a),n=b.length),w/=n,A=H/2-w/2-D,K=d3.scale.linear().domain([0,n-1]).range([-A,A])),k=[],L=0,q=r=0,t=y.length;r<t;q=++r)for(E=y[q],x=a.axes.stacked?0:K(q%n),G=E.values,s=0,u=G.length;s<u;s++){if(g=G[s],a.axes.stacked)I=g.d3plus[C],c=g.d3plus[C+"0"];else{if(B=e(a,g,a[C].value),0===B)continue;"log"===a[C].scale.value&&(L=B<0?-1:1),I=a[C].scale.viz(B),c=a[C].scale.viz(L)}m=e(a,g,a[l].value),g.d3plus[l]=a[l].scale.viz(m),g.d3plus[l]+=a.axes.margin[d]+x,v=c-I,g.d3plus[C]=c-v/2,a.axes.stacked||(g.d3plus[C]+=a.axes.margin[z]),g.d3plus[J]=w,g.d3plus[p]=Math.abs(v),g.d3plus.init={},g.d3plus.init[C]=a[C].scale.viz(L),g.d3plus.init[C]-=g.d3plus[C],g.d3plus.init[C]+=a.axes.margin[z],g.d3plus.init[J]=g.d3plus[J],g.d3plus.label=!1,k.push(g)}return k},d.filter=function(a,b){return g(a,b)},d.requirements=["data","x","y"],d.setup=function(a){var b,c,d;return a.axes.discrete||(b=a.time.value===a.y.value?"y":"x",a.self[b]({scale:"discrete"})),d=a[a.axes.opposite],c=a.size,!d.value&&c.value||c.changed&&c.previous===d.value?a.self[a.axes.opposite](c.value):!c.value&&d.value||d.changed&&d.previous===c.value?a.self.size(d.value):void 0},d.shapes=["square"],b.exports=d},{"../../core/fetch/value.coffee":68,"../../util/uniques.coffee":209,"./helpers/graph/draw.coffee":307,"./helpers/graph/nest.coffee":313,"./helpers/graph/stack.coffee":314}],302:[function(a,b,c){var d,e,f,g,h;e=a("../../core/fetch/value.coffee"),f=a("./helpers/graph/draw.coffee"),g=a("../../string/strip.js"),h=a("../../util/uniques.coffee"),d=function(a){var b,c,d,i,j,k,l,m,n,o,p,q,r;return f(a,{buffer:!0,mouse:!0}),d=a.x.domain.viz.concat(a.y.domain.viz),d.indexOf(void 0)>=0?[]:(c=a.axes.discrete,o=a.axes.opposite,b="x"===c?a.axes.margin.left:a.axes.margin.top,n="x"===o?a.axes.margin.left:a.axes.margin.top,i="x"===c?"height":"width",r="x"===c?"width":"height",q=a.axes[r]/a[c].ticks.values.length,q=d3.min([q-2*a.labels.padding,100]),l=a.type.mode.value,l instanceof Array||(l=[l,l]),k=function(b){var c,d,f;d={};for(c in a.data.keys)f=h(b,c,e,a),d[c]=1===f.length?f[0]:f;return d},m=!1,j=[],p=[],d3.nest().key(function(b){return e(a,b,a[c].value)}).rollup(function(d){var f,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W;for(M=a[o].scale.viz,U=d.map(function(b){return e(a,b,a[o].value)}),U.sort(function(a,b){return a-b}),S=h(U),y=d3.quantile(U,.25),G=d3.quantile(U,.5),N=d3.quantile(U,.75),O={},"tukey"===l[1]?(A=y-N,P=N-1.5*A,Q="top tukey"):"extent"===l[1]?(P=d3.max(U),Q="maximum"):"number"==typeof l[1]&&(P=d3.quantile(U,(100-l[1])/100),Q=l[1]+" percentile"),P=d3.min([d3.max(U),P]),a.tooltip.extent.value&&(O[Q]={key:a[o].value,value:P}),a.tooltip.iqr.value&&(O["third quartile"]={key:a[o].value,value:N},O.median={key:a[o].value,value:G},O["first quartile"]={key:a[o].value,value:y}),"tukey"===l[0]?(A=y-N,f=y+1.5*A,s="bottom tukey"):"extent"===l[0]?(f=d3.min(U),s="minimum"):"number"==typeof l[0]&&(f=d3.quantile(U,l[0]/100),s=l[0]+" percentile"),f=d3.max([d3.min(U),f]),a.tooltip.extent.value&&(O[s]={key:a[o].value,value:f}),u=[],t=[],R=[],L=[],z=0,E=d.length;z<E;z++)v=d[z],T=e(a,v,a[o].value),T>=y&&T<=N?u.push(v):T>=f&&T<y?t.push(v):T<=P&&T>N?R.push(v):L.push(v);for(C=e(a,d[0],a[c].value),V=a[c].scale.viz(C),V+=b,D=a.format.value(C,{key:a[c].value,vars:a}),C.constructor===Date&&(C=C.getTime()),C=g(C),u=k(u),u.d3plus={color:"white",id:"box_"+C,init:{},label:!1,shape:"square",stroke:"#444",text:"Interquartile Range for "+D},u.d3plus[r]=q,u.d3plus.init[r]=q,u.d3plus[i]=Math.abs(M(y)-M(N)),u.d3plus[c]=V,W=d3.min([M(y),M(N)])+u.d3plus[i]/2,W+=n,u.d3plus[o]=W,u.d3plus.tooltip=O,p.push(u),I={d3plus:{id:"median_line_"+C,position:"height"===i?"top":"right",shape:"whisker",static:!0}},K=a.format.value(G,{key:a[o].value,vars:a}),D={background:"#fff",names:[K],padding:0,resize:!1,x:0,y:0},w=Math.abs(M(G)-M(y)),x=Math.abs(M(G)-M(N)),J=2*d3.min([w,x]),H=2*a.data.stroke.width+2*a.labels.padding,D["width"===r?"w":"h"]=q-H,D["width"===i?"w":"h"]=J-H,I.d3plus.label=D,I.d3plus[r]=q,I.d3plus[c]=V,I.d3plus[o]=M(G)+n,p.push(I),t=k(t),t.d3plus={id:"bottom_whisker_line_"+C,offset:u.d3plus[i]/2,position:"height"===i?"bottom":"left",shape:"whisker",static:!0},"x"===o&&(t.d3plus.offset*=-1),t.d3plus[i]=Math.abs(M(f)-M(y)),t.d3plus[r]=q,t.d3plus[c]=V,t.d3plus[o]=W,p.push(t),R=k(R),R.d3plus={id:"top_whisker_line_"+C,offset:u.d3plus[i]/2,position:"height"===i?"top":"right",shape:"whisker",static:!0},"y"===o&&(R.d3plus.offset*=-1),R.d3plus[i]=Math.abs(M(P)-M(N)),R.d3plus[r]=q,R.d3plus[c]=V,R.d3plus[o]=W,p.push(R),B=0,F=L.length;B<F;B++)v=L[B],v.d3plus[c]=V,v.d3plus[o]=M(e(a,v,a.y.value)),v.d3plus[o]+=n,v.d3plus.r=4,v.d3plus.shape=a.shape.value;return m=!L.length&&P-f===0,j.push(G),p=p.concat(L),d}).entries(a.data.viz),m&&1===h(j).length?[]:p)},d.modes=["tukey","extent",Array,Number],d.requirements=["data","x","y"],d.shapes=["circle","check","cross","diamond","square","triangle","triangle_up","triangle_down"],d.setup=function(a){var b;if(!a.axes.discrete)return b=a.time.value===a.y.value?"y":"x",a.self[b]({scale:"discrete"})},b.exports=d},{"../../core/fetch/value.coffee":68,"../../string/strip.js":174,"../../util/uniques.coffee":209,"./helpers/graph/draw.coffee":307}],303:[function(a,b,c){var d,e,f,g,h,i,j;d=a("../../array/sort.coffee"),h=a("../../core/fetch/value.coffee"),f=a("../../core/fetch/color.coffee"),g=a("../../core/fetch/text.js"),j=a("../../color/legible.coffee"),i=a("../../core/data/group.coffee"),e=function(a){var b,c,e,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P;if(r=i(a,a.data.viz),r=d(r,null,null,null,a),m=r.length,m<4?(e=m,E=1):(F=a.width.viz/a.height.viz,e=Math.ceil(Math.sqrt(m*F)),E=Math.ceil(Math.sqrt(m/F))),m>0)for(;(E-1)*e>=m;)E--;for(c=a.width.viz/e,b=a.height.viz/E,a.size.value?(p=d3.min(a.data.viz,function(b){return h(a,b,a.size.value,a.id.value,"min")}),o=d3.max(a.data.viz,function(b){return h(a,b,a.size.value,a.id.value)}),n=[p,o]):n=[0,0],C=5,H=d3.min([c,b])/2-2*C,w=a.labels.value&&!a.small&&H>=40?d3.max([20,d3.min([.25*H,50])]):0,H-=w,I=d3.min([H,a.size.scale.min.value]),G=a.size.scale.value.domain(n).rangeRound([I,H]),B=d3.layout.pack().children(function(a){return a.values}).padding(C).radius(function(a){return G(a)}).size([c-2*C,b-2*C-w]).value(function(a){return a.value}),l=[],D=0,s=t=0,x=r.length;t<x;s=++t){for(k=r[s],K=B.nodes(k),M=c*s%a.width.viz,P=b*D,u=0,y=K.length;u<y;u++)J=K[u],J.children?(A={d3plus:{}},A[a.id.value]=J.key):A=J.d3plus,A.d3plus.depth=a.id.grouping.value?J.depth:a.depth.value,A.d3plus.x=J.x,A.d3plus.xOffset=M,A.d3plus.y=J.y,A.d3plus.yOffset=P+w,A.d3plus.r=J.r,l.push(A);(s+1)%e===0&&D++}for(q=H/d3.max(l,function(a){return a.d3plus.r}),L=B.size()[0]/2,O=B.size()[1]/2,v=0,z=l.length;v<z;v++)k=l[v],k.d3plus.x=(k.d3plus.x-L)*q+L+k.d3plus.xOffset,k.d3plus.y=(k.d3plus.y-O)*q+O+k.d3plus.yOffset,k.d3plus.r=k.d3plus.r*q,delete k.d3plus.xOffset,delete k.d3plus.yOffset,k.d3plus.static=k.d3plus.depth<a.depth.value&&a.id.grouping.value,!w||0!==k.d3plus.depth&&a.id.grouping.value!==!1?delete k.d3plus.label:(k.d3plus.text=g(a,k[a.id.value],k.d3plus.depth),N=w>3*a.labels.padding?a.labels.padding:0,k.d3plus.label={x:0,y:-(H+N+w/2),w:2*H,h:w-N,padding:0,resize:!0,color:j(f(a,k,k.d3plus.depth)),force:!0});return l.sort(function(a,b){return a.d3plus.depth-b.d3plus.depth})},e.fill=!0,e.requirements=["data"],e.scale=1.05,e.shapes=["circle","donut"],b.exports=e},{"../../array/sort.coffee":36,"../../color/legible.coffee":45,"../../core/data/group.coffee":58,"../../core/fetch/color.coffee":64,"../../core/fetch/text.js":67,"../../core/fetch/value.coffee":68}],304:[function(a,b,c){var d,e;e=a("../../../core/console/print.coffee"),d=function(a){var b,c;c={circle:"scatter",donut:"scatter",line:"line",square:"scatter",area:"stacked"},b=c[a.shape.value],e.warning('The "chart" visualization type has been deprecated and will be removed in version 2.0. Please use the "'+b+'" visualization type.'),a.self.type(b).draw()},d.shapes=["circle","donut","line","square","area"],b.exports=d},{"../../../core/console/print.coffee":53}],305:[function(a,b,c){var d;d=function(a){var b,c,d,e,f,g;return topojson.presimplify(a.coords.value),b=a.coords.value,d=d3.keys(b.objects)[0],g=topojson.feature(b,b.objects[d]),c=g.features,f=a.coords.solo.value,e=a.coords.mute.value,c=c.filter(function(b){return b[a.id.value]=b.id,f.length?f.indexOf(b.id)>=0:!e.length||e.indexOf(b.id)<0})},d.libs=["topojson"],d.nesting=!1,d.requirements=["coords"],d.scale=1,d.shapes=["coordinates"],d.zoom=!0,b.exports=d},{}],306:[function(a,b,c){var d,e,f;d=a("../../../../core/fetch/color.coffee"),e=a("../../../../color/legible.coffee"),f=a("../../../../core/console/print.coffee"),b.exports=function(a){var b,c,g,h,i,j,k,l,m,n,o;for(b=a.axes,h=b.stacked?[]:a.data.viz,o=2*h.length>a.data.large?0:a.draw.timing,l=function(c,f){return"y"===f?c.attr("x1",-2).attr("x2",-8).attr("y1",function(a){return a.d3plus.y-b.margin.top}).attr("y2",function(a){return a.d3plus.y-b.margin.top}):c.attr("x1",function(a){return a.d3plus.x-b.margin.left}).attr("x2",function(a){return a.d3plus.x-b.margin.left}).attr("y1",b.height+2).attr("y2",b.height+8),c.style("stroke",function(b){return e(d(a,b))}).style("stroke-width",a.data.stroke.width).attr("shape-rendering",a.shape.rendering.value)},a.dev.value&&f.time("creating axis tick groups"),n=a.group.select("g#d3plus_graph_plane").selectAll("g.d3plus_data_tick").data(h,function(c){var d;return d=b.discrete?"_"+c.d3plus[b.discrete]:"","tick_"+c[a.id.value]+"_"+c.d3plus.depth+d}),n.enter().append("g").attr("class","d3plus_data_tick").attr("opacity",0),a.dev.value&&f.timeEnd("creating axis tick groups"),k=["x","y"],i=0,j=k.length;i<j;i++)c=k[i],a.dev.value&&o&&f.time("creating "+c+" ticks"),g=o&&c!==b.discrete?h:[],m=n.selectAll("line.d3plus_data_"+c).data(g,function(b){return"tick_"+b[a.id.value]+"_"+b.d3plus.depth}),a.dev.value&&o&&f.timeEnd("creating "+c+" ticks"),a.dev.value&&o&&f.time("styling "+c+" ticks"),o>0?m.transition().duration(o).call(l,c):m.call(l,c),m.enter().append("line").attr("class","d3plus_data_"+c).call(l,c),a.dev.value&&o&&f.timeEnd("styling "+c+" ticks");o>0?(n.transition().duration(o).attr("opacity",1),n.exit().transition().duration(o).attr("opacity",0).remove()):(n.attr("opacity",1),n.exit().remove())}},{"../../../../color/legible.coffee":45,"../../../../core/console/print.coffee":53,"../../../../core/fetch/color.coffee":64}],307:[function(a,b,c){var d,e,f,g;d=a("./includes/axes.coffee"),e=a("./includes/svg.coffee"),f=a("./includes/mouse.coffee"),g=a("./includes/plot.coffee"),b.exports=function(a,b){void 0===b&&(b={}),d(a,b),g(a,b),e(a,b),a.mouse=b.mouse===!0&&f}},{"./includes/axes.coffee":308,"./includes/mouse.coffee":310,"./includes/plot.coffee":311,"./includes/svg.coffee":312}],308:[function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o;d=a("../../../../../array/sort.coffee"),g=a("./buffer.coffee"),f=a("../../../../../util/buckets.coffee"),i=a("../../../../../core/fetch/data.js"),j=a("../../../../../core/fetch/value.coffee"),m=a("../../../../../core/console/print.coffee"),o=a("../../../../../util/uniques.coffee"),b.exports=function(a,b){var c,d,f,i,p,q,r,s,t,u,v,w;for(f=h(a),!f&&a.axes.dataset||(a.axes.dataset=k(a)),a.axes.scale=!(!b.buffer||b.buffer===!0)&&n(a,b.buffer),c=a.width.viz>a.height.viz?["y","x"]:["x","y"],p=0,r=c.length;p<r;p++)d=c[p],t="x"===d?"y":"x",v=a.order.changed||a.order.sort.changed||a.order.value===!0&&a[t].changed,(!a[d].ticks.values||f||v)&&(a.dev.value&&m.time("calculating "+d+" axis"),a[d].reset=!0,a[d].ticks.values=!1,d===a.axes.discrete&&a[d].value!==a.time.value&&(a[d].ticks.values=o(a.axes.dataset,a[d].value,j,a)),w=[!0,d].indexOf(b.zero)>0,u=e(a,d,w),"y"===d&&(u=u.reverse()),a[d].scale.viz=l(a,d,u),a[d].domain.viz=u,a.dev.value&&m.timeEnd("calculating "+d+" axis"));if(a.axes.mirror.value&&(i=d3.extent(a.y.domain.viz.concat(a.x.domain.viz)),a.x.domain.viz=i,a.x.scale.viz.domain(i),i=i.slice().reverse(),a.y.domain.viz=i,a.y.scale.viz.domain(i)),b.buffer)for(q=0,s=c.length;q<s;q++)d=c[q],d!==a.axes.discrete&&g(a,d,b.buffer)},h=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n;if(c=a.time.fixed.value&&(a.time.solo.changed||a.time.mute.changed),c||(c=a.id.solo.changed||a.id.mute.changed),c)return c;for(d=["data","time","id","depth","type","x","y"],e=0,i=d.length;e<i;e++)if(g=d[e],a[g].changed){c=!0;break}if(c)return c;for(n=["mute","range","scale","solo","stacked","zerofill"],l=["x","y"],f=0,j=l.length;f<j;f++)for(b=l[f],h=0,k=n.length;h<k;h++)if(m=n[h],a[b][m].changed){c=!0;break}return c},k=function(a){var b,c;return a.time.fixed.value?a.data.viz:(c=d3.range(0,a.id.nesting.length),d3.merge([function(){var d,e,f;for(f=[],d=0,e=c.length;d<e;d++)b=c[d],f.push(i(a,"all",b));return f}()]))},e=function(a,b,c,e){var f,g,h,i,k,l,m,n,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J;if(z="x"===b?"y":"x",a[b].range.value&&2===a[b].range.value.length)return a[b].range.value.slice();if("share"===a[b].scale.value)return a[b].ticks.values=d3.range(0,1.1,.1),[0,1];if(a[b].stacked.value){for(G=[],A=a.axes.dataset,p=0,t=A.length;p<t;p++)m=A[p],m.values?G=G.concat(m.values):G.push(m);return k=d3.nest().key(function(b){return j(a,b,a[z].value)}).rollup(function(c){var d,e;return e=d3.sum(c,function(c){var d;return d=j(a,c,a[b].value),d>0?d:0}),d=d3.sum(c,function(c){var d;return d=j(a,c,a[b].value),d<0?d:0}),[d,e]}).entries(G),J=d3.merge(k.map(function(a){return a.values})),d3.extent(J)}if(a[b].value===a.time.value)return a.time.solo.value.length?d3.extent(a.time.solo.value).map(function(a){return a.constructor!==Date?(a+="",4===a.length&&parseInt(a)+""===a&&(a+="/01/01"),new Date(a)):a}):d3.extent(a.data.time.ticks);for(J=[],B=a.axes.dataset,q=0,u=B.length;q<u;q++)m=B[q],I=j(a,m,a[b].value),I instanceof Array?J=J.concat(I):J.push(I);if("string"==typeof J[0]){if(F=a.order.value===!0?a[z].value:a.order.value){for(E=a.order.sort.value,f=a.order.agg.value||a.aggs.value[F]||"max",g=typeof f,l=J.reduce(function(a,b){return a[b]=[],a},{}),C=a.axes.dataset,s=0,v=C.length;s<v;s++)if(m=C[s],m.values)for(D=m.values,x=0,w=D.length;x<w;x++)H=D[x],n=j(a,H,a[b].value),l[n].push(j(a,H,F));else n=j(a,m,a[b].value),l[n].push(j(a,m,F));for(r in l)H=l[r],"string"===g?l[r]=d3[f](H):"function"===g&&(l[r]=f(H,F));return l=d(d3.entries(l),"value",E),l=l.reduce(function(a,b){return a.push(b.key),a},[])}return o(J)}return J.sort(function(a,b){return a-b}),"log"===a[b].scale.value&&(0===J[0]&&(J[0]=1),0===J[J.length-1]&&(J[J.length-1]=-1)),c&&(i=J.every(function(a){return a>0}),h=J.every(function(a){return a<0}),(i||h)&&(y=i?1:-1,J.push("log"===a[b].scale.value?y:0))),d3.extent(J)},l=function(a,b,c){var d,e,g;return e="x"===b?a.width.viz:a.height.viz,g=a[b].scale.value,["discrete","share"].indexOf(g)>=0&&(g="linear"),"string"==typeof c[0]?(g="ordinal",d=f([0,e],c.length)):d=[0,e],d3.scale[g]().domain(c).range(d)},n=function(a,b){var c,d,e;return b===!0&&(b="size"),b in a&&(b=a[b].value),e=a.size.scale.min.value,"function"==typeof e&&(e=e(a)),d=a.size.scale.max.value,"function"==typeof d&&(d=d(a)),b===!1?a.size.scale.value.rangeRound([d,d]):"number"==typeof b?a.size.scale.value.rangeRound([b,b]):b?(a.dev.value&&m.time("calculating buffer scale"),c=d3.extent(a.axes.dataset,function(c){var d;return d=j(a,c,b),d?d:0}),c[0]===c[1]&&(e=d),a.dev.value&&m.timeEnd("calculating buffer scale"),a.size.scale.value.domain(c).rangeRound([e,d])):void 0}},{"../../../../../array/sort.coffee":36,"../../../../../core/console/print.coffee":53,"../../../../../core/fetch/data.js":65,"../../../../../core/fetch/value.coffee":68,"../../../../../util/buckets.coffee":203,"../../../../../util/uniques.coffee":209,"./buffer.coffee":309}],309:[function(a,b,c){var d,e;d=a("../../../../../util/buckets.coffee"),e=a("../../../../../util/closest.coffee"),b.exports=function(a,b,c){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G;if("share"!==a[b].scale.value&&!a[b].range.value&&a[b].reset){if(b===a.axes.discrete){if(m=a[b].scale.viz.domain(),"string"==typeof m[0]){for(q=m.length;q>=0;)m.splice(q,0,"d3plus_buffer_"+q),q--;return x=a[b].scale.viz.range(),x=d(d3.extent(x),m.length),a[b].scale.viz.domain(m).range(x)}return"y"===b&&(m=m.slice().reverse()),1===a[b].ticks.values.length?a[b].value===a.time.value&&1!==a.data.time.ticks.length?(i=e(a.data.time.ticks,m[0]),B=a.data.time.ticks.indexOf(i),B>0?m[0]=a.data.time.ticks[B-1]:(k=a.data.time.ticks[B+1]-i,m[0]=new Date(i.getTime()-k)),B<a.data.time.ticks.length-1?m[1]=a.data.time.ticks[B+1]:(k=i-a.data.time.ticks[B-1],m[1]=new Date(i.getTime()+k))):(m[0]-=1,m[1]+=1):a.axes.scale?(l=Math.abs(m[1]-m[0]),f=l/(a[b].ticks.values.length-1),f/=2,y=a[b].scale.viz.range()[1],v=1.5*a.axes.scale.range()[1],p=a[b].scale.viz.invert(-v),o=a[b].scale.viz.invert(y+v),m[0]-f<p?(m[0]=m[0]-f,m[1]=m[1]+f):(m=[p,o],"y"===b&&(m=m.reverse()),n=a[b].scale.viz.domain(),n=n[1]-n[0],n||(m[0]-=1,m[1]+=1))):(l=Math.abs(m[1]-m[0]),f=l/(a[b].ticks.values.length-1),f/=2,m[0]=m[0]-f,m[1]=m[1]+f),"y"===b&&(m=m.reverse()),a[b].scale.viz.domain(m)}if("x"===c&&"x"===b||"y"===c&&"y"===b||c===!0)return m=a[b].scale.viz.domain(),h=m[0]>=0&&m[1]>=0,g=m[0]<=0&&m[1]<=0,"log"===a[b].scale.value?(G=h?1:-1,h&&"y"===b&&(m=m.slice().reverse()),t=Math.pow(10,parseInt(Math.abs(m[0])).toString().length-1)*G,s=m[0]%t,r=s,s&&r/t<=.1&&(r+=t*G),u=0===s?t:r,m[0]-=u,0===m[0]&&(m[0]=G),E=Math.pow(10,parseInt(Math.abs(m[1])).toString().length-1)*G,D=m[1]%E,C=Math.abs(E-D),D&&C/E<=.1&&(C+=E*G),F=0===D?E:C,m[1]+=F,0===m[1]&&(m[1]=G),h&&"y"===b&&(m=m.reverse())):(G=0,"y"===b&&(m=m.slice().reverse()),A=m.filter(function(a){return a.constructor===String}),f=.05*Math.abs(m[1]-m[0])||1,A.length||(m[0]=m[0]-f,m[1]=m[1]+f,(h&&m[0]<G||g&&m[0]>G)&&(m[0]=G),(h&&m[1]<G||g&&m[1]>G)&&(m[1]=G)),"y"===b&&(m=m.reverse())),a[b].scale.viz.domain(m);if(a.axes.scale)return j=!1,a.axes.mirror.value&&(w="y"===b?"x":"y",j=a[w].scale.viz,z=a.width.viz>a.height.viz?"x":"y"),b===z&&j?m=j.domain().slice().reverse():(y=a[b].scale.viz.range()[1],v=a.axes.scale.range()[1],p=a[b].scale.viz.invert(1.5*-v),o=a[b].scale.viz.invert(y+1.5*v),m=[p,o],"y"===b&&(m=m.reverse()),n=a[b].scale.viz.domain(),n=n[1]-n[0],n||(m[0]-=1,m[1]+=1),"y"===b&&(m=m.reverse())),a[b].scale.viz.domain(m)}}},{"../../../../../util/buckets.coffee":203,"../../../../../util/closest.coffee":205}],310:[function(a,b,c){var d,e,f,g,h;d=a("../../../../../util/copy.coffee"),e=a("../../../../../client/pointer.coffee"),f=a("../../../../../core/fetch/color.coffee"),g=a("../../../../../core/fetch/value.coffee"),h=a("../../../../../color/legible.coffee"),b.exports=function(a,b){var c,d,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x;return c=d3.event.type===e.click&&(b.tooltip.value.long||b.tooltip.html.value),i=[e.over,e.move].indexOf(d3.event.type)>=0,w=a.d3plus.x,x=a.d3plus.y,p=a.d3plus.r||0,s=b.types[b.type.value].scale||1,p*=s,j=b.axes,v=b.draw.timing?b.timing.mouseevents:0,!c&&i?(d=h(f(b,a)),k=["x","y"].filter(function(c){var d;return d=g(b,a,b[c].value),!(d instanceof Array)&&c!==b.axes.stacked&&b[c].mouse.value&&c!==b.axes.discrete})):k=[],l=function(a){return a.attr("x1",function(a){return"x"===a?w:w-p}).attr("y1",function(a){return"y"===a?x:x+p}).attr("x2",function(a){return"x"===a?w:w-p}).attr("y2",function(a){return"y"===a?x:x+p}).attr("opacity",0)},m=function(a){return a.style("stroke",function(a){return"area"===b.shape.value?"white":d}).attr("stroke-dasharray",function(a){return b[a].mouse.dasharray.value}).attr("shape-rendering",function(a){return b[a].mouse.rendering.value}).style("stroke-width",function(a){return b[a].mouse.width})},n=function(c){return c.attr("x1",function(a){return"x"===a?w:w-p}).attr("y1",function(a){return"y"===a?x:x+p}).attr("x2",function(c){return"x"===c?w:a.d3plus.x0||j.margin.left-b[c].ticks.size}).attr("y2",function(c){return"y"===c?x:a.d3plus.y0||j.height+j.margin.top+b[c].ticks.size}).style("opacity",1)},o=b.g.labels.selectAll("line.d3plus_mouse_axis_label").data(k),v?(o.enter().append("line").attr("class","d3plus_mouse_axis_label").attr("pointer-events","none").call(l).call(m),o.transition().duration(v).call(n).call(m),o.exit().transition().duration(v).call(l).remove()):(o.call(n).call(m),o.enter().append("line").attr("class","d3plus_mouse_axis_label").attr("pointer-events","none").call(l).call(m),o.exit().remove()),t=function(c){return c.attr("font-size",function(a){return b[a].ticks.font.size+"px"}).attr("fill",function(a){return b[a].ticks.font.color}).attr("font-family",function(a){return b[a].ticks.font.family.value}).attr("font-weight",function(a){return b[a].ticks.font.weight}).attr("x",function(a){return"x"===a?w:j.margin.left-5-b[a].ticks.size}).attr("y",function(c){return"y"===c?x:a.d3plus.y0?a.d3plus.y+(a.d3plus.y0-a.d3plus.y)/2+j.margin.top-6:j.height+j.margin.top+5+b[c].ticks.size}).attr("fill","area"===b.shape.value?"white":d)},u=b.g.labels.selectAll("text.d3plus_mouse_axis_label").data(k),u.enter().append("text").attr("class","d3plus_mouse_axis_label").attr("id",function(a){return a+"_d3plusmouseaxislabel"}).attr("dy",function(a){return"y"===a?.35*b[a].ticks.font.size:b[a].ticks.font.size}).style("text-anchor",function(a){return"y"===a?"end":"middle"}).attr("opacity",0).attr("pointer-events","none").call(t),u.text(function(c){var d,e;return d=b.axes.stacked||c,e=g(b,a,b[d].value),b.format.value(e,{key:b[d].value,vars:b,labels:b[d].affixes.value})}),v?(u.transition().duration(v).delay(v).attr("opacity",1).call(t),u.exit().transition().duration(v).attr("opacity",0).remove()):(u.attr("opacity",1).call(t),u.exit().remove()),q=function(c){var e;return e=function(a){return d3.select("text#"+a+"_d3plusmouseaxislabel").node().getBBox()},c.attr("x",function(a){var c;return c=e(a).width,"x"===a?w-c/2-5:j.margin.left-b[a].ticks.size-c-10}).attr("y",function(c){var d;return d=e(c).height/2+5,"y"===c?x-d:a.d3plus.y0?a.d3plus.y+(a.d3plus.y0-a.d3plus.y)/2+j.margin.top-d:j.height+j.margin.top+b[c].ticks.size}).attr("width",function(a){return e(a).width+10}).attr("height",function(a){return e(a).height+10}).style("stroke","area"===b.shape.value?"transparent":d).attr("fill","area"===b.shape.value?d:b.background.value).attr("shape-rendering",function(a){return b[a].mouse.rendering.value}).style("stroke-width",function(a){return b[a].mouse.width})},r=b.g.labels.selectAll("rect.d3plus_mouse_axis_label").data(k),v?(r.enter().insert("rect","text.d3plus_mouse_axis_label").attr("class","d3plus_mouse_axis_label").attr("pointer-events","none").attr("opacity",0).call(q),r.transition().duration(v).delay(v).attr("opacity",1).call(q),r.exit().transition().duration(v).attr("opacity",0).remove()):(r.attr("opacity",1).call(q),r.enter().insert("rect","text.d3plus_mouse_axis_label").attr("class","d3plus_mouse_axis_label").attr("pointer-events","none").call(q),r.exit().remove())}},{"../../../../../client/pointer.coffee":40,"../../../../../color/legible.coffee":45,"../../../../../core/fetch/color.coffee":64,"../../../../../core/fetch/value.coffee":68,"../../../../../util/copy.coffee":206}],311:[function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o;d=a("../../../../../util/buckets.coffee"),e=a("./buffer.coffee"),g=a("../../../../../core/fetch/value.coffee"),h=a("../../../../../font/sizes.coffee"),m=a("../../../../../textwrap/textwrap.coffee"),n=a("../../../../../core/data/time.coffee"),o=a("../../../../../util/uniques.coffee"),b.exports=function(a,b){var c,d,h,i,l,m,o,p,q,r,s,t,u,v,w,x,y;for(a.axes.margin=k(a),a.axes.height=a.height.viz,a.axes.width=a.width.viz,c=a.width.viz>a.height.viz?["y","x"]:["x","y"],l=0,o=c.length;l<o;l++){if(d=c[l],a[d].ticks.values===!1)if(a[d].value===a.time.value){for(w=a.time.solo.value,w=w.length?w.map(function(a){return a.constructor!==Date&&(a+="",4===a.length&&parseInt(a)+""===a&&(a+="/01/01"),a=new Date(a)),a}):a.data.time.values,i=d3.extent(w),t=a.data.time.stepType,w=[i[0]],v=i[0];v<i[1];)q=new Date(v),v=new Date(q["set"+t](q["get"+t]()+1)),w.push(v);a[d].ticks.values=w}else a[d].ticks.values=a[d].scale.viz.ticks();a[d].ticks.values.length||(y=g(a,a.data.viz,a[d].value),y instanceof Array||(y=[y]),a[d].ticks.values=y),r="x"===d?"y":"x",(1===a[d].ticks.values.length||b.buffer&&b.buffer!==r&&d===a.axes.discrete&&a[d].reset===!0)&&e(a,d,b.buffer),a[d].reset=!1,a[d].value===a.time.value?(h={"font-family":a[d].ticks.font.family.value,"font-weight":a[d].ticks.font.weight,"font-size":a[d].ticks.font.size+"px"},x=n(a,{values:a[d].ticks.values,limit:a.width.viz,style:h}),a[d].ticks.visible=x.values.map(Number),a[d].ticks.format=x.format):"log"===a[d].scale.value?(w=a[d].ticks.values,u=w.filter(function(a){return"1"===Math.abs(a).toString().charAt(0)}),u.length<3?a[d].ticks.visible=w:a[d].ticks.visible=u):a[d].ticks.visible=a[d].ticks.values}for(a.small||j(a),s=["x","y"],m=0,p=s.length;m<p;m++)d=s[m],a[d].axis.svg=f(a,d)},k=function(a){return a.small?{top:0,right:0,bottom:0,left:0}:{top:10,right:10,bottom:10,left:10}},j=function(a){var b,c,e,f,g,j,k,l,n,o,p,q,r,s,t,u,v,w,x,y;return k=a.x.scale.viz.domain(),u=a.y.scale.viz.domain(),s={"font-size":a.y.ticks.font.size+"px","font-family":a.y.ticks.font.family.value,"font-weight":a.y.ticks.font.weight},y=a.y.ticks.visible,"log"===a.y.scale.value?x=y.map(function(a){return i(a)}):"share"===a.y.scale.value?x=y.map(function(b){return a.format.value(100*b,{key:"share",vars:a})}):a.y.value===a.time.value?x=y.map(function(b,c){return a.y.ticks.format(new Date(b))}):("string"==typeof y[0]&&(y=a.y.scale.viz.domain().filter(function(a){return 0!==a.indexOf("d3plus_buffer_")})),x=y.map(function(b){return a.format.value(b,{key:a.y.value,vars:a,labels:a.y.affixes.value})})),t=d3.max(h(x,s),function(a){return a.width}),t=Math.ceil(t+a.labels.padding),a.axes.margin.left+=t,v=a.y.label.fetch(a),v?(w={"font-family":a.y.label.font.family.value,"font-weight":a.y.label.font.weight,"font-size":a.y.label.font.size+"px"},a.y.label.height=h([v],w)[0].height):a.y.label.height=0,a.y.label.value&&(a.axes.margin.left+=a.y.label.height,a.axes.margin.left+=2*a.y.label.padding),a.axes.width-=a.axes.margin.left+a.axes.margin.right,a.x.scale.viz.range(d([0,a.axes.width],k.length)),f={"font-size":a.x.ticks.font.size+"px","font-family":a.x.ticks.font.family.value,"font-weight":a.x.ticks.font.weight},r=a.x.ticks.visible,"log"===a.x.scale.value?q=r.map(function(a){return i(a)}):"share"===a.x.scale.value?q=r.map(function(b){return a.format.value(100*b,{key:"share",vars:a})}):a.x.value===a.time.value?q=r.map(function(b,c){return a.x.ticks.format(new Date(b))}):("string"==typeof r[0]&&(r=a.x.scale.viz.domain().filter(function(a){return 0!==a.indexOf("d3plus_buffer_")})),q=r.map(function(b){return a.format.value(b,{key:a.x.value,vars:a,labels:a.x.affixes.value})})),p=h(q,f),j=d3.max(p,function(a){return a.width}),g=d3.max(p,function(a){return a.height}),1===r.length?o=a.axes.width:(o=a.x.scale.viz(r[1])-a.x.scale.viz(r[0]),o=Math.abs(o)),j>o&&q.join("").indexOf(" ")>0?(a.x.ticks.wrap=!0,p=h(q,f,{mod:function(b){return m().container(d3.select(b)).height(a.axes.height/2).width(o).draw()}}),j=d3.max(p,function(a){return a.width}),g=d3.max(p,function(a){return a.height})):a.x.ticks.wrap=!1,a.x.ticks.hidden=!1,a.x.ticks.baseline="auto",j<=o?a.x.ticks.rotate=0:j<a.axes.height/2?(p=h(q,f,{mod:function(b){return m().container(d3.select(b)).width(a.axes.height/2).height(o).draw()}}),g=d3.max(p,function(a){return a.width}),j=d3.max(p,function(a){return a.height}),a.x.ticks.rotate=-90):(j=0,g=0),j&&g||(a.x.ticks.hidden=!0,a.x.ticks.rotate=0),j=Math.ceil(j),g=Math.ceil(g),j++,g++,a.x.ticks.maxHeight=g,a.x.ticks.maxWidth=j,a.axes.margin.bottom+=g+a.labels.padding,b=a.x.ticks.visible[a.x.ticks.visible.length-1],c=a.x.scale.viz(b),c+=j/2+a.axes.margin.left,c>a.width.value&&(e=c-a.width.value+a.axes.margin.right,a.axes.width-=e,a.axes.margin.right+=e),l=a.x.label.fetch(a),l?(n={"font-family":a.x.label.font.family.value,
"font-weight":a.x.label.font.weight,"font-size":a.x.label.font.size+"px"},a.x.label.height=h([l],n)[0].height):a.x.label.height=0,a.x.label.value&&(a.axes.margin.bottom+=a.x.label.height,a.axes.margin.bottom+=2*a.x.label.padding),a.axes.height-=a.axes.margin.top+a.axes.margin.bottom,a.x.scale.viz.range(d([0,a.axes.width],k.length)),a.y.scale.viz.range(d([0,a.axes.height],u.length))},f=function(a,b){return d3.svg.axis().tickSize(a[b].ticks.size).tickPadding(5).orient("x"===b?"bottom":"left").scale(a[b].scale.viz).tickValues(a[b].ticks.values).tickFormat(function(c,d){var e,f;return a[b].ticks.hidden?null:(f=a[b].scale.value,e=c.constructor===Date?+c:c,a[b].ticks.visible.indexOf(e)>=0?"share"===f?a.format.value(100*c,{key:"share",vars:a,labels:a[b].affixes.value}):c.constructor===Date?a[b].ticks.format(c):"log"===f?i(c):a.format.value(c,{key:a[b].value,vars:a,labels:a[b].affixes.value}):null)})},l="⁰¹²³⁴⁵⁶⁷⁸⁹",i=function(a){var b,c,d;return c=Math.round(Math.log(Math.abs(a))/Math.LN10),d=Math.abs(a).toString().charAt(0),b="10 "+(c+"").split("").map(function(a){return l[a]}).join(""),"1"!==d&&(b=d+" x "+b),a<0?"-"+b:b}},{"../../../../../core/data/time.coffee":63,"../../../../../core/fetch/value.coffee":68,"../../../../../font/sizes.coffee":101,"../../../../../textwrap/textwrap.coffee":199,"../../../../../util/buckets.coffee":203,"../../../../../util/uniques.coffee":209,"./buffer.coffee":309}],312:[function(a,b,c){var d,e,f;d=a("../../../../../color/mix.coffee"),e=a("../../../../../textwrap/textwrap.coffee"),f=a("../../../../../object/validate.coffee"),b.exports=function(a){var b,c,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca;if(n=a.x.domain.viz.concat(a.y.domain.viz),n.indexOf(void 0)>=0)return null;for(k={width:a.axes.width,height:a.axes.height,fill:a.axes.background.color,stroke:a.axes.background.stroke.color,"stroke-width":a.axes.background.stroke.width,"shape-rendering":a.axes.background.rendering.value},c={left:"start",center:"middle",right:"end"},h=a.small?[]:[0],W=function(b,c){return b.attr("x1",function(b){return"x"===c?a.x.scale.viz(b):0}).attr("x2",function(b){return"x"===c?a.x.scale.viz(b):a.axes.width}).attr("y1",function(b){return"y"===c?a.y.scale.viz(b):0}).attr("y2",function(b){return"y"===c?a.y.scale.viz(b):a.axes.height})},X=function(b,c,e){var f,g;return f=e?a[c].grid.color:a[c].ticks.color,g="log"===a[c].scale.value,b.attr("stroke",function(b){var h;return 0===b?a[c].axis.color:(b.constructor===Date&&(b=+b),h=a[c].ticks.visible.indexOf(b)>=0,!h||g&&"1"!==Math.abs(b).toString().charAt(0)?e?d(f,a.axes.background.color,.4,1):d(f,a.background.value,.4,1):f)}).attr("stroke-width",a[c].ticks.width).attr("shape-rendering",a[c].ticks.rendering.value)},o=function(b,c,d){var e;return e=0===c?"axis":"ticks",c=a[b][e].font[d],c&&(c.length||"number"==typeof c)?c:a[b].ticks.font[d]},V=function(b,c){var e;return e="log"===a[c].scale.value,b.attr("font-size",function(a){return o(c,a,"size")+"px"}).attr("fill",function(b){var f;return f=o(c,b,"color"),e&&"1"!==Math.abs(b).toString().charAt(0)?d(f,a.background.value,.4,1):f}).attr("font-family",function(a){return o(c,a,"family").value}).attr("font-weight",function(a){return o(c,a,"weight")})},F=function(b,c){var d,e;return d="x"===c?"height":"width",e="x"===c?"y":"x",b.attr(e+"1",0).attr(e+"2",a.axes[d]).attr(c+"1",function(a){return a.coords.line}).attr(c+"2",function(a){return a.coords.line}).attr("stroke",function(b){return b.color||a[c].lines.color}).attr("stroke-width",a[c].lines.width).attr("shape-rendering",a[c].lines.rendering.value).attr("stroke-dasharray",a[c].lines.dasharray.value)},C=function(b,d){var e;return e="x"===d?"y":"x",b.attr(e,function(a){return a.coords.text[e]+"px"}).attr(d,function(a){return a.coords.text[d]+"px"}).attr("dy",a[d].lines.font.position.value).attr("text-anchor",c[a[d].lines.font.align.value]).attr("transform",function(a){return a.transform}).attr("font-size",a[d].lines.font.size+"px").attr("fill",function(b){return b.color||a[d].lines.color}).attr("font-family",a[d].lines.font.family.value).attr("font-weight",a[d].lines.font.weight)},K="translate("+a.axes.margin.left+","+a.axes.margin.top+")",J=a.group.selectAll("g#d3plus_graph_plane").data([0]),J.transition().duration(a.draw.timing).attr("transform",K),J.enter().append("g").attr("id","d3plus_graph_plane").attr("transform",K),j=J.selectAll("rect#d3plus_graph_background").data([0]),j.transition().duration(a.draw.timing).attr(k),j.enter().append("rect").attr("id","d3plus_graph_background").attr("x",0).attr("y",0).attr(k),I=J.selectAll("path#d3plus_graph_mirror").data([0]),I.enter().append("path").attr("id","d3plus_graph_mirror").attr("fill","#000").attr("fill-opacity",.03).attr("stroke-width",1).attr("stroke","#ccc").attr("stroke-dasharray","10,10").attr("opacity",0),I.transition().duration(a.draw.timing).attr("opacity",function(){return a.axes.mirror.value?1:0}).attr("d",function(){var a,b;return b=k.width,a=k.height,"M "+b+" "+a+" L 0 "+a+" L "+b+" 0 Z"}),Q=0!==a.x.ticks.rotate,_=function(b){var c;return c=b.attr("transform","translate(0,"+a.axes.height+")").call(a.x.axis.svg.scale(a.x.scale.viz)).selectAll("g.tick"),c.selectAll("line").attr("y2",function(b){var c;return b.constructor===Date&&(b=+b),c=d3.select(this).attr("y2"),a.x.ticks.visible.indexOf(b)>=0?c:c/2}),c.select("text").attr("dy","").style("text-anchor",Q?"end":"middle").call(V,"x").each("end",function(b){if(b.constructor===Date&&(b=+b),!a.x.ticks.hidden&&a.x.ticks.visible.indexOf(b)>=0)return e().container(d3.select(this)).rotate(a.x.ticks.rotate).valign(Q?"middle":"top").width(a.x.ticks.maxWidth).height(a.x.ticks.maxHeight).padding(0).x(-a.x.ticks.maxWidth/2).draw()})},Z=J.selectAll("g#d3plus_graph_xticks").data(h),Z.transition().duration(a.draw.timing).call(_),Z.selectAll("line").transition().duration(a.draw.timing).call(X,"x"),$=Z.enter().append("g").attr("id","d3plus_graph_xticks").transition().duration(0).call(_),$.selectAll("path").attr("fill","none"),$.selectAll("line").call(X,"x"),Z.exit().transition().duration(a.data.timing).attr("opacity",0).remove(),ca=function(b){var c;return c=b.call(a.y.axis.svg.scale(a.y.scale.viz)).selectAll("g.tick"),c.selectAll("line").attr("y2",function(b){var c;return b.constructor===Date&&(b=+b),c=d3.select(this).attr("y2"),a.x.ticks.visible.indexOf(b)>=0?c:c/2}),c.select("text").call(V,"y")},aa=J.selectAll("g#d3plus_graph_yticks").data(h),aa.transition().duration(a.draw.timing).call(ca),aa.selectAll("line").transition().duration(a.draw.timing).call(X,"y"),ba=aa.enter().append("g").attr("id","d3plus_graph_yticks").call(ca),ba.selectAll("path").attr("fill","none"),ba.selectAll("line").call(X,"y"),aa.exit().transition().duration(a.data.timing).attr("opacity",0).remove(),w=function(b,c){return b.attr("x","x"===c?a.width.viz/2:-(a.axes.height/2+a.axes.margin.top)).attr("y","x"===c?a.height.viz-a[c].label.height/2-a[c].label.padding:a[c].label.height/2+a[c].label.padding).attr("transform","y"===c?"rotate(-90)":null).attr("font-family",a[c].label.font.family.value).attr("font-weight",a[c].label.font.weight).attr("font-size",a[c].label.font.size+"px").attr("fill",a[c].label.font.color).style("text-anchor","middle").attr("dominant-baseline","central")},O=["x","y"],r=0,x=O.length;r<x;r++)g=O[r],a[g].grid.value?q=a[g].ticks.values:(q=[],a[g].ticks.values.indexOf(0)>=0&&a[g].axis.value&&(q=[0])),p=J.selectAll("g#d3plus_graph_"+g+"grid").data([0]),p.enter().append("g").attr("id","d3plus_graph_"+g+"grid"),G=p.selectAll("line").data(q,function(a,b){return a.constructor===Date?a.getTime():a}),G.transition().duration(a.draw.timing).call(W,g).call(X,g,!0),G.enter().append("line").style("opacity",0).call(W,g).call(X,g,!0).transition().duration(a.draw.timing).delay(a.draw.timing/2).style("opacity",1),G.exit().transition().duration(a.draw.timing/2).style("opacity",0).remove(),i=a[g].label.fetch(a),v=h&&i?[0]:[],b=a.format.affixes.value[a[g].value],i&&!a[g].affixes.value&&b&&(R=a[g].affixes.separator.value,R===!0?R=["[","]"]:R===!1&&(R=["",""]),i+=" "+R[0]+b[0]+" "+b[1]+R[1]),u=a.group.selectAll("text#d3plus_graph_"+g+"label").data(v),u.text(i).transition().duration(a.draw.timing).call(w,g),u.enter().append("text").attr("id","d3plus_graph_"+g+"label").text(i).call(w,g),u.exit().transition().duration(a.data.timing).attr("opacity",0).remove();for(P=["x","y"],s=0,y=P.length;s<y;s++){for(g=P[s],D=J.selectAll("g#d3plus_graph_"+g+"_userlines").data([0]),D.enter().append("g").attr("id","d3plus_graph_"+g+"_userlines"),m=a[g].scale.viz.domain(),"y"===g&&(m=m.slice().reverse()),S=[],B=[],Y=a[g].lines.value||[],t=0,z=Y.length;t<z;t++)A=Y[t],l=f(A)?A.position:A,isNaN(l)||(l=parseFloat(l),l>m[0]&&l<m[1]&&(l=f(A)?A:{position:l},l.coords={line:a[g].scale.viz(l.position)},B.push(l),l.text&&(l.axis=g,l.padding=.5*a[g].lines.font.padding.value,l.align=a[g].lines.font.align.value,L=a[g].lines.font.position.text,T="middle"===L?0:2*l.padding,"top"===L&&(T=-T),"x"===g?(U="left"===l.align?a.axes.height:"center"===l.align?a.axes.height/2:0,"left"===l.align&&(U-=2*l.padding),"right"===l.align&&(U+=2*l.padding)):(U="left"===l.align?0:"center"===l.align?a.axes.width/2:a.axes.width,"right"===l.align&&(U-=2*l.padding),"left"===l.align&&(U+=2*l.padding)),l.coords.text={},l.coords.text["x"===g?"y":"x"]=U,l.coords.text[g]=a[g].scale.viz(l.position)+T,l.transform="x"===g?"rotate(-90,"+l.coords.text.x+","+l.coords.text.y+")":null,S.push(l))));G=D.selectAll("line.d3plus_graph_"+g+"line").data(B,function(a){return a.position}),G.enter().append("line").attr("class","d3plus_graph_"+g+"line").attr("opacity",0).call(F,g),G.transition().duration(a.draw.timing).attr("opacity",1).call(F,g),G.exit().transition().duration(a.draw.timing).attr("opacity",0).remove(),H=D.selectAll("text.d3plus_graph_"+g+"line_text").data(S,function(a){return a.position}),H.enter().append("text").attr("class","d3plus_graph_"+g+"line_text").attr("id",function(a){var b;return b=a.position+"",b=b.replace("-","neg"),b=b.replace(".","p"),"d3plus_graph_"+g+"line_text_"+b}).attr("opacity",0).call(C,g),H.text(function(a){return a.text}).transition().duration(a.draw.timing).attr("opacity",1).call(C,g),H.exit().transition().duration(a.draw.timing).attr("opacity",0).remove(),N=function(b){var c;return c=function(a){var b;return b=a.position+"",b=b.replace("-","neg"),b=b.replace(".","p"),J.select("text#d3plus_graph_"+a.axis+"line_text_"+b).node().getBBox()},b.attr("x",function(a){return c(a).x-a.padding}).attr("y",function(a){return c(a).y-a.padding}).attr("transform",function(a){return a.transform}).attr("width",function(a){return c(a).width+2*a.padding}).attr("height",function(a){return c(a).height+2*a.padding}).attr("fill",a.axes.background.color)},M=a[g].lines.font.background.value?S:[],E=D.selectAll("rect.d3plus_graph_"+g+"line_rect").data(M,function(a){return a.position}),E.enter().insert("rect","text.d3plus_graph_"+g+"line_text").attr("class","d3plus_graph_"+g+"line_rect").attr("pointer-events","none").attr("opacity",0).call(N),E.transition().delay(a.draw.timing).each("end",function(b){return d3.select(this).transition().duration(a.draw.timing).attr("opacity",1).call(N)}),E.exit().transition().duration(a.draw.timing).attr("opacity",0).remove()}}},{"../../../../../color/mix.coffee":47,"../../../../../object/validate.coffee":171,"../../../../../textwrap/textwrap.coffee":199}],313:[function(a,b,c){var d,e,f;d=a("../../../../core/fetch/value.coffee"),e=a("../../../../string/strip.js"),f=a("../../../../util/uniques.coffee"),b.exports=function(a,b){var c,g,h,i,j,k;return b||(b=a.data.viz),c=a[a.axes.discrete],h=a[a.axes.opposite],k=c.value===a.time.value,k?(j=a.data.time.ticks,g=a.time.solo.value.length?"solo":"mute",a.time[g].value.length&&(i=a.time[g].value.slice().map(function(a){return a.constructor!==Date&&(a+="",4===a.length&&parseInt(a)+""===a&&(a+="/01/01"),a=new Date(a)),+a}),j=j.filter(function(a){return"solo"===g?i.indexOf(+a)>=0:i.indexOf(+a)<0}))):j=c.ticks.values?c.ticks.values:f(b,c.value,d,a),d3.nest().key(function(b){var c,f,g,h,i,j;for(i="nesting",h=a.id.nesting.slice(0,a.depth.value+1),f=0,g=h.length;f<g;f++)c=h[f],j=d(a,b,c),j instanceof Array&&(j=j.join("_")),i+="_"+e(j);return i}).rollup(function(b){var e,i,l,m,n,o,p,q,r,s,t,u;if(e=f(b,c.value,d,a),u=e.length&&e[0].constructor===Date,u&&(e=e.map(Number)),c.zerofill.value)for(i="log"===c.scale.value?h.scale.viz.domain().every(function(a){return a<0})?-1:1:0,l=m=0,o=j.length;m<o;l=++m)if(t=j[l],s=k?+t:t,e.indexOf(s)<0){for(q={d3plus:{}},r=a.id.nesting,n=0,p=r.length;n<p;n++)g=r[n],g in b[0]&&(q[g]=b[0][g]);q[c.value]=t,q[h.value]=0,q[h.value]=i,b.splice(l,0,q)}return"string"==typeof b[0][c.value]?b:b.sort(function(b,e){var f,g,i,j,k;return f=d(a,b,c.value),i=d(a,e,c.value),(k=f-i)?k:(g=d(a,b,h.value),j=d(a,e,h.value),g-j)})}).entries(b)}},{"../../../../core/fetch/value.coffee":68,"../../../../string/strip.js":174,"../../../../util/uniques.coffee":209}],314:[function(a,b,c){var d;d=a("../../../../core/fetch/value.coffee"),b.exports=function(a,b){var c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;for(r=a.axes.stacked,e=a[r].scale.viz(0),p=a[r].scale.value,n="x"===r?"y":"x",j="y"===r?a.axes.margin.top:a.axes.margin.left,m="share"===p?"expand":"zero",q=d3.layout.stack().values(function(a){return a.values}).offset(m).x(function(a){return a.d3plus[n]}).y(function(b){return e-a[r].scale.viz(d(a,b,a[r].value))}).out(function(b,c,f){var g,h;return h=d(a,b,a[r].value),g=h<0,"share"===p?(b.d3plus[r+"0"]=(1-c)*e,b.d3plus[r]=b.d3plus[r+"0"]-f*e):(b.d3plus[r+"0"]=e-c,b.d3plus[r]=b.d3plus[r+"0"]-f),b.d3plus[r]+=j,b.d3plus[r+"0"]+=j}),o=[],l=[],f=0,h=b.length;f<h;f++)if(c=b[f],t=d(a,c,a[r].value),t instanceof Array){for(k=!0,g=0,i=t.length;g<i;g++)if(s=t[g],s>=0){k=!1;break}k?l.push(c):o.push(c)}else t>=0&&o.push(c),t<0&&l.push(c);return o.length||l.length?(o.length&&(o=q(o)),l.length&&(l=q(l)),o.concat(l)):q(b)}},{"../../../../core/fetch/value.coffee":68}],315:[function(a,b,c){var d,e,f,g,h;d=a("../../core/fetch/value.coffee"),e=a("./helpers/graph/draw.coffee"),g=a("./helpers/graph/nest.coffee"),h=a("./helpers/graph/stack.coffee"),f=function(a){var b,c,f,g,i,j,k,l,m;if(e(a,{buffer:a.axes.opposite,mouse:!0}),f=a.x.domain.viz.concat(a.y.domain.viz),f.indexOf(void 0)>=0)return[];for(c=a.data.viz,g=0,j=c.length;g<j;g++)for(l=c[g],m=l.values,i=0,k=m.length;i<k;i++)b=m[i],b.d3plus.x=a.x.scale.viz(d(a,b,a.x.value)),b.d3plus.x+=a.axes.margin.left,b.d3plus.y=a.y.scale.viz(d(a,b,a.y.value)),b.d3plus.y+=a.axes.margin.top;return a.axes.stacked?h(a,c):c},f.filter=function(a,b){return g(a,b)},f.requirements=["data","x","y"],f.setup=function(a){var b,c,d;a.axes.discrete||(b=a.time.value===a.y.value?"y":"x",a.self[b]({scale:"discrete"})),d=a[a.axes.opposite],c=a.size,!d.value&&c.value||c.changed&&c.previous===d.value?a.self[a.axes.opposite](c.value):(!c.value&&d.value||d.changed&&d.previous===c.value)&&a.self.size(d.value)},f.shapes=["line"],f.tooltip="static",b.exports=f},{"../../core/fetch/value.coffee":68,"./helpers/graph/draw.coffee":307,"./helpers/graph/nest.coffee":313,"./helpers/graph/stack.coffee":314}],316:[function(a,b,c){var d=a("../../network/smallestGap.coffee"),e=a("../../core/fetch/value.coffee"),f=function(a){var b=a.nodes.restricted||a.nodes.value,c=a.edges.restricted||a.edges.value,f=d3.extent(b,function(a){return a.x}),g=d3.extent(b,function(a){return a.y}),h=[1,1];if("number"==typeof a.size.value?h=[a.size.value,a.size.value]:a.size.value&&(h=d3.extent(b,function(b){var c=e(a,b,a.size.value);return 0===c?null:c})),"undefined"==typeof h[0]&&(h=[1,1]),"number"==typeof a.size.value)var i=a.size.value,j=a.size.value;else{var i=d(b,{accessor:function(a){return[a.x,a.y]}}),k=i/2,l=a.size.value?a.nodes.overlap:.4;if(i*=l,a.edges.arrows.value&&(i=.5*i),h[0]===h[1]){var j=k;i=k}else{var m=f[1]+1.1*i-(f[0]-1.1*i),n=g[1]+1.1*i-(g[0]-1.1*i),o=m/n,p=a.width.viz/a.height.viz;if(p>o)var q=a.height.viz/n;else var q=a.width.viz/m;var j=.25*i;j*q<2&&(j=2/q)}}var r=a.size.scale.value.domain(h).range([j,i]);a.zoom.bounds=[[f[0]-1.1*i,g[0]-1.1*i],[f[1]+1.1*i,g[1]+1.1*i]];var s=[],t={};return b.forEach(function(b){var c=a.data.viz.filter(function(c){return c[a.id.value]==b[a.id.value]})[0],d=c||{};d[a.id.value]=b[a.id.value],d.d3plus={},d.d3plus.x=b.x,d.d3plus.y=b.y;var f=e(a,d,a.size.value);d.d3plus.r=f?r(f):r.range()[0],t[d[a.id.value]]={x:d.d3plus.x,y:d.d3plus.y,r:d.d3plus.r},s.push(d)}),s.sort(function(a,b){return b.d3plus.r-a.d3plus.r}),c.forEach(function(b,c){b.d3plus&&delete b.d3plus.spline,b[a.edges.source].d3plus={};var d=t[b[a.edges.source][a.id.value]];b[a.edges.source].d3plus.r=d.r,b[a.edges.source].d3plus.x=d.x,b[a.edges.source].d3plus.y=d.y,b[a.edges.target].d3plus={};var e=t[b[a.edges.target][a.id.value]];b[a.edges.target].d3plus.r=e.r,b[a.edges.target].d3plus.x=e.x,b[a.edges.target].d3plus.y=e.y}),{nodes:s,edges:c}};f.nesting=!1,f.requirements=["nodes","edges"],f.scale=1.05,f.shapes=["circle","square","donut"],f.tooltip="static",f.zoom=!0,b.exports=f},{"../../core/fetch/value.coffee":68,"../../network/smallestGap.coffee":167}],317:[function(a,b,c){var d,e,f,g,h=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};e=a("../../network/shortestPath.coffee"),d=a("../../core/fetch/value.coffee"),f=a("../../util/uniques.coffee"),g=function(a){var b,c,e,f,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma;for(o=[],T={},T[a.focus.value[0]]=0,T[a.focus.value[1]]=0,U={all:[[a.focus.value[0]],[a.focus.value[1]]]},Y=g.paths,S=r=0,x=Y.length;r<x;S=++r)for(R=Y[S],o=o.concat(R.edges),w=a.focus.value[0],U[S]=[w],Z=R.edges,n=s=0,y=Z.length;s<y;n=++s)m=Z[n],m[a.edges.source]=a.data.viz.filter(function(b){return m[a.edges.source][a.id.value]===b[a.id.value]})[0],m[a.edges.target]=a.data.viz.filter(function(b){return m[a.edges.target][a.id.value]===b[a.id.value]})[0],L=m[a.edges.source][a.id.value]===w?"target":"source",M=m[a.edges[L]][a.id.value],void 0===T[M]&&(T[M]=S),U[S].push(M),w=M;fa=0;for(S in U)if(R=U[S],"all"!==S){for(J=0,p=t=0,z=R.length;t<z;p=++t)if(q=R[p],0!==p&&p!==R.length-1&&T[q]===parseFloat(S)){for(J=1,V=R[p-1],K=R[p+1],W=null,N=null,$=U.all,j=F=0,A=$.length;F<A;j=++F)i=$[j],h.call(i,V)>=0&&(W=j),h.call(i,K)>=0&&(N=j);null!==W&&null===N?W+1===U.all.length-1?U.all.splice(W+1,0,[q]):U.all[W+1].push(q):N-W===1?U.all.splice(N,0,[q]):N-W>1&&U.all[N-1].push(q)}fa+=J}for(ea=Math.floor(a.height.viz/fa),ma=[],p=0;p<fa;)p%2===0?ma.push(p):ma.unshift(p),p++;for(u=a.size.value&&!a.small?30:0,la=d3.scale.ordinal().domain(ma).range(d3.range(ea/2-u,a.height.viz+ea/2-u,(a.height.viz-ea)/(fa-1))),l=U.all.length,k=Math.floor(a.width.viz/l),ja=d3.scale.linear().domain([0,l-1]).rangeRound([k/2,a.width.viz-k/2]),H=5,G=.4*d3.min([k,ea-u]),ha=d3.extent(a.data.viz,function(b){var c;return c=d(a,b,a.size.value),c||0}),ga=a.size.scale.value.domain(ha).rangeRound([H,G]),_=a.data.viz,I=0,B=_.length;I<B;I++){for(O=_[I],null==O.d3plus&&(O.d3plus={}),aa=U.all,j=P=0,C=aa.length;P<C;j=++P)i=aa[j],ba=O[a.id.value],h.call(i,ba)>=0&&(O.d3plus.x=ja(j));O.d3plus.y=la(T[O[a.id.value]]),a.size.value?(ia=d(a,O,a.size.value),O.d3plus.r=ia?ga(ia):H):O.d3plus.r=G,O.d3plus.r<.1*k&&!a.small?O.d3plus.label={x:0,y:O.d3plus.r+2*a.labels.padding,w:.6*k,h:u+G-O.d3plus.r,resize:!1}:delete O.d3plus.label}for(ca=g.paths,S=Q=0,D=ca.length;Q<D;S=++Q)for(R=ca[S],w=a.focus.value[0],da=R.edges,n=X=0,E=da.length;X<E;n=++X)m=da[n],L=m[a.edges.source][a.id.value]===w?"target":"source",v="target"===L?"source":"target",M=m[a.edges[L]][a.id.value],T[w]!==T[M]?(m.d3plus={spline:!0},null==(b=m[a.edges.source]).d3plus&&(b.d3plus={}),null==(c=m[a.edges.source].d3plus).edges&&(c.edges={}),null==(e=m[a.edges.target]).d3plus&&(e.d3plus={}),null==(f=m[a.edges.target].d3plus).edges&&(f.edges={}),ka=m[L].d3plus.x-m[v].d3plus.x,m[v].d3plus.edges[m[L][a.id.value]]={angle:Math.PI,radius:k/2},m[L].d3plus.edges[m[v][a.id.value]]={angle:0,radius:k/2,offset:ka-k}):delete m.d3plus,w=M;return{nodes:a.data.viz,edges:o}},g.filter=function(a,b){var c,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;for(j=a.edges.filtered||a.edges.value,g.paths=e(j,a.focus.value[0],{target:a.focus.value[1],distance:a.edges.size.value||void 0,nodeid:a.id.value,startpoint:a.edges.source,endpoint:a.edges.target,K:a.edges.limit.value||5}),g.nodes=[],c=[],u=g.paths,m=0,p=u.length;m<p;m++)for(t=u[m],v=t.edges,n=0,q=v.length;n<q;n++)i=v[n],x=i[a.edges.source],y=i[a.edges.target],c.indexOf(x[a.id.value])<0&&(g.nodes.push(x),c.push(x[a.id.value])),c.indexOf(y[a.id.value])<0&&(g.nodes.push(y),c.push(y[a.id.value]));for(l=f(g.nodes,a.id.value,d,a),w=[],o=0,r=l.length;o<r;o++)k=l[o],h=b.filter(function(b){return b[a.id.value]===k}),h[0]?w.push(h[0]):(s={d3plus:{}},s[a.id.value]=k,w.push(s));return w},g.nesting=!1,g.requirements=[function(a){return{status:2===a.focus.value.length,text:a.format.locale.value.method.focus+" x 2"}},"edges"],g.scale=1,g.shapes=["circle","square","donut"],g.tooltip="static",b.exports=g},{"../../core/fetch/value.coffee":68,"../../network/shortestPath.coffee":166,"../../util/uniques.coffee":209}],318:[function(a,b,c){var d,e,f,g,h,i;d=a("../../array/comparator.coffee"),e=a("../../core/data/threshold.js"),f=a("../../core/fetch/value.coffee"),g=a("../../core/data/group.coffee"),h={},i=function(a){var b,c,e,i,j,k,l,m,n;for(l=d3.layout.pie().value(function(a){return a.value}).sort(function(b,c){var e,g;return a.order.value?d(b.d3plus,c.d3plus,[a.order.value],a.order.sort.value,[],a):(e=f(a,b.d3plus,a.id.value),void 0===h[e]&&(h[e]=b.value),g=f(a,c.d3plus,a.id.value),void 0===h[g]&&(h[g]=c.value),h[g]<h[e]?-1:1)}),c=g(a,a.data.viz,[]),k=l(c),n=[],m=d3.min([a.width.viz,a.height.viz])/2-2*a.labels.padding,e=0,j=k.length;e<j;e++)b=k[e],i=b.data.d3plus,i.d3plus.startAngle=b.startAngle,i.d3plus.endAngle=b.endAngle,i.d3plus.r=m,i.d3plus.x=a.width.viz/2,i.d3plus.y=a.height.viz/2,n.push(i);return n},i.filter=e,i.requirements=["data","size"],i.shapes=["arc"],i.threshold=function(a){return 1600/(a.width.viz*a.height.viz)},b.exports=i},{"../../array/comparator.coffee":34,"../../core/data/group.coffee":58,"../../core/data/threshold.js":62,"../../core/fetch/value.coffee":68}],319:[function(b,c,d){var e=b("../../array/sort.coffee"),f=b("../../client/pointer.coffee"),g=b("../../core/fetch/value.coffee"),h=b("../../core/fetch/color.coffee"),i=b("../../color/legible.coffee"),j=b("../../tooltip/remove.coffee"),k=b("../../network/smallestGap.coffee"),l=b("../../util/uniques.coffee"),m=function(b){var c=d3.min([b.height.viz,b.width.viz])/2,d=b.small||!b.labels.value?(c-2*b.labels.padding)/2:c/3,m=b.small||!b.labels.value?1.4*d:d,n=2*d,o=[],p=[],q=b.data.viz.filter(function(a){return a[b.id.value]===b.focus.value[0]})[0];q||(q={d3plus:{}},q[b.id.value]=b.focus.value[0]),q.d3plus.x=b.width.viz/2,q.d3plus.y=b.height.viz/2,q.d3plus.r=.65*m;var r=[],s=[b.focus.value[0]];b.edges.connections(b.focus.value[0],b.id.value).forEach(function(a){var c=a[b.edges.source][b.id.value]==b.focus.value[0]?a[b.edges.target]:a[b.edges.source],d=b.data.viz.filter(function(a){return a[b.id.value]===c[b.id.value]})[0];d||(d={d3plus:{}},d[b.id.value]=c[b.id.value]),d.d3plus.edges=b.edges.connections(d[b.id.value],b.id.value).filter(function(a){return a[b.edges.source][b.id.value]!=b.focus.value[0]&&a[b.edges.target][b.id.value]!=b.focus.value[0]}),d.d3plus.edge=a,s.push(d[b.id.value]),r.push(d)});var t=b.order.value||b.color.value||b.size.value||b.id.value;r.sort(function(a,c){var d=a.d3plus.edges.length-c.d3plus.edges.length;return d?d:e([a,c],t,b.order.sort.value,b.color.value||[],b)}),"number"==typeof b.edges.limit.value?r=r.slice(0,b.edges.limit.value):"function"==typeof b.edges.limit.value&&(r=b.edges.limit.value(r));var u=[],v=0;r.forEach(function(a){var c=a[b.id.value];a.d3plus.edges=a.d3plus.edges.filter(function(a){var d=a[b.edges.source][b.id.value],e=a[b.edges.target][b.id.value];return s.indexOf(d)<0&&e==c||s.indexOf(e)<0&&d==c}),v+=a.d3plus.edges.length||1,a.d3plus.edges.forEach(function(a){var d=a[b.edges.source],e=a[b.edges.target],f=e[b.id.value]==c?d:e;s.push(f[b.id.value])})}),e(r,t,b.order.sort.value,b.color.value||[],b);var w=0,x=2*Math.PI,y=0;r.forEach(function(c,d){var f=c.d3plus.edges.length||1,g=x/v*f;0==d&&(y=h,w-=g/2);var h=w+g/2;h-=x/4,c.d3plus.radians=h,c.d3plus.x=b.width.viz/2+m*Math.cos(h),c.d3plus.y=b.height.viz/2+m*Math.sin(h),w+=g,c.d3plus.edges.sort(function(a,d){var a=a[b.edges.source][b.id.value]==c[b.id.value]?a[b.edges.target]:a[b.edges.source],d=d[b.edges.source][b.id.value]==c[b.id.value]?d[b.edges.target]:d[b.edges.source];return e([a,d],t,b.order.sort.value,b.color.value||[],b)}),c.d3plus.edges.forEach(function(d,e){var g=d[b.edges.source][b.id.value]==c[b.id.value]?d[b.edges.target]:d[b.edges.source],i=x/v,j=b.data.viz.filter(function(a){return a[b.id.value]===g[b.id.value]})[0];j||(j={d3plus:{}},j[b.id.value]=g[b.id.value]),a=h-i*f/2+i/2+i*e,j.d3plus.radians=a,j.d3plus.x=b.width.viz/2+n*Math.cos(a),j.d3plus.y=b.height.viz/2+n*Math.sin(a),u.push(j)})});var z=k(r,{accessor:function(a){return[a.d3plus.x,a.d3plus.y]}}),A=k(u,{accessor:function(a){return[a.d3plus.x,a.d3plus.y]}});if(z||(z=d/2),A||(A=d/4),z/2-4<8)var B=d3.min([z/2,8]);else var B=z/2-4;if(A/2-4<4)var C=d3.min([A/2,4]);else var C=A/2-4;C>d/10&&(C=d/10),C>B&&C>10&&(C=.75*B),B>1.5*C&&(B=1.5*C),B=Math.floor(B),C=Math.floor(C);var D=l(r,b.id.value,g,b);D=D.concat(l(u,b.id.value,g,b)),D.push(b.focus.value[0]);var E=b.data.viz.filter(function(a){return D.indexOf(a[b.id.value])>=0});if(b.size.value){var F=d3.extent(E,function(a){return g(b,a,b.size.value)});F[0]==F[1]&&(F[0]=0);var c=d3.scale.linear().domain(F).rangeRound([3,d3.min([B,C])]),G=g(b,q,b.size.value);q.d3plus.r=c(G)}else{var c=d3.scale.linear().domain([1,2]).rangeRound([B,C]);b.edges.label&&(q.d3plus.r=1.5*c(1))}return u.forEach(function(a){a.d3plus.ring=2;var d=b.size.value?g(b,a,b.size.value):2;a.d3plus.r=c(d)}),r.forEach(function(a){a.d3plus.ring=1;var d=b.size.value?g(b,a,b.size.value):1;a.d3plus.r=c(d)}),p=[q].concat(r).concat(u),r.forEach(function(a,c){var e=[b.edges.source,b.edges.target],f=a.d3plus.edge;e.forEach(function(a){f[a]=p.filter(function(c){return c[b.id.value]==f[a][b.id.value]})[0]}),delete f.d3plus,o.push(f),b.edges.connections(a[b.id.value],b.id.value).forEach(function(c){var e=c[b.edges.source][b.id.value]==a[b.id.value]?c[b.edges.target]:c[b.edges.source];if(e[b.id.value]!=q[b.id.value]){var f=u.filter(function(a){return a[b.id.value]==e[b.id.value]})[0];if(f);else{f=r.filter(function(a){return a[b.id.value]==e[b.id.value]})[0]}if(f){c.d3plus={spline:!0,translate:{x:b.width.viz/2,y:b.height.viz/2}};var h=[b.edges.source,b.edges.target];h.forEach(function(e,g){c[e]=p.filter(function(a){return a[b.id.value]==c[e][b.id.value]})[0],void 0===c[e].d3plus.edges&&(c[e].d3plus.edges={});var h=0===g?c[b.edges.target][b.id.value]:c[b.edges.source][b.id.value];c[e][b.id.value]==a[b.id.value]?c[e].d3plus.edges[h]={angle:a.d3plus.radians+Math.PI,radius:d/2}:c[e].d3plus.edges[h]={angle:f.d3plus.radians,radius:d/2}}),o.push(c)}}})}),p.forEach(function(a){if(!b.small&&b.labels.value)if(a[b.id.value]!=b.focus.value[0]){a.d3plus.rotate=a.d3plus.radians*(180/Math.PI);var c=a.d3plus.rotate,e=d-3*b.labels.padding-a.d3plus.r;if(c<-90||c>90){c-=180;var f=-(a.d3plus.r+e/2+b.labels.padding),g="end"}else var f=a.d3plus.r+e/2+b.labels.padding,g="start";var j=r.indexOf(a)>=0,k=1==a.d3plus.ring?z:A;a.d3plus.label={x:f,y:0,w:e,h:k,angle:c,anchor:g,valign:"center",color:i(h(b,a)),resize:[8,b.labels.font.size],background:j,mouse:!0}}else if(b.size.value||b.edges.label){var k=m-2*a.d3plus.r-2*b.labels.padding;a.d3plus.label={x:0,y:a.d3plus.r+k/2,w:m,h:k,color:i(h(b,a)),resize:[10,40],background:!0,mouse:!0}}else delete a.d3plus.rotate,delete a.d3plus.label;else delete a.d3plus.rotate,delete a.d3plus.label}),b.mouse[f.click]=function(a){a[b.id.value]!=b.focus.value[0]&&(j(b.type.value),b.self.focus(a[b.id.value]).draw())},{edges:o,nodes:p,data:E}};m.filter=function(a,b){var c=a.edges.connections(a.focus.value[0],a.id.value,!0),d=[];c.forEach(function(b){d=d.concat(a.edges.connections(b[a.id.value],a.id.value,!0))});var e=c.concat(d),f=l(e,a.id.value,g,a),h=[];return f.forEach(function(c){var d=b.filter(function(b){return b[a.id.value]==c})[0];if(d)h.push(d);else{var e={d3plus:{}};e[a.id.value]=c,h.push(e)}}),h},m.nesting=!1,m.scale=1,m.shapes=["circle","square","donut"],m.requirements=["edges","focus"],m.tooltip="static",c.exports=m},{"../../array/sort.coffee":36,"../../client/pointer.coffee":40,"../../color/legible.coffee":45,"../../core/fetch/color.coffee":64,"../../core/fetch/value.coffee":68,"../../network/smallestGap.coffee":167,"../../tooltip/remove.coffee":202,"../../util/uniques.coffee":209}],320:[function(a,b,c){var d,e,f,g,h,i;d=a("../../core/fetch/value.coffee"),e=a("./helpers/graph/draw.coffee"),f=a("../../core/console/print.coffee"),h=a("../../array/sort.coffee"),i=a("./helpers/graph/dataTicks.coffee"),g=function(a){var b,c,f,g,j;if(e(a,{buffer:"size",mouse:!0}),c=a.x.domain.viz.concat(a.y.domain.viz),c.indexOf(void 0)>=0)return[];for(j=a.data.viz,f=0,g=j.length;f<g;f++)b=j[f],b.d3plus.x=a.x.scale.viz(d(a,b,a.x.value)),b.d3plus.x+=a.axes.margin.left,b.d3plus.y=a.y.scale.viz(d(a,b,a.y.value)),b.d3plus.y+=a.axes.margin.top,"number"!=typeof a.size.value&&a.size.value?b.d3plus.r=a.axes.scale(d(a,b,a.size.value)):b.d3plus.r=a.axes.scale(0);return i(a),h(a.data.viz,a.order.value||a.size.value||a.id.value,"desc"===a.order.sort.value?"asc":"desc",a.color.value||[],a)},g.fill=!0,g.requirements=["data","x","y"],g.scale=1.1,g.setup=function(a){if(a.time.value&&!a.axes.discrete&&(a.time.value===a.x.value&&a.self.x({scale:"discrete"}),a.time.value===a.y.value))return a.self.y({scale:"discrete"})},g.shapes=["circle","square","donut"],g.tooltip="static",b.exports=g},{"../../array/sort.coffee":36,"../../core/console/print.coffee":53,"../../core/fetch/value.coffee":68,"./helpers/graph/dataTicks.coffee":306,"./helpers/graph/draw.coffee":307}],321:[function(a,b,c){var d,e,f,g,h,i,j,k;d=a("../../util/closest.coffee"),e=a("../../core/fetch/value.coffee"),f=a("./helpers/graph/draw.coffee"),g=a("./helpers/graph/nest.coffee"),h=a("../../array/sort.coffee"),i=a("./helpers/graph/stack.coffee"),k=a("../../core/data/threshold.js"),j=function(a){var b,c,d,g,j,k,l,m,n,o,p;if(f(a,{buffer:a.axes.opposite}),g=a.x.domain.viz.concat(a.y.domain.viz),g.indexOf(void 0)>=0)return[];for(c=h(a.data.viz,null,null,null,a),d=a[a.axes.discrete],n=a[a.axes.opposite],j=0,l=c.length;j<l;j++)for(o=c[j],o.d3plus||(o.d3plus={}),p=o.values,k=0,m=p.length;k<m;k++)b=p[k],b.d3plus||(b.d3plus={}),b.d3plus.x=d.scale.viz(e(a,b,d.value)),b.d3plus.x+=a.axes.margin.left,b.d3plus.y=n.scale.viz(e(a,b,n.value)),b.d3plus.y+=a.axes.margin.top,b.d3plus.merged instanceof Array&&(o.d3plus.merged||(o.d3plus.merged=[]),o.d3plus.merged=o.d3plus.merged.concat(b.d3plus.merged)),b.d3plus.text&&!o.d3plus.text&&(o.d3plus.text=b.d3plus.text);return i(a,c)},j.filter=function(a,b){return g(a,k(a,b,a[a.axes.discrete].value))},j.requirements=["data","x","y"],j.setup=function(a){var b,c,d;a.axes.discrete||(b=a.time.value===a.y.value?"y":"x",a.self[b]({scale:"discrete"})),a[a.axes.discrete].zerofill.value||a.self[a.axes.discrete]({zerofill:!0}),a[a.axes.opposite].stacked.value||a.self[a.axes.opposite]({stacked:!0}),d=a[a.axes.opposite],c=a.size,!d.value&&c.value||c.changed&&c.previous===d.value?a.self[a.axes.opposite](c.value):(!c.value&&d.value||d.changed&&d.previous===c.value)&&a.self.size(d.value)},j.shapes=["area"],j.threshold=function(a){return 20/a.height.viz},j.tooltip="static",b.exports=j},{"../../array/sort.coffee":36,"../../core/data/threshold.js":62,"../../core/fetch/value.coffee":68,"../../util/closest.coffee":205,"./helpers/graph/draw.coffee":307,"./helpers/graph/nest.coffee":313,"./helpers/graph/stack.coffee":314}],322:[function(a,b,c){var d=a("../../core/fetch/value.coffee"),e=a("../../util/uniques.coffee"),f=a("../../util/copy.coffee"),g=a("../../color/random.coffee"),h=function(a){
var b=e(a.data.viz,a.id.value,d,a),c=e(a.cols.value);c.indexOf("label")<0&&a.cols.index.value&&c.unshift("label");var h=a.height.viz/(b.length+1),i=a.width.viz/c.length;a.group.selectAll("rect").data([0]).enter().append("rect").attr("class","background").attr("height",a.height.viz).attr("width",a.width.viz).style("fill",a.color.missing);var j=a.group.selectAll("line.horiz").data(a.data.viz);j.enter().append("line").attr("class","horiz"),j.attr("x1",0).attr("y1",function(a,b){return h*b+h}).attr("x2",a.width.viz).attr("y2",function(a,b){return h*b+h}).style("fill","#fff").style("stroke","#fff"),j.exit().remove();var k=a.group.selectAll("line.vert").data(c);k.enter().append("line").attr("class","vert"),k.attr("x1",function(a,b){return i*b+i}).attr("y1",0).attr("x2",function(a,b){return i*b+i}).attr("y2",a.height.viz).style("fill","#fff").style("stroke","#fff"),k.exit().remove();var l=[],m={};return c.forEach(function(b,c){var d={d3plus:{x:i*c+i/2,y:h/2,width:i,height:h,id:"d3p_header_"+b.toString().replace(/ /g,"_"),shape:"square",color:"#fff",text:b}};if(b==a.id.value&&(d.d3plus.color="#fff"),"label"==b&&(d.d3plus.label=!1,d.d3plus.color="#fff",d.d3plus.stroke="#fff"),l.push(d),"number"==a.data.keys[b]){var e=d3.extent(a.data.viz,function(a){return a[b]});e[0]==e[1]&&(e=[e[0]-1,e[1]]),m[b]=d3.scale.linear().domain(e).range([a.color.missing,g(b)])}else"boolean"==a.data.keys[b]&&(m[b]=function(c){return c?g(b):a.color.missing})}),a.data.viz.forEach(function(b,d){d+=1,c.forEach(function(c,e){var g=f(b);g.d3plus.id="d3p_"+g[a.id.value].toString().replace(/ /g,"_")+"_"+c,g.d3plus.x=i*e+i/2,g.d3plus.y=h*d+h/2,g.d3plus.width=i,g.d3plus.height=h,"label"==c&&(g.d3plus.shape="square",g.d3plus.color="#fff",l.push(g)),d3.keys(b).indexOf(c)>=0&&c in b&&(m[c]&&(g.d3plus.color=m[c](g[c])),g.d3plus.text=g[c],"boolean"==a.data.keys[c]?g.d3plus.label=!1:"string"==a.data.keys[c]&&(g.d3plus.color=a.color.missing,g.d3plus.stroke="#fff",g.d3plus.shape="square"),l.push(g))})}),l};h.shapes=["check","cross","diamond","square","triangle","triangle_up","triangle_down"],h.requirements=["data","cols"],b.exports=h},{"../../color/random.coffee":48,"../../core/fetch/value.coffee":68,"../../util/copy.coffee":206,"../../util/uniques.coffee":209}],323:[function(a,b,c){var d,e,f,g;d=a("../../core/data/threshold.js"),e=a("../../core/data/group.coffee"),f=a("../../object/merge.coffee"),g=function(a){var b,c,d,g,h,i,j;if(d=e(a,a.data.viz),c=d3.layout.treemap().mode(a.type.mode.value).round(!0).size([a.width.viz,a.height.viz]).children(function(a){return a.values}).padding(a.data.padding.value).sort(function(a,b){var c;return c=a.value-b.value,0===c?a.id<b.id:c}).nodes({name:"root",values:d}).filter(function(a){return!a.values&&a.area}),c.length){for(j=c[0];j.parent;)j=j.parent;for(i=[],g=0,h=c.length;g<h;g++)b=c[g],b.d3plus.d3plus=f(b.d3plus.d3plus,{x:b.x+b.dx/2,y:b.y+b.dy/2,width:b.dx,height:b.dy,share:b.value/j.value}),i.push(b.d3plus)}return i},g.filter=d,g.modes=["squarify","slice","dice","slice-dice"],g.requirements=["data","size"],g.shapes=["square"],g.threshold=function(a){return 1600/(a.width.viz*a.height.viz)},b.exports=g},{"../../core/data/group.coffee":58,"../../core/data/threshold.js":62,"../../object/merge.coffee":170}],324:[function(a,b,c){var d,e,f,g,h,i,j;d=a("../core/methods/attach.coffee"),e=a("./methods/helpers/axis.coffee"),g=a("./helpers/ui/message.js"),h=a("./helpers/drawSteps.js"),i=a("../core/console/print.coffee"),f=a("./helpers/container.coffee"),j=a("../object/validate.coffee"),b.exports=function(){var b;return b={g:{apps:{}},types:{bar:a("./types/bar.coffee"),bubbles:a("./types/bubbles.coffee"),box:a("./types/box.coffee"),chart:a("./types/deprecated/chart.coffee"),geo_map:a("./types/geo_map.coffee"),line:a("./types/line.coffee"),network:a("./types/network.js"),paths:a("./types/paths.coffee"),pie:a("./types/pie.coffee"),rings:a("./types/rings.js"),scatter:a("./types/scatter.coffee"),stacked:a("./types/stacked.coffee"),table:a("./types/table.js"),tree_map:a("./types/tree_map.coffee")}},b.self=function(a){return a.each(function(){var a,c,d,e,j,k,l;b.draw.frozen=!0,b.error.internal=null,"timing"in b.draw||(b.draw.timing=b.timing.transitions),b.error.value&&(b.draw.timing=0),b.container.changed&&f(b),k=b.width.value<=b.width.small,j=b.height.value<=b.height.small,b.small=k||j,b.width.viz=b.width.value,b.height.viz=b.height.value,a=!1,c=function(){l.length?e():b.dev.value&&(i.groupEnd(),i.timeEnd("total draw time"),i.log("\n"))},d=function(a,d){d=d||"function",a[d]instanceof Array?a[d].forEach(function(a){a(b,c)}):"function"==typeof a[d]&&a[d](b,c),a.wait||c()},e=function(){var e,f,h,j;j=l.shift(),h=b.g.message&&a===j.message,f=!("check"in j)||j.check,"function"==typeof f&&(f=f(b)),f?h?d(j):(b.dev.value&&(a!==!1&&i.groupEnd(),i.group(j.message)),"string"==typeof b.messages.value?(a=b.messages.value,e=b.messages.value):(a=j.message,e=b.format.value(j.message)),b.draw.update?(g(b,e),b.error.value?d(j):setTimeout(function(){return d(j)},10)):d(j)):"otherwise"in j?b.error.value?d(j,"otherwise"):setTimeout(function(){return d(j,"otherwise")},10):c()},b.messages.style.backup=b.group&&"1"===b.group.attr("opacity")?"small":"large",l=h(b),e()}),b.self},d(b,{active:a("./methods/active.coffee"),aggs:a("./methods/aggs.coffee"),attrs:a("./methods/attrs.coffee"),axes:a("./methods/axes.coffee"),background:a("./methods/background.coffee"),color:a("./methods/color.coffee"),cols:a("./methods/cols.js"),config:a("./methods/config.coffee"),container:a("./methods/container.coffee"),coords:a("./methods/coords.coffee"),csv:a("./methods/csv.coffee"),data:a("./methods/data.coffee"),depth:a("./methods/depth.coffee"),descs:a("./methods/descs.coffee"),dev:a("./methods/dev.coffee"),draw:a("./methods/draw.js"),edges:a("./methods/edges.js"),error:a("./methods/error.coffee"),focus:a("./methods/focus.coffee"),font:a("./methods/font.coffee"),footer:a("./methods/footer.coffee"),format:a("./methods/format.coffee"),height:a("./methods/height.coffee"),history:a("./methods/history.coffee"),icon:a("./methods/icon.coffee"),id:a("./methods/id.coffee"),labels:a("./methods/labels.coffee"),legend:a("./methods/legend.coffee"),links:a("./methods/links.coffee"),margin:a("./methods/margin.coffee"),messages:a("./methods/messages.coffee"),nodes:a("./methods/nodes.coffee"),order:a("./methods/order.coffee"),shape:a("./methods/shape.coffee"),size:a("./methods/size.coffee"),style:a("./methods/style.coffee"),temp:a("./methods/temp.coffee"),text:a("./methods/text.coffee"),time:a("./methods/time.coffee"),timeline:a("./methods/timeline.coffee"),timing:a("./methods/timing.coffee"),title:a("./methods/title.coffee"),tooltip:a("./methods/tooltip.coffee"),total:a("./methods/total.coffee"),type:a("./methods/type.coffee"),ui:a("./methods/ui.coffee"),width:a("./methods/width.coffee"),x:e("x"),y:e("y"),zoom:a("./methods/zoom.js")}),b.self}},{"../core/console/print.coffee":53,"../core/methods/attach.coffee":79,"../object/validate.coffee":171,"./helpers/container.coffee":210,"./helpers/drawSteps.js":211,"./helpers/ui/message.js":243,"./methods/active.coffee":252,"./methods/aggs.coffee":253,"./methods/attrs.coffee":254,"./methods/axes.coffee":255,"./methods/background.coffee":256,"./methods/color.coffee":257,"./methods/cols.js":258,"./methods/config.coffee":259,"./methods/container.coffee":260,"./methods/coords.coffee":261,"./methods/csv.coffee":262,"./methods/data.coffee":263,"./methods/depth.coffee":264,"./methods/descs.coffee":265,"./methods/dev.coffee":266,"./methods/draw.js":267,"./methods/edges.js":268,"./methods/error.coffee":269,"./methods/focus.coffee":270,"./methods/font.coffee":271,"./methods/footer.coffee":272,"./methods/format.coffee":273,"./methods/height.coffee":274,"./methods/helpers/axis.coffee":275,"./methods/history.coffee":276,"./methods/icon.coffee":277,"./methods/id.coffee":278,"./methods/labels.coffee":279,"./methods/legend.coffee":280,"./methods/links.coffee":281,"./methods/margin.coffee":282,"./methods/messages.coffee":283,"./methods/nodes.coffee":284,"./methods/order.coffee":285,"./methods/shape.coffee":286,"./methods/size.coffee":287,"./methods/style.coffee":288,"./methods/temp.coffee":289,"./methods/text.coffee":290,"./methods/time.coffee":291,"./methods/timeline.coffee":292,"./methods/timing.coffee":293,"./methods/title.coffee":294,"./methods/tooltip.coffee":295,"./methods/total.coffee":296,"./methods/type.coffee":297,"./methods/ui.coffee":298,"./methods/width.coffee":299,"./methods/zoom.js":300,"./types/bar.coffee":301,"./types/box.coffee":302,"./types/bubbles.coffee":303,"./types/deprecated/chart.coffee":304,"./types/geo_map.coffee":305,"./types/line.coffee":315,"./types/network.js":316,"./types/paths.coffee":317,"./types/pie.coffee":318,"./types/rings.js":319,"./types/scatter.coffee":320,"./types/stacked.coffee":321,"./types/table.js":322,"./types/tree_map.coffee":323}]},{},[162]);